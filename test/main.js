/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 55);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return core; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__observable_Observable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_reflect_metadata__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_reflect_metadata___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_reflect_metadata__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__global_Patch__ = __webpack_require__(20);




__WEBPACK_IMPORTED_MODULE_3__global_Patch__;
/**
 * 核心上下文对象，负责内核消息转发、对象注入等核心功能的实现
 *
 * @export
 * @class Core
 */
var Core = /** @class */ (function () {
    function Core() {
        /*********************** 下面是内核消息系统 ***********************/
        this._observable = new __WEBPACK_IMPORTED_MODULE_1__observable_Observable__["a" /* default */]();
        /*********************** 下面是依赖注入系统 ***********************/
        /**
         * 记录已经注入过的对象单例
         *
         * @private
         * @type {Dictionary<Function, any>}
         * @memberof Core
         */
        this._injectDict = new __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__["a" /* default */]();
        /**
         * 注入字符串类型字典，记录注入字符串和类型构造函数的映射
         *
         * @private
         * @type {Dictionary<any, IConstructor>}
         * @memberof Core
         */
        this._injectStrDict = new __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__["a" /* default */]();
        // 进行单例判断
        if (Core._instance)
            throw new Error("已生成过Core实例，不允许多次生成");
        // 赋值单例
        Core._instance = this;
        // 注入自身
        this.mapInjectValue(this);
    }
    Object.defineProperty(Core.prototype, "disposed", {
        /**
         * Core的disposed属性没有任何作用，仅为了实现接口，始终会返回false
         *
         * @readonly
         * @type {boolean}
         * @memberof Core
         */
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Core.prototype, "observable", {
        /**
         * 将IObservable暴露出来
         *
         * @readonly
         * @type {IObservable}
         * @memberof Core
         */
        get: function () {
            return this._observable;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Core.prototype, "parent", {
        /**
         * 获取到父级IObservable
         *
         * @type {IObservable}
         * @memberof Core
         */
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    /** dispatch方法实现 */
    Core.prototype.dispatch = function () {
        var params = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            params[_i] = arguments[_i];
        }
        this._observable.dispatch.apply(this._observable, params);
    };
    /**
     * 监听内核消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Core
     */
    Core.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.listen(type, handler, thisArg, once);
    };
    /**
     * 移除内核消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Core
     */
    Core.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.unlisten(type, handler, thisArg, once);
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Core
     */
    Core.prototype.mapCommand = function (type, cmd) {
        this._observable.mapCommand(type, cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Core
     */
    Core.prototype.unmapCommand = function (type, cmd) {
        this._observable.unmapCommand(type, cmd);
    };
    /**
     * 添加一个类型注入，会立即生成一个实例并注入到框架内核中
     *
     * @param {IConstructor} target 要注入的类型（注意不是实例）
     * @param {*} [type] 如果提供该参数，则使用该类型代替注入类型的key，否则使用注入类型自身作为key
     * @memberof Core
     */
    Core.prototype.mapInject = function (target, type) {
        // 如果已经注入过了，则使用已经注入的单例再次注入
        var oriTarget = target["__ori_constructor__"] || target;
        var value = this._injectDict.get(oriTarget) || new target();
        this.mapInjectValue(value, type);
    };
    /**
     * 注入一个对象实例
     *
     * @param {*} value 要注入的对象实例
     * @param {*} [type] 如果提供该参数，则使用该类型代替注入类型的key，否则使用注入实例的构造函数作为key
     * @memberof Core
     */
    Core.prototype.mapInjectValue = function (value, type) {
        // 如果是字符串则记录类型构造函数映射
        if (!(type instanceof Function) || !type.prototype) {
            this._injectStrDict.set(type, value.constructor);
            type = value.constructor;
        }
        // 记录已注入的单例
        this._injectDict.set(value.constructor, value);
        // 开始注入
        Reflect.defineMetadata("design:type", value, type["__ori_constructor__"] || type);
    };
    /**
     * 移除类型注入
     *
     * @param {*} type 要移除注入的类型
     * @memberof Core
     */
    Core.prototype.unmapInject = function (type) {
        // 如果是字符串则记录类型构造函数映射
        if (!(type instanceof Function) || !type.prototype)
            type = this._injectStrDict.get(type);
        Reflect.deleteMetadata("design:type", type["__ori_constructor__"] || type);
    };
    /**
     * 获取注入的对象实例
     *
     * @param {*} type 注入对象的类型
     * @returns {*} 注入的对象实例
     * @memberof Core
     */
    Core.prototype.getInject = function (type) {
        if (!(type instanceof Function) || !type.prototype)
            type = this._injectStrDict.get(type);
        if (type) {
            // 需要用原始的构造函数取
            type = type["__ori_constructor__"] || type;
            return Reflect.getMetadata("design:type", type);
        }
    };
    /**
     * Core的dispose方法没有任何作用，仅为了实现接口
     *
     * @memberof Core
     */
    Core.prototype.dispose = function () {
    };
    return Core;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Core);
/** 再额外导出一个单例 */
var core = new Core();


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = __extends;
/* unused harmony export __assign */
/* unused harmony export __rest */
/* harmony export (immutable) */ __webpack_exports__["a"] = __decorate;
/* unused harmony export __param */
/* harmony export (immutable) */ __webpack_exports__["c"] = __metadata;
/* unused harmony export __awaiter */
/* unused harmony export __generator */
/* unused harmony export __exportStar */
/* unused harmony export __values */
/* unused harmony export __read */
/* unused harmony export __spread */
/* unused harmony export __await */
/* unused harmony export __asyncGenerator */
/* unused harmony export __asyncDelegator */
/* unused harmony export __asyncValues */
/* unused harmony export __makeTemplateObject */
/* unused harmony export __importStar */
/* unused harmony export __importDefault */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = Object.setPrototypeOf ||
    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = Object.assign || function __assign(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = y[op[0] & 2 ? "return" : op[0] ? "throw" : "next"]) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [0, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; }; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator];
    return m ? m.call(o) : typeof __values === "function" ? __values(o) : o[Symbol.iterator]();
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["Injectable"] = Injectable;
/* harmony export (immutable) */ __webpack_exports__["Inject"] = Inject;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__global_Patch__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_reflect_metadata__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_reflect_metadata___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_reflect_metadata__);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * Core模组的装饰器注入模块
*/
/** 生成类型实例并注入，可以进行类型转换注入（即注入类型可以和注册类型不一致，采用@Injectable(AnotherClass)的形式即可） */
function Injectable() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    if (this === __WEBPACK_IMPORTED_MODULE_1__global_Patch__["decorateThis"]) {
        // 不需要转换注册类型，直接注册
        __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].mapInject(args[0]);
    }
    else {
        // 需要转换注册类型，需要返回一个ClassDecorator
        return function (realCls) {
            for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {
                var cls = args_1[_i];
                // 注入类型
                __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].mapInject(realCls, cls);
            }
            // 需要转换的也要额外将自身注入一个
            __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].mapInject(realCls);
        };
    }
}
;
function Inject(target, key) {
    if (key) {
        var cls = Reflect.getMetadata("design:type", target, key);
        doInject(target.constructor, key, cls);
    }
    else {
        return function (prototype, propertyKey) {
            doInject(prototype.constructor, propertyKey, target);
        };
    }
}
;
function doInject(cls, key, type) {
    // 监听实例化
    var target;
    Object(__WEBPACK_IMPORTED_MODULE_2__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        Object.defineProperty(instance, key, {
            configurable: true,
            enumerable: true,
            get: function () { return target || (target = __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].getInject(type)); }
        });
    });
}


/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = extendObject;
/* harmony export (immutable) */ __webpack_exports__["a"] = cloneObject;
/* unused harmony export getGUID */
/* unused harmony export getAutoIncId */
/* unused harmony export isEmpty */
/* unused harmony export trimData */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return extendsClass; });
/* harmony export (immutable) */ __webpack_exports__["d"] = getObjectHash;
/* harmony export (immutable) */ __webpack_exports__["e"] = getObjectHashs;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 对象工具集
*/
/**
 * populate properties
 * @param target        目标obj
 * @param sources       来源obj
 */
function extendObject(target) {
    var sources = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        sources[_i - 1] = arguments[_i];
    }
    sources.forEach(function (source) {
        if (!source)
            return;
        for (var propName in source) {
            if (source.hasOwnProperty(propName)) {
                target[propName] = source[propName];
            }
        }
    });
    return target;
}
/**
 * 复制对象
 * @param target 要复制的对象
 * @param deep 是否深表复制，默认浅表复制
 * @returns {any} 复制后的对象
 */
function cloneObject(target, deep) {
    if (deep === void 0) { deep = false; }
    if (target == null)
        return null;
    var newObject = Object.create(Object.getPrototypeOf(target));
    var keys = Object.keys(target);
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        var value = target[key];
        if (deep && typeof value == "object") {
            // 如果是深表复制，则需要递归复制子对象
            value = cloneObject(value, true);
        }
        var desc = Object.getOwnPropertyDescriptor(target, key);
        Object.defineProperty(newObject, key, desc);
    }
    return newObject;
}
/**
 * 生成一个随机ID
 */
function getGUID() {
    var s = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
    }
    s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
    s[19] = hexDigits.substr((parseInt(s[19]) & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
    s[8] = s[13] = s[18] = s[23] = "-";
    return s.join("");
}
var _getAutoIncIdMap = {};
/**
 * 生成自增id（从0开始）
 * @param type
 */
function getAutoIncId(type) {
    var index = _getAutoIncIdMap[type] || 0;
    _getAutoIncIdMap[type] = index++;
    return type + "-" + index;
}
/**
 * 判断对象是否为null或者空对象
 * @param obj 要判断的对象
 * @returns {boolean} 是否为null或者空对象
 */
function isEmpty(obj) {
    var result = true;
    for (var key in obj) {
        result = false;
        break;
    }
    return result;
}
/**
 * 移除data中包含的空引用或未定义
 * @param data 要被移除空引用或未定义的对象
 */
function trimData(data) {
    for (var key in data) {
        if (data[key] == null) {
            delete data[key];
        }
    }
    return data;
}
/**
 * 让child类继承自parent类
 * @param child 子类
 * @param parent 父类
 */
var extendsClass = (function () {
    var extendStatics = Object["setPrototypeOf"] ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var hash = 0;
var hashTypes = ["object", "function"];
/**
 * 获取一个对象的对象哈希字符串
 *
 * @export
 * @param {*} target 任意对象，可以是基础类型或null
 * @returns {string} 哈希值
 */
function getObjectHash(target) {
    if (target == null)
        return "__object_hash_0__";
    var key = "__object_hash__";
    var value;
    // 只有当前对象上有key才算
    if (Object.prototype.hasOwnProperty.call(target, key))
        value = target[key];
    // 如果已经有哈希值则直接返回
    if (value)
        return value;
    // 如果是基础类型则直接返回对应字符串
    var type = typeof target;
    if (hashTypes.indexOf(type) < 0)
        return type + ":" + target;
    // 如果是复杂类型则返回计算的哈希值并打上标签
    var value = "__object_hash_" + (++hash) + "__";
    Object.defineProperty(target, key, {
        configurable: true,
        enumerable: false,
        writable: false,
        value: value
    });
    return value;
}
/**
 * 获取多个对象的哈希字符串，会对每个对象调用getObjectHash生成单个哈希值，并用|连接
 *
 * @export
 * @param {...any[]} targets 希望获取哈希值的对象列表
 * @returns {string} 多个对象共同作用下的哈希值
 */
function getObjectHashs() {
    var targets = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        targets[_i] = arguments[_i];
    }
    var values = targets.map(function (target) { return getObjectHash(target); });
    return values.join("|");
}


/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ObjectUtil__ = __webpack_require__(3);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-15
 * @modify date 2017-09-15
 *
 * 字典，支持key为任意类型的对象
*/
var Dictionary = /** @class */ (function () {
    function Dictionary() {
        this._keyDict = {};
        this._valueDict = {};
    }
    Object.defineProperty(Dictionary.prototype, "size", {
        /**
         * 获取字典内的元素数量
         *
         * @readonly
         * @type {number}
         * @memberof Dictionary
         */
        get: function () {
            var size = 0;
            for (var hash in this._keyDict)
                size++;
            return size;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Dictionary.prototype, "keys", {
        /**
         * 获取字典key的集合
         *
         * @readonly
         * @type {K[]}
         * @memberof Dictionary
         */
        get: function () {
            var keys = [];
            for (var hash in this._keyDict) {
                keys.push(this._keyDict[hash]);
            }
            return keys;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Dictionary.prototype, "values", {
        /**
         * 获取字典值的集合
         *
         * @readonly
         * @type {V[]}
         * @memberof Dictionary
         */
        get: function () {
            var values = [];
            for (var hash in this._valueDict) {
                values.push(this._valueDict[hash]);
            }
            return values;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 设置一个键值对
     *
     * @param {K} key 键
     * @param {V} value 值
     * @memberof Dictionary
     */
    Dictionary.prototype.set = function (key, value) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["d" /* getObjectHash */])(key);
        this._keyDict[hash] = key;
        this._valueDict[hash] = value;
    };
    /**
     * 获取一个值
     *
     * @param {K} key 键
     * @returns {V} 值
     * @memberof Dictionary
     */
    Dictionary.prototype.get = function (key) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["d" /* getObjectHash */])(key);
        return this._valueDict[hash];
    };
    /**
     * 删除一个键值对
     *
     * @param {K} key 键
     * @memberof Dictionary
     */
    Dictionary.prototype.delete = function (key) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["d" /* getObjectHash */])(key);
        delete this._keyDict[hash];
        delete this._valueDict[hash];
    };
    /**
     * 遍历字典
     *
     * @param {(key:K, value:V)=>void} callback 每次遍历的回调
     * @memberof Dictionary
     */
    Dictionary.prototype.forEach = function (callback) {
        for (var hash in this._keyDict) {
            var key = this._keyDict[hash];
            var value = this._valueDict[hash];
            callback(key, value);
        }
    };
    return Dictionary;
}());
/* harmony default export */ __webpack_exports__["a"] = (Dictionary);


/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__ = __webpack_require__(13);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 环境参数
*/
var Environment = /** @class */ (function () {
    function Environment() {
        this._env = "dev";
        this._hostsDict = {};
        this._cdnsDict = {};
        this._curCDNIndex = 0;
    }
    Object.defineProperty(Environment.prototype, "env", {
        /**
         * 获取当前环境字符串
         *
         * @readonly
         * @type {string}
         * @memberof Environment
         */
        get: function () {
            return this._env;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Environment.prototype, "hostsDict", {
        /**
         * 获取域名字典
         *
         * @readonly
         * @type {{[env:string]:string[]}}
         * @memberof Environment
         */
        get: function () {
            return this._hostsDict;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取当前环境下某索引处的消息域名
     *
     * @param {number} [index=0] 域名字典索引，默认是0
     * @returns {string} 域名字符串，如果取不到则使用当前域名
     * @memberof Environment
     */
    Environment.prototype.getHost = function (index) {
        if (index === void 0) { index = 0; }
        var hosts = this._hostsDict[this._env];
        if (!hosts)
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])();
        return (hosts[index] || Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])());
    };
    Object.defineProperty(Environment.prototype, "cdnsDict", {
        /**
         * 获取CDN字典
         *
         * @readonly
         * @type {{[env:string]:string[]}}
         * @memberof Environment
         */
        get: function () {
            return this._cdnsDict;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Environment.prototype, "curCDNHost", {
        /**
         * 获取当前使用的CDN域名
         *
         * @readonly
         * @type {string}
         * @memberof Environment
         */
        get: function () {
            var cdns = this._cdnsDict[this._env];
            if (!cdns)
                return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])();
            return (cdns[this._curCDNIndex] || Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])());
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 切换下一个CDN
     *
     * @returns {boolean} 是否已经到达CDN列表的终点，回到了起点
     * @memberof Environment
     */
    Environment.prototype.nextCDN = function () {
        var cdns = this._cdnsDict[this._env];
        if (!cdns)
            return true;
        this._curCDNIndex++;
        if (this._curCDNIndex >= cdns.length) {
            this._curCDNIndex = 0;
            return true;
        }
        return false;
    };
    /**
     * 初始化Environment对象，因为该对象保存的数据基本来自项目初始参数，所以必须有initialize方法
     *
     * @param {string} [env] 当前所属环境字符串
     * @param {{[env:string]:string[]}} [hostsDict] host数组字典
     * @param {{[env:string]:string[]}} [cdnsDict] cdn数组字典
     * @memberof Environment
     */
    Environment.prototype.initialize = function (env, hostsDict, cdnsDict) {
        this._env = env || "dev";
        this._hostsDict = hostsDict || {};
        this._cdnsDict = cdnsDict || {};
        this._curCDNIndex = 0;
    };
    /**
     * 让url的域名变成消息域名
     *
     * @param {string} url 要转变的url
     * @param {number} [index=0] host索引，默认0
     * @returns {string} 转变后的url
     * @memberof Environment
     */
    Environment.prototype.toHostURL = function (url, index) {
        if (index === void 0) { index = 0; }
        // 加上domain
        url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.getHost(index));
        // 返回url
        return url;
    };
    /**
     * 让url的域名变成CDN域名
     *
     * @param {string} url 要转变的url
     * @param {boolean} [forced=false] 是否强制替换host
     * @param {boolean} [infix=true] 是否加入路径中缀，即host之后，index.html之前的部分，默认加入
     * @returns {string} 转变后的url
     * @memberof Environment
     */
    Environment.prototype.toCDNHostURL = function (url, forced, infix) {
        if (forced === void 0) { forced = false; }
        if (infix === void 0) { infix = true; }
        if (infix) {
            // 组织中缀
            var midnameIndex = window.location.pathname.lastIndexOf("/");
            var midname = window.location.pathname.substring(0, midnameIndex + 1);
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.curCDNHost + "/" + midname, forced);
        }
        else {
            // 只替换域名
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.curCDNHost, forced);
        }
    };
    Environment = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Environment);
    return Environment;
}());
/* harmony default export */ __webpack_exports__["default"] = (Environment);
/** 再额外导出一个单例 */
var environment = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Environment);


/***/ }),
/* 6 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["e"] = wrapConstruct;
/* harmony export (immutable) */ __webpack_exports__["a"] = getConstructor;
/* harmony export (immutable) */ __webpack_exports__["c"] = listenConstruct;
/* unused harmony export unlistenConstruct */
/* harmony export (immutable) */ __webpack_exports__["d"] = listenDispose;
/* harmony export (immutable) */ __webpack_exports__["b"] = listenApply;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ObjectUtil__ = __webpack_require__(3);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-13
 * @modify date 2017-09-13
 *
 * 装饰器工具集
*/
// 用来判断是否支持Proxy
var hasProxy = (window["Proxy"] && Proxy.revocable instanceof Function);
var instanceDict = new __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__["a" /* default */]();
function handleInstance(instance) {
    var cls = instance.constructor;
    cls = cls["__ori_constructor__"] || cls;
    var funcs = instanceDict.get(cls);
    if (funcs)
        for (var _i = 0, funcs_1 = funcs; _i < funcs_1.length; _i++) {
            var func = funcs_1[_i];
            func(instance);
        }
}
/**
 * 包装一个类型，监听类型的实例化操作
 *
 * @export
 * @param {IConstructor} cls 要监听构造的类型构造器
 * @returns {IConstructor} 新的构造函数
 */
function wrapConstruct(cls) {
    if (hasProxy) {
        // 使用Proxy监听类型构建
        return new Proxy(cls, {
            construct: function (target, args, newTarget) {
                var result = Reflect.construct(target, args, newTarget);
                if (newTarget)
                    result.constructor = newTarget;
                handleInstance(result);
                return result;
            }
        });
    }
    else {
        // 创建一个新的构造函数
        var func;
        eval('func = function ' + cls["name"] + '(){onConstruct.call(this, arguments)}');
        // 动态设置继承
        Object(__WEBPACK_IMPORTED_MODULE_1__utils_ObjectUtil__["c" /* extendsClass */])(func, cls);
        // 为新的构造函数打一个标签，用以记录原始的构造函数
        func["__ori_constructor__"] = cls;
        // 为原始构造函数也打一个标签，用以记录新构造函数
        cls["__wrap_constructor__"] = func;
        // 返回新的构造函数
        return func;
    }
    function onConstruct(args) {
        // 恢复__proto__
        Object.defineProperty(this, "__proto__", {
            configurable: true,
            enumerable: false,
            writable: true,
            value: cls.prototype
        });
        // 调用父类构造函数构造实例
        cls.apply(this, args);
        // 调用回调
        handleInstance(this);
    }
}
/**
 * 如果传入的类有包装类，则返回包装类，否则返回其本身
 *
 * @export
 * @param {IConstructor} cls 要获取包装类的类构造函数
 * @returns {IConstructor}
 */
function getConstructor(cls) {
    return (cls["__wrap_constructor__"] || cls);
}
/**
 * 监听类型的实例化
 *
 * @export
 * @param {IConstructor} cls 要监听实例化的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function listenConstruct(cls, handler) {
    cls = cls["__ori_constructor__"] || cls;
    var list = instanceDict.get(cls);
    if (!list)
        instanceDict.set(cls, list = []);
    if (list.indexOf(handler) < 0)
        list.push(handler);
}
/**
 * 移除实例化监听
 *
 * @export
 * @param {IConstructor} cls 要移除监听实例化的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function unlistenConstruct(cls, handler) {
    cls = cls["__ori_constructor__"] || cls;
    var list = instanceDict.get(cls);
    if (list) {
        var index = list.indexOf(handler);
        if (index >= 0)
            list.splice(index, 1);
    }
}
/**
 * 监听类型销毁（如果能够销毁的话，需要类型具有dispose方法），该监听不需要移除
 *
 * @export
 * @param {IConstructor} cls 要监听销毁的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function listenDispose(cls, handler) {
    var dispose = cls.prototype.dispose;
    // 判断类型是否具有dispose方法
    if (dispose) {
        // 替换dispose方法
        cls.prototype.dispose = function () {
            // 调用回调
            handler(this);
            // 调用原始dispose方法执行销毁
            return dispose.apply(this, arguments);
        };
    }
}
/**
 * 监听某个实例的某个方法调用，并插入逻辑
 *
 * @export
 * @param {IConstructor|any} target 要监听的对象类型或实例
 * @param {string} name 要监听调用的方法名
 * @param {(instance:any, args?:any[])=>any[]|void} [before] 执行前调用的回调，如果有返回值则替换掉正式方法执行时的参数
 * @param {(instance:any, args?:any[], result?:any)=>any} [after] 执行后调用的回调，可以接收正式方法的返回值，如果after有返回值则替换掉正式方法的返回值
 * @param {boolean} [once=true] 是否是一次性监听，默认是true
 */
function listenApply(target, name, before, after, once) {
    if (once === void 0) { once = true; }
    if (target instanceof Function)
        // 是个类型，监听构建后再执行处理
        listenConstruct(target, onGetInstance);
    else
        // 是个实例，直接执行处理
        onGetInstance(target);
    function onGetInstance(instance) {
        // 篡改指定方法
        var oriFunc = instance.hasOwnProperty(name) ? instance[name] : null;
        instance[name] = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // 调用回调
            var tempArgs = before && before(instance, args);
            // 替换参数
            if (tempArgs)
                args = tempArgs;
            // 如果是一次性监听，则恢复原始方法
            if (once) {
                if (oriFunc)
                    instance[name] = oriFunc;
                else
                    delete instance[name];
            }
            // 调用原始方法
            var result = instance[name].apply(this, args);
            // 调用回调
            var tempResult = after && after(instance, args, result);
            // 替换结果
            if (tempResult)
                result = tempResult;
            // 返回结果
            return result;
        };
    }
}


/***/ }),
/* 7 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["ModelClass"] = ModelClass;
/* harmony export (immutable) */ __webpack_exports__["MediatorClass"] = MediatorClass;
/* harmony export (immutable) */ __webpack_exports__["MessageHandler"] = MessageHandler;
/* harmony export (immutable) */ __webpack_exports__["GlobalMessageHandler"] = GlobalMessageHandler;
/* harmony export (immutable) */ __webpack_exports__["ResponseHandler"] = ResponseHandler;
/* harmony export (immutable) */ __webpack_exports__["GlobalResponseHandler"] = GlobalResponseHandler;
/* harmony export (immutable) */ __webpack_exports__["SubMediator"] = SubMediator;
/* harmony export (immutable) */ __webpack_exports__["BindValue"] = BindValue;
/* harmony export (immutable) */ __webpack_exports__["BindExp"] = BindExp;
/* harmony export (immutable) */ __webpack_exports__["BindFunc"] = BindFunc;
/* harmony export (immutable) */ __webpack_exports__["BindOn"] = BindOn;
/* harmony export (immutable) */ __webpack_exports__["BindIf"] = BindIf;
/* harmony export (immutable) */ __webpack_exports__["BindFor"] = BindFor;
/* harmony export (immutable) */ __webpack_exports__["BindMessage"] = BindMessage;
/* harmony export (immutable) */ __webpack_exports__["BindGlobalMessage"] = BindGlobalMessage;
/* harmony export (immutable) */ __webpack_exports__["BindResponse"] = BindResponse;
/* harmony export (immutable) */ __webpack_exports__["BindGlobalResponse"] = BindGlobalResponse;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_reflect_metadata__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_reflect_metadata___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_reflect_metadata__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_global_Patch__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__core_message_Message__ = __webpack_require__(30);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_DisplayUtil__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__bind_Utils__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__net_NetManager__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__ = __webpack_require__(43);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__BindUtil__ = __webpack_require__(45);
















/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * 负责注入的模块
*/
/** 定义数据模型，支持实例注入，并且自身也会被注入 */
function ModelClass() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    // 转调Injectable方法
    if (this === __WEBPACK_IMPORTED_MODULE_2__core_global_Patch__["decorateThis"]) {
        var cls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(args[0]);
        __WEBPACK_IMPORTED_MODULE_3__core_injector_Injector__["Injectable"].call(this, cls);
        return cls;
    }
    else {
        var result = __WEBPACK_IMPORTED_MODULE_3__core_injector_Injector__["Injectable"].apply(this, args);
        return function (realCls) {
            realCls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(realCls);
            result.call(this, realCls);
            return realCls;
        };
    }
}
/** 定义界面中介者，支持实例注入，并可根据所赋显示对象自动调整所使用的表现层桥 */
function MediatorClass(moduleName) {
    return function (cls) {
        // 判断一下Mediator是否有dispose方法，没有的话弹一个警告
        if (!cls.prototype.dispose)
            console.warn("Mediator[" + cls["name"] + "]不具有dispose方法，可能会造成内存问题，请让该Mediator实现IDisposable接口");
        // 监听实例化
        Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
            // 替换skin属性
            var $skin;
            var oriSkin = instance.skin;
            Object.defineProperty(instance, "skin", {
                configurable: true,
                enumerable: true,
                get: function () {
                    return $skin;
                },
                set: function (value) {
                    if (value === $skin)
                        return;
                    var lastBridge = this.bridge;
                    // 根据skin类型选取表现层桥
                    this.bridge = __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__["a" /* bridgeManager */].getBridgeBySkin(value);
                    // 记录值
                    if (this.bridge) {
                        if (this.bridge === lastBridge && $skin) {
                            // 需要判断桥的类型是否相同，且之前有皮肤，则替换皮肤
                            $skin = this.bridge.replaceSkin(this, $skin, value);
                        }
                        else {
                            // 否则直接包装一下皮肤
                            $skin = this.bridge.wrapSkin(this, value);
                        }
                    }
                    else {
                        // 不认识的皮肤类型，直接赋值
                        $skin = value;
                    }
                }
            });
            // 如果本来就有皮肤，则赋值皮肤
            if (oriSkin)
                instance.skin = oriSkin;
        });
        // 包装类
        var wrapperCls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(cls);
        // 注册模块，每一个Mediator都有成为独立Module的能力
        Object(__WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["registerModule"])(moduleName, wrapperCls);
        // 返回包装类
        return wrapperCls;
    };
}
function MessageHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_4__core_message_Message__["a" /* default */]))
            throw new Error("@MessageHandler装饰器装饰的方法的首个参数必须是Message");
        doMessageHandler(target.constructor, key, resClass, true);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doMessageHandler(prototype.constructor, propertyKey, target, true);
        };
    }
}
;
function GlobalMessageHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_4__core_message_Message__["a" /* default */]))
            throw new Error("@GlobalMessageHandler装饰器装饰的方法的首个参数必须是Message");
        doMessageHandler(target.constructor, key, resClass, false);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doMessageHandler(prototype.constructor, propertyKey, target, false);
        };
    }
}
;
function doMessageHandler(cls, key, type, inModule) {
    // 监听实例化
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        if (instance instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"] && instance.parent) {
            // 如果是被托管的Mediator，则需要等到被托管后再执行注册
            addSubHandler(instance, function () {
                var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
                observable.listen(type, instance[key], instance);
            });
        }
        else {
            var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
            observable.listen(type, instance[key], instance);
        }
    });
    // 监听销毁
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(cls, function (instance) {
        var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        observable.unlisten(type, instance[key], instance);
    });
}
function ResponseHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__["default"]))
            throw new Error("无参数@ResponseHandler装饰器装饰的方法的首个参数必须是ResponseData");
        doResponseHandler(target.constructor, key, defs[0], true);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doResponseHandler(prototype.constructor, propertyKey, target, true);
        };
    }
}
function GlobalResponseHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__["default"]))
            throw new Error("无参数@GlobalResponseHandler装饰器装饰的方法的首个参数必须是ResponseData");
        doResponseHandler(target.constructor, key, defs[0], false);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doResponseHandler(prototype.constructor, propertyKey, target, false);
        };
    }
}
function doResponseHandler(cls, key, type, inModule) {
    // 监听实例化
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        if (instance instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"] && instance.parent) {
            // 如果是被托管的Mediator，则需要等到被托管后再执行注册
            addSubHandler(instance, function () {
                __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].listenResponse(type, instance[key], instance, false, (inModule ? instance.observable : undefined));
            });
        }
        else {
            __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].listenResponse(type, instance[key], instance, false, (inModule ? instance.observable : undefined));
        }
    });
    // 监听销毁
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(cls, function (instance) {
        __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].unlistenResponse(type, instance[key], instance, false, (inModule ? instance.observable : undefined));
    });
}
var subHandlerDict = new __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__["a" /* default */]();
function addSubHandler(instance, handler) {
    if (!instance)
        return;
    var handlers = subHandlerDict.get(instance);
    if (!handlers)
        subHandlerDict.set(instance, handlers = []);
    if (handlers.indexOf(handler) < 0)
        handlers.push(handler);
}
function SubMediator(arg1, arg2, arg3) {
    var skin;
    var mediatorCls;
    var dataExp;
    // 判断是否是参数化装饰
    if (this === __WEBPACK_IMPORTED_MODULE_2__core_global_Patch__["decorateThis"]) {
        // 无参数
        doSubMediator(arg1, arg2);
    }
    else {
        // 有参数，分配参数
        if (typeof arg1 === "string" && !arg2 && !arg3) {
            dataExp = arg1;
        }
        else if (arg1 instanceof Function) {
            mediatorCls = arg1;
            dataExp = arg2;
        }
        else {
            skin = arg1;
            mediatorCls = arg2;
            dataExp = arg3;
        }
        // 返回装饰器方法
        return doSubMediator;
    }
    function doSubMediator(prototype, propertyKey) {
        if (prototype.delegateMediator instanceof Function && prototype.undelegateMediator instanceof Function) {
            // 监听实例化
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(prototype.constructor, function (instance) {
                var mediator;
                var temp = instance[propertyKey];
                // 篡改属性
                Object.defineProperty(instance, propertyKey, {
                    configurable: true,
                    enumerable: true,
                    get: function () {
                        return mediator;
                    },
                    set: function (value) {
                        var _this = this;
                        if (value instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"]) {
                            // 取消托管中介者
                            if (mediator) {
                                this.undelegateMediator(mediator);
                            }
                            // 设置中介者
                            mediator = value;
                            // 托管新的中介者
                            if (mediator) {
                                // 如果当前中介者没有皮肤就用装饰器皮肤
                                if (skin && !mediator.skin)
                                    mediator.skin = skin;
                            }
                        }
                        else if (value) {
                            // 赋值皮肤
                            skin = value;
                            // 如果存在中介者，则额外赋值中介者皮肤
                            if (mediator) {
                                if (mediator.skin && mediator.status < __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED) {
                                    // 当前有皮肤且中介者尚未打开完毕，说明是现在是皮肤转发阶段，要用老皮肤替换新皮肤的位置
                                    Object(__WEBPACK_IMPORTED_MODULE_7__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, value, mediator.skin);
                                    // 同步位置
                                    mediator.bridge.syncSkin(value, mediator.skin);
                                }
                                else {
                                    // 当前没皮肤，或者中介者已经打开完毕了，说明新皮肤就是要替换老皮肤
                                    mediator.skin = value;
                                }
                            }
                        }
                        else {
                            // mediator和skin都赋值为空
                            skin = value;
                            if (mediator) {
                                mediator.skin = value;
                                this.undelegateMediator(mediator);
                            }
                            mediator = value;
                        }
                        // 如果当前中介者已经为正在打开或已打开状态，则额外调用open
                        if (mediator) {
                            // 托管中介者
                            this.delegateMediator(mediator);
                            // 如果当前中介者已经为正在打开或已打开状态，则额外调用open
                            if (mediator.skin) {
                                if (mediator.status === __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].UNOPEN) {
                                    var getCommonScope = function () {
                                        return {
                                            $this: _this,
                                            $data: _this.viewModel,
                                            $bridge: _this.bridge,
                                            $currentTarget: mediator,
                                            $target: mediator
                                        };
                                    };
                                    // 子Mediator还没有open，open之
                                    if (this.status === __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED) {
                                        // 父Mediator已经open了，直接open之
                                        var data = dataExp ? Object(__WEBPACK_IMPORTED_MODULE_8__bind_Utils__["c" /* evalExp */])(dataExp, this.viewModel, this.viewModel, this.data, getCommonScope()) : this.data;
                                        if (!data)
                                            data = this.data;
                                        // 执行open方法
                                        mediator.open(data);
                                    }
                                    else if (this.status < __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED && dataExp) {
                                        // 父Mediator也没有open，监听子Mediator的open，篡改参数
                                        Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["b" /* listenApply */])(mediator, "open", function () {
                                            var data = Object(__WEBPACK_IMPORTED_MODULE_8__bind_Utils__["c" /* evalExp */])(dataExp, _this.viewModel, _this.viewModel, _this.data, getCommonScope());
                                            if (data)
                                                return [data];
                                        });
                                    }
                                }
                            }
                        }
                    }
                });
                // 实例化
                if (temp) {
                    instance[propertyKey] = temp;
                }
                else if (temp === undefined) {
                    // 优先使用装饰器提供的中介者类型，如果没有则使用元数据
                    var cls = mediatorCls || Reflect.getMetadata("design:type", prototype, propertyKey);
                    instance[propertyKey] = temp = new cls(skin);
                }
                // 执行回调
                var handlers = subHandlerDict.get(mediator);
                if (handlers) {
                    for (var _i = 0, handlers_1 = handlers; _i < handlers_1.length; _i++) {
                        var handler = handlers_1[_i];
                        handler(mediator);
                    }
                    // 移除记录
                    subHandlerDict.delete(mediator);
                }
            });
            // 监听销毁
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(prototype.constructor, function (instance) {
                var mediator = instance[propertyKey];
                if (mediator) {
                    // 移除实例
                    instance[propertyKey] = undefined;
                }
            });
        }
    }
}
var onOpenDict = new __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__["a" /* default */]();
function _listenOnOpen(prototype, before, after) {
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["b" /* listenApply */])(prototype.constructor, "onOpen", function (mediator) {
        // 记录onOpen篡改次数
        var count = onOpenDict.get(mediator) || 0;
        onOpenDict.set(mediator, count + 1);
        // 调用回调
        before && before(mediator);
    }, function (mediator) {
        // 调用回调
        after && after(mediator);
        // 递减篡改次数
        var count = onOpenDict.get(mediator) - 1;
        onOpenDict.set(mediator, count);
        // 判断是否所有onOpen都调用完毕，如果完毕了，则启动编译过程
        if (count <= 0) {
            // 移除数据
            onOpenDict.delete(mediator);
            // 全调用完毕了，按层级顺序由浅入深编译
            var bindTargets = mediator.bindTargets;
            for (var depth in bindTargets) {
                var dict = bindTargets[depth];
                dict.forEach(function (currentTarget) { return __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compile"](mediator, currentTarget); });
            }
        }
    });
}
/**
 * 获取显示对象在mediator.skin中的嵌套层级
 *
 * @param {IMediator} mediator 中介者
 * @param {*} target 目标显示对象
 * @returns {number}
 */
function getDepth(mediator, target) {
    var skin = mediator.skin;
    var bridge = mediator.bridge;
    var depth = 0;
    if (bridge.isMySkin(target)) {
        while (target && target !== skin) {
            depth++;
            target = bridge.getParent(target);
        }
        // 如果显示对象是没有根的，或者不在skin的显示树中，则返回0
        if (!target)
            depth = 0;
    }
    return depth;
}
function searchUIDepth(values, mediator, target, callback, addressing) {
    if (addressing === void 0) { addressing = false; }
    // 获取显示层级
    var depth = getDepth(mediator, target);
    // 如果有中断编译则将遍历的工作推迟到中断重启后，否则直接开始遍历
    var stopLeftHandlers = target.__stop_left_handlers__;
    if (stopLeftHandlers)
        stopLeftHandlers.push(handler);
    else
        handler(target, mediator.bindTargets, stopLeftHandlers);
    function handler(target, bindTargets, leftHandlers) {
        var index = -1;
        if (leftHandlers)
            index = leftHandlers.indexOf(handler);
        // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
        Object(__WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUI"])(values, target, function (currentTarget, name, exp, depth) {
            if (addressing)
                currentTarget = currentTarget[name];
            // 记录当前编译目标和命令本体目标到bindTargets中
            var dict = bindTargets[depth];
            if (!dict)
                bindTargets[depth] = dict = new __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__["a" /* default */]();
            dict.set(currentTarget, target);
            // 调用回调
            callback(currentTarget, target, name, exp, leftHandlers, index);
        }, depth);
    }
}
/**
 * @private
 */
function BindValue(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            // 组织参数字典
            var uiDict;
            if (typeof arg1 == "string") {
                uiDict = {};
                uiDict[arg1] = arg2;
            }
            else {
                uiDict = arg1;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            searchUIDepth(uiDict, mediator, target, function (currentTarget, target, name, exp) {
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileValue"], name, exp);
            });
        });
    };
}
/**
 * @private
 */
function BindExp(exp) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            // 组织参数字典
            var uiDict = {};
            if (exp instanceof Array) {
                for (var key in exp) {
                    uiDict[key] = exp[key];
                }
            }
            else {
                uiDict[""] = exp;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            searchUIDepth(uiDict, mediator, target, function (currentTarget, target, name, exp) {
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileExp"], exp);
            });
        });
    };
}
/**
 * @private
 */
function BindFunc(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            // 组织参数字典
            var funcDict;
            if (typeof arg1 == "string") {
                funcDict = {};
                funcDict[arg1] = arg2;
            }
            else {
                funcDict = arg1;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            searchUIDepth(funcDict, mediator, target, function (currentTarget, target, name, argExps) {
                // 统一参数类型为字符串数组
                if (!(argExps instanceof Array))
                    argExps = [argExps];
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"].apply(__WEBPACK_IMPORTED_MODULE_14__BindUtil__, [currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFunc"], name].concat(argExps));
            });
        });
    };
}
/**
 * @private
 */
function BindOn(arg1, arg2, arg3) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            // 获取编译启动目标
            var target = mediator[propertyKey];
            // 组织参数字典
            if (typeof arg1 == "string") {
                if (arg3) {
                    // 指定了UI对象，先去寻找
                    var nameDict = {};
                    nameDict[arg1] = "";
                    searchUIDepth(nameDict, mediator, target, function (currentTarget, target, type, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], arg2, arg3);
                    }, true);
                }
                else {
                    var evtDict = {};
                    evtDict[arg1] = arg2;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    searchUIDepth(evtDict, mediator, target, function (currentTarget, target, type, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], type, exp);
                    });
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                searchUIDepth(arg1, mediator, target, function (currentTarget, target, type, exp) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], type, exp);
                });
            }
        });
    };
}
/**
 * @private
 */
function BindIf(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 === "string" || arg1 instanceof Function) {
                if (!arg2) {
                    // 没有指定寻址路径，就是要操作当前对象，但也要经过一次searchUIDepth操作
                    searchUIDepth({ r: 13 }, mediator, target, function (currentTarget, target, name, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], arg1);
                    });
                }
                else {
                    // 指定了寻址路径，需要寻址
                    var uiDict = {};
                    uiDict[arg1] = arg2;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    searchUIDepth(uiDict, mediator, target, function (currentTarget, target, name, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], exp);
                    }, true);
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                searchUIDepth(arg1, mediator, target, function (currentTarget, target, name, exp) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], exp);
                }, true);
            }
        });
    };
}
/**
 * @private
 */
function BindFor(arg1, arg2, arg3) {
    // 组织参数
    var uiDict;
    var name;
    var exp;
    var mediatorCls;
    if (typeof arg1 === "string") {
        if (typeof arg2 === "string") {
            name = arg1;
            exp = arg2;
            mediatorCls = arg3;
        }
        else {
            exp = arg1;
            mediatorCls = arg2;
        }
    }
    else {
        uiDict = arg1;
    }
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            // 取到编译目标对象
            var target = mediator[propertyKey];
            // 开始赋值指令
            if (!uiDict) {
                if (!name) {
                    // 没有指定寻址路径，就是要操作当前对象，但也要经过一次searchUIDepth操作
                    searchUIDepth({ r: 13 }, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], exp, mediatorCls);
                        // 设置中断编译
                        target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                    });
                }
                else {
                    // 指定了寻址路径，需要寻址
                    var uiDict = {};
                    uiDict[name] = exp;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    searchUIDepth(uiDict, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], _exp, mediatorCls);
                        // 设置中断编译
                        target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                    }, true);
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                searchUIDepth(uiDict, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], _exp, mediatorCls);
                    // 设置中断编译
                    target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                }, true);
            }
        });
    };
}
function doBindMessage(mediator, target, type, uiDict, observable) {
    searchUIDepth(uiDict, mediator, target, function (currentTarget, target, name, exp) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileMessage"], type, name, exp, observable);
    });
}
/**
 * @private
 */
function BindMessage(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindMessage(mediator, target, arg1, arg2, mediator.observable);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindMessage(mediator, target, type, arg1[type], mediator.observable);
                }
            }
        });
    };
}
/**
 * @private
 */
function BindGlobalMessage(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindMessage(mediator, target, arg1, arg2);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindMessage(mediator, target, type, arg1[type]);
                }
            }
        });
    };
}
function doBindResponse(mediator, target, type, uiDict, observable) {
    searchUIDepth(uiDict, mediator, target, function (currentTarget, target, name, exp) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileResponse"], type, name, exp, observable);
    });
}
/**
 * @private
 */
function BindResponse(arg1, arg2) {
    return function (prototype, propertyKey) {
        // Response需要在onOpen之后执行，因为可能有初始化消息需要绑定，要在onOpen后有了viewModel再首次更新显示
        _listenOnOpen(prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindResponse(mediator, target, arg1, arg2, mediator.observable);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindResponse(mediator, target, type, arg1[type], mediator.observable);
                }
            }
        });
    };
}
/**
 * @private
 */
function BindGlobalResponse(arg1, arg2) {
    return function (prototype, propertyKey) {
        _listenOnOpen(prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindResponse(mediator, target, arg1, arg2);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindResponse(mediator, target, type, arg1[type]);
                }
            }
        });
    };
}


/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["registerModule"] = registerModule;
/* harmony export (immutable) */ __webpack_exports__["getModule"] = getModule;
/* harmony export (immutable) */ __webpack_exports__["getModuleName"] = getModuleName;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_observable_Observable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bind_Mutator__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bind_BindManager__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__net_NetManager__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__utils_ArrayUtil__ = __webpack_require__(42);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__MediatorMessage__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__system_System__ = __webpack_require__(25);














var moduleDict = {};
var moduleNameDict = new __WEBPACK_IMPORTED_MODULE_2__utils_Dictionary__["a" /* default */]();
/**
 * 注册模块
 *
 * @export
 * @param {string} moduleName 模块名
 * @param {IMediatorConstructor} cls 模块类型
 */
function registerModule(moduleName, cls) {
    moduleDict[moduleName] = cls;
    moduleNameDict.set(cls, moduleName);
}
/**
 * 获取模块类型
 *
 * @export
 * @param {string} moduleName 模块名
 * @returns {IMediatorConstructor}
 */
function getModule(moduleName) {
    return moduleDict[moduleName];
}
/**
 * 获取模块名
 *
 * @export
 * @param {ModuleType} type 模块实例或模块类型
 * @returns {string} 模块名
 */
function getModuleName(type) {
    var cls = Object(__WEBPACK_IMPORTED_MODULE_12__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
    return moduleNameDict.get(cls);
}
var Mediator = /** @class */ (function () {
    function Mediator(skin) {
        this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].UNOPEN;
        /**
         * 绑定目标数组，第一层key是调用层级，第二层是该层级需要编译的对象数组
         *
         * @type {Dictionary<any, any>[]}
         * @memberof Mediator
         */
        this.bindTargets = [];
        this._openMask = true;
        this._listeners = [];
        this._disposeDict = new __WEBPACK_IMPORTED_MODULE_2__utils_Dictionary__["a" /* default */]();
        /**
         * 父中介者
         *
         * @type {IMediator}
         * @memberof Mediator
         */
        this.parent = null;
        this._children = [];
        /*********************** 下面是模块消息系统 ***********************/
        this._observable = new __WEBPACK_IMPORTED_MODULE_1__core_observable_Observable__["a" /* default */](__WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */]);
        // 赋值模块名称
        this._moduleName = getModuleName(this);
        // 赋值皮肤
        if (skin)
            this.skin = skin;
        this.oriSkin = skin;
        // 初始化绑定
        __WEBPACK_IMPORTED_MODULE_4__bind_BindManager__["a" /* bindManager */].bind(this);
    }
    Object.defineProperty(Mediator.prototype, "status", {
        /**
         * 获取中介者状态
         *
         * @readonly
         * @type {MediatorStatus}
         * @memberof Mediator
         */
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "viewModel", {
        /**
         * 获取或设置ViewModel
         *
         * @type {*}
         * @memberof Mediator
         */
        get: function () {
            return this._viewModel;
        },
        set: function (value) {
            // 设置的时候进行一次变异
            this._viewModel = Object(__WEBPACK_IMPORTED_MODULE_3__bind_Mutator__["a" /* mutate */])(value);
            // 更新绑定
            __WEBPACK_IMPORTED_MODULE_4__bind_BindManager__["a" /* bindManager */].bind(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "disposed", {
        /**
         * 获取中介者是否已被销毁
         *
         * @readonly
         * @type {boolean}
         * @memberof Mediator
         */
        get: function () {
            return (this._status === __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].DISPOSED);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "data", {
        /**
         * 打开时传递的data对象
         *
         * @type {*}
         * @memberof Mediator
         */
        get: function () {
            return this._data;
        },
        set: function (value) {
            this._data = value;
            // 递归设置子中介者的data
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var mediator = _a[_i];
                mediator.data = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "openMask", {
        /**
         * 开启时是否触发全屏遮罩，防止用户操作，设置操作会影响所有子孙中介者。默认是true
         *
         * @type {boolean}
         * @memberof Mediator
         */
        get: function () {
            return this._openMask;
        },
        set: function (value) {
            this._openMask = value;
            // 递归设置所有子中介者的openMask
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var child = _a[_i];
                child.openMask = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "responses", {
        /**
         * 模块初始消息的返回数据
         *
         * @type {ResponseData[]}
         * @memberof Mediator
         */
        get: function () {
            return this._responses;
        },
        set: function (value) {
            this._responses = value;
            // 递归设置子中介者的data
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var mediator = _a[_i];
                mediator.responses = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "moduleName", {
        /**
         * 获取模块名
         *
         * @readonly
         * @type {string}
         * @memberof Mediator
         */
        get: function () {
            return this._moduleName;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载从listAssets中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @returns {void}
     * @memberof Mediator
     */
    Mediator.prototype.loadAssets = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadAssets接口
                _this.onLoadAssets(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的资源
                var mediator = mediators.shift();
                mediator.loadAssets(temp);
            }
        };
        // 加载自身资源
        var assets = this.listAssets();
        if (assets && assets.length > 0) {
            // 去重
            assets = Object(__WEBPACK_IMPORTED_MODULE_10__utils_ArrayUtil__["a" /* unique */])(assets);
            // 开始加载
            this.bridge.loadAssets(assets, this, temp);
        }
        else {
            // 没有资源，直接调用回调
            handler();
        }
    };
    /**
     * 加载从listStyleFiles中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.loadStyleFiles = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadStyleFiles接口
                _this.onLoadStyleFiles(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的资源
                var mediator = mediators.shift();
                mediator.loadStyleFiles(temp);
            }
        };
        // 开始加载css文件
        var cssFiles = this.listStyleFiles();
        // 去重
        cssFiles = Object(__WEBPACK_IMPORTED_MODULE_10__utils_ArrayUtil__["a" /* unique */])(cssFiles);
        // 加载
        __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["b" /* assetsManager */].loadStyleFiles(cssFiles, temp);
    };
    /**
     * 加载从listJsFiles中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.loadJsFiles = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadJsFiles接口
                _this.onLoadJsFiles(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的js
                var mediator = mediators.shift();
                mediator.loadJsFiles(temp);
            }
        };
        // 开始加载js文件
        var jsFiles = this.listJsFiles();
        // 去重
        jsFiles = Object(__WEBPACK_IMPORTED_MODULE_10__utils_ArrayUtil__["a" /* unique */])(jsFiles);
        // 加载
        __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["b" /* assetsManager */].loadJsFiles(jsFiles, temp);
    };
    /**
     * 发送从listInitRequests中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.sendInitRequests = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (responses) {
            if (responses instanceof Error) {
                var err = responses instanceof Error ? responses : undefined;
                // 调用onSendInitRequests接口
                _this.onSendInitRequests(err);
                // 调用回调
                handler(err);
            }
            else {
                if (isMine) {
                    isMine = false;
                    // 赋值返回值
                    _this.responses = responses;
                    // 调用回调
                    var stop = _this.onGetResponses(responses);
                    if (stop) {
                        var err = new Error("用户中止打开模块操作");
                        // 调用onSendInitRequests接口
                        _this.onSendInitRequests(err);
                        // 调用回调
                        handler(err);
                        return;
                    }
                }
                if (mediators.length <= 0) {
                    // 调用onSendInitRequests接口
                    _this.onSendInitRequests();
                    // 调用回调
                    handler();
                }
                else {
                    // 发送一个子中介者的初始化消息
                    var mediator = mediators.shift();
                    mediator.sendInitRequests(temp);
                }
            }
        };
        // 发送所有模块消息，模块消息默认发送全局内核
        var isMine = true;
        __WEBPACK_IMPORTED_MODULE_7__net_NetManager__["netManager"].sendMultiRequests(this.listInitRequests(), temp, this, this.observable);
    };
    /**
     * 当所需资源加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadAssets = function (err) {
    };
    /**
     * 当所需CSS加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadStyleFiles = function (err) {
    };
    /**
     * 当所需js加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadJsFiles = function (err) {
    };
    /**
     * 当所需资源加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onSendInitRequests = function (err) {
    };
    /**
     * 当获取到所有初始化请求返回时调用，可以通过返回一个true来阻止模块的打开
     *
     * @param {ResponseData[]} responses 返回结构数组
     * @returns {boolean} 返回true则表示停止模块打开
     * @memberof Mediator
     */
    Mediator.prototype.onGetResponses = function (responses) {
        return false;
    };
    /**
     * 打开，为了实现IOpenClose接口
     *
     * @param {*} [data] 开启数据
     * @param {...any[]} args 其他数据
     * @returns {*} 返回自身引用
     * @memberof Mediator
     */
    Mediator.prototype.open = function (data) {
        var _this = this;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 判断状态
        if (this._status === __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].UNOPEN) {
            // 修改状态
            this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].OPENING;
            // 赋值参数
            this.data = data;
            // 记一个是否需要遮罩的flag
            var maskFlag = this.openMask;
            // 发送初始化消息
            this.sendInitRequests(function (err) {
                if (err) {
                    // 移除遮罩
                    hideMask();
                    // 调用回调
                    _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                }
                else {
                    // 加载所有已托管中介者的资源
                    _this.loadAssets(function (err) {
                        if (err) {
                            // 移除遮罩
                            hideMask();
                            // 调用回调
                            _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                        }
                        else {
                            // 加载css文件
                            _this.loadStyleFiles(function (err) {
                                if (err) {
                                    // 移除遮罩
                                    hideMask();
                                    // 调用回调
                                    _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                                }
                                else {
                                    // 加载js文件
                                    _this.loadJsFiles(function (err) {
                                        // 移除遮罩
                                        hideMask();
                                        // 判断错误
                                        if (err) {
                                            // 调用回调
                                            _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                                        }
                                        else {
                                            // 要先开启自身，再开启子中介者
                                            // 调用回调
                                            _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].BeforeOpen);
                                            // 调用模板方法
                                            _this.__beforeOnOpen.apply(_this, [data].concat(args));
                                            // 调用自身onOpen方法
                                            var result = _this.onOpen.apply(_this, [data].concat(args));
                                            if (result !== undefined)
                                                _this.data = data = result;
                                            // 初始化绑定，如果子类并没有在onOpen中设置viewModel，则给一个默认值以启动绑定功能
                                            if (!_this._viewModel)
                                                _this.viewModel = {};
                                            // 记录子中介者数量，并监听其开启完毕事件
                                            var subCount = _this._children.length;
                                            if (subCount > 0) {
                                                // 调用所有已托管中介者的open方法
                                                for (var _i = 0, _a = _this._children; _i < _a.length; _i++) {
                                                    var mediator = _a[_i];
                                                    mediator.open(data);
                                                }
                                            }
                                            // 修改状态
                                            _this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].OPENED;
                                            // 调用模板方法
                                            _this.__afterOnOpen.apply(_this, [data].concat(args));
                                            // 调用回调
                                            _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_9__IMediatorModulePart__["a" /* ModuleOpenStatus */].AfterOpen);
                                            // 派发事件
                                            _this.dispatch(__WEBPACK_IMPORTED_MODULE_11__MediatorMessage__["a" /* default */].MEDIATOR_OPENED, _this);
                                        }
                                    });
                                }
                            });
                        }
                    });
                }
            });
            // 显示Loading
            if (maskFlag) {
                __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].showLoading(null, "mediatorOpen");
                maskFlag = false;
            }
        }
        // 返回自身引用
        return this;
        function hideMask() {
            // 隐藏Loading
            if (!maskFlag)
                __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].hideLoading("mediatorOpen");
            maskFlag = false;
        }
    };
    Mediator.prototype.__beforeOnOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    Mediator.prototype.__afterOnOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    /**
     * 关闭，为了实现IOpenClose接口
     *
     * @param {*} [data] 关闭数据
     * @param {...any[]} args 其他参数
     * @returns {*} 返回自身引用
     * @memberof Mediator
     */
    Mediator.prototype.close = function (data) {
        var _this = this;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        if (this._status === __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].OPENED) {
            var doClose = function () {
                // 调用模板方法
                _this.__beforeOnClose.apply(_this, [data].concat(args));
                // 修改状态
                _this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].CLOSING;
                // 调用自身onClose方法
                _this.onClose.apply(_this, [data].concat(args));
                // 修改状态
                _this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].CLOSED;
                // 调用模板方法
                _this.__afterOnClose.apply(_this, [data].concat(args));
            };
            var subCount = this._children.length;
            if (subCount > 0) {
                var handler = function (mediator) {
                    if (_this._children.indexOf(mediator) >= 0 && --subCount === 0) {
                        // 取消监听
                        _this.unlisten(__WEBPACK_IMPORTED_MODULE_11__MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, handler);
                        // 执行关闭
                        doClose();
                    }
                };
                this.listen(__WEBPACK_IMPORTED_MODULE_11__MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, handler);
                // 调用所有已托管中介者的close方法
                for (var _a = 0, _b = this._children.concat(); _a < _b.length; _a++) {
                    var mediator = _b[_a];
                    mediator.close(data);
                }
            }
            else {
                // 没有子中介者，直接执行
                doClose();
            }
        }
        // 返回自身引用
        return this;
    };
    Mediator.prototype.__beforeOnClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    Mediator.prototype.__afterOnClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 派发关闭事件
        this.dispatch(__WEBPACK_IMPORTED_MODULE_11__MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, this);
        // 给子类用的模板方法
        this.dispose();
    };
    /**
     * 当打开时调用
     *
     * @param {*} [data] 可能的打开参数
     * @param {...any[]} args 其他参数
     * @returns {*} 若返回对象则使用该对象替换传入的data进行后续开启操作
     * @memberof Mediator
     */
    Mediator.prototype.onOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 可重写
    };
    /**
     * 当关闭时调用
     *
     * @param {*} [data] 可能的关闭参数
     * @param {...any[]} args 其他参数
     * @memberof Mediator
     */
    Mediator.prototype.onClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 可重写
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {*} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof Mediator
     */
    Mediator.prototype.mapListener = function (target, type, handler, thisArg) {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners[i];
            if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                // 已经存在一样的监听，不再监听
                return;
            }
        }
        // 记录监听
        this._listeners.push({ target: target, type: type, handler: handler, thisArg: thisArg });
        // 调用桥接口
        this.bridge.mapListener(target, type, handler, thisArg);
    };
    /**
     * 注销监听事件
     *
     * @param {*} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof Mediator
     */
    Mediator.prototype.unmapListener = function (target, type, handler, thisArg) {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners[i];
            if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                // 调用桥接口
                this.bridge.unmapListener(target, type, handler, thisArg);
                // 移除记录
                this._listeners.splice(i, 1);
                break;
            }
        }
    };
    /**
     * 注销所有注册在当前中介者上的事件监听
     *
     * @memberof Mediator
     */
    Mediator.prototype.unmapAllListeners = function () {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners.pop();
            // 调用桥接口
            this.bridge.unmapListener(data.target, data.type, data.handler, data.thisArg);
        }
    };
    Mediator.prototype.disposeChild = function (mediator, oriDispose) {
        // 调用原始销毁方法
        oriDispose.call(mediator);
        // 取消托管
        this.undelegateMediator(mediator);
    };
    ;
    Object.defineProperty(Mediator.prototype, "root", {
        /**
         * 获取根级中介者（当做模块直接被打开的中介者）
         *
         * @type {IMediator}
         * @memberof IMediator
         */
        get: function () {
            return (this.parent ? this.parent.root : this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "children", {
        /**
         * 获取所有子中介者
         *
         * @type {IMediator[]}
         * @memberof Mediator
         */
        get: function () {
            return this._children;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 托管子中介者
     *
     * @param {IMediator} mediator 要托管的中介者
     * @memberof Mediator
     */
    Mediator.prototype.delegateMediator = function (mediator) {
        if (this._children.indexOf(mediator) < 0) {
            // 托管新的中介者
            this._children.push(mediator);
            // 设置关系
            mediator.parent = this;
            // 设置observable关系
            mediator.observable.parent = this._observable;
            // 篡改dispose方法，以监听其dispose
            if (mediator.hasOwnProperty("dispose"))
                this._disposeDict.set(mediator, mediator.dispose);
            mediator.dispose = this.disposeChild.bind(this, mediator, mediator.dispose);
        }
    };
    /**
     * 取消托管子中介者
     *
     * @param {IMediator} mediator 要取消托管的中介者
     * @memberof Mediator
     */
    Mediator.prototype.undelegateMediator = function (mediator) {
        var index = this._children.indexOf(mediator);
        if (index >= 0) {
            // 取消托管中介者
            this._children.splice(index, 1);
            // 移除关系
            mediator.parent = null;
            // 移除observable关系
            if (mediator.observable)
                mediator.observable.parent = null;
            // 恢复dispose方法，取消监听dispose
            var oriDispose = this._disposeDict.get(mediator);
            if (oriDispose)
                mediator.dispose = oriDispose;
            else
                delete mediator.dispose;
            this._disposeDict.delete(mediator);
        }
    };
    /**
     * 判断指定中介者是否包含在该中介者里（判断范围包括当前中介者和子孙级中介者）
     *
     * @param {IMediator} mediator 要判断的中介者
     * @returns {boolean}
     * @memberof Mediator
     */
    Mediator.prototype.containsMediator = function (mediator) {
        // 首先判断自身
        if (mediator === this)
            return true;
        // 判断子中介者
        var contains = false;
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var child = _a[_i];
            if (child.containsMediator(mediator)) {
                contains = true;
                break;
            }
        }
        return contains;
    };
    /**
     * 其他模块被关闭回到当前模块时调用
     *
     * @param {(IMediator|undefined)} from 从哪个模块回到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.wakeUp = function (from, data) {
        // 调用自身方法
        this.onWakeUp(from, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onWakeUp(from, data);
        }
    };
    /**
     * 模块切换到前台时调用（与wakeUp的区别是open时activate会触发，但wakeUp不会）
     *
     * @param {(IMediator|undefined)} from 从哪个模块来到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.activate = function (from, data) {
        // 调用自身方法
        this.onActivate(from, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onActivate(from, data);
        }
    };
    /**
     * 模块切换到后台时调用（close之后或者其他模块打开时）
     *
     * @param {(IMediator|undefined)} to 将要去往哪个模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.deactivate = function (to, data) {
        // 调用自身方法
        this.onDeactivate(to, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onDeactivate(to, data);
        }
    };
    /**
     * 列出中介者所需的资源数组，可重写
     *
     * @returns {string[]}
     * @memberof Mediator
     */
    Mediator.prototype.listAssets = function () {
        return null;
    };
    /**
     * 列出所需CSS资源URL，可重写
     *
     * @returns {string[]}
     * @memberof Mediator
     */
    Mediator.prototype.listStyleFiles = function () {
        return null;
    };
    /**
     * 列出所需JS资源URL，可重写
     *
     * @returns {string[]}
     * @memberof Mediator
     */
    Mediator.prototype.listJsFiles = function () {
        return null;
    };
    /**
     * 列出模块初始化请求，可重写
     *
     * @returns {RequestData[]}
     * @memberof Mediator
     */
    Mediator.prototype.listInitRequests = function () {
        return null;
    };
    /**
     * 其他模块被关闭回到当前模块时调用
     *
     * @param {(IMediator|undefined)} from 从哪个模块回到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onWakeUp = function (from, data) {
        // 可重写
    };
    /**
     * 模块切换到前台时调用（与onWakeUp的区别是open时onActivate会触发，但onWakeUp不会）
     *
     * @param {(IMediator|undefined)} from 从哪个模块来到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onActivate = function (from, data) {
        // 可重写
    };
    /**
     * 模块切换到后台时调用（close之后或者其他模块打开时）
     *
     * @param {(IMediator|undefined)} to 将要去往哪个模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onDeactivate = function (to, data) {
        // 可重写
    };
    Object.defineProperty(Mediator.prototype, "observable", {
        /**
         * 暴露IObservable
         *
         * @readonly
         * @type {IObservable}
         * @memberof Mediator
         */
        get: function () {
            return this._observable;
        },
        enumerable: true,
        configurable: true
    });
    /** dispatch方法实现 */
    Mediator.prototype.dispatch = function () {
        var params = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            params[_i] = arguments[_i];
        }
        this._observable.dispatch.apply(this._observable, params);
    };
    /**
     * 监听消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Mediator
     */
    Mediator.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.listen(type, handler, thisArg, once);
    };
    /**
     * 移除消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Mediator
     */
    Mediator.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.unlisten(type, handler, thisArg, once);
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Mediator
     */
    Mediator.prototype.mapCommand = function (type, cmd) {
        this._observable.mapCommand(type, cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Mediator
     */
    Mediator.prototype.unmapCommand = function (type, cmd) {
        this._observable.unmapCommand(type, cmd);
    };
    /**
     * 销毁中介者
     *
     * @memberof Mediator
     */
    Mediator.prototype.dispose = function () {
        var _this = this;
        // 判断状态
        if (this.status >= __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].DISPOSING)
            return;
        // 修改状态
        this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].DISPOSING;
        // 移除绑定
        __WEBPACK_IMPORTED_MODULE_4__bind_BindManager__["a" /* bindManager */].unbind(this);
        // 注销事件监听
        this.unmapAllListeners();
        // 调用模板方法
        this.onDispose();
        // 移除显示，只移除没有原始皮肤的，因为如果有原始皮肤，其原始parent可能不希望子节点被移除
        if (!this.oriSkin) {
            if (this.skin && this.bridge) {
                var parent = this.bridge.getParent(this.skin);
                if (parent)
                    this.bridge.removeChild(parent, this.skin);
            }
        }
        // 移除表现层桥
        this.bridge = null;
        // 移除ViewModel
        this._viewModel = null;
        // 移除绑定目标数组
        this.bindTargets = null;
        // 移除皮肤
        this.skin = null;
        this.oriSkin = null;
        // 将所有子中介者销毁
        for (var i = 0, len = this._children.length; i < len; i++) {
            var mediator = this._children.pop();
            this.undelegateMediator(mediator);
            mediator.dispose();
        }
        // 将observable的销毁拖延到下一帧，因为虽然执行了销毁，但有可能这之后还会使用observable发送消息
        __WEBPACK_IMPORTED_MODULE_13__system_System__["a" /* system */].nextFrame(function () {
            // 移除observable
            _this._observable.dispose();
            _this._observable = null;
            // 修改状态
            _this._status = __WEBPACK_IMPORTED_MODULE_8__MediatorStatus__["a" /* default */].DISPOSED;
        });
    };
    /**
     * 当销毁时调用
     *
     * @memberof Mediator
     */
    Mediator.prototype.onDispose = function () {
        // 可重写
    };
    return Mediator;
}());
/* harmony default export */ __webpack_exports__["default"] = (Mediator);


/***/ }),
/* 9 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return bridgeManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mediator_Mediator__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__BridgeMessage__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__panel_PanelManager__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__scene_SceneManager__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__module_ModuleManager__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__mask_MaskManager__ = __webpack_require__(15);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 用来管理所有表现层对象
*/
var BridgeManager = /** @class */ (function () {
    function BridgeManager() {
        this._bridgeDict = {};
        this._bridgeList = [];
    }
    Object.defineProperty(BridgeManager.prototype, "currentBridge", {
        /**
         * 获取当前的表现层桥实例（规则是取当前模块的第一个拥有bridge属性的Mediator的bridge）
         *
         * @readonly
         * @type {IBridge}
         * @memberof BridgeManager
         */
        get: function () {
            // 找出当前的场景或模块
            var curHasBridge = __WEBPACK_IMPORTED_MODULE_6__scene_SceneManager__["a" /* sceneManager */].currentScene || __WEBPACK_IMPORTED_MODULE_7__module_ModuleManager__["moduleManager"].currentModuleInstance;
            // 先用当前首个IHasBridge的bridge
            if (curHasBridge) {
                var hasBridges = this.getAllHasBridges(curHasBridge);
                for (var _i = 0, hasBridges_1 = hasBridges; _i < hasBridges_1.length; _i++) {
                    var hasBridge = hasBridges_1[_i];
                    if (hasBridge.bridge)
                        return hasBridge.bridge;
                }
            }
            // 没找到，再用第一个桥代替
            return (this._bridgeList[0] && this._bridgeList[0][0]);
        },
        enumerable: true,
        configurable: true
    });
    BridgeManager.prototype.getAllHasBridges = function (hasBridge) {
        var result = [hasBridge];
        // 如果是中介者，则额外提供子中介者
        if (hasBridge instanceof __WEBPACK_IMPORTED_MODULE_3__mediator_Mediator__["default"]) {
            for (var _i = 0, _a = hasBridge.children; _i < _a.length; _i++) {
                var temp = _a[_i];
                result = result.concat(this.getAllHasBridges(temp));
            }
        }
        return result;
    };
    /**
     * 获取表现层桥实例
     *
     * @param {string} type 表现层类型
     * @returns {IBridge} 表现层桥实例
     * @memberof BridgeManager
     */
    BridgeManager.prototype.getBridge = function (type) {
        var data = this._bridgeDict[type];
        return (data && data[0]);
    };
    /**
     * 通过给出一个显示对象皮肤实例来获取合适的表现层桥实例
     *
     * @param {*} skin 皮肤实例
     * @returns {IBridge|null} 皮肤所属表现层桥实例
     * @memberof BridgeManager
     */
    BridgeManager.prototype.getBridgeBySkin = function (skin) {
        if (skin) {
            // 遍历所有已注册的表现层桥进行判断
            for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
                var data = _a[_i];
                var bridge = data[0];
                if (bridge.isMySkin(skin))
                    return bridge;
            }
        }
        return null;
    };
    /**
     * 注册一个表现层桥实例到框架中
     *
     * @param {...IBridge[]} bridges 要注册的所有表现层桥
     * @memberof BridgeManager
     */
    BridgeManager.prototype.registerBridge = function () {
        var _this = this;
        var bridges = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            bridges[_i] = arguments[_i];
        }
        // 进行DOM初始化判断
        if (!document.body) {
            var onLoad = function (evt) {
                window.removeEventListener("load", onLoad);
                // 重新调用注册方法
                _this.registerBridge.apply(_this, bridges);
            };
            window.addEventListener("load", onLoad);
            return;
        }
        // 进行初始化
        if (bridges.length > 0) {
            var self = this;
            // 记录
            for (var _a = 0, bridges_1 = bridges; _a < bridges_1.length; _a++) {
                var bridge = bridges_1[_a];
                var type = bridge.type;
                if (!this._bridgeDict[type]) {
                    var data = [bridge, false];
                    this._bridgeDict[type] = data;
                    this._bridgeList.push(data);
                }
            }
            // 开始初始化
            for (var _b = 0, bridges_2 = bridges; _b < bridges_2.length; _b++) {
                var bridge = bridges_2[_b];
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__BridgeMessage__["a" /* default */].BRIDGE_BEFORE_INIT, bridge);
                // 初始化Mask
                __WEBPACK_IMPORTED_MODULE_8__mask_MaskManager__["a" /* maskManager */].registerMask(bridge.type, bridge.maskEntity);
                // 注册通用提示框
                __WEBPACK_IMPORTED_MODULE_5__panel_PanelManager__["a" /* panelManager */].registerPrompt(bridge.type, bridge.promptClass);
                // 初始化该表现层实例
                if (bridge.init)
                    bridge.init(afterInitBridge);
                else
                    afterInitBridge(bridge);
            }
        }
        else {
            this.testAllInit();
        }
        function afterInitBridge(bridge) {
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__BridgeMessage__["a" /* default */].BRIDGE_AFTER_INIT, bridge);
            // 设置初始化完毕属性
            var data = self._bridgeDict[bridge.type];
            data[1] = true;
            // 先隐藏表现层桥的htmlWrapper
            bridge.htmlWrapper.style.display = "none";
            // 测试是否全部初始化完毕
            self.testAllInit();
        }
    };
    BridgeManager.prototype.testAllInit = function () {
        var allInited = true;
        for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
            var data = _a[_i];
            allInited = allInited && data[1];
        }
        if (allInited)
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT);
    };
    BridgeManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], BridgeManager);
    return BridgeManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (BridgeManager);
/** 再额外导出一个单例 */
var bridgeManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(BridgeManager);


/***/ }),
/* 10 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "moduleManager", function() { return moduleManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__ModuleMessage__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mediator_IMediatorModulePart__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mediator_Mediator__ = __webpack_require__(8);







/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-14
 * @modify date 2017-09-15
 *
 * 模块管理器，管理模块相关的所有操作。模块具有唯一性，同一时间不可以打开两个相同模块，如果打开则会退回到先前的模块处
*/
var ModuleManager = /** @class */ (function () {
    function ModuleManager() {
        this._moduleStack = [];
        this._openCache = [];
        this._opening = null;
        this._busy = false;
    }
    Object.defineProperty(ModuleManager.prototype, "currentModule", {
        /**
         * 获取当前模块
         *
         * @readonly
         * @type {IMediatorConstructor|undefined}
         * @memberof ModuleManager
         */
        get: function () {
            var curData = this.getCurrent();
            return (curData && curData[0]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ModuleManager.prototype, "currentModuleInstance", {
        /**
         * 获取当前模块的实例
         *
         * @readonly
         * @type {(IMediator|undefined)}
         * @memberof ModuleManager
         */
        get: function () {
            var curData = this.getCurrent();
            return (curData && curData[1]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ModuleManager.prototype, "activeCount", {
        /**
         * 获取活动模块数量
         *
         * @readonly
         * @type {number}
         * @memberof ModuleManager
         */
        get: function () {
            return this._moduleStack.length;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取模块在栈中的索引
     *
     * @param {IMediatorConstructor} cls 模块类型
     * @returns {number} 索引值
     * @memberof ModuleManager
     */
    ModuleManager.prototype.getIndex = function (cls) {
        for (var i = 0, len = this._moduleStack.length; i < len; i++) {
            if (this._moduleStack[i][0] == cls)
                return i;
        }
        return -1;
    };
    /**
     * 获取索引处模块类型
     *
     * @param {number} index 模块索引值
     * @returns {IMediatorConstructor} 模块类型
     * @memberof ModuleManager
     */
    ModuleManager.prototype.getModule = function (index) {
        var data = this._moduleStack[index];
        return data && data[0];
    };
    ModuleManager.prototype.getAfter = function (cls) {
        var result = [];
        for (var _i = 0, _a = this._moduleStack; _i < _a.length; _i++) {
            var module = _a[_i];
            if (module[0] == cls)
                return result;
            result.push(module);
        }
        return null;
    };
    ModuleManager.prototype.getCurrent = function () {
        // 按顺序遍历模块，取出最新的没有在开启中的模块
        var target;
        for (var _i = 0, _a = this._moduleStack; _i < _a.length; _i++) {
            var temp = _a[_i];
            if (temp[0] !== this._opening) {
                target = temp;
                break;
            }
        }
        return target;
    };
    /**
     * 获取模块是否开启中
     *
     * @param {IMediatorConstructor} cls 要判断的模块类型
     * @returns {boolean} 是否开启
     * @memberof ModuleManager
     */
    ModuleManager.prototype.isOpened = function (cls) {
        return (this._moduleStack.filter(function (temp) { return temp[0] == cls; }).length > 0);
    };
    ModuleManager.prototype.activateModule = function (module, from, data) {
        if (module) {
            // 调用activate接口
            module.activate(from, data);
        }
    };
    ModuleManager.prototype.deactivateModule = function (module, to, data) {
        if (module) {
            // 调用deactivate接口
            module.deactivate(to, data);
        }
    };
    /**
     * 打开模块
     *
     * @param {ModuleType|string} clsOrName 模块类型或名称
     * @param {*} [data] 参数
     * @param {boolean} [replace=false] 是否替换当前模块
     * @memberof ModuleManager
     */
    ModuleManager.prototype.open = function (module, data, replace) {
        var _this = this;
        if (replace === void 0) { replace = false; }
        // 如果是字符串则获取引用
        var type = (typeof module == "string" ? Object(__WEBPACK_IMPORTED_MODULE_6__mediator_Mediator__["getModule"])(module) : module);
        // 非空判断
        if (!type)
            return;
        // 判断是否正在打开模块
        if (this._busy) {
            this._openCache.push([type, data, replace]);
            return;
        }
        this._busy = true;
        // 取到类型
        var cls = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
        var after = this.getAfter(cls);
        if (!after) {
            // 记录正在打开的模块类型
            this._opening = type;
            // 尚未打开过，正常开启模块
            var target = type instanceof Function ? new cls() : type;
            // 赋值打开参数
            target.data = data;
            // 数据先行
            var from = this.getCurrent();
            var fromModule = from && from[1];
            var moduleData = [cls, target, null];
            this._moduleStack.unshift(moduleData);
            // 设置回调
            target.moduleOpenHandler = function (status, err) {
                switch (status) {
                    case __WEBPACK_IMPORTED_MODULE_5__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop:
                        // 移除先行数据
                        var tempData = _this._moduleStack.shift();
                        // 销毁模块
                        tempData[1].dispose();
                        // 派发失败消息
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__ModuleMessage__["default"].MODULE_CHANGE_FAILED, cls, from && from[0], err);
                        // 结束一次模块开启
                        _this.onFinishOpen();
                        break;
                    case __WEBPACK_IMPORTED_MODULE_5__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].BeforeOpen:
                        // 这里要优先关闭标识符，否则在开启的模块的onOpen方法里如果有操作Mask的动作就会被这个标识阻塞住
                        _this._opening = null;
                        // 篡改target的close方法，使其改为触发ModuleManager的close
                        moduleData[2] = target.hasOwnProperty("close") ? target.close : null;
                        target.close = function (data) {
                            moduleManager.close(target, data);
                        };
                        break;
                    case __WEBPACK_IMPORTED_MODULE_5__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].AfterOpen:
                        // 调用onDeactivate接口
                        _this.deactivateModule(fromModule, target, data);
                        // 调用onActivate接口
                        _this.activateModule(target, fromModule, data);
                        // 如果replace是true，则关掉上一个模块
                        if (replace)
                            _this.close(from && from[0], data);
                        // 派发消息
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__ModuleMessage__["default"].MODULE_CHANGE, cls, fromModule);
                        // 结束一次模块开启
                        _this.onFinishOpen();
                        break;
                }
            };
            // 调用open接口
            target.open(data);
        }
        else if (after.length > 0) {
            // 已经打开且不是当前模块，先关闭当前模块到目标模块之间的所有模块
            for (var i = 1, len = after.length; i < len; i++) {
                this.close(after[i][0], data);
            }
            // 最后关闭当前模块，以实现从当前模块直接跳回到目标模块
            this.close(after[0][0], data);
            // 结束一次模块开启
            this.onFinishOpen();
        }
        else {
            // 结束一次模块开启
            this.onFinishOpen();
        }
    };
    ModuleManager.prototype.onFinishOpen = function () {
        // 关闭标识符
        this._opening = null;
        this._busy = false;
        // 如果有缓存的模块需要打开则打开之
        if (this._openCache.length > 0)
            this.open.apply(this, this._openCache.shift());
    };
    /**
     * 关闭模块，只有关闭的是当前模块时才会触发onDeactivate和onActivate，否则只会触发close
     *
     * @param {ModuleType|string} clsOrName 模块类型或名称
     * @param {*} [data] 参数
     * @memberof ModuleManager
     */
    ModuleManager.prototype.close = function (module, data) {
        // 如果是字符串则获取引用
        var type = (typeof module == "string" ? Object(__WEBPACK_IMPORTED_MODULE_6__mediator_Mediator__["getModule"])(module) : module);
        // 非空判断
        if (!type)
            return;
        // 数量判断，不足一个模块时不关闭
        if (this.activeCount <= 1)
            return;
        // 取到类型
        var cls = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
        // 存在性判断
        var index = this.getIndex(cls);
        if (index < 0)
            return;
        // 取到目标模块
        var moduleData = this._moduleStack[index];
        var target = moduleData[1];
        // 恢复原始close方法
        var oriClose = moduleData[2];
        if (oriClose)
            target.close = oriClose;
        else
            delete target.close;
        // 如果是当前模块，则需要调用onDeactivate和onActivate接口，否则不用
        if (index == 0) {
            // 数据先行
            this._moduleStack.shift();
            // 获取前一个模块
            var to = this._moduleStack[0];
            var toModule = to && to[1];
            // 调用onDeactivate接口
            this.deactivateModule(target, toModule, data);
            // 调用close接口
            target.close(data);
            // 调用onActivate接口
            this.activateModule(toModule, target, data);
            // 调用onWakeUp接口
            toModule.wakeUp(target, data);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__ModuleMessage__["default"].MODULE_CHANGE, to && to[0], cls);
        }
        else {
            // 数据先行
            this._moduleStack.splice(index, 1);
            // 调用close接口
            target.close(data);
        }
    };
    ModuleManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], ModuleManager);
    return ModuleManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (ModuleManager);
/** 再额外导出一个单例 */
var moduleManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(ModuleManager);


/***/ }),
/* 11 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return JSLoadMode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return assetsManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_HTTPUtil__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_URLUtil__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__version_Version__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_ArrayUtil__ = __webpack_require__(42);








/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-26
 * @modify date 2017-10-26
 *
 * 资源管理器
*/
var AssetsManager = /** @class */ (function () {
    function AssetsManager() {
        this._keyDict = {};
        this._assetsDict = {};
    }
    /**
     * @private
     */
    AssetsManager.prototype.configPath = function (arg1, arg2) {
        if (typeof arg1 == "string") {
            this._keyDict[arg1] = arg2;
        }
        else {
            for (var key in arg1) {
                this._keyDict[key] = arg1[key];
            }
        }
    };
    /**
     * 获取资源，同步的，且如果找不到资源并不会触发加载
     *
     * @param {string} keyOrPath 资源的短名称或路径
     * @returns {*}
     * @memberof AssetsManager
     */
    AssetsManager.prototype.getAssets = function (keyOrPath) {
        var path = this._keyDict[keyOrPath] || keyOrPath;
        var result = this._assetsDict[path];
        // 如果是个数组则表示正在加载中，返回undefined
        if (result instanceof Array)
            return undefined;
        else
            return result;
    };
    /**
     * 加载资源，如果已加载过则同步回调，如果未加载则加载后异步回调
     *
     * @param {string|string[]} keyOrPath 资源短名称或资源路径
     * @param {(assets?:any|any[])=>void} complete 完成回调，如果加载失败则参数是个Error对象
     * @param {XMLHttpRequestResponseType} [responseType] 加载类型
     * @param {(keyOrPath?:string, assets?:any)=>void} [oneComplete] 一个资源加载完毕会调用这个回调，如果有的话。仅在keyOrPath是数组情况下生效
     * @returns {void}
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadAssets = function (keyOrPath, complete, responseType, oneComplete) {
        var _this = this;
        // 非空判断
        if (!keyOrPath) {
            complete && complete(value);
            return;
        }
        // 获取路径
        if (keyOrPath instanceof Array) {
            // 数组去重
            keyOrPath = Object(__WEBPACK_IMPORTED_MODULE_7__utils_ArrayUtil__["a" /* unique */])(keyOrPath);
            // 是个数组，转换成单一名称或对象
            var count = keyOrPath.length;
            var results = [];
            // 判断数量
            if (count > 0) {
                // 声明回调
                var handler = function (path, assets) {
                    // 调用回调
                    oneComplete && oneComplete(path, assets);
                    // 填充数组
                    var index = keyOrPath.indexOf(path);
                    results[index] = assets;
                    // 判断完成
                    if (--count === 0)
                        complete && complete(results);
                };
                // 并行加载资源
                for (var i = 0, len = count; i < len; i++) {
                    var path = keyOrPath[i];
                    this.loadAssets(path, null, null, handler);
                }
            }
            else {
                // 直接完成
                complete && complete(results);
            }
        }
        else {
            // 是单一名称或对象
            var path = this._keyDict[keyOrPath] || keyOrPath;
            // 获取值
            var value = this._assetsDict[path];
            if (value instanceof Array) {
                // 正在加载中，等待之
                value.push(complete);
            }
            else if (value) {
                // 已经加载过了，直接返回
                oneComplete && oneComplete(keyOrPath, value);
                complete && complete(value);
            }
            else {
                // 没有就去加载
                this._assetsDict[path] = value = [function (result) {
                        oneComplete && oneComplete(keyOrPath, result);
                        complete && complete(result);
                    }];
                Object(__WEBPACK_IMPORTED_MODULE_3__utils_HTTPUtil__["a" /* load */])({
                    url: __WEBPACK_IMPORTED_MODULE_5__version_Version__["a" /* version */].wrapHashUrl(path),
                    useCDN: true,
                    responseType: responseType,
                    onResponse: function (result) {
                        // 记录结果
                        _this._assetsDict[path] = result;
                        // 通知各个回调
                        for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {
                            var handler = value_1[_i];
                            handler(result);
                        }
                    },
                    onError: function (err) {
                        // 移除结果
                        delete _this._assetsDict[path];
                        // 通知各个回调
                        for (var _i = 0, value_2 = value; _i < value_2.length; _i++) {
                            var handler = value_2[_i];
                            handler(err);
                        }
                    }
                });
            }
        }
    };
    /**
     * 加载CSS样式文件
     *
     * @param {string[]} cssFiles 样式文件URL列表
     * @param {(err?:Error)=>void} handler 完成回调
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadStyleFiles = function (cssFiles, handler) {
        if (!cssFiles || cssFiles.length === 0) {
            handler();
            return;
        }
        var count = cssFiles.length;
        var stop = false;
        for (var _i = 0, cssFiles_1 = cssFiles; _i < cssFiles_1.length; _i++) {
            var cssFile = cssFiles_1[_i];
            var cssNode = document.createElement("link");
            cssNode.rel = "stylesheet";
            cssNode.type = "text/css";
            cssNode.href = __WEBPACK_IMPORTED_MODULE_6__env_Environment__["environment"].toCDNHostURL(__WEBPACK_IMPORTED_MODULE_5__version_Version__["a" /* version */].wrapHashUrl(cssFile));
            cssNode.onload = onLoadOne;
            cssNode.onerror = onErrorOne;
            document.body.appendChild(cssNode);
        }
        function onLoadOne() {
            // 如果全部加载完毕则调用回调
            if (!stop && --count === 0)
                handler();
        }
        function onErrorOne(evt) {
            if (!stop) {
                stop = true;
                handler(new Error("CSS加载失败"));
            }
        }
    };
    /**
     * 加载JS文件
     *
     * @param {JSFile[]} jsFiles js文件列表
     * @param {(err?:Error)=>void} handler 完成回调
     * @param {boolean} [ordered=false] 是否保证标签形式js的执行顺序，保证执行顺序会降低标签形式js的加载速度，因为必须串行加载。该参数不会影响JSONP形式的加载速度和执行顺序，JSONP形式脚本总是并行加载且顺序执行的。默认是true
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadJsFiles = function (jsFiles, handler, ordered) {
        if (ordered === void 0) { ordered = true; }
        if (!jsFiles || jsFiles.length === 0) {
            handler();
            return;
        }
        jsFiles = jsFiles.concat();
        var count = jsFiles.length;
        var jsonpCount = 0;
        var stop = false;
        var nodes = [];
        // 遍历加载js
        for (var i in jsFiles) {
            var jsFile = jsFiles[i];
            // 统一类型
            if (typeof jsFile === "string") {
                // 是简单路径，变成JSFileData
                jsFiles[i] = jsFile = {
                    url: jsFile,
                    mode: JSLoadMode.AUTO
                };
            }
            // 创建一个空的script标签
            var jsNode = document.createElement("script");
            jsNode.type = "text/javascript";
            nodes.push(jsNode);
            // 开始加载
            if (jsFile.mode === JSLoadMode.JSONP || (jsFile.mode === JSLoadMode.AUTO && !Object(__WEBPACK_IMPORTED_MODULE_4__utils_URLUtil__["b" /* isAbsolutePath */])(jsFile.url))) {
                this.loadAssets(jsFile.url, null, null, onCompleteOne);
                // 递增数量
                jsonpCount++;
            }
            else {
                // 使用script标签方式加载，不用在意顺序
                jsNode.onload = onLoadOne;
                jsNode.onerror = onErrorOne;
                jsNode.src = __WEBPACK_IMPORTED_MODULE_6__env_Environment__["environment"].toCDNHostURL(__WEBPACK_IMPORTED_MODULE_5__version_Version__["a" /* version */].wrapHashUrl(jsFile.url));
            }
        }
        // 判断一次
        var appendIndex = 0;
        judgeAppend();
        function judgeAppend() {
            if (jsonpCount === 0) {
                // 这里统一将所有script标签添加到DOM中，以此保持顺序
                for (var i = appendIndex, len = nodes.length; i < len;) {
                    var node = nodes[i];
                    document.body.appendChild(node);
                    // 记录添加索引
                    appendIndex = ++i;
                    // 如果需要保持顺序且当前是标签形式js，则停止添加，等待加载完毕再继续
                    if (ordered && node.src)
                        break;
                }
            }
        }
        function onCompleteOne(url, result) {
            if (result instanceof Error) {
                // 调用失败
                onErrorOne();
            }
            else {
                // 取到索引
                var index = -1;
                for (var i = 0, len = jsFiles.length; i < len; i++) {
                    var jsFile = jsFiles[i];
                    if (jsFile.url === url) {
                        index = i;
                        break;
                    }
                }
                // 填充script标签内容
                if (index >= 0) {
                    var jsNode = nodes[index];
                    jsNode.innerHTML = result;
                }
                // 递减jsonp数量
                jsonpCount--;
                // 调用成功
                onLoadOne();
            }
        }
        function onLoadOne() {
            // 添加标签
            judgeAppend();
            // 如果全部加载完毕则调用回调
            if (!stop && --count === 0)
                handler();
        }
        function onErrorOne() {
            if (!stop) {
                stop = true;
                handler(new Error("JS加载失败"));
            }
        }
    };
    AssetsManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__["Injectable"]
    ], AssetsManager);
    return AssetsManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (AssetsManager);
var JSLoadMode;
(function (JSLoadMode) {
    JSLoadMode[JSLoadMode["AUTO"] = 0] = "AUTO";
    JSLoadMode[JSLoadMode["JSONP"] = 1] = "JSONP";
    JSLoadMode[JSLoadMode["TAG"] = 2] = "TAG";
})(JSLoadMode || (JSLoadMode = {}));
/** 再额外导出一个单例 */
var assetsManager = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(AssetsManager);


/***/ }),
/* 12 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "netManager", function() { return netManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_message_CoreMessage__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ObjectUtil__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__RequestData__ = __webpack_require__(35);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__NetMessage__ = __webpack_require__(62);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__ = __webpack_require__(15);








var NetManager = /** @class */ (function () {
    function NetManager() {
        this._responseDict = {};
        this._responseListeners = {};
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_3__core_message_CoreMessage__["a" /* default */].MESSAGE_DISPATCHED, this.onMsgDispatched, __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */]);
    }
    NetManager.prototype.onMsgDispatched = function (msg) {
        var observable = this.observable;
        // 如果消息是通讯消息则做处理
        if (msg instanceof __WEBPACK_IMPORTED_MODULE_5__RequestData__["default"]) {
            // 添加遮罩
            if (msg.__useMask)
                __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].showLoading(null, "net");
            // 指定消息参数连接上公共参数作为参数
            Object(__WEBPACK_IMPORTED_MODULE_4__utils_ObjectUtil__["b" /* extendObject */])(msg.__params.data, __WEBPACK_IMPORTED_MODULE_5__RequestData__["commonData"]);
            // 发送消息
            msg.__policy.sendRequest(msg);
            // 派发系统消息
            observable.dispatch(__WEBPACK_IMPORTED_MODULE_6__NetMessage__["a" /* default */].NET_REQUEST, msg);
        }
    };
    /**
     * 注册一个返回结构体
     *
     * @param {string} type 返回类型
     * @param {IResponseDataConstructor} cls 返回结构体构造器
     * @memberof NetManager
     */
    NetManager.prototype.registerResponse = function (cls) {
        this._responseDict[cls.type] = cls;
    };
    /**
     * 添加一个通讯返回监听
     *
     * @param {(IResponseDataConstructor|string)} clsOrType 要监听的返回结构构造器或者类型字符串
     * @param {ResponseHandler} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.listenResponse = function (clsOrType, handler, thisArg, once, observable) {
        if (once === void 0) { once = false; }
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var type = (typeof clsOrType == "string" ? clsOrType : clsOrType.type);
        var listeners = this._responseListeners[type];
        if (!listeners)
            this._responseListeners[type] = listeners = [];
        for (var _i = 0, listeners_1 = listeners; _i < listeners_1.length; _i++) {
            var listener = listeners_1[_i];
            if (handler == listener[0] && thisArg == listener[1] && once == listener[2])
                return;
        }
        listeners.push([handler, thisArg, once, observable]);
    };
    /**
     * 移除一个通讯返回监听
     *
     * @param {(IResponseDataConstructor|string)} clsOrType 要移除监听的返回结构构造器或者类型字符串
     * @param {ResponseHandler} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.unlistenResponse = function (clsOrType, handler, thisArg, once, observable) {
        if (once === void 0) { once = false; }
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var type = (typeof clsOrType == "string" ? clsOrType : clsOrType.type);
        var listeners = this._responseListeners[type];
        if (listeners) {
            for (var i = 0, len = listeners.length; i < len; i++) {
                var listener = listeners[i];
                if (handler == listener[0] && thisArg == listener[1] && once == listener[2] && observable == listener[3]) {
                    listeners.splice(i, 1);
                    break;
                }
            }
        }
    };
    /**
     * 发送多条请求，并且等待返回结果（如果有的话），调用回调
     *
     * @param {RequestData[]} [requests 要发送的请求列表
     * @param {(responses?:ResponseData[]|Error)=>void} [handler] 收到返回结果或错误后的回调函数
     * @param {*} [thisArg] this指向
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.sendMultiRequests = function (requests, handler, thisArg, observable) {
        var self = this;
        var responses = [];
        var leftResCount = 0;
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        for (var _i = 0, _a = requests || []; _i < _a.length; _i++) {
            var request = _a[_i];
            var response = request.__params.response;
            if (response) {
                // 监听一次性返回
                this.listenResponse(response, onResponse, request);
                // 记录返回监听
                responses.push(response);
                // 记录数量
                leftResCount++;
            }
            // 发送请求
            observable.dispatch(request);
        }
        // 测试回调
        testCallback();
        function onResponse(response) {
            if (response instanceof Error) {
                // 出错了，直接调用回调
                handler && handler.call(thisArg, response);
            }
            else {
                // 成功了
                for (var key in responses) {
                    var temp = responses[key];
                    if (temp == response.constructor && this === response.__params.request) {
                        self.unlistenResponse(temp, onResponse, this);
                        responses[key] = response;
                        leftResCount--;
                        // 测试回调
                        testCallback();
                        break;
                    }
                }
            }
        }
        function testCallback() {
            // 判断是否全部替换完毕
            if (leftResCount <= 0) {
                handler && handler.call(thisArg, responses);
            }
        }
    };
    /** 这里导出不希望用户使用的方法，供框架内使用 */
    NetManager.prototype.__onResponse = function (type, result, request) {
        // 移除遮罩
        if (request && request.__useMask)
            __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].hideLoading("net");
        // 解析结果
        var cls = this._responseDict[type];
        if (cls) {
            var response = new cls();
            // 执行解析
            response.parse(result);
            // 设置配对请求和发送内核
            var observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
            if (request) {
                response.__params.request = request;
                // 由上至下找到最远的一个有效内核
                for (var i = request.__observables.length - 1; i >= 0; i--) {
                    var temp = request.__observables[i];
                    if (!temp || temp.disposed)
                        break;
                    else
                        observable = temp;
                }
            }
            // 派发事件
            observable.dispatch(__WEBPACK_IMPORTED_MODULE_6__NetMessage__["a" /* default */].NET_RESPONSE, response, request);
            // 递归处理事件监听
            this.recurseResponse(type, response, request, observable);
        }
        else {
            console.warn("没有找到返回结构体定义：" + type);
        }
    };
    NetManager.prototype.__onError = function (type, err, request) {
        // 移除遮罩
        if (request && request.__useMask)
            __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].hideLoading("net");
        // 如果有配对请求，则将返回值发送到请求所在的原始内核里
        var observable = request && request.__oriObservable;
        // 派发事件
        observable.dispatch(__WEBPACK_IMPORTED_MODULE_6__NetMessage__["a" /* default */].NET_ERROR, err, request);
        // 递归处理事件监听
        this.recurseResponse(type, err, request, observable);
    };
    NetManager.prototype.recurseResponse = function (type, response, request, observable) {
        // 先递归父级，与消息发送时顺序相反
        if (observable.parent) {
            this.recurseResponse(type, response, request, observable.parent);
        }
        // 触发事件形式监听
        var listeners = this._responseListeners[type];
        if (listeners) {
            listeners = listeners.concat();
            for (var _i = 0, listeners_2 = listeners; _i < listeners_2.length; _i++) {
                var listener = listeners_2[_i];
                if (listener[3] == observable) {
                    // 必须是同核消息才能触发回调
                    listener[0].call(listener[1], response, request);
                    // 如果是一次性监听则移除之
                    if (listener[2])
                        this.unlistenResponse(type, listener[0], listener[1], listener[2], listener[3]);
                }
            }
        }
    };
    NetManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __metadata */]("design:paramtypes", [])
    ], NetManager);
    return NetManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (NetManager);
/** 再额外导出一个单例 */
var netManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(NetManager);


/***/ }),
/* 13 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = getCurOrigin;
/* harmony export (immutable) */ __webpack_exports__["d"] = trimURL;
/* harmony export (immutable) */ __webpack_exports__["b"] = isAbsolutePath;
/* harmony export (immutable) */ __webpack_exports__["e"] = validateProtocol;
/* harmony export (immutable) */ __webpack_exports__["g"] = wrapHost;
/* harmony export (immutable) */ __webpack_exports__["f"] = wrapAbsolutePath;
/* unused harmony export getHostAndPathname */
/* unused harmony export getPath */
/* unused harmony export getName */
/* unused harmony export parseUrl */
/* unused harmony export getQueryParams */
/* harmony export (immutable) */ __webpack_exports__["c"] = joinQueryParams;
/* unused harmony export joinHashParams */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ObjectUtil__ = __webpack_require__(3);

/**
 * 获取当前页面的origin，会兼容IE10以下
 *
 * @export
 * @returns {string}
 */
function getCurOrigin() {
    if (window.location.origin)
        return window.location.origin;
    return (window.location.protocol + "//" + window.location.host);
}
/**
 * 规整url
 * @param url
 */
function trimURL(url) {
    // 去除多余的"/"
    url = url.replace(/([^:\/]|(:\/))\/+/g, "$1/");
    if (url.charAt(0) == "/")
        url = url.substr(1);
    // 处理非紧贴域名的"/xx/../"
    var reg = /(?!:\/{2,}[^\/]+\/)([^\/\.]+)\/[^\/\.]+?\/\.\.\//;
    while (reg.test(url)) {
        url = url.replace(reg, "/$1");
    }
    // 处理"/./"和剩余的"/../"，直接丢弃之
    var reg = /\/\.{1,2}\//;
    while (reg.test(url)) {
        url = url.replace(reg, "/");
    }
    return url;
}
/**
 * 检查URL是否是绝对路径（具有协议头）
 * @param url 要判断的URL
 * @returns {any} 是否是绝对路径
 */
function isAbsolutePath(url) {
    if (url == null)
        return false;
    return (url.indexOf("://") >= 0);
}
/**
 * 如果url有protocol，使其与当前域名的protocol统一，否则会跨域
 * @param url 要统一protocol的url
 * @param {string} [protocol] 要统一成的protocol，不传则根据当前页面的protocol使用。根据标准，protocol是要携带:的，比如“http:”
 */
function validateProtocol(url, protocol) {
    if (url == null)
        return null;
    var index = url.indexOf("://");
    if (index < 0)
        return url;
    // 因为protocol是要携带:的，所以index自加1
    index++;
    if (protocol) {
        // 直接使用传递的protocol
        return protocol + url.substr(index);
    }
    else {
        protocol = url.substring(0, index);
        // 调整http和https
        if (protocol == "http:" || protocol == "https:") {
            return window.location.protocol + url.substr(index);
        }
        // 调整ws和wss
        if (protocol == "ws:" || protocol == "wss:") {
            if (window.location.protocol == "https:")
                protocol = "wss:";
            else
                protocol = "ws:";
            return protocol + url.substr(index);
        }
        // 不需要调整
        return url;
    }
}
/**
 * 替换url中的host
 * @param url       url
 * @param host      要替换的host
 * @param forced    是否强制替换（默认false）
 */
function wrapHost(url, host, forced) {
    if (forced === void 0) { forced = false; }
    host = host || getCurOrigin();
    var re = /^(?:[^\/]+):\/{2,}(?:[^\/]+)\//;
    var arr = url.match(re);
    if (arr && arr.length > 0) {
        if (forced) {
            url = url.substr(arr[0].length);
            url = host + "/" + url;
        }
    }
    else {
        url = host + "/" + url;
    }
    // 合法化一下protocol
    url = validateProtocol(url);
    // 最后规整一下url
    url = trimURL(url);
    return url;
}
/**
 * 将相对于当前页面的相对路径包装成绝对路径
 * @param relativePath 相对于当前页面的相对路径
 * @param host 传递该参数会用该host替换当前host
 */
function wrapAbsolutePath(relativePath, host) {
    // 获取当前页面的url
    var curPath = getPath(window.location.href);
    var url = trimURL(curPath + "/" + relativePath);
    if (host != null) {
        url = wrapHost(url, host, true);
    }
    return url;
}
/**
 * 获取URL的host+pathname部分，即问号(?)以前的部分
 *
 */
function getHostAndPathname(url) {
    if (url == null)
        throw new Error("url不能为空");
    // 去掉get参数和hash
    url = url.split("#")[0].split("?")[0];
    // 去掉多余的/
    url = trimURL(url);
    return url;
}
/**
 * 获取URL路径（文件名前的部分）
 * @param url 要分析的URL
 */
function getPath(url) {
    // 首先去掉多余的/
    url = getHostAndPathname(url);
    // 然后获取到路径
    var urlArr = url.split("/");
    urlArr.pop();
    return urlArr.join("/") + "/";
}
/**
 * 获取URL的文件名
 * @param url 要分析的URL
 */
function getName(url) {
    // 先去掉get参数和hash
    url = url.split("#")[0].split("?")[0];
    // 然后获取到文件名
    var urlArr = url.split("/");
    var fileName = urlArr[urlArr.length - 1];
    return fileName;
}
/**
 * 解析URL
 * @param url 要被解析的URL字符串
 * @returns {any} 解析后的URLLocation结构体
 */
function parseUrl(url) {
    var regExp = /(([^:]+:)\/{2,}(([^:\/\?#]+)(:(\d+))?))(\/[^?#]*)?(\?[^#]*)?(#.*)?/;
    var match = regExp.exec(url);
    if (match) {
        return {
            href: match[0] || "",
            origin: match[1] || "",
            protocol: match[2] || "",
            host: match[3] || "",
            hostname: match[4] || "",
            port: match[6] || "",
            pathname: match[7] || "",
            search: match[8] || "",
            hash: (match[9] == "#" ? "" : match[9]) || ""
        };
    }
    else {
        throw new Error("传入parseUrl方法的参数不是一个完整的URL：" + url);
    }
}
/**
 * 解析url查询参数
 * @TODO 添加对jquery编码方式的支持
 * @param url url
 */
function getQueryParams(url) {
    var index = url.indexOf("#");
    if (index >= 0) {
        url = url.substring(0, index);
    }
    index = url.indexOf("?");
    if (index < 0)
        return {};
    var queryString = url.substring(index + 1);
    var params = {};
    var kvs = queryString.split("&");
    for (var _i = 0, kvs_1 = kvs; _i < kvs_1.length; _i++) {
        var kv = kvs_1[_i];
        var pair = kv.split("=", 2);
        if (pair.length !== 2 || !pair[0]) {
            console.log("[URLUtil] invalid query params: " + kv);
            continue;
        }
        var name = decodeURIComponent(pair[0]);
        var value = decodeURIComponent(pair[1]);
        params[name] = value;
    }
    return params;
}
/**
 * 将参数连接到指定URL后面
 * @param url url
 * @param params 一个map，包含要连接的参数
 * @return string 连接后的URL地址
 */
function joinQueryParams(url, params) {
    if (url == null)
        throw new Error("url不能为空");
    var oriParams = getQueryParams(url);
    var targetParams = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["b" /* extendObject */])(oriParams, params);
    var hash = parseUrl(url).hash;
    url = getHostAndPathname(url);
    var isFirst = true;
    for (var key in targetParams) {
        if (isFirst) {
            url += "?" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
            isFirst = false;
        }
        else {
            url += "&" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
        }
    }
    // 加上hash
    url += hash;
    return url;
}
/**
 * 将参数链接到URL的hash后面
 * @param url 如果传入的url没有注明hash模块，则不会进行操作
 * @param params 一个map，包含要连接的参数
 */
function joinHashParams(url, params) {
    if (url == null)
        throw new Error("url不能为空");
    var hash = parseUrl(url).hash;
    if (hash == null || hash == "")
        return url;
    for (var key in params) {
        var value = params[key];
        if (value && typeof value != "string")
            value = value.toString();
        hash += ((hash.indexOf("?") < 0 ? "?" : "&") + encodeURIComponent(key) + "=" + encodeURIComponent(value));
    }
    return (url.split("#")[0] + hash);
}


/***/ }),
/* 14 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__SceneManager__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mediator_MediatorMessage__ = __webpack_require__(24);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 实现了IScene接口的场景中介者基类
*/
var SceneMediator = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](SceneMediator, _super);
    function SceneMediator(skin, policy) {
        var _this = _super.call(this, skin) || this;
        _this.policy = policy;
        return _this;
    }
    SceneMediator.prototype.__afterOnOpen = function (data) {
        __WEBPACK_IMPORTED_MODULE_2__SceneManager__["a" /* sceneManager */].push(this, data);
    };
    SceneMediator.prototype.__afterOnClose = function (data) {
        var _this = this;
        // 篡改onAfterOut，等待关闭动画结束后再执行
        var oriOnAfterOut = this.onAfterOut;
        this.onAfterOut = function (toScene, data) {
            oriOnAfterOut.call(_this, toScene, data);
            // 派发关闭事件
            _this.dispatch(__WEBPACK_IMPORTED_MODULE_3__mediator_MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, _this);
        };
        __WEBPACK_IMPORTED_MODULE_2__SceneManager__["a" /* sceneManager */].pop(this, data);
    };
    /**
     * 切入场景开始前调用
     * @param fromScene 从哪个场景切入
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onBeforeIn = function (fromScene, data) {
        // 可重写
    };
    /**
     * 切入场景开始后调用
     * @param fromScene 从哪个场景切入
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onAfterIn = function (fromScene, data) {
        // 可重写
    };
    /**
     * 切出场景开始前调用
     * @param toScene 要切入到哪个场景
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onBeforeOut = function (toScene, data) {
        // 可重写
    };
    /**
     * 切出场景开始后调用
     * @param toScene 要切入到哪个场景
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onAfterOut = function (toScene, data) {
        // 可重写
    };
    return SceneMediator;
}(__WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SceneMediator);


/***/ }),
/* 15 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return maskManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__ = __webpack_require__(9);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * 遮罩管理器
*/
var MaskManager = /** @class */ (function () {
    function MaskManager() {
        this._entityDict = {};
        this._loadingMaskDict = {};
    }
    MaskManager.prototype.getLoadingMaskCount = function () {
        var count = 0;
        for (var key in this._loadingMaskDict) {
            var temp = this._loadingMaskDict[key];
            if (temp > 0)
                count += temp;
        }
        return count;
    };
    MaskManager.prototype.plusLoadingMaskCount = function (key) {
        var count = this._loadingMaskDict[key] || 0;
        if (count < 0)
            count = 0;
        this._loadingMaskDict[key] = ++count;
        return count;
    };
    MaskManager.prototype.minusLoadingMaskCount = function (key) {
        var count = this._loadingMaskDict[key] || 0;
        count--;
        if (count < 0)
            count = 0;
        this._loadingMaskDict[key] = count;
        if (count == 0)
            delete this._loadingMaskDict[key];
        return count;
    };
    /**
     * 初始化MaskUtil
     * @param type 所属表现层桥
     * @param entity 遮罩实体
     */
    MaskManager.prototype.registerMask = function (type, entity) {
        this._entityDict[type] = entity;
    };
    /**
     * 显示遮罩
     */
    MaskManager.prototype.showMask = function (alpha) {
        var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
        var entity = this._entityDict[type];
        if (entity != null) {
            // 显示遮罩
            entity.showMask(alpha);
            // 调用回调
            entity.maskData.onShowMask && entity.maskData.onShowMask();
        }
    };
    /**
     * 隐藏遮罩
     */
    MaskManager.prototype.hideMask = function () {
        var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
        var entity = this._entityDict[type];
        if (entity != null) {
            // 调用回调
            entity.maskData.onHideMask && entity.maskData.onHideMask();
            // 隐藏遮罩
            entity.hideMask();
        }
    };
    /**当前是否在显示遮罩*/
    MaskManager.prototype.isShowingMask = function () {
        var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
        var entity = this._entityDict[type];
        if (entity != null)
            return entity.isShowingMask();
        return false;
    };
    /**
     * 显示加载图
     */
    MaskManager.prototype.showLoading = function (alpha, key) {
        if (key === void 0) { key = null; }
        // 若当前你没有loading则显示loading
        if (this.getLoadingMaskCount() == 0) {
            var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // 显示遮罩
                entity.showLoading(alpha);
                // 调用回调
                entity.maskData.onShowLoading && entity.maskData.onShowLoading(entity.loadingSkin);
            }
        }
        // 增计数
        this.plusLoadingMaskCount(key);
    };
    /**
     * 隐藏加载图
     */
    MaskManager.prototype.hideLoading = function (key) {
        if (key === void 0) { key = null; }
        // 减计数
        this.minusLoadingMaskCount(key);
        if (this.getLoadingMaskCount() == 0) {
            // 移除loading
            var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // 调用回调
                entity.maskData.onHideLoading && entity.maskData.onHideLoading(entity.loadingSkin);
                // 隐藏遮罩
                entity.hideLoading();
            }
        }
    };
    /**当前是否在显示loading*/
    MaskManager.prototype.isShowingLoading = function () {
        var type = __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge.type;
        var entity = this._entityDict[type];
        if (entity != null)
            return entity.isShowingLoading();
        return false;
    };
    /** 显示模态窗口遮罩 */
    MaskManager.prototype.showModalMask = function (popup, alpha) {
        var type = popup.bridge.type;
        var entity = this._entityDict[type];
        if (entity != null) {
            // 显示遮罩
            entity.showModalMask(popup, alpha);
            // 调用回调
            entity.maskData.onShowModalMask && entity.maskData.onShowModalMask(popup);
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskManager.prototype.hideModalMask = function (popup) {
        var type = popup.bridge.type;
        var entity = this._entityDict[type];
        if (entity != null) {
            // 调用回调
            entity.maskData.onHideModalMask && entity.maskData.onHideModalMask(popup);
            // 隐藏遮罩
            entity.hideModalMask(popup);
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskManager.prototype.isShowingModalMask = function (popup) {
        var type = popup.bridge.type;
        var entity = this._entityDict[type];
        if (entity != null)
            return entity.isShowingModalMask(popup);
        return false;
    };
    MaskManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__["Injectable"]
    ], MaskManager);
    return MaskManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (MaskManager);
/** 再额外导出一个单例 */
var maskManager = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(MaskManager);


/***/ }),
/* 16 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 模块消息
*/
var ModuleMessage = /** @class */ (function () {
    function ModuleMessage() {
    }
    /**
     * 切换模块消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_CHANGE = "moduleChange";
    /**
     * 切换模块失败消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_CHANGE_FAILED = "moduleChangeFailed";
    /**
     * 加载模块失败消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_LOAD_ASSETS_ERROR = "moduleLoadAssetsError";
    return ModuleMessage;
}());
/* harmony default export */ __webpack_exports__["default"] = (ModuleMessage);


/***/ }),
/* 17 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-02-24
 * @modify date 2018-02-24
 *
 * 中介者状态枚举
*/
var MediatorStatus;
(function (MediatorStatus) {
    MediatorStatus[MediatorStatus["UNOPEN"] = 0] = "UNOPEN";
    MediatorStatus[MediatorStatus["OPENING"] = 1] = "OPENING";
    MediatorStatus[MediatorStatus["OPENED"] = 2] = "OPENED";
    MediatorStatus[MediatorStatus["CLOSING"] = 3] = "CLOSING";
    MediatorStatus[MediatorStatus["CLOSED"] = 4] = "CLOSED";
    MediatorStatus[MediatorStatus["DISPOSING"] = 5] = "DISPOSING";
    MediatorStatus[MediatorStatus["DISPOSED"] = 6] = "DISPOSED";
})(MediatorStatus || (MediatorStatus = {}));
/* harmony default export */ __webpack_exports__["a"] = (MediatorStatus);


/***/ }),
/* 18 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["DOMMediatorClass"] = DOMMediatorClass;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__DOMBridge__ = __webpack_require__(26);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * 负责注入的模块
*/
function DOMMediatorClass(moduleName, skin) {
    var skins = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        skins[_i - 2] = arguments[_i];
    }
    return function (cls) {
        // 调用MediatorClass方法
        cls = Object(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__["MediatorClass"])(moduleName)(cls);
        // 监听类型实例化，转换皮肤格式
        var finalSkin;
        if (skins.length === 0) {
            finalSkin = skin;
        }
        else {
            skins.unshift(skin);
            finalSkin = skins;
        }
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) {
            // 先赋值桥
            mediator.bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_3__DOMBridge__["default"].TYPE);
            // 然后监听onOpen，在onOpen中设置皮肤
            Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", function (mediator) {
                mediator.skin = finalSkin;
            });
        });
        // 返回结果类型
        return cls;
    };
}


/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process, global) {/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Reflect;
(function (Reflect) {
    // Metadata Proposal
    // https://rbuckton.github.io/reflect-metadata/
    (function (factory) {
        var root = typeof global === "object" ? global :
            typeof self === "object" ? self :
                typeof this === "object" ? this :
                    Function("return this;")();
        var exporter = makeExporter(Reflect);
        if (typeof root.Reflect === "undefined") {
            root.Reflect = Reflect;
        }
        else {
            exporter = makeExporter(root.Reflect, exporter);
        }
        factory(exporter);
        function makeExporter(target, previous) {
            return function (key, value) {
                if (typeof target[key] !== "function") {
                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });
                }
                if (previous)
                    previous(key, value);
            };
        }
    })(function (exporter) {
        var hasOwn = Object.prototype.hasOwnProperty;
        // feature test for Symbol support
        var supportsSymbol = typeof Symbol === "function";
        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== "undefined" ? Symbol.toPrimitive : "@@toPrimitive";
        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== "undefined" ? Symbol.iterator : "@@iterator";
        var supportsCreate = typeof Object.create === "function"; // feature test for Object.create support
        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support
        var downLevel = !supportsCreate && !supportsProto;
        var HashMap = {
            // create an object in dictionary mode (a.k.a. "slow" mode in v8)
            create: supportsCreate
                ? function () { return MakeDictionary(Object.create(null)); }
                : supportsProto
                    ? function () { return MakeDictionary({ __proto__: null }); }
                    : function () { return MakeDictionary({}); },
            has: downLevel
                ? function (map, key) { return hasOwn.call(map, key); }
                : function (map, key) { return key in map; },
            get: downLevel
                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }
                : function (map, key) { return map[key]; },
        };
        // Load global or shim versions of Map, Set, and WeakMap
        var functionPrototype = Object.getPrototypeOf(Function);
        var usePolyfill = typeof process === "object" && process.env && process.env["REFLECT_METADATA_USE_MAP_POLYFILL"] === "true";
        var _Map = !usePolyfill && typeof Map === "function" && typeof Map.prototype.entries === "function" ? Map : CreateMapPolyfill();
        var _Set = !usePolyfill && typeof Set === "function" && typeof Set.prototype.entries === "function" ? Set : CreateSetPolyfill();
        var _WeakMap = !usePolyfill && typeof WeakMap === "function" ? WeakMap : CreateWeakMapPolyfill();
        // [[Metadata]] internal slot
        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots
        var Metadata = new _WeakMap();
        /**
         * Applies a set of decorators to a property of a target object.
         * @param decorators An array of decorators.
         * @param target The target object.
         * @param propertyKey (Optional) The property key to decorate.
         * @param attributes (Optional) The property descriptor for the target key.
         * @remarks Decorators are applied in reverse order.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Example = Reflect.decorate(decoratorsArray, Example);
         *
         *     // property (on constructor)
         *     Reflect.decorate(decoratorsArray, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.decorate(decoratorsArray, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Object.defineProperty(Example, "staticMethod",
         *         Reflect.decorate(decoratorsArray, Example, "staticMethod",
         *             Object.getOwnPropertyDescriptor(Example, "staticMethod")));
         *
         *     // method (on prototype)
         *     Object.defineProperty(Example.prototype, "method",
         *         Reflect.decorate(decoratorsArray, Example.prototype, "method",
         *             Object.getOwnPropertyDescriptor(Example.prototype, "method")));
         *
         */
        function decorate(decorators, target, propertyKey, attributes) {
            if (!IsUndefined(propertyKey)) {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))
                    throw new TypeError();
                if (IsNull(attributes))
                    attributes = undefined;
                propertyKey = ToPropertyKey(propertyKey);
                return DecorateProperty(decorators, target, propertyKey, attributes);
            }
            else {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsConstructor(target))
                    throw new TypeError();
                return DecorateConstructor(decorators, target);
            }
        }
        exporter("decorate", decorate);
        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)
        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata
        /**
         * A default metadata decorator factory that can be used on a class, class member, or parameter.
         * @param metadataKey The key for the metadata entry.
         * @param metadataValue The value for the metadata entry.
         * @returns A decorator function.
         * @remarks
         * If `metadataKey` is already defined for the target and target key, the
         * metadataValue for that key will be overwritten.
         * @example
         *
         *     // constructor
         *     @Reflect.metadata(key, value)
         *     class Example {
         *     }
         *
         *     // property (on constructor, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticProperty;
         *     }
         *
         *     // property (on prototype, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         property;
         *     }
         *
         *     // method (on constructor)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticMethod() { }
         *     }
         *
         *     // method (on prototype)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         method() { }
         *     }
         *
         */
        function metadata(metadataKey, metadataValue) {
            function decorator(target, propertyKey) {
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))
                    throw new TypeError();
                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
            }
            return decorator;
        }
        exporter("metadata", metadata);
        /**
         * Define a unique metadata entry on the target.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param metadataValue A value that contains attached metadata.
         * @param target The target object on which to define metadata.
         * @param propertyKey (Optional) The property key for the target.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Reflect.defineMetadata("custom:annotation", options, Example);
         *
         *     // property (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticMethod");
         *
         *     // method (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "method");
         *
         *     // decorator factory as metadata-producing annotation.
         *     function MyAnnotation(options): Decorator {
         *         return (target, key?) => Reflect.defineMetadata("custom:annotation", options, target, key);
         *     }
         *
         */
        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
        }
        exporter("defineMetadata", defineMetadata);
        /**
         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasMetadata", hasMetadata);
        /**
         * Gets a value indicating whether the target object has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasOwnMetadata", hasOwnMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetMetadata(metadataKey, target, propertyKey);
        }
        exporter("getMetadata", getMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("getOwnMetadata", getOwnMetadata);
        /**
         * Gets the metadata keys defined on the target object or its prototype chain.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "method");
         *
         */
        function getMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryMetadataKeys(target, propertyKey);
        }
        exporter("getMetadataKeys", getMetadataKeys);
        /**
         * Gets the unique metadata keys defined on the target object.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "method");
         *
         */
        function getOwnMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryOwnMetadataKeys(target, propertyKey);
        }
        exporter("getOwnMetadataKeys", getOwnMetadataKeys);
        /**
         * Deletes the metadata entry from the target object with the provided key.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata entry was found and deleted; otherwise, false.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.deleteMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function deleteMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return false;
            if (!metadataMap.delete(metadataKey))
                return false;
            if (metadataMap.size > 0)
                return true;
            var targetMetadata = Metadata.get(target);
            targetMetadata.delete(propertyKey);
            if (targetMetadata.size > 0)
                return true;
            Metadata.delete(target);
            return true;
        }
        exporter("deleteMetadata", deleteMetadata);
        function DecorateConstructor(decorators, target) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsConstructor(decorated))
                        throw new TypeError();
                    target = decorated;
                }
            }
            return target;
        }
        function DecorateProperty(decorators, target, propertyKey, descriptor) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target, propertyKey, descriptor);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsObject(decorated))
                        throw new TypeError();
                    descriptor = decorated;
                }
            }
            return descriptor;
        }
        function GetOrCreateMetadataMap(O, P, Create) {
            var targetMetadata = Metadata.get(O);
            if (IsUndefined(targetMetadata)) {
                if (!Create)
                    return undefined;
                targetMetadata = new _Map();
                Metadata.set(O, targetMetadata);
            }
            var metadataMap = targetMetadata.get(P);
            if (IsUndefined(metadataMap)) {
                if (!Create)
                    return undefined;
                metadataMap = new _Map();
                targetMetadata.set(P, metadataMap);
            }
            return metadataMap;
        }
        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata
        function OrdinaryHasMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return true;
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryHasMetadata(MetadataKey, parent, P);
            return false;
        }
        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata
        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return false;
            return ToBoolean(metadataMap.has(MetadataKey));
        }
        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata
        function OrdinaryGetMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return OrdinaryGetOwnMetadata(MetadataKey, O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryGetMetadata(MetadataKey, parent, P);
            return undefined;
        }
        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata
        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return undefined;
            return metadataMap.get(MetadataKey);
        }
        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata
        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);
            metadataMap.set(MetadataKey, MetadataValue);
        }
        // 3.1.6.1 OrdinaryMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys
        function OrdinaryMetadataKeys(O, P) {
            var ownKeys = OrdinaryOwnMetadataKeys(O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (parent === null)
                return ownKeys;
            var parentKeys = OrdinaryMetadataKeys(parent, P);
            if (parentKeys.length <= 0)
                return ownKeys;
            if (ownKeys.length <= 0)
                return parentKeys;
            var set = new _Set();
            var keys = [];
            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {
                var key = ownKeys_1[_i];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {
                var key = parentKeys_1[_a];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            return keys;
        }
        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys
        function OrdinaryOwnMetadataKeys(O, P) {
            var keys = [];
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return keys;
            var keysObj = metadataMap.keys();
            var iterator = GetIterator(keysObj);
            var k = 0;
            while (true) {
                var next = IteratorStep(iterator);
                if (!next) {
                    keys.length = k;
                    return keys;
                }
                var nextValue = IteratorValue(next);
                try {
                    keys[k] = nextValue;
                }
                catch (e) {
                    try {
                        IteratorClose(iterator);
                    }
                    finally {
                        throw e;
                    }
                }
                k++;
            }
        }
        // 6 ECMAScript Data Typ0es and Values
        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values
        function Type(x) {
            if (x === null)
                return 1 /* Null */;
            switch (typeof x) {
                case "undefined": return 0 /* Undefined */;
                case "boolean": return 2 /* Boolean */;
                case "string": return 3 /* String */;
                case "symbol": return 4 /* Symbol */;
                case "number": return 5 /* Number */;
                case "object": return x === null ? 1 /* Null */ : 6 /* Object */;
                default: return 6 /* Object */;
            }
        }
        // 6.1.1 The Undefined Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type
        function IsUndefined(x) {
            return x === undefined;
        }
        // 6.1.2 The Null Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type
        function IsNull(x) {
            return x === null;
        }
        // 6.1.5 The Symbol Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type
        function IsSymbol(x) {
            return typeof x === "symbol";
        }
        // 6.1.7 The Object Type
        // https://tc39.github.io/ecma262/#sec-object-type
        function IsObject(x) {
            return typeof x === "object" ? x !== null : typeof x === "function";
        }
        // 7.1 Type Conversion
        // https://tc39.github.io/ecma262/#sec-type-conversion
        // 7.1.1 ToPrimitive(input [, PreferredType])
        // https://tc39.github.io/ecma262/#sec-toprimitive
        function ToPrimitive(input, PreferredType) {
            switch (Type(input)) {
                case 0 /* Undefined */: return input;
                case 1 /* Null */: return input;
                case 2 /* Boolean */: return input;
                case 3 /* String */: return input;
                case 4 /* Symbol */: return input;
                case 5 /* Number */: return input;
            }
            var hint = PreferredType === 3 /* String */ ? "string" : PreferredType === 5 /* Number */ ? "number" : "default";
            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);
            if (exoticToPrim !== undefined) {
                var result = exoticToPrim.call(input, hint);
                if (IsObject(result))
                    throw new TypeError();
                return result;
            }
            return OrdinaryToPrimitive(input, hint === "default" ? "number" : hint);
        }
        // 7.1.1.1 OrdinaryToPrimitive(O, hint)
        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive
        function OrdinaryToPrimitive(O, hint) {
            if (hint === "string") {
                var toString_1 = O.toString;
                if (IsCallable(toString_1)) {
                    var result = toString_1.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            else {
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var toString_2 = O.toString;
                if (IsCallable(toString_2)) {
                    var result = toString_2.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            throw new TypeError();
        }
        // 7.1.2 ToBoolean(argument)
        // https://tc39.github.io/ecma262/2016/#sec-toboolean
        function ToBoolean(argument) {
            return !!argument;
        }
        // 7.1.12 ToString(argument)
        // https://tc39.github.io/ecma262/#sec-tostring
        function ToString(argument) {
            return "" + argument;
        }
        // 7.1.14 ToPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-topropertykey
        function ToPropertyKey(argument) {
            var key = ToPrimitive(argument, 3 /* String */);
            if (IsSymbol(key))
                return key;
            return ToString(key);
        }
        // 7.2 Testing and Comparison Operations
        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations
        // 7.2.2 IsArray(argument)
        // https://tc39.github.io/ecma262/#sec-isarray
        function IsArray(argument) {
            return Array.isArray
                ? Array.isArray(argument)
                : argument instanceof Object
                    ? argument instanceof Array
                    : Object.prototype.toString.call(argument) === "[object Array]";
        }
        // 7.2.3 IsCallable(argument)
        // https://tc39.github.io/ecma262/#sec-iscallable
        function IsCallable(argument) {
            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.
            return typeof argument === "function";
        }
        // 7.2.4 IsConstructor(argument)
        // https://tc39.github.io/ecma262/#sec-isconstructor
        function IsConstructor(argument) {
            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.
            return typeof argument === "function";
        }
        // 7.2.7 IsPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-ispropertykey
        function IsPropertyKey(argument) {
            switch (Type(argument)) {
                case 3 /* String */: return true;
                case 4 /* Symbol */: return true;
                default: return false;
            }
        }
        // 7.3 Operations on Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-objects
        // 7.3.9 GetMethod(V, P)
        // https://tc39.github.io/ecma262/#sec-getmethod
        function GetMethod(V, P) {
            var func = V[P];
            if (func === undefined || func === null)
                return undefined;
            if (!IsCallable(func))
                throw new TypeError();
            return func;
        }
        // 7.4 Operations on Iterator Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects
        function GetIterator(obj) {
            var method = GetMethod(obj, iteratorSymbol);
            if (!IsCallable(method))
                throw new TypeError(); // from Call
            var iterator = method.call(obj);
            if (!IsObject(iterator))
                throw new TypeError();
            return iterator;
        }
        // 7.4.4 IteratorValue(iterResult)
        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue
        function IteratorValue(iterResult) {
            return iterResult.value;
        }
        // 7.4.5 IteratorStep(iterator)
        // https://tc39.github.io/ecma262/#sec-iteratorstep
        function IteratorStep(iterator) {
            var result = iterator.next();
            return result.done ? false : result;
        }
        // 7.4.6 IteratorClose(iterator, completion)
        // https://tc39.github.io/ecma262/#sec-iteratorclose
        function IteratorClose(iterator) {
            var f = iterator["return"];
            if (f)
                f.call(iterator);
        }
        // 9.1 Ordinary Object Internal Methods and Internal Slots
        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots
        // 9.1.1.1 OrdinaryGetPrototypeOf(O)
        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof
        function OrdinaryGetPrototypeOf(O) {
            var proto = Object.getPrototypeOf(O);
            if (typeof O !== "function" || O === functionPrototype)
                return proto;
            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.
            // Try to determine the superclass constructor. Compatible implementations
            // must either set __proto__ on a subclass constructor to the superclass constructor,
            // or ensure each class has a valid `constructor` property on its prototype that
            // points back to the constructor.
            // If this is not the same as Function.[[Prototype]], then this is definately inherited.
            // This is the case when in ES6 or when using __proto__ in a compatible browser.
            if (proto !== functionPrototype)
                return proto;
            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.
            var prototype = O.prototype;
            var prototypeProto = prototype && Object.getPrototypeOf(prototype);
            if (prototypeProto == null || prototypeProto === Object.prototype)
                return proto;
            // If the constructor was not a function, then we cannot determine the heritage.
            var constructor = prototypeProto.constructor;
            if (typeof constructor !== "function")
                return proto;
            // If we have some kind of self-reference, then we cannot determine the heritage.
            if (constructor === O)
                return proto;
            // we have a pretty good guess at the heritage.
            return constructor;
        }
        // naive Map shim
        function CreateMapPolyfill() {
            var cacheSentinel = {};
            var arraySentinel = [];
            var MapIterator = (function () {
                function MapIterator(keys, values, selector) {
                    this._index = 0;
                    this._keys = keys;
                    this._values = values;
                    this._selector = selector;
                }
                MapIterator.prototype["@@iterator"] = function () { return this; };
                MapIterator.prototype[iteratorSymbol] = function () { return this; };
                MapIterator.prototype.next = function () {
                    var index = this._index;
                    if (index >= 0 && index < this._keys.length) {
                        var result = this._selector(this._keys[index], this._values[index]);
                        if (index + 1 >= this._keys.length) {
                            this._index = -1;
                            this._keys = arraySentinel;
                            this._values = arraySentinel;
                        }
                        else {
                            this._index++;
                        }
                        return { value: result, done: false };
                    }
                    return { value: undefined, done: true };
                };
                MapIterator.prototype.throw = function (error) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    throw error;
                };
                MapIterator.prototype.return = function (value) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    return { value: value, done: true };
                };
                return MapIterator;
            }());
            return (function () {
                function Map() {
                    this._keys = [];
                    this._values = [];
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                }
                Object.defineProperty(Map.prototype, "size", {
                    get: function () { return this._keys.length; },
                    enumerable: true,
                    configurable: true
                });
                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };
                Map.prototype.get = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    return index >= 0 ? this._values[index] : undefined;
                };
                Map.prototype.set = function (key, value) {
                    var index = this._find(key, /*insert*/ true);
                    this._values[index] = value;
                    return this;
                };
                Map.prototype.delete = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    if (index >= 0) {
                        var size = this._keys.length;
                        for (var i = index + 1; i < size; i++) {
                            this._keys[i - 1] = this._keys[i];
                            this._values[i - 1] = this._values[i];
                        }
                        this._keys.length--;
                        this._values.length--;
                        if (key === this._cacheKey) {
                            this._cacheKey = cacheSentinel;
                            this._cacheIndex = -2;
                        }
                        return true;
                    }
                    return false;
                };
                Map.prototype.clear = function () {
                    this._keys.length = 0;
                    this._values.length = 0;
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                };
                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };
                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };
                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };
                Map.prototype["@@iterator"] = function () { return this.entries(); };
                Map.prototype[iteratorSymbol] = function () { return this.entries(); };
                Map.prototype._find = function (key, insert) {
                    if (this._cacheKey !== key) {
                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);
                    }
                    if (this._cacheIndex < 0 && insert) {
                        this._cacheIndex = this._keys.length;
                        this._keys.push(key);
                        this._values.push(undefined);
                    }
                    return this._cacheIndex;
                };
                return Map;
            }());
            function getKey(key, _) {
                return key;
            }
            function getValue(_, value) {
                return value;
            }
            function getEntry(key, value) {
                return [key, value];
            }
        }
        // naive Set shim
        function CreateSetPolyfill() {
            return (function () {
                function Set() {
                    this._map = new _Map();
                }
                Object.defineProperty(Set.prototype, "size", {
                    get: function () { return this._map.size; },
                    enumerable: true,
                    configurable: true
                });
                Set.prototype.has = function (value) { return this._map.has(value); };
                Set.prototype.add = function (value) { return this._map.set(value, value), this; };
                Set.prototype.delete = function (value) { return this._map.delete(value); };
                Set.prototype.clear = function () { this._map.clear(); };
                Set.prototype.keys = function () { return this._map.keys(); };
                Set.prototype.values = function () { return this._map.values(); };
                Set.prototype.entries = function () { return this._map.entries(); };
                Set.prototype["@@iterator"] = function () { return this.keys(); };
                Set.prototype[iteratorSymbol] = function () { return this.keys(); };
                return Set;
            }());
        }
        // naive WeakMap shim
        function CreateWeakMapPolyfill() {
            var UUID_SIZE = 16;
            var keys = HashMap.create();
            var rootKey = CreateUniqueKey();
            return (function () {
                function WeakMap() {
                    this._key = CreateUniqueKey();
                }
                WeakMap.prototype.has = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.has(table, this._key) : false;
                };
                WeakMap.prototype.get = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.get(table, this._key) : undefined;
                };
                WeakMap.prototype.set = function (target, value) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);
                    table[this._key] = value;
                    return this;
                };
                WeakMap.prototype.delete = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? delete table[this._key] : false;
                };
                WeakMap.prototype.clear = function () {
                    // NOTE: not a real clear, just makes the previous data unreachable
                    this._key = CreateUniqueKey();
                };
                return WeakMap;
            }());
            function CreateUniqueKey() {
                var key;
                do
                    key = "@@WeakMap@@" + CreateUUID();
                while (HashMap.has(keys, key));
                keys[key] = true;
                return key;
            }
            function GetOrCreateWeakMapTable(target, create) {
                if (!hasOwn.call(target, rootKey)) {
                    if (!create)
                        return undefined;
                    Object.defineProperty(target, rootKey, { value: HashMap.create() });
                }
                return target[rootKey];
            }
            function FillRandomBytes(buffer, size) {
                for (var i = 0; i < size; ++i)
                    buffer[i] = Math.random() * 0xff | 0;
                return buffer;
            }
            function GenRandomBytes(size) {
                if (typeof Uint8Array === "function") {
                    if (typeof crypto !== "undefined")
                        return crypto.getRandomValues(new Uint8Array(size));
                    if (typeof msCrypto !== "undefined")
                        return msCrypto.getRandomValues(new Uint8Array(size));
                    return FillRandomBytes(new Uint8Array(size), size);
                }
                return FillRandomBytes(new Array(size), size);
            }
            function CreateUUID() {
                var data = GenRandomBytes(UUID_SIZE);
                // mark as random - RFC 4122 § 4.4
                data[6] = data[6] & 0x4f | 0x40;
                data[8] = data[8] & 0xbf | 0x80;
                var result = "";
                for (var offset = 0; offset < UUID_SIZE; ++offset) {
                    var byte = data[offset];
                    if (offset === 4 || offset === 6 || offset === 8)
                        result += "-";
                    if (byte < 16)
                        result += "0";
                    result += byte.toString(16).toLowerCase();
                }
                return result;
            }
        }
        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.
        function MakeDictionary(obj) {
            obj.__ = undefined;
            delete obj.__;
            return obj;
        }
    });
})(Reflect || (Reflect = {}));
//# sourceMappingURL=Reflect.js.map
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(32), __webpack_require__(58)))

/***/ }),
/* 20 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "decorateThis", function() { return decorateThis; });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 这个文件的存在是为了对现有js功能打补丁修bug等
*/
/** 修复Array.findIndex会被遍历到的问题 */
if (Array.prototype.hasOwnProperty("findIndex")) {
    var desc = Object.getOwnPropertyDescriptor(Array.prototype, "findIndex");
    if (desc.enumerable) {
        desc.enumerable = false;
        Object.defineProperty(Array.prototype, "findIndex", desc);
    }
}
/** 为某些不支持ErrorEvent的浏览器添加ErrorEvent支持 */
try {
    new ErrorEvent("");
}
catch (err) {
    window["ErrorEvent"] = function ErrorEvent(type, errorEventInitDict) {
        if (!errorEventInitDict)
            errorEventInitDict = {};
        if (Event instanceof Function) {
            Event.call(this, type, errorEventInitDict);
            this.initErrorEvent(type, errorEventInitDict.bubbles, errorEventInitDict.cancelable, errorEventInitDict.message, errorEventInitDict.filename, errorEventInitDict.lineno);
            this.error = errorEventInitDict.error;
            return this;
        }
        else {
            var evt = document.createEvent("ErrorEvent");
            evt.initErrorEvent(type, errorEventInitDict.bubbles, errorEventInitDict.cancelable, errorEventInitDict.message, errorEventInitDict.filename, errorEventInitDict.lineno);
            return evt;
        }
    };
    window["ErrorEvent"].prototype.initErrorEvent = function initErrorEvent(typeArg, canBubbleArg, cancelableArg, messageArg, filenameArg, linenoArg) {
        this.type = typeArg;
        this.bubbles = canBubbleArg;
        this.cancelable = cancelableArg;
        this.message = messageArg;
        this.filename = filenameArg;
        this.lineno = linenoArg;
    };
}
/** 篡改Reflect.decorate方法，用于为装饰器方法打个flag，标记装饰器是否为参数化装饰 */
var decorateThis = {};
if (Reflect && Reflect.decorate) {
    var oriDecorate = Reflect.decorate;
    Reflect.decorate = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // 篡改args[0][0]（装饰器方法引用），在调用时为其提供一个this指向，指向window
        var oriRef = args[0][0];
        args[0][0] = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return oriRef.apply(decorateThis, args);
        };
        // 调用原始方法
        var result = oriDecorate.apply(this, args);
        // 还原篡改项
        args[0][0] = oriRef;
        // 返回结果
        return result;
    };
}


/***/ }),
/* 21 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = createRunFunc;
/* unused harmony export runExp */
/* harmony export (immutable) */ __webpack_exports__["a"] = createEvalFunc;
/* harmony export (immutable) */ __webpack_exports__["c"] = evalExp;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(3);

function wrapEvalFunc(exp) {
    // 这个方法的功能主要是将多个scope合并成为一个scope
    return function () {
        var scopes = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            scopes[_i] = arguments[_i];
        }
        var scope = __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["b" /* extendObject */].apply(void 0, [{}].concat(scopes.reverse()));
        return exp.call(this, scope);
    };
}
/**
 * 将表达式包装成为方法
 *
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} scopeCount 参数个数，仅在exp为表达式时有效
 * @returns {EvalFunc} 包装方法
 */
function wrapEvalFuncExp(exp, scopeCount) {
    if (typeof exp === "string") {
        var argList = [];
        var expStr = exp;
        for (var i = 0; i < scopeCount; i++) {
            argList.push("s" + i);
            expStr = "with(s" + i + "||{}){" + expStr + "}";
        }
        return Function(argList.join(","), expStr);
    }
    else {
        return wrapEvalFunc(exp);
    }
}
/**
 * 创建一个执行方法，用于未来执行
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} [scopeCount=0] 所需的域的数量
 * @returns {EvalFunc} 创建的方法
 */
function createRunFunc(exp, scopeCount) {
    if (scopeCount === void 0) { scopeCount = 0; }
    if (typeof exp === "string") {
        var func;
        try {
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        catch (err) {
            // 可能是某些版本的解释器不认识模板字符串，将模板字符串变成普通字符串
            var sepStr = (exp.indexOf('"') < 0 ? '"' : "'");
            // 将exp中的·替换为'
            var reg = /([^\\]?)`/g;
            exp = exp.replace(reg, "$1" + sepStr);
            // 将exp中${...}替换为" + ... + "的形式
            reg = /\$\{(.*?)\}/g;
            exp = exp.replace(reg, sepStr + "+($1)+" + sepStr);
            // 重新生成方法并返回
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        return func;
    }
    else {
        return wrapEvalFunc(exp);
    }
}
/**
 * 直接执行表达式，不求值。该方法可以执行多条语句
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {*} [thisArg] this指向
 * @param {...any[]} scopes 表达式的作用域列表
 */
function runExp(exp, thisArg) {
    var scopes = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        scopes[_i - 2] = arguments[_i];
    }
    createRunFunc(exp, scopes.length).apply(thisArg, scopes);
}
/**
 * 创建一个表达式求值方法，用于未来执行
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} [scopeCount=0] 所需的域的数量
 * @returns {EvalFunc} 创建的方法
 */
function createEvalFunc(exp, scopeCount) {
    if (scopeCount === void 0) { scopeCount = 0; }
    if (typeof exp === "string")
        return createRunFunc("return " + exp, scopeCount);
    else
        return wrapEvalFunc(exp);
}
/**
 * 表达式求值，无法执行多条语句
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {*} [thisArg] this指向
 * @param {...any[]} scopes 表达式的作用域列表
 * @returns {*} 返回值
 */
function evalExp(exp, thisArg) {
    var scopes = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        scopes[_i - 2] = arguments[_i];
    }
    return createEvalFunc(exp, scopes.length).apply(thisArg, scopes);
}


/***/ }),
/* 22 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return panelManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__NonePanelPolicy__ = __webpack_require__(63);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__PanelMessage__ = __webpack_require__(64);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__IPromptPanel__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_Dictionary__ = __webpack_require__(4);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 弹窗管理器，包含弹出弹窗、关闭弹窗、弹窗管理等功能
*/
var PanelManager = /** @class */ (function () {
    function PanelManager() {
        this._panels = [];
        this._priorities = new __WEBPACK_IMPORTED_MODULE_8__utils_Dictionary__["a" /* default */]();
        this._modalDict = new __WEBPACK_IMPORTED_MODULE_8__utils_Dictionary__["a" /* default */]();
        /************************ 下面是通用弹窗的逻辑 ************************/
        this._promptDict = {};
    }
    PanelManager_1 = PanelManager;
    /**
     * 获取当前显示的弹窗数组（副本）
     *
     * @param {IConstructor} [cls] 弹窗类型，如果传递该参数则只返回该类型的已打开弹窗，否则将返回所有已打开的弹窗
     * @returns {IPanel[]} 已打开弹窗数组
     * @memberof PanelManager
     */
    PanelManager.prototype.getOpened = function (cls) {
        if (!cls)
            return this._panels.concat();
        else
            return this._panels.filter(function (panel) { return panel.constructor == cls; });
    };
    /**
     * 获取弹窗是否已开启
     *
     * @param {IPanel} panel 弹窗对象
     * @returns {boolean} 是否已经开启
     * @memberof PanelManager
     */
    PanelManager.prototype.isOpened = function (panel) {
        return (this._panels.indexOf(panel) >= 0);
    };
    PanelManager.prototype.updateModalMask = function (panel) {
        // 首先将传入的panel的模态遮罩去除
        __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].hideModalMask(panel);
        // 然后为最上层的模态弹窗添加遮罩
        for (var i = this._panels.length - 1; i >= 0; i--) {
            panel = this._panels[i];
            if (this._modalDict.get(panel)) {
                // 如果已经有遮罩了，先移除之
                if (__WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].isShowingModalMask(panel))
                    __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].hideModalMask(panel);
                // 添加遮罩
                __WEBPACK_IMPORTED_MODULE_7__mask_MaskManager__["a" /* maskManager */].showModalMask(panel);
                break;
            }
        }
    };
    /**
     * 打开一个弹窗
     *
     * @param {IPanel} panel 要打开的弹窗
     * @param {*} [data] 数据
     * @param {boolean} [isModal=true] 是否模态弹出
     * @param {{x:number, y:number}} [from] 弹出起点位置
     * @returns {IPanel} 返回弹窗对象
     * @memberof PanelManager
     */
    PanelManager.prototype.pop = function (panel, data, isModal, from) {
        var _this = this;
        if (isModal === void 0) { isModal = true; }
        if (this._panels.indexOf(panel) < 0) {
            // 数据先行
            this._panels.push(panel);
            // 弹窗所在的表现层必须要显示
            panel.bridge.htmlWrapper.style.display = "";
            // 获取策略
            var policy = panel.policy || panel.bridge.defaultPanelPolicy || __WEBPACK_IMPORTED_MODULE_3__NonePanelPolicy__["a" /* default */];
            // 调用回调
            panel.onBeforePop(data, isModal, from);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__PanelMessage__["a" /* default */].PANEL_BEFORE_POP, panel, isModal, from);
            // 调用准备接口
            policy.prepare && policy.prepare(panel);
            // 添加显示
            var bridge = panel.bridge;
            bridge.addChild(panel.bridge.panelLayer, panel.skin);
            // 根据优先级进行排序
            this._panels.sort(function (a, b) {
                var priA = _this._priorities.get(a) || 0;
                var priB = _this._priorities.get(b) || 0;
                return priA - priB;
            });
            // 根据排序后的顺序调整显示顺序
            for (var _i = 0, _a = this._panels; _i < _a.length; _i++) {
                var temp = _a[_i];
                temp.bridge.addChild(temp.bridge.panelLayer, temp.skin);
            }
            // 调用策略接口
            policy.pop(panel, function () {
                // 调用回调
                panel.onAfterPop(data, isModal, from);
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__PanelMessage__["a" /* default */].PANEL_AFTER_POP, panel, isModal, from);
            }, from);
            // 记录模态数据
            this._modalDict.set(panel, isModal);
            // 更新模态遮罩
            this.updateModalMask(panel);
        }
        return panel;
    };
    /**
     * 关闭一个弹窗
     *
     * @param {IPanel} panel 要关闭的弹窗
     * @param {*} [data] 数据
     * @param {{x:number, y:number}} [to] 关闭终点位置
     * @returns {IPanel} 返回弹窗对象
     * @memberof PanelManager
     */
    PanelManager.prototype.drop = function (panel, data, to) {
        var index = this._panels.indexOf(panel);
        if (index >= 0) {
            // 数据先行
            this._panels.splice(index, 1);
            // 获取策略
            var policy = panel.policy || panel.bridge.defaultPanelPolicy || __WEBPACK_IMPORTED_MODULE_3__NonePanelPolicy__["a" /* default */];
            // 调用回调
            panel.onBeforeDrop(data, to);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__PanelMessage__["a" /* default */].PANEL_BEFORE_DROP, panel, to);
            // 调用策略接口
            policy.drop(panel, function () {
                // 调用回调
                panel.onAfterDrop(data, to);
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__PanelMessage__["a" /* default */].PANEL_AFTER_DROP, panel, to);
                // 移除显示
                var bridge = panel.bridge;
                var parent = bridge.getParent(panel.skin);
                if (parent)
                    bridge.removeChild(parent, panel.skin);
                // 调用接口
                panel.dispose();
            }, to);
            // 移除优先级数据
            this._priorities.delete(panel);
            // 移除模态数据
            this._modalDict.delete(panel);
            // 更新模态遮罩
            this.updateModalMask(panel);
        }
        return panel;
    };
    /**
     * 注册通用弹窗
     *
     * @param {string} type 通用弹窗要注册到的表现层类型
     * @param {IPromptPanelConstructor} prompt 通用弹窗类型
     * @memberof PanelManager
     */
    PanelManager.prototype.registerPrompt = function (type, prompt) {
        this._promptDict[type] = prompt;
    };
    /**
     * 取消注册通用弹窗
     *
     * @param {string} type 要取消注册通用弹窗的表现层类型
     * @memberof PanelManager
     */
    PanelManager.prototype.unregisterPrompt = function (type) {
        delete this._promptDict[type];
    };
    /**
     * @private
     */
    PanelManager.prototype.prompt = function (msgOrParams) {
        var handlers = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            handlers[_i - 1] = arguments[_i];
        }
        var params;
        if (typeof msgOrParams == "string") {
            params = {
                msg: msgOrParams,
                handlers: handlers
            };
        }
        else {
            params = msgOrParams;
        }
        // 取到当前场景的类型
        var curBridge = __WEBPACK_IMPORTED_MODULE_6__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge;
        var type = curBridge && curBridge.type;
        // 用场景类型取到弹窗对象
        var promptCls = this._promptDict[type];
        if (promptCls == null) {
            // 没有找到当前模块类型关联的通用弹窗类型，改用系统弹窗凑合一下
            alert(params.msg);
            return;
        }
        // 增加默认值
        for (var i in params.handlers) {
            var handler = params.handlers[i];
            if (handler.text == null)
                handler.text = handler.data;
            if (handler.buttonType == null)
                handler.buttonType = __WEBPACK_IMPORTED_MODULE_5__IPromptPanel__["a" /* ButtonType */].normal;
        }
        // 实例化
        var prompt = new promptCls();
        // 设置优先级
        this._priorities.set(prompt, PanelManager_1.PRIORITY_PROMPT);
        // 显示弹窗
        prompt.open(params);
        // 更新弹窗
        prompt.update(params);
        // 返回弹窗
        return prompt;
    };
    /**
     * 显示警告窗口（只有一个确定按钮）
     *
     * @param {(string|IPromptParams)} msgOrParams 要显示的文本，或者弹窗数据
     * @param {()=>void} [okHandler] 确定按钮点击回调
     * @returns {IPromptPanel} 返回弹窗实体
     * @memberof PanelManager
     */
    PanelManager.prototype.alert = function (msgOrParams, okHandler) {
        var params;
        if (typeof msgOrParams == "string") {
            params = { msg: msgOrParams };
        }
        else {
            params = msgOrParams;
        }
        params.handlers = [
            { data: "确定", handler: okHandler, buttonType: __WEBPACK_IMPORTED_MODULE_5__IPromptPanel__["a" /* ButtonType */].important }
        ];
        return this.prompt(params);
    };
    /**
     * 显示确认窗口（有一个确定按钮和一个取消按钮）
     *
     * @param {(string|IPromptParams)} msgOrParams 要显示的文本，或者弹窗数据
     * @param {()=>void} [okHandler] 确定按钮点击回调
     * @param {()=>void} [cancelHandler] 取消按钮点击回调
     * @returns {IPromptPanel} 返回弹窗实体
     * @memberof PanelManager
     */
    PanelManager.prototype.confirm = function (msgOrParams, okHandler, cancelHandler) {
        var params;
        if (typeof msgOrParams == "string") {
            params = { msg: msgOrParams };
        }
        else {
            params = msgOrParams;
        }
        params.handlers = [
            { data: "取消", handler: cancelHandler, buttonType: __WEBPACK_IMPORTED_MODULE_5__IPromptPanel__["a" /* ButtonType */].normal },
            { data: "确定", handler: okHandler, buttonType: __WEBPACK_IMPORTED_MODULE_5__IPromptPanel__["a" /* ButtonType */].important }
        ];
        return this.prompt(params);
    };
    PanelManager.PRIORITY_NORMAL = 0;
    PanelManager.PRIORITY_PROMPT = 1;
    PanelManager = PanelManager_1 = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], PanelManager);
    return PanelManager;
    var PanelManager_1;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (PanelManager);
/** 再额外导出一个单例 */
var panelManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(PanelManager);


/***/ }),
/* 23 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return version; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__ = __webpack_require__(13);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 管理文件哈希版本号
*/
var Version = /** @class */ (function () {
    function Version() {
        this._hashDict = {};
    }
    /**
     * 初始化哈希版本工具
     *
     * @param {()=>void} handler 回调
     * @param {string} [host] version.cfg文件加载域名，不传则使用当前域名
     * @param {string} [version] 加载version.cfg文件的版本号，不传则使用随机时间戳作为版本号
     * @memberof Version
     */
    Version.prototype.initialize = function (handler, host, version) {
        var self = this;
        if (window["__Olympus_Version_hashDict__"]) {
            // 之前在哪加载过，无需再次加载，直接使用
            this._hashDict = window["__Olympus_Version_hashDict__"];
            handler();
        }
        else {
            // 去加载version.cfg
            var request = null;
            if (window["XDomainRequest"] && navigator.userAgent.indexOf("MSIE 10.") < 0) {
                // code for IE7 - IE9
                request = new window["XDomainRequest"]();
            }
            else if (window["XMLHttpRequest"]) {
                // code for IE10, Firefox, Chrome, Opera, Safari
                request = new XMLHttpRequest();
            }
            else if (window["ActiveXObject"]) {
                // code for IE6, IE5
                request = new ActiveXObject("Microsoft.XMLHTTP");
            }
            // 注册回调函数
            request.onload = function (evt) {
                if (request.status === undefined) {
                    // 说明是不支持XMLHttpRequest的情况，查看其responseText是否为""
                    if (request.responseText === "") {
                        // 失败
                        request.onerror(new ErrorEvent("RequestError", { filename: url }));
                    }
                    else {
                        // 成功
                        onLoad(evt);
                        handler();
                    }
                }
                else {
                    // 即使是onLoad也要判断下状态码
                    var statusHead = Math.floor(request.status * 0.01);
                    switch (statusHead) {
                        case 2:
                        case 3:
                            // 2xx和3xx的状态码认为是成功
                            onLoad(evt);
                            handler();
                            break;
                        case 4:
                        case 5:
                            // 4xx和5xx的状态码认为是错误，转调错误回调
                            request.onerror(new ErrorEvent("RequestError", { filename: url, message: request.status + " " + request.statusText }));
                            break;
                    }
                }
            };
            var url;
            if (version) {
                request.onerror = function () {
                    // 使用-r_方式加载失败了，再试一次用query参数加载版本号
                    var url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg?v=" + version, host);
                    request.abort();
                    request.onerror = handler;
                    request.open("GET", url, true);
                    request.send();
                };
                // 设置连接信息
                url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg", host);
                // 添加-r_方式版本号
                url = this.joinVersion(url, version);
            }
            else {
                // 没有版本号，直接使用当前时间戳加载
                request.onerror = handler;
                url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg?v=" + Date.now(), host);
            }
            request.open("GET", url, true);
            // 发送数据，开始和服务器进行交互
            request.send();
        }
        function onLoad(evt) {
            var request = evt.target;
            var responseText = request.responseText;
            var lines = responseText.split("\n");
            for (var i in lines) {
                var line = lines[i];
                var arr = line.split("  ");
                if (arr.length == 2) {
                    var key = arr[1].substr(2);
                    var value = arr[0];
                    self._hashDict[key] = value;
                }
            }
            // 在window上挂一份
            window["__Olympus_Version_hashDict__"] = self._hashDict;
        }
    };
    /**
     * 获取文件哈希值，如果没有文件哈希值则返回null
     *
     * @param {string} url 文件的URL
     * @returns {string} 文件的哈希值，或者null
     * @memberof Version
     */
    Version.prototype.getHash = function (url) {
        url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["d" /* trimURL */])(url);
        var result = null;
        for (var path in this._hashDict) {
            if (url.indexOf(path) >= 0) {
                result = this._hashDict[path];
                break;
            }
        }
        return result;
    };
    /**
     * 将url转换为哈希版本url
     *
     * @param {string} url 原始url
     * @returns {string} 哈希版本url
     * @memberof Version
     */
    Version.prototype.wrapHashUrl = function (url) {
        var hash = this.getHash(url);
        if (hash != null) {
            url = this.joinVersion(url, hash);
        }
        return url;
    };
    /**
     * 添加-r_XXX形式版本号
     *
     * @param {string} url
     * @param {string} version 版本号，以数字和小写字母组成
     * @returns {string} 加版本号后的url，如果没有查到版本号则返回原始url
     * @memberof Version
     */
    Version.prototype.joinVersion = function (url, version) {
        if (version == null)
            return url;
        // 去掉version中的非法字符
        version = version.replace(/[^0-9a-z]+/ig, "");
        // 插入版本号
        var reg = /(([a-zA-Z]+:\/+[^\/\?#]+\/)?[^\?#]+)\.([^\?]+)(\?.+)?/;
        var result = reg.exec(url);
        if (result != null) {
            url = result[1] + "-r_" + version + "." + result[3] + (result[4] || "");
        }
        return url;
    };
    /**
     * 移除-r_XXX形式版本号
     *
     * @param {string} url url
     * @returns {string} 移除版本号后的url
     * @memberof Version
     */
    Version.prototype.removeVersion = function (url) {
        // 去掉-r_XXX版本号，如果有
        url = url.replace(/\-r_[a-z0-9]+\./ig, ".");
        return url;
    };
    Version = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Version);
    return Version;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Version);
/** 再额外导出一个单例 */
var version = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Version);


/***/ }),
/* 24 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-03-05
 * @modify date 2018-03-05
 *
 * 中介者消息
*/
var MediatorMessage = /** @class */ (function () {
    function MediatorMessage() {
    }
    /**
     * 中介者开启完毕事件
     *
     * @static
     * @type {string}
     * @memberof MediatorMessage
     */
    MediatorMessage.MEDIATOR_OPENED = "mediatorOpened";
    /**
     * 中介者关闭完毕事件
     *
     * @static
     * @type {string}
     * @memberof MediatorMessage
     */
    MediatorMessage.MEDIATOR_CLOSED = "mediatorClosed";
    return MediatorMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (MediatorMessage);


/***/ }),
/* 25 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return system; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 用来记录程序运行时间，并且提供延迟回调或频率回调功能
*/
var System = /** @class */ (function () {
    function System() {
        // 这里尝试一下TS的Tuple类型——Raykid
        this._nextFrameList = [];
        this._timer = 0;
        var self = this;
        if (window.requestAnimationFrame instanceof Function) {
            requestAnimationFrame(onRequestAnimationFrame);
        }
        else {
            // 如果不支持requestAnimationFrame则改用setTimeout计时，延迟时间1000/60毫秒
            var startTime = Date.now();
            setInterval(function () {
                var curTime = Date.now();
                // 赋值timer
                self._timer = curTime - startTime;
                // 调用tick方法
                self.tick();
            }, 1000 / 60);
        }
        function onRequestAnimationFrame(timer) {
            // 赋值timer，这个方法里无法获取this，因此需要通过注入的静态属性取到自身实例
            self._timer = timer;
            // 调用tick方法
            self.tick();
            // 计划下一次执行
            requestAnimationFrame(onRequestAnimationFrame);
        }
    }
    /**
     * 获取从程序运行到当前所经过的毫秒数
     *
     * @returns {number} 毫秒数
     * @memberof System
     */
    System.prototype.getTimer = function () {
        return this._timer;
    };
    System.prototype.tick = function () {
        // 调用下一帧回调
        for (var i = 0, len = this._nextFrameList.length; i < len; i++) {
            var data = this._nextFrameList.shift();
            data[0].apply(data[1], data[2]);
        }
    };
    /**
     * 在下一帧执行某个方法
     *
     * @param {Function} handler 希望在下一帧执行的某个方法
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 方法参数列表
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.nextFrame = function (handler, thisArg) {
        var _this = this;
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        var data = [handler, thisArg, args];
        this._nextFrameList.push(data);
        return {
            cancel: function () {
                var index = _this._nextFrameList.indexOf(data);
                if (index >= 0)
                    _this._nextFrameList.splice(index, 1);
            }
        };
    };
    /**
     * 每帧执行某个方法，直到取消为止
     *
     * @param {Function} handler 每帧执行的某个方法
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 方法参数列表
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.enterFrame = function (handler, thisArg) {
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        var self = this;
        var cancelable = this.nextFrame.apply(this, [wrapHandler, thisArg].concat(args));
        return {
            cancel: function () {
                cancelable.cancel();
            }
        };
        function wrapHandler() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // 调用回调
            handler.apply(this, args);
            // 执行下一帧
            cancelable = self.nextFrame.apply(self, [wrapHandler, this].concat(args));
        }
    };
    /**
     * 设置延迟回调
     *
     * @param {number} duration 延迟毫秒值
     * @param {Function} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 要传递的参数
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.setTimeout = function (duration, handler, thisArg) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var startTimer = this._timer;
        // 启动计时器
        var nextFrame = this.nextFrame(tick, this);
        function tick() {
            var delta = this._timer - startTimer;
            if (delta >= duration) {
                nextFrame = null;
                handler.apply(thisArg, args);
            }
            else {
                nextFrame = this.nextFrame(tick, this);
            }
        }
        return {
            cancel: function () {
                nextFrame && nextFrame.cancel();
                nextFrame = null;
            }
        };
    };
    /**
     * 设置延时间隔
     *
     * @param {number} duration 延迟毫秒值
     * @param {Function} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 要传递的参数
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.setInterval = function (duration, handler, thisArg) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var timeout = this.setTimeout(duration, onTimeout, this);
        function onTimeout() {
            // 触发回调
            handler.apply(thisArg, args);
            // 继续下一次
            timeout = this.setTimeout(duration, onTimeout, this);
        }
        return {
            cancel: function () {
                timeout && timeout.cancel();
                timeout = null;
            }
        };
    };
    System = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __metadata */]("design:paramtypes", [])
    ], System);
    return System;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (System);
/** 再额外导出一个单例 */
var system = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(System);


/***/ }),
/* 26 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__dom_mask_MaskEntity__ = __webpack_require__(68);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__ = __webpack_require__(69);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__dom_panel_BackPanelPolicy__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__dom_scene_FadeScenePolicy__ = __webpack_require__(71);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__);
/// <amd-module name="DOMBridge"/>
/// <reference types="tween.js"/>








/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 基于DOM的表现层桥实现
*/
var DOMBridge = /** @class */ (function () {
    function DOMBridge(params) {
        /**
         * 获取默认弹窗策略
         *
         * @type {IPanelPolicy}
         * @memberof DOMBridge
         */
        this.defaultPanelPolicy = new __WEBPACK_IMPORTED_MODULE_5__dom_panel_BackPanelPolicy__["a" /* default */]();
        /**
         * 获取默认场景切换策略
         *
         * @type {IScenePolicy}
         * @memberof DOMBridge
         */
        this.defaultScenePolicy = new __WEBPACK_IMPORTED_MODULE_6__dom_scene_FadeScenePolicy__["a" /* default */]();
        this._listenerDict = {};
        this._initParams = params;
    }
    Object.defineProperty(DOMBridge.prototype, "type", {
        /**
         * 获取表现层类型名称
         *
         * @readonly
         * @type {string}
         * @memberof DOMBridge
         */
        get: function () {
            return DOMBridge.TYPE;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "htmlWrapper", {
        /**
         * 获取表现层HTML包装器，可以对其样式进行自定义调整
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "root", {
        /**
         * 获取根显示节点
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "stage", {
        /**
         * 获取舞台引用，DOM的舞台指向根节点
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "bgLayer", {
        /**
         * 获取背景容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._bgLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "sceneLayer", {
        /**
         * 获取场景容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._sceneLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "frameLayer", {
        /**
         * 获取框架容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._frameLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "panelLayer", {
        /**
         * 获取弹窗容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._panelLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "maskLayer", {
        /**
         * 获取遮罩容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._maskLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "topLayer", {
        /**
         * 获取顶级容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._topLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "promptClass", {
        /**
         * 获取通用提示框
         *
         * @readonly
         * @type {IPromptPanelConstructor}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.promptClass;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "maskEntity", {
        /**
         * 获取遮罩实体
         *
         * @readonly
         * @type {IMaskEntity}
         * @memberof DOMBridge
         */
        get: function () {
            return new __WEBPACK_IMPORTED_MODULE_3__dom_mask_MaskEntity__["a" /* default */](this._initParams.maskData);
        },
        enumerable: true,
        configurable: true
    });
    DOMBridge.prototype.createLayer = function () {
        // 生成一个父容器，不响应点击事件，但会撑起全屏幕范围
        var layer = document.createElement("div");
        layer.style.position = "fixed";
        layer.style.top = "0%";
        layer.style.left = "0%";
        layer.style.width = "100%";
        layer.style.height = "100%";
        layer.style.pointerEvents = "none";
        this.root.appendChild(layer);
        // 生成一个子容器，实际用来放置子对象，目的是响应点击事件
        var subLayer = document.createElement("div");
        subLayer.style.pointerEvents = "auto";
        layer.appendChild(subLayer);
        // 返回子容器
        return subLayer;
    };
    /**
     * 初始化表现层桥，可以没有该方法，没有该方法则表示该表现层无需初始化
     * @param {()=>void} complete 初始化完毕后的回调
     * @memberof DOMBridge
     */
    DOMBridge.prototype.init = function (complete) {
        // 如果是名称，则转变成引用
        if (typeof this._initParams.container == "string") {
            this._initParams.container = document.querySelector(this._initParams.container);
        }
        // 如果是空，则生成一个
        if (!this._initParams.container) {
            this._initParams.container = document.createElement("div");
            document.body.appendChild(this._initParams.container);
        }
        // 创建背景显示层
        this._bgLayer = this.createLayer();
        // 创建场景显示层
        this._sceneLayer = this.createLayer();
        // 创建框架显示层
        this._frameLayer = this.createLayer();
        // 创建弹出层
        this._panelLayer = this.createLayer();
        // 创建遮罩层
        this._maskLayer = this.createLayer();
        // 创建顶级显示层
        this._topLayer = this.createLayer();
        // 添加Tween.js驱动
        __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__["a" /* system */].enterFrame(function () {
            // 每次使用最新的当前运行毫秒数更新Tween.js
            __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__["update"](__WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__["a" /* system */].getTimer());
        });
        // 调用回调
        complete(this);
    };
    /**
     * 判断皮肤是否是DOM显示节点
     *
     * @param {HTMLElement|string|string[]} skin 皮肤对象
     * @returns {boolean} 是否是DOM显示节点
     * @memberof DOMBridge
     */
    DOMBridge.prototype.isMySkin = function (skin) {
        if (skin instanceof HTMLElement)
            return true;
        if (typeof skin === "string" && (Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["b" /* isDOMPath */])(skin) || Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["c" /* isDOMStr */])(skin)))
            return true;
        if (skin instanceof Array) {
            // 数组里每一个元素都必须是皮肤
            var result = true;
            for (var _i = 0, skin_1 = skin; _i < skin_1.length; _i++) {
                var temp = skin_1[_i];
                if (!(typeof temp === "string" && (Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["b" /* isDOMPath */])(temp) || Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["c" /* isDOMStr */])(temp)))) {
                    result = false;
                    break;
                }
            }
            return result;
        }
        return false;
    };
    /**
     * 包装HTMLElement节点
     *
     * @param {IMediator} mediator 中介者
     * @param {HTMLElement|string|string[]} skin 原始HTMLElement节点
     * @returns {HTMLElement} 包装后的HTMLElement节点
     * @memberof DOMBridge
     */
    DOMBridge.prototype.wrapSkin = function (mediator, skin) {
        return Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["e" /* wrapSkin */])(mediator, skin);
    };
    /**
     * 替换皮肤，用于组件变身时不同表现层桥的处理
     *
     * @param {IMediator} mediator 中介者
     * @param {*} current 当前皮肤
     * @param {HTMLElement|string|string[]} target 要替换的皮肤
     * @returns {*} 替换完毕的皮肤
     * @memberof DOMBridge
     */
    DOMBridge.prototype.replaceSkin = function (mediator, current, target) {
        target = Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["d" /* toHTMLElement */])(target);
        // 如果有父节点，则用目标节点替换当前节点位置
        var parent = current.parentElement;
        if (parent) {
            parent.insertBefore(target, current);
            parent.removeChild(current);
        }
        // 重新包装节点
        this.wrapSkin(mediator, target);
        // 返回皮肤
        return target;
    };
    /**
     * 同步皮肤，用于组件变身后的重新定位
     *
     * @param {HTMLElement} current 当前皮肤
     * @param {HTMLElement} target 替换的皮肤
     * @memberof DOMBridge
     */
    DOMBridge.prototype.syncSkin = function (current, target) {
        if (!current || !target)
            return;
        // DOM无需特意同步，因为其样式都可以以css样式方式在外部表示，而仅有当前节点的style属性是需要同步的
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["b" /* extendObject */])(target.style, current.style);
    };
    /**
     * 创建一个空的显示对象
     *
     * @returns {HTMLElement}
     * @memberof DOMBridge
     */
    DOMBridge.prototype.createEmptyDisplay = function () {
        return document.createElement("div");
    };
    /**
     * 添加显示
     *
     * @param {Element} parent 要添加到的父容器
     * @param {Element} target 被添加的显示对象
     * @return {Element} 返回被添加的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.addChild = function (parent, target) {
        return parent.appendChild(target);
    };
    /**
     * 按索引添加显示
     *
     * @param {Element} parent 要添加到的父容器
     * @param {Element} target 被添加的显示对象
     * @param {number} index 要添加到的父级索引
     * @return {Element} 返回被添加的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.addChildAt = function (parent, target, index) {
        return parent.insertBefore(target, this.getChildAt(parent, index));
    };
    /**
     * 移除显示对象
     *
     * @param {Element} parent 父容器
     * @param {Element} target 被移除的显示对象
     * @return {Element} 返回被移除的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChild = function (parent, target) {
        if (parent && target && target.parentElement === parent)
            return parent.removeChild(target);
        else
            return target;
    };
    /**
     * 按索引移除显示
     *
     * @param {Element} parent 父容器
     * @param {number} index 索引
     * @return {Element} 返回被移除的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChildAt = function (parent, index) {
        return this.removeChild(parent, this.getChildAt(parent, index));
    };
    /**
     * 移除所有显示对象
     *
     * @param {Element} parent 父容器
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChildren = function (parent) {
        for (var i = 0, len = parent.children.length; i < len; i++) {
            parent.removeChild(parent.children.item(i));
        }
    };
    /**
     * 获取父容器
     *
     * @param {Element} target 目标对象
     * @returns {Element} 父容器
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getParent = function (target) {
        return target.parentElement;
    };
    /**
     * 获取指定索引处的显示对象
     *
     * @param {Element} parent 父容器
     * @param {number} index 指定父级索引
     * @return {Element} 索引处的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildAt = function (parent, index) {
        return parent.children.item(index);
    };
    /**
     * 获取显示索引
     *
     * @param {Element} parent 父容器
     * @param {Element} target 子显示对象
     * @return {number} target在parent中的索引
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildIndex = function (parent, target) {
        for (var i = 0, len = parent.children.length; i < len; i++) {
            if (target === parent.children.item(i))
                return i;
        }
        return -1;
    };
    /**
     * 通过名称获取显示对象
     *
     * @param {Element} parent 父容器
     * @param {string} name 对象名称
     * @return {Element} 显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildByName = function (parent, name) {
        return parent.children.namedItem(name);
    };
    /**
     * 获取子显示对象数量
     *
     * @param {Element} parent 父容器
     * @return {number} 子显示对象数量
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildCount = function (parent) {
        return parent.childElementCount;
    };
    /**
     * 加载资源
     *
     * @param {string[]} assets 资源数组
     * @param {IMediator} mediator 资源列表
     * @param {(err?:Error)=>void} handler 回调函数
     * @memberof DOMBridge
     */
    DOMBridge.prototype.loadAssets = function (assets, mediator, handler) {
        // 开始加载皮肤列表
        if (assets)
            assets = assets.concat();
        loadNext();
        function loadNext() {
            if (!assets || assets.length <= 0) {
                // 调用回调
                handler();
            }
            else {
                var skin = assets.shift();
                __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_assets_AssetsManager__["b" /* assetsManager */].loadAssets(skin, function (result) {
                    if (result instanceof Error)
                        handler(result);
                    else
                        loadNext();
                });
            }
        }
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {EventTarget} target 事件目标对象
     * @param {string} type 事件类型
     * @param {(evt:Event)=>void} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.mapListener = function (target, type, handler, thisArg) {
        var key = Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["e" /* getObjectHashs */])(target, type, handler, thisArg);
        // 判断是否已经存在该监听，如果存在则不再监听
        if (this._listenerDict[key])
            return;
        // 监听
        var listener = function (evt) {
            // 调用回调
            handler.call(thisArg || this, evt);
        };
        target.addEventListener(type, listener);
        // 记录监听
        this._listenerDict[key] = listener;
    };
    /**
     * 注销监听事件
     *
     * @param {EventTarget} target 事件目标对象
     * @param {string} type 事件类型
     * @param {(evt:Event)=>void} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
        var key = Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["e" /* getObjectHashs */])(target, type, handler, thisArg);
        // 判断是否已经存在该监听，如果存在则移除监听
        var listener = this._listenerDict[key];
        if (listener) {
            target.removeEventListener(type, listener);
            // 移除记录
            delete this._listenerDict[key];
        }
    };
    /**
     * 为绑定的列表显示对象包装一个渲染器创建回调
     *
     * @param {HTMLElement} target BindFor指令指向的显示对象
     * @param {(key?:any, value?:any, renderer?:HTMLElement)=>void} handler 渲染器创建回调
     * @returns {*} 返回一个备忘录对象，会在赋值时提供
     * @memberof IBridge
     */
    DOMBridge.prototype.wrapBindFor = function (target, handler) {
        var parent = target.parentElement;
        // 生成一个from节点和一个to节点，用来占位
        var from = document.createElement("div");
        var to = document.createElement("div");
        parent && parent.insertBefore(from, target);
        parent && parent.insertBefore(to, target);
        // 移除显示
        parent && parent.removeChild(target);
        // 返回备忘录
        return { parent: parent, from: from, to: to, handler: handler };
    };
    /**
     * 为列表显示对象赋值
     *
     * @param {HTMLElement} target BindFor指令指向的显示对象
     * @param {*} datas 数据集合
     * @param {*} memento wrapBindFor返回的备忘录对象
     * @memberof IBridge
     */
    DOMBridge.prototype.valuateBindFor = function (target, datas, memento) {
        // 移除已有的列表项显示
        var parent = memento.parent;
        if (parent) {
            var fromIndex = this.getChildIndex(parent, memento.from);
            var toIndex = this.getChildIndex(parent, memento.to);
            for (var i = fromIndex + 1; i < toIndex; i++) {
                this.removeChildAt(parent, fromIndex + 1);
            }
        }
        // 添加新的渲染器
        for (var key in datas) {
            var newElement = target.cloneNode(true);
            // 拷贝子孙对象引用
            Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["a" /* copyRef */])(newElement, newElement);
            // 添加显示
            parent && parent.insertBefore(newElement, memento.to);
            // 使用cloneNode方法复制渲染器
            memento.handler(key, datas[key], newElement);
        }
    };
    /** 提供静态类型常量 */
    DOMBridge.TYPE = "DOM";
    return DOMBridge;
}());
/* harmony default export */ __webpack_exports__["default"] = (DOMBridge);


/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Tween.js - Licensed under the MIT license
 * https://github.com/tweenjs/tween.js
 * ----------------------------------------------
 *
 * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.
 * Thank you all, you're awesome!
 */


var _Group = function () {
	this._tweens = {};
	this._tweensAddedDuringUpdate = {};
};

_Group.prototype = {
	getAll: function () {

		return Object.keys(this._tweens).map(function (tweenId) {
			return this._tweens[tweenId];
		}.bind(this));

	},

	removeAll: function () {

		this._tweens = {};

	},

	add: function (tween) {

		this._tweens[tween.getId()] = tween;
		this._tweensAddedDuringUpdate[tween.getId()] = tween;

	},

	remove: function (tween) {

		delete this._tweens[tween.getId()];
		delete this._tweensAddedDuringUpdate[tween.getId()];

	},

	update: function (time, preserve) {

		var tweenIds = Object.keys(this._tweens);

		if (tweenIds.length === 0) {
			return false;
		}

		time = time !== undefined ? time : TWEEN.now();

		// Tweens are updated in "batches". If you add a new tween during an update, then the
		// new tween will be updated in the next batch.
		// If you remove a tween during an update, it may or may not be updated. However,
		// if the removed tween was added during the current batch, then it will not be updated.
		while (tweenIds.length > 0) {
			this._tweensAddedDuringUpdate = {};

			for (var i = 0; i < tweenIds.length; i++) {

				var tween = this._tweens[tweenIds[i]];

				if (tween && tween.update(time) === false) {
					tween._isPlaying = false;

					if (!preserve) {
						delete this._tweens[tweenIds[i]];
					}
				}
			}

			tweenIds = Object.keys(this._tweensAddedDuringUpdate);
		}

		return true;

	}
};

var TWEEN = new _Group();

TWEEN.Group = _Group;
TWEEN._nextId = 0;
TWEEN.nextId = function () {
	return TWEEN._nextId++;
};


// Include a performance.now polyfill.
// In node.js, use process.hrtime.
if (typeof (window) === 'undefined' && typeof (process) !== 'undefined') {
	TWEEN.now = function () {
		var time = process.hrtime();

		// Convert [seconds, nanoseconds] to milliseconds.
		return time[0] * 1000 + time[1] / 1000000;
	};
}
// In a browser, use window.performance.now if it is available.
else if (typeof (window) !== 'undefined' &&
         window.performance !== undefined &&
		 window.performance.now !== undefined) {
	// This must be bound, because directly assigning this function
	// leads to an invocation exception in Chrome.
	TWEEN.now = window.performance.now.bind(window.performance);
}
// Use Date.now if it is available.
else if (Date.now !== undefined) {
	TWEEN.now = Date.now;
}
// Otherwise, use 'new Date().getTime()'.
else {
	TWEEN.now = function () {
		return new Date().getTime();
	};
}


TWEEN.Tween = function (object, group) {
	this._object = object;
	this._valuesStart = {};
	this._valuesEnd = {};
	this._valuesStartRepeat = {};
	this._duration = 1000;
	this._repeat = 0;
	this._repeatDelayTime = undefined;
	this._yoyo = false;
	this._isPlaying = false;
	this._reversed = false;
	this._delayTime = 0;
	this._startTime = null;
	this._easingFunction = TWEEN.Easing.Linear.None;
	this._interpolationFunction = TWEEN.Interpolation.Linear;
	this._chainedTweens = [];
	this._onStartCallback = null;
	this._onStartCallbackFired = false;
	this._onUpdateCallback = null;
	this._onCompleteCallback = null;
	this._onStopCallback = null;
	this._group = group || TWEEN;
	this._id = TWEEN.nextId();

};

TWEEN.Tween.prototype = {
	getId: function getId() {
		return this._id;
	},

	isPlaying: function isPlaying() {
		return this._isPlaying;
	},

	to: function to(properties, duration) {

		this._valuesEnd = properties;

		if (duration !== undefined) {
			this._duration = duration;
		}

		return this;

	},

	start: function start(time) {

		this._group.add(this);

		this._isPlaying = true;

		this._onStartCallbackFired = false;

		this._startTime = time !== undefined ? typeof time === 'string' ? TWEEN.now() + parseFloat(time) : time : TWEEN.now();
		this._startTime += this._delayTime;

		for (var property in this._valuesEnd) {

			// Check if an Array was provided as property value
			if (this._valuesEnd[property] instanceof Array) {

				if (this._valuesEnd[property].length === 0) {
					continue;
				}

				// Create a local copy of the Array with the start value at the front
				this._valuesEnd[property] = [this._object[property]].concat(this._valuesEnd[property]);

			}

			// If `to()` specifies a property that doesn't exist in the source object,
			// we should not set that property in the object
			if (this._object[property] === undefined) {
				continue;
			}

			// Save the starting value.
			this._valuesStart[property] = this._object[property];

			if ((this._valuesStart[property] instanceof Array) === false) {
				this._valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings
			}

			this._valuesStartRepeat[property] = this._valuesStart[property] || 0;

		}

		return this;

	},

	stop: function stop() {

		if (!this._isPlaying) {
			return this;
		}

		this._group.remove(this);
		this._isPlaying = false;

		if (this._onStopCallback !== null) {
			this._onStopCallback(this._object);
		}

		this.stopChainedTweens();
		return this;

	},

	end: function end() {

		this.update(this._startTime + this._duration);
		return this;

	},

	stopChainedTweens: function stopChainedTweens() {

		for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {
			this._chainedTweens[i].stop();
		}

	},

	group: function group(group) {
		this._group = group;
		return this;
	},

	delay: function delay(amount) {

		this._delayTime = amount;
		return this;

	},

	repeat: function repeat(times) {

		this._repeat = times;
		return this;

	},

	repeatDelay: function repeatDelay(amount) {

		this._repeatDelayTime = amount;
		return this;

	},

	yoyo: function yoyo(yy) {

		this._yoyo = yy;
		return this;

	},

	easing: function easing(eas) {

		this._easingFunction = eas;
		return this;

	},

	interpolation: function interpolation(inter) {

		this._interpolationFunction = inter;
		return this;

	},

	chain: function chain() {

		this._chainedTweens = arguments;
		return this;

	},

	onStart: function onStart(callback) {

		this._onStartCallback = callback;
		return this;

	},

	onUpdate: function onUpdate(callback) {

		this._onUpdateCallback = callback;
		return this;

	},

	onComplete: function onComplete(callback) {

		this._onCompleteCallback = callback;
		return this;

	},

	onStop: function onStop(callback) {

		this._onStopCallback = callback;
		return this;

	},

	update: function update(time) {

		var property;
		var elapsed;
		var value;

		if (time < this._startTime) {
			return true;
		}

		if (this._onStartCallbackFired === false) {

			if (this._onStartCallback !== null) {
				this._onStartCallback(this._object);
			}

			this._onStartCallbackFired = true;
		}

		elapsed = (time - this._startTime) / this._duration;
		elapsed = (this._duration === 0 || elapsed > 1) ? 1 : elapsed;

		value = this._easingFunction(elapsed);

		for (property in this._valuesEnd) {

			// Don't update properties that do not exist in the source object
			if (this._valuesStart[property] === undefined) {
				continue;
			}

			var start = this._valuesStart[property] || 0;
			var end = this._valuesEnd[property];

			if (end instanceof Array) {

				this._object[property] = this._interpolationFunction(end, value);

			} else {

				// Parses relative end values with start as base (e.g.: +10, -3)
				if (typeof (end) === 'string') {

					if (end.charAt(0) === '+' || end.charAt(0) === '-') {
						end = start + parseFloat(end);
					} else {
						end = parseFloat(end);
					}
				}

				// Protect against non numeric properties.
				if (typeof (end) === 'number') {
					this._object[property] = start + (end - start) * value;
				}

			}

		}

		if (this._onUpdateCallback !== null) {
			this._onUpdateCallback(this._object);
		}

		if (elapsed === 1) {

			if (this._repeat > 0) {

				if (isFinite(this._repeat)) {
					this._repeat--;
				}

				// Reassign starting values, restart by making startTime = now
				for (property in this._valuesStartRepeat) {

					if (typeof (this._valuesEnd[property]) === 'string') {
						this._valuesStartRepeat[property] = this._valuesStartRepeat[property] + parseFloat(this._valuesEnd[property]);
					}

					if (this._yoyo) {
						var tmp = this._valuesStartRepeat[property];

						this._valuesStartRepeat[property] = this._valuesEnd[property];
						this._valuesEnd[property] = tmp;
					}

					this._valuesStart[property] = this._valuesStartRepeat[property];

				}

				if (this._yoyo) {
					this._reversed = !this._reversed;
				}

				if (this._repeatDelayTime !== undefined) {
					this._startTime = time + this._repeatDelayTime;
				} else {
					this._startTime = time + this._delayTime;
				}

				return true;

			} else {

				if (this._onCompleteCallback !== null) {

					this._onCompleteCallback(this._object);
				}

				for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {
					// Make the chained tweens start exactly at the time they should,
					// even if the `update()` method was called way past the duration of the tween
					this._chainedTweens[i].start(this._startTime + this._duration);
				}

				return false;

			}

		}

		return true;

	}
};


TWEEN.Easing = {

	Linear: {

		None: function (k) {

			return k;

		}

	},

	Quadratic: {

		In: function (k) {

			return k * k;

		},

		Out: function (k) {

			return k * (2 - k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k;
			}

			return - 0.5 * (--k * (k - 2) - 1);

		}

	},

	Cubic: {

		In: function (k) {

			return k * k * k;

		},

		Out: function (k) {

			return --k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k + 2);

		}

	},

	Quartic: {

		In: function (k) {

			return k * k * k * k;

		},

		Out: function (k) {

			return 1 - (--k * k * k * k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k;
			}

			return - 0.5 * ((k -= 2) * k * k * k - 2);

		}

	},

	Quintic: {

		In: function (k) {

			return k * k * k * k * k;

		},

		Out: function (k) {

			return --k * k * k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k * k * k + 2);

		}

	},

	Sinusoidal: {

		In: function (k) {

			return 1 - Math.cos(k * Math.PI / 2);

		},

		Out: function (k) {

			return Math.sin(k * Math.PI / 2);

		},

		InOut: function (k) {

			return 0.5 * (1 - Math.cos(Math.PI * k));

		}

	},

	Exponential: {

		In: function (k) {

			return k === 0 ? 0 : Math.pow(1024, k - 1);

		},

		Out: function (k) {

			return k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			if ((k *= 2) < 1) {
				return 0.5 * Math.pow(1024, k - 1);
			}

			return 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);

		}

	},

	Circular: {

		In: function (k) {

			return 1 - Math.sqrt(1 - k * k);

		},

		Out: function (k) {

			return Math.sqrt(1 - (--k * k));

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return - 0.5 * (Math.sqrt(1 - k * k) - 1);
			}

			return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);

		}

	},

	Elastic: {

		In: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);

		},

		Out: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			k *= 2;

			if (k < 1) {
				return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);
			}

			return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;

		}

	},

	Back: {

		In: function (k) {

			var s = 1.70158;

			return k * k * ((s + 1) * k - s);

		},

		Out: function (k) {

			var s = 1.70158;

			return --k * k * ((s + 1) * k + s) + 1;

		},

		InOut: function (k) {

			var s = 1.70158 * 1.525;

			if ((k *= 2) < 1) {
				return 0.5 * (k * k * ((s + 1) * k - s));
			}

			return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);

		}

	},

	Bounce: {

		In: function (k) {

			return 1 - TWEEN.Easing.Bounce.Out(1 - k);

		},

		Out: function (k) {

			if (k < (1 / 2.75)) {
				return 7.5625 * k * k;
			} else if (k < (2 / 2.75)) {
				return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;
			} else if (k < (2.5 / 2.75)) {
				return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;
			} else {
				return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;
			}

		},

		InOut: function (k) {

			if (k < 0.5) {
				return TWEEN.Easing.Bounce.In(k * 2) * 0.5;
			}

			return TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;

		}

	}

};

TWEEN.Interpolation = {

	Linear: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.Linear;

		if (k < 0) {
			return fn(v[0], v[1], f);
		}

		if (k > 1) {
			return fn(v[m], v[m - 1], m - f);
		}

		return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);

	},

	Bezier: function (v, k) {

		var b = 0;
		var n = v.length - 1;
		var pw = Math.pow;
		var bn = TWEEN.Interpolation.Utils.Bernstein;

		for (var i = 0; i <= n; i++) {
			b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);
		}

		return b;

	},

	CatmullRom: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.CatmullRom;

		if (v[0] === v[m]) {

			if (k < 0) {
				i = Math.floor(f = m * (1 + k));
			}

			return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);

		} else {

			if (k < 0) {
				return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);
			}

			if (k > 1) {
				return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);
			}

			return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);

		}

	},

	Utils: {

		Linear: function (p0, p1, t) {

			return (p1 - p0) * t + p0;

		},

		Bernstein: function (n, i) {

			var fc = TWEEN.Interpolation.Utils.Factorial;

			return fc(n) / fc(i) / fc(n - i);

		},

		Factorial: (function () {

			var a = [1];

			return function (n) {

				var s = 1;

				if (a[n]) {
					return a[n];
				}

				for (var i = n; i > 1; i--) {
					s *= i;
				}

				a[n] = s;
				return s;

			};

		})(),

		CatmullRom: function (p0, p1, p2, p3, t) {

			var v0 = (p2 - p0) * 0.5;
			var v1 = (p3 - p1) * 0.5;
			var t2 = t * t;
			var t3 = t * t2;

			return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;

		}

	}

};

// UMD (Universal Module Definition)
(function (root) {

	if (true) {

		// AMD
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function () {
			return TWEEN;
		}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

	} else if (typeof module !== 'undefined' && typeof exports === 'object') {

		// Node.js
		module.exports = TWEEN;

	} else if (root !== undefined) {

		// Global variable
		root.TWEEN = TWEEN;

	}

})(this);

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(32)))

/***/ }),
/* 28 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_module_ModuleMessage__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_scene_SceneMessage__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__ = __webpack_require__(84);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__egret_AssetsLoader__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__egret_panel_BackPanelPolicy__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__egret_scene_FadeScenePolicy__ = __webpack_require__(90);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__egret_mask_MaskEntity__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__egret_utils_UIUtil__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__egret_command_UpdateScreenSizeCommand__ = __webpack_require__(93);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__egret_utils_SkinUtil__ = __webpack_require__(95);
/// <amd-module name="EgretBridge"/>













/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * Egret的表现层桥实现，当前Egret版本：5.0.7
*/
var EgretBridge = /** @class */ (function () {
    function EgretBridge(params) {
        /**
         * 默认弹窗策略
         *
         * @type {IPanelPolicy}
         * @memberof EgretBridge
         */
        this.defaultPanelPolicy = new __WEBPACK_IMPORTED_MODULE_7__egret_panel_BackPanelPolicy__["a" /* default */]();
        /**
         * 默认场景切换策略
         *
         * @type {IScenePolicy}
         * @memberof EgretBridge
         */
        this.defaultScenePolicy = new __WEBPACK_IMPORTED_MODULE_8__egret_scene_FadeScenePolicy__["a" /* default */]();
        this._initParams = params;
    }
    Object.defineProperty(EgretBridge.prototype, "type", {
        /**
         * 获取表现层类型名称
         *
         * @readonly
         * @type {string}
         * @memberof EgretBridge
         */
        get: function () {
            return EgretBridge.TYPE;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "htmlWrapper", {
        /**
         * 获取表现层HTML包装器，可以对其样式进行自定义调整
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof EgretBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "root", {
        /**
         * 获取根显示节点
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._root;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "stage", {
        /**
         * 获取舞台引用
         *
         * @readonly
         * @type {egret.Stage}
         * @memberof EgretBridge
         */
        get: function () {
            return this._stage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "bgLayer", {
        /**
         * 获取背景容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._bgLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "sceneLayer", {
        /**
         * 获取场景容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._sceneLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "frameLayer", {
        /**
         * 获取框架容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._frameLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "panelLayer", {
        /**
         * 获取弹窗容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._panelLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "maskLayer", {
        /**
         * 获取遮罩容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._maskLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "topLayer", {
        /**
         * 获取顶级容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._topLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "promptClass", {
        /**
         * 获取通用提示框
         *
         * @readonly
         * @type {IPromptPanelConstructor}
         * @memberof EgretBridge
         */
        get: function () {
            return this._initParams.promptClass;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "maskEntity", {
        /**
         * 获取遮罩实体
         *
         * @readonly
         * @type {IMaskEntity}
         * @memberof EgretBridge
         */
        get: function () {
            return new __WEBPACK_IMPORTED_MODULE_9__egret_mask_MaskEntity__["a" /* default */](this._initParams.maskData);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 初始化表现层桥
     * @param {()=>void} complete 初始化完毕后的回调
     * @memberof EgretBridge
     */
    EgretBridge.prototype.init = function (complete) {
        // 生成html和body的样式节点
        var style = document.createElement("style");
        style.textContent = "\n            html, body {\n                -ms-touch-action: none;\n                background: " + egret.toColorString(this._initParams.backgroundColor || 0) + ";\n                padding: 0;\n                border: 0;\n                margin: 0;\n                height: 100%;\n            }\n        ";
        document.head.appendChild(style);
        // 统一容器
        if (typeof this._initParams.container == "string") {
            this._initParams.container = document.querySelector(this._initParams.container);
        }
        if (!this._initParams.container) {
            this._initParams.container = document.createElement("div");
            document.body.appendChild(this._initParams.container);
        }
        var container = this._initParams.container;
        // 构建容器参数
        container.style.margin = "auto";
        container.style.width = "100%";
        container.style.height = "100%";
        container.style.position = "fixed";
        container.style.top = "0%";
        container.style.left = "0%";
        container.className = "egret-player";
        container.setAttribute("data-entry-class", "__EgretRoot__");
        container.setAttribute("data-orientation", "auto");
        container.setAttribute("data-scale-mode", this._initParams.scaleMode || egret.StageScaleMode.FIXED_NARROW);
        container.setAttribute("data-frame-rate", (this._initParams.frameRate || 60) + "");
        container.setAttribute("data-content-width", this._initParams.width + "");
        container.setAttribute("data-content-height", this._initParams.height + "");
        container.setAttribute("data-show-paint-rect", (this._initParams.showPaintRect || false) + "");
        container.setAttribute("data-multi-fingered", (this._initParams.multiFingered || 2) + "");
        container.setAttribute("data-show-fps", (this._initParams.showFPS || false) + "");
        container.setAttribute("data-show-fps-style", this._initParams.showFPSStyle || "x:0,y:0,size:12,textColor:0xffffff,bgAlpha:0.9");
        container.setAttribute("data-show-log", (this._initParams.showLog || false) + "");
        // 构建__EgretRoot__类，使得Egret引擎可以通过window寻址的方式找到该类，同时又可以让其将控制权转交给Application
        var self = this;
        window["__EgretRoot__"] = function () {
            eui.UILayer.call(this);
            this.touchEnabled = false;
        };
        window["__EgretRoot__"].prototype = new eui.UILayer();
        window["__EgretRoot__"].prototype.$onAddToStage = function (stage, nestLevel) {
            // 调用父类方法
            eui.UILayer.prototype.$onAddToStage.call(this, stage, nestLevel);
            // 移除引用
            delete window["__EgretRoot__"];
            // 将控制权移交给Application对象
            onRootInitialized(this);
        };
        // 根据渲染模式初始化Egret引擎
        switch (this._initParams.renderMode) {
            case __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__["a" /* default */].WEBGL:
                initEgret("webgl");
                break;
            case __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__["a" /* default */].CANVAS:
            default:
                initEgret("canvas");
                break;
        }
        function initEgret(renderMode) {
            if (window["eui"]) {
                // 篡改eui.DataGroup.commitProperties和getVirtualElementAt方法，为renderer添加一个标签以修复列表首项渲染多次的bug
                var oriCommitProperties = eui.DataGroup.prototype["commitProperties"];
                eui.DataGroup.prototype["commitProperties"] = function () {
                    this.__egret_datagroup_state__ = 1;
                    var result = oriCommitProperties.apply(this, arguments);
                    return result;
                };
                var oriGetVirtualElementAt = eui.DataGroup.prototype["getVirtualElementAt"];
                eui.DataGroup.prototype["getVirtualElementAt"] = function () {
                    this.__egret_datagroup_state__ = 2;
                    var result = oriGetVirtualElementAt.apply(this, arguments);
                    return result;
                };
                // 篡改eui.registerBindable方法，把__bindables__赋值变为不可遍历的属性
                var oriRegisterBindable = eui.registerBindable;
                eui.registerBindable = function (instance, property) {
                    var result = oriRegisterBindable.call(this, instance, property);
                    // 改变可遍历性
                    var desc = Object.getOwnPropertyDescriptor(instance, "__bindables__");
                    if (desc && desc.enumerable) {
                        desc.enumerable = false;
                        Object.defineProperty(instance, "__bindables__", desc);
                    }
                    // 返回结果
                    return result;
                };
                // 篡改Watcher.checkBindable方法，把__listeners__赋值变为不可遍历
                var oriCheckBindable = eui.Watcher["checkBindable"];
                eui.Watcher["checkBindable"] = function (host, property) {
                    var result = oriCheckBindable.call(this, host, property);
                    // 改变可遍历性
                    var desc = Object.getOwnPropertyDescriptor(host, "__listeners__");
                    if (desc && desc.enumerable) {
                        desc.enumerable = false;
                        Object.defineProperty(host, "__listeners__", desc);
                    }
                };
            }
            // 启动Egret引擎
            egret.runEgret({
                renderMode: renderMode,
                audioType: 0
            });
        }
        function onRootInitialized(root) {
            self._root = root;
            self._stage = root.stage;
            // 创建背景显示层
            self._bgLayer = new eui.UILayer();
            self._bgLayer.touchEnabled = false;
            root.addChild(self._bgLayer);
            // 创建场景显示层
            self._sceneLayer = new eui.UILayer();
            self._sceneLayer.touchEnabled = false;
            root.addChild(self._sceneLayer);
            // 创建框架显示层
            self._frameLayer = new eui.UILayer();
            self._frameLayer.touchEnabled = false;
            root.addChild(self._frameLayer);
            // 创建弹出层
            self._panelLayer = new eui.UILayer();
            self._panelLayer.touchEnabled = false;
            root.addChild(self._panelLayer);
            // 创建遮罩层
            self._maskLayer = new eui.UILayer();
            self._maskLayer.touchEnabled = false;
            root.addChild(self._maskLayer);
            // 创建顶级显示层
            self._topLayer = new eui.UILayer();
            self._topLayer.touchEnabled = false;
            root.addChild(self._topLayer);
            // 插入更新屏幕命令
            __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__["a" /* core */].mapCommand(__WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_scene_SceneMessage__["a" /* default */].SCENE_BEFORE_CHANGE, __WEBPACK_IMPORTED_MODULE_11__egret_command_UpdateScreenSizeCommand__["a" /* default */]);
            // 设置资源和主题适配器
            egret.registerImplementation("eui.IAssetAdapter", new AssetAdapter());
            egret.registerImplementation("eui.IThemeAdapter", new ThemeAdapter(self._initParams));
            // 加载资源配置
            RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
            var url = Object(__WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__["f" /* wrapAbsolutePath */])(self._initParams.pathPrefix + "resource/default.res.json", __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__["environment"].curCDNHost);
            RES.loadConfig(url, self._initParams.pathPrefix + "resource/");
        }
        function onConfigComplete(evt) {
            RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
            // 加载主题配置
            var url = Object(__WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__["f" /* wrapAbsolutePath */])(this._initParams.pathPrefix + "resource/default.thm.json", __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__["environment"].curCDNHost);
            var theme = new eui.Theme(url, self._root.stage);
            theme.addEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
        }
        function onThemeLoadComplete(evt) {
            evt.target.removeEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
            // 加载预加载资源组
            var preloadGroups = this._initParams.preloadGroups;
            self.loadAssets(preloadGroups, null, function (err) { return complete(self); });
        }
    };
    /**
     * 判断皮肤是否是Egret显示对象
     *
     * @param {*} skin 皮肤对象
     * @returns {boolean} 是否是Egret显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.isMySkin = function (skin) {
        if (skin instanceof egret.DisplayObject)
            return true;
        if (skin instanceof Function)
            return (skin.prototype instanceof egret.DisplayObject);
        if (typeof skin === "string")
            return (egret.getDefinitionByName(skin) != null);
    };
    /**
     * 包装HTMLElement节点
     *
     * @param {IMediator} mediator 中介者
     * @param {*} skin 原始皮肤
     * @returns {egret.DisplayObject} 包装后的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.wrapSkin = function (mediator, skin) {
        return Object(__WEBPACK_IMPORTED_MODULE_12__egret_utils_SkinUtil__["a" /* wrapSkin */])(mediator, skin);
    };
    /**
     * 替换皮肤，用于组件变身时不同表现层桥的处理
     *
     * @param {IMediator} mediator 中介者
     * @param {*} current 当前皮肤
     * @param {*} target 要替换的皮肤
     * @returns {*} 替换完毕的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.replaceSkin = function (mediator, current, target) {
        // Egret皮肤需要判断类型，进行不同处理
        if (current instanceof eui.Component) {
            if (target instanceof eui.Component) {
                // 两边都是eui组件，直接将右手皮肤赋值给左手
                current.skinName = target.skin;
            }
            else if (target instanceof egret.DisplayObject) {
                // 右手是普通显示对象，移除左手皮肤，添加右手显示到其中
                current.skinName = null;
                current.addChild(target);
            }
            else {
                // 其他情况都认为右手是皮肤数据
                current.skinName = target;
            }
            // 返回左手
            return current;
        }
        else {
            if (!(target instanceof egret.DisplayObject)) {
                // 右手不是显示对象，认为是皮肤数据，生成一个eui.Component包裹它
                var temp = new eui.Component();
                temp.skinName = target;
                target = temp;
            }
            // 右手替换左手位置
            var parent = current.parent;
            parent.addChildAt(target, parent.getChildIndex(current));
            parent.removeChild(current);
            // 返回右手
            return target;
        }
    };
    /**
     * 同步皮肤，用于组件变身后的重新定位
     *
     * @param {egret.DisplayObject} current 当前皮肤
     * @param {egret.DisplayObject} target 替换的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.syncSkin = function (current, target) {
        if (!current || !target)
            return;
        // 设置属性
        // 下面是egret级别属性
        var props = [
            "matrix", "anchorOffsetX", "anchorOffsetY", "alpha", "visible"
        ];
        // 如果当前宽高不为0则同样设置宽高
        if (current.width > 0)
            props.push("width");
        if (current.height > 0)
            props.push("height");
        // 下面是eui级别属性
        if (current instanceof eui.Component && target instanceof eui.Component) {
            props.push.apply(props, [
                "horizontalCenter", "verticalCenter", "left", "right", "top", "bottom"
            ]);
        }
        // 全部赋值
        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {
            var prop = props_1[_i];
            target[prop] = current[prop];
        }
    };
    /**
     * 创建一个空的显示对象
     *
     * @returns {egret.Sprite}
     * @memberof EgretBridge
     */
    EgretBridge.prototype.createEmptyDisplay = function () {
        return new egret.Sprite();
    };
    /**
     * 添加显示
     *
     * @param {egret.DisplayObjectContainer} parent 要添加到的父容器
     * @param {egret.DisplayObject} target 被添加的显示对象
     * @return {egret.DisplayObject} 返回被添加的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.addChild = function (parent, target) {
        if (parent && target)
            return parent.addChild(target);
        else
            return target;
    };
    /**
     * 按索引添加显示
     *
     * @param {egret.DisplayObjectContainer} parent 要添加到的父容器
     * @param {egret.DisplayObject} target 被添加的显示对象
     * @param {number} index 要添加到的父级索引
     * @return {egret.DisplayObject} 返回被添加的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.addChildAt = function (parent, target, index) {
        if (parent && target)
            return parent.addChildAt(target, index);
        else
            return target;
    };
    /**
     * 移除显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {egret.DisplayObject} target 被移除的显示对象
     * @return {egret.DisplayObject} 返回被移除的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChild = function (parent, target) {
        if (parent && target && target.parent === parent)
            return parent.removeChild(target);
        else
            return target;
    };
    /**
     * 按索引移除显示
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {number} index 索引
     * @return {egret.DisplayObject} 返回被移除的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChildAt = function (parent, index) {
        if (parent && index >= 0)
            return parent.removeChildAt(index);
        else
            return null;
    };
    /**
     * 移除所有显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChildren = function (parent) {
        if (parent)
            parent.removeChildren();
    };
    /**
     * 获取父容器
     *
     * @param {egret.DisplayObject} target 目标对象
     * @returns {egret.DisplayObjectContainer} 父容器
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getParent = function (target) {
        return target.parent;
    };
    /**
     * 获取指定索引处的显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {number} index 指定父级索引
     * @return {egret.DisplayObject} 索引处的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildAt = function (parent, index) {
        return parent.getChildAt(index);
    };
    /**
     * 获取显示索引
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {egret.DisplayObject} target 子显示对象
     * @return {number} target在parent中的索引
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildIndex = function (parent, target) {
        return parent.getChildIndex(target);
    };
    /**
     * 通过名称获取显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {string} name 对象名称
     * @return {egret.DisplayObject} 显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildByName = function (parent, name) {
        return parent.getChildByName(name);
    };
    /**
     * 获取子显示对象数量
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @return {number} 子显示对象数量
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildCount = function (parent) {
        return parent.numChildren;
    };
    /**
     * 加载资源
     *
     * @param {string[]} assets 资源数组
     * @param {IMediator} mediator 资源列表
     * @param {(err?:Error)=>void} handler 回调函数
     * @memberof EgretBridge
     */
    EgretBridge.prototype.loadAssets = function (assets, mediator, handler) {
        var loader = new __WEBPACK_IMPORTED_MODULE_6__egret_AssetsLoader__["a" /* default */]({
            oneError: function (evt) {
                // 调用回调
                handler(new Error("资源加载失败"));
                // 派发加载错误事件
                __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_module_ModuleMessage__["default"].MODULE_LOAD_ASSETS_ERROR, evt);
            },
            complete: function (dict) {
                // 调用回调
                handler();
            }
        });
        loader.loadGroups(assets);
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {egret.EventDispatcher} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.mapListener = function (target, type, handler, thisArg) {
        target.addEventListener(type, handler, thisArg);
    };
    /**
     * 注销监听事件
     *
     * @param {egret.EventDispatcher} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
        target.removeEventListener(type, handler, thisArg);
    };
    /**
     * 为绑定的列表显示对象包装一个渲染器创建回调
     *
     * @param {eui.DataGroup} target BindFor指令指向的显示对象
     * @param {(key?:any, value?:any, renderer?:eui.IItemRenderer)=>void} rendererHandler 渲染器创建回调
     * @returns {*} 返回一个备忘录对象，会在赋值时提供
     * @memberof IBridge
     */
    EgretBridge.prototype.wrapBindFor = function (target, rendererHandler) {
        var memento = {};
        Object(__WEBPACK_IMPORTED_MODULE_10__egret_utils_UIUtil__["a" /* wrapEUIList */])(target, function (data, renderer) {
            // 取出key
            var key;
            var datas = memento.datas;
            // 遍历memento的datas属性（在valuateBindFor时被赋值）
            if (datas instanceof Array) {
                key = renderer.itemIndex;
            }
            else {
                for (var i in datas) {
                    if (datas[i] === data) {
                        // 这就是我们要找的key
                        key = i;
                        break;
                    }
                }
            }
            // 调用回调
            if (key != null) {
                if (memento.syncDict) {
                    if (!memento.syncDict[key]) {
                        if (target["__egret_datagroup_state__"] === 1 || target["__egret_datagroup_state__"] === 2) {
                            memento.syncDict[key] = data;
                            rendererHandler(key, data, renderer);
                        }
                    }
                }
                else {
                    rendererHandler(key, data, renderer);
                }
            }
        });
        return memento;
    };
    /**
     * 为列表显示对象赋值
     *
     * @param {eui.DataGroup} target BindFor指令指向的显示对象
     * @param {*} datas 数据集合
     * @param {*} memento wrapBindFor返回的备忘录对象
     * @memberof IBridge
     */
    EgretBridge.prototype.valuateBindFor = function (target, datas, memento) {
        var provider;
        // 初始化列表状态
        target["__egret_datagroup_state__"] = 0;
        // 设置memento
        memento.datas = datas;
        memento.syncDict = {};
        setTimeout(function () {
            // 一次渲染后解锁
            delete memento.syncDict;
        }, 0);
        // 复制datas
        if (datas instanceof Array) {
            provider = new eui.ArrayCollection(datas);
        }
        else {
            // 是字典，将其变为数组
            var list = [];
            for (var key in datas) {
                list.push(datas[key]);
            }
            provider = new eui.ArrayCollection(list);
        }
        // 赋值
        target.dataProvider = provider;
    };
    /** 提供静态类型常量 */
    EgretBridge.TYPE = "Egret";
    return EgretBridge;
}());
/* harmony default export */ __webpack_exports__["default"] = (EgretBridge);
var AssetAdapter = /** @class */ (function () {
    function AssetAdapter() {
    }
    /**
     * @language zh_CN
     * 解析素材
     * @param source 待解析的新素材标识符
     * @param compFunc 解析完成回调函数，示例：callBack(content:any,source:string):void;
     * @param thisObject callBack的 this 引用
     */
    AssetAdapter.prototype.getAsset = function (source, compFunc, thisObject) {
        if (RES.hasRes(source)) {
            var data = RES.getRes(source);
            if (data)
                onGetRes(data);
            else
                RES.getResAsync(source, onGetRes, this);
        }
        else {
            RES.getResByUrl(source, onGetRes, this, RES.ResourceItem.TYPE_IMAGE);
        }
        function onGetRes(data) {
            compFunc.call(thisObject, data, source);
        }
    };
    return AssetAdapter;
}());
var ThemeAdapter = /** @class */ (function () {
    function ThemeAdapter(initParams) {
        this._initParams = initParams;
    }
    /**
     * 解析主题
     * @param url 待解析的主题url
     * @param compFunc 解析完成回调函数，示例：compFunc(e:egret.Event):void;
     * @param errorFunc 解析失败回调函数，示例：errorFunc():void;
     * @param thisObject 回调的this引用
     */
    ThemeAdapter.prototype.getTheme = function (url, compFunc, errorFunc, thisObject) {
        RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
        RES.getResByUrl(url, onGetRes, this, RES.ResourceItem.TYPE_TEXT);
        function onGetRes(e) {
            try {
                // 需要为所有主题资源添加路径前缀
                var data = JSON.parse(e);
                for (var key in data.skins)
                    data.skins[key] = this._initParams.pathPrefix + data.skins[key];
                for (var key in data.exmls) {
                    // 如果只是URL则直接添加前缀，否则是内容集成方式，需要单独修改path属性
                    var exml = data.exmls[key];
                    if (typeof exml == "string")
                        data.exmls[key] = this._initParams.pathPrefix + exml;
                    else
                        exml.path = this._initParams.pathPrefix + exml.path;
                }
                e = JSON.stringify(data);
            }
            catch (err) { }
            compFunc.call(thisObject, e);
        }
        function onError(e) {
            if (e.resItem.url == url) {
                RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
                errorFunc.call(thisObject);
            }
        }
    };
    return ThemeAdapter;
}());


/***/ }),
/* 29 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__ = __webpack_require__(57);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__message_CoreMessage__ = __webpack_require__(31);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-31
 * @modify date 2017-10-31
 *
 * 可观察接口的默认实现对象，会将收到的消息通知给注册的回调
*/
var Observable = /** @class */ (function () {
    function Observable(parent) {
        this._listenerDict = {};
        this._commandDict = {};
        this._disposed = false;
        this.parent = parent && parent.observable;
    }
    Object.defineProperty(Observable.prototype, "observable", {
        /**
         * 获取到IObservable实体，若本身就是IObservable实体则返回本身
         *
         * @type {IObservable}
         * @memberof Observable
         */
        get: function () {
            return this;
        },
        enumerable: true,
        configurable: true
    });
    Observable.prototype.handleMessages = function (msg) {
        var listeners1 = this._listenerDict[msg.__type];
        var listeners2 = this._listenerDict[msg.constructor.toString()];
        var listeners = (listeners1 && listeners2 ? listeners1.concat(listeners2) : listeners1 || listeners2);
        if (listeners) {
            listeners = listeners.concat();
            for (var _i = 0, listeners_1 = listeners; _i < listeners_1.length; _i++) {
                var temp = listeners_1[_i];
                // 调用处理函数
                if (msg instanceof __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */])
                    // 如果是通用消息，则将参数结构后调用回调
                    (_a = temp.handler).call.apply(_a, [temp.thisArg].concat(msg.params));
                else
                    // 如果是其他消息，则直接将消息体传给回调
                    temp.handler.call(temp.thisArg, msg);
                // 如果是一次性监听则移除之
                if (temp.once) {
                    this.unlisten(msg.__type, temp.handler, temp.thisArg, temp.once);
                    this.unlisten(msg.constructor.toString(), temp.handler, temp.thisArg, temp.once);
                }
            }
        }
        var _a;
    };
    Observable.prototype.doDispatch = function (msg) {
        // 记录流转内核
        msg.__observables.push(this);
        // 触发命令
        this.handleCommands(msg);
        // 触发用listen形式监听的消息
        this.handleMessages(msg);
    };
    /** dispatch方法实现 */
    Observable.prototype.dispatch = function (typeOrMsg) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        // 销毁判断
        if (this._disposed)
            return;
        // 统一消息对象
        var msg = typeOrMsg;
        if (typeof typeOrMsg == "string") {
            msg = new __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */](typeOrMsg);
            msg.params = params;
        }
        // 派发消息
        this.doDispatch(msg);
        // 额外派发一个通用事件
        this.doDispatch(new __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1__message_CoreMessage__["a" /* default */].MESSAGE_DISPATCHED, msg));
        // 将事件转发到上一层
        this.parent && this.parent.dispatch(msg);
    };
    /**
     * 监听内核消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @memberof Observable
     */
    Observable.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        // 销毁判断
        if (this._disposed)
            return;
        type = (typeof type == "string" ? type : type.toString());
        var listeners = this._listenerDict[type];
        if (!listeners)
            this._listenerDict[type] = listeners = [];
        // 检查存在性
        for (var i = 0, len = listeners.length; i < len; i++) {
            var temp = listeners[i];
            // 如果已经存在监听则直接返回
            if (temp.handler == handler && temp.thisArg == thisArg)
                return;
        }
        // 添加监听
        listeners.push({ handler: handler, thisArg: thisArg, once: once });
    };
    /**
     * 移除内核消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @memberof Observable
     */
    Observable.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        // 销毁判断
        if (this._disposed)
            return;
        type = (typeof type == "string" ? type : type.toString());
        var listeners = this._listenerDict[type];
        // 检查存在性
        if (listeners) {
            for (var i = 0, len = listeners.length; i < len; i++) {
                var temp = listeners[i];
                // 如果已经存在监听则直接返回
                if (temp.handler == handler && temp.thisArg == thisArg && temp.once == once) {
                    listeners.splice(i, 1);
                    break;
                }
            }
        }
    };
    Observable.prototype.handleCommands = function (msg) {
        var commands = this._commandDict[msg.__type];
        if (commands) {
            commands = commands.concat();
            for (var _i = 0, commands_1 = commands; _i < commands_1.length; _i++) {
                var cls = commands_1[_i];
                // 执行命令
                new cls(msg).exec();
            }
        }
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Observable
     */
    Observable.prototype.mapCommand = function (type, cmd) {
        // 销毁判断
        if (this._disposed)
            return;
        var commands = this._commandDict[type];
        if (!commands)
            this._commandDict[type] = commands = [];
        if (commands.indexOf(cmd) < 0)
            commands.push(cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Observable
     */
    Observable.prototype.unmapCommand = function (type, cmd) {
        // 销毁判断
        if (this._disposed)
            return;
        var commands = this._commandDict[type];
        if (!commands)
            return;
        var index = commands.indexOf(cmd);
        if (index < 0)
            return;
        commands.splice(index, 1);
    };
    Object.defineProperty(Observable.prototype, "disposed", {
        /** 是否已经被销毁 */
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    /** 销毁 */
    Observable.prototype.dispose = function () {
        // 销毁判断
        if (this._disposed)
            return;
        // 移除上一层观察者引用
        this.parent = null;
        // 清空所有消息监听
        this._listenerDict = null;
        // 清空所有命令
        this._commandDict = null;
        // 标记销毁
        this._disposed = true;
    };
    return Observable;
}());
/* harmony default export */ __webpack_exports__["a"] = (Observable);


/***/ }),
/* 30 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 消息基类
*/
var Message = /** @class */ (function () {
    function Message(type) {
        /**
         * 消息派发内核列表
         *
         * @type {IObservable}
         * @memberof Message
         */
        this.__observables = [];
        this._type = type;
    }
    Object.defineProperty(Message.prototype, "__type", {
        /**
         * 获取消息类型字符串
         *
         * @readonly
         * @type {string}
         * @memberof Message
         */
        get: function () {
            return this._type;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Message.prototype, "__observable", {
        /**
         * 消息当前所属内核
         *
         * @type {IObservable}
         * @memberof Message
         */
        get: function () {
            return this.__observables[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Message.prototype, "__oriObservable", {
        /**
         * 消息所属的原始内核（第一个派发到的内核）
         *
         * @type {IObservable}
         * @memberof Message
         */
        get: function () {
            return this.__observables[this.__observables.length - 1];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 再次发送消息，会使用首个内核重新发送该消息
     *
     * @memberof Message
     */
    Message.prototype.redispatch = function () {
        this.__oriObservable.dispatch(this);
    };
    return Message;
}());
/* harmony default export */ __webpack_exports__["a"] = (Message);


/***/ }),
/* 31 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-13
 * @modify date 2017-09-13
 *
 * 核心事件类型
*/
var CoreMessage = /** @class */ (function () {
    function CoreMessage() {
    }
    /**
     * 任何消息派发到框架后都会派发这个消息
     *
     * @static
     * @type {string}
     * @memberof CoreMessage
     */
    CoreMessage.MESSAGE_DISPATCHED = "messageDispatched";
    return CoreMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (CoreMessage);


/***/ }),
/* 32 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 33 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils__ = __webpack_require__(21);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 数据更新订阅者，当依赖的数据有更新时会触发callback通知外面
*/
var Watcher = /** @class */ (function () {
    function Watcher(bind, currentTarget, target, exp, callback, thisArg) {
        var scopes = [];
        for (var _i = 6; _i < arguments.length; _i++) {
            scopes[_i - 6] = arguments[_i];
        }
        this._disposed = false;
        // 记录Bind实例
        this._bind = bind;
        // 记录作用目标、表达式和作用域
        this._currentTarget = currentTarget;
        this._target = target;
        this._exp = exp;
        this._thisArg = thisArg;
        this._scopes = scopes;
        // 将表达式和作用域解析为一个Function
        this._expFunc = Object(__WEBPACK_IMPORTED_MODULE_0__Utils__["a" /* createEvalFunc */])(exp, 1 + scopes.length);
        // 记录回调函数
        this._callback = callback;
        // 进行首次更新
        this.update();
    }
    Object.defineProperty(Watcher.prototype, "disposed", {
        /**
         * 获取该观察者是否已经被销毁
         *
         * @readonly
         * @type {boolean}
         * @memberof Watcher
         */
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取到表达式当前最新值
     * @returns {any} 最新值
     */
    Watcher.prototype.getValue = function () {
        if (this._disposed)
            return null;
        var value;
        // 记录自身
        Watcher.updating = this;
        // 设置通用属性
        var commonScope = {
            $this: this._bind.mediator,
            $data: this._bind.mediator.viewModel,
            $bridge: this._bind.mediator.bridge,
            $currentTarget: this._currentTarget,
            $target: this._target
        };
        // 表达式求值
        try {
            value = (_a = this._expFunc).call.apply(_a, [this._thisArg].concat(this._scopes, [commonScope]));
        }
        catch (err) {
            // 输出错误日志
            console.warn("表达式求值错误\nerr: " + err.toString() + "\nexp：" + this._exp);
        }
        // 移除自身记录
        Watcher.updating = null;
        return value;
        var _a;
    };
    /**
     * 当依赖的数据有更新时调用该方法
     * @param extra 可能的额外数据
     */
    Watcher.prototype.update = function (extra) {
        if (this._disposed)
            return;
        var value = this.getValue();
        if (!Watcher.isEqual(value, this._value)) {
            this._callback && this._callback(value, this._value, extra);
            this._value = Watcher.deepCopy(value);
        }
    };
    /** 销毁订阅者 */
    Watcher.prototype.dispose = function () {
        if (this._disposed)
            return;
        this._value = null;
        this._target = null;
        this._exp = null;
        this._scopes = null;
        this._expFunc = null;
        this._callback = null;
        this._disposed = true;
    };
    /**
     * 是否相等，包括基础类型和对象/数组的对比
     */
    Watcher.isEqual = function (a, b) {
        return (a == b || (Watcher.isObject(a) && Watcher.isObject(b)
            ? JSON.stringify(a) == JSON.stringify(b)
            : false));
    };
    /**
     * 是否为对象(包括数组、正则等)
     */
    Watcher.isObject = function (obj) {
        return (obj && typeof obj == "object");
    };
    /**
     * 复制对象，若为对象则深度复制
     */
    Watcher.deepCopy = function (from) {
        if (Watcher.isObject(from)) {
            try {
                // 复杂类型对象，先字符串化，再对象化
                return JSON.parse(JSON.stringify(from));
            }
            catch (err) { }
        }
        // 基本类型对象和无法复制的对象，直接返回之
        return from;
    };
    /** 记录当前正在执行update方法的Watcher引用 */
    Watcher.updating = null;
    Watcher._uid = 0;
    return Watcher;
}());
/* harmony default export */ __webpack_exports__["a"] = (Watcher);


/***/ }),
/* 34 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return bindManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Bind__ = __webpack_require__(61);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Utils__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__net_NetManager__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_ObjectUtil__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_DisplayUtil__ = __webpack_require__(40);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 绑定管理器，可以将数据和显示对象绑定到一起，MVVM书写界面
*/
var BindManager = /** @class */ (function () {
    function BindManager() {
        this._bindDict = new __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__["a" /* default */]();
        this._regExp = /^\s*(\w+)\s+((in)|(of))\s+(.+?)\s*$/;
    }
    /**
     * 绑定数据到UI上
     *
     * @param {IMediator} mediator 中介者
     * @returns {Bind} 返回绑定实例
     * @memberof BindManager
     */
    BindManager.prototype.bind = function (mediator) {
        var bindData = this._bindDict.get(mediator);
        if (!bindData) {
            this._bindDict.set(mediator, bindData = {
                bind: new __WEBPACK_IMPORTED_MODULE_4__Bind__["a" /* default */](mediator),
                callbacks: []
            });
        }
        // 重新绑定所有
        for (var _i = 0, _a = bindData.callbacks; _i < _a.length; _i++) {
            var callback = _a[_i];
            callback();
        }
        // 返回Bind对象
        return bindData.bind;
    };
    /**
     * 移除绑定
     *
     * @param {IMediator} mediator
     * @returns {Bind}
     * @memberof BindManager
     */
    BindManager.prototype.unbind = function (mediator) {
        var bindData = this._bindDict.get(mediator);
        if (bindData) {
            bindData.bind.dispose();
            this._bindDict.delete(mediator);
        }
        return bindData && bindData.bind;
    };
    BindManager.prototype.addBindHandler = function (mediator, callback) {
        var handler = function () {
            // 判断数据是否合法
            if (!mediator.viewModel)
                return;
            // 开始绑定
            callback();
        };
        // 添加绑定数据
        var bindData = this._bindDict.get(mediator);
        if (bindData.callbacks.indexOf(handler) < 0)
            bindData.callbacks.push(handler);
        // 立即调用一次
        handler();
    };
    BindManager.prototype.getNearestAncestor = function (bridge, target, propName) {
        if (!target || target[propName])
            return target;
        else
            return this.getNearestAncestor(bridge, bridge.getParent(target), propName);
    };
    /**
     * 绑定属性值
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} name 绑定的属性名
     * @param {(EvalExp)} exp 绑定的表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindValue = function (mediator, currentTarget, target, envModels, name, exp) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定新的订阅者
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    currentTarget[name] = value;
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
            var _a;
        });
    };
    /**
     * 绑定一个表达式，与bindValue类似，但不会给属性赋值
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {(EvalExp)} exp 绑定的表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindExp = function (mediator, currentTarget, target, envModels, exp) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定新的订阅者
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    // 不干任何事情
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
            var _a;
        });
    };
    /**
     * 绑定方法执行
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} name 绑定的方法名
     * @param {...(EvalExp)[]} argExps 执行方法的参数表达式或方法列表
     * @memberof BindManager
     */
    BindManager.prototype.bindFunc = function (mediator, currentTarget, target, envModels, name) {
        var _this = this;
        var argExps = [];
        for (var _i = 5; _i < arguments.length; _i++) {
            argExps[_i - 5] = arguments[_i];
        }
        var watchers = [];
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            // 判断参数数量，无参数方法一次性执行即可，无需绑定，有参数的方法则需要每次参数改变就执行一次
            if (argExps.length > 0) {
                // 将表达式中所有undefined和null变为内部值
                var undefinedValue = Date.now() * Math.random() + "_undefined";
                var nullValue = Date.now() * Math.random() + "_null";
                argExps = argExps.map(function (exp) {
                    if (exp === undefined)
                        return "'" + undefinedValue + "'";
                    else if (exp === null)
                        return "'" + nullValue + "'";
                    else
                        return exp;
                });
                // 绑定表达式参数数组
                var initValue = {};
                var args = [];
                var argsInited = false;
                var handler = function (index, value) {
                    // 将value中的undefined和null恢复回去
                    if (value === undefinedValue)
                        value = undefined;
                    else if (value == nullValue)
                        value = null;
                    // 设置参数值
                    args[index] = value;
                    // 判断参数是否齐全
                    if (!argsInited) {
                        for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {
                            var arg = args_1[_i];
                            // 如果列表里存在初始值，表示没有赋值完毕，直接返回
                            if (arg === initValue)
                                return;
                        }
                        // 设置初始化完毕状态
                        argsInited = true;
                    }
                    // 赋值已经完毕了，调用方法，this指向ui本身
                    currentTarget[name].apply(currentTarget, args);
                };
                // 清理旧的订阅者
                for (var i = 0, len = watchers.length; i < len; i++) {
                    watchers.shift().dispose();
                }
                // 循环绑定表达式到handler
                for (var i = 0, len = argExps.length; i < len; i++) {
                    // 记录一个初始值，用于判断参数列表是否已赋值完毕
                    args.push(initValue);
                }
                for (var i = 0, len = argExps.length; i < len; i++) {
                    // 绑定表达式
                    var watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, argExps[i], handler.bind(_this, i), mediator.viewModel].concat(envModels, [mediator.viewModel]));
                    // 记录订阅者
                    watchers.push(watcher);
                }
            }
            else {
                // 无参数执行，无需绑定，一次性执行即可
                target[name]();
            }
            var _a;
        });
    };
    /**
     * 绑定事件
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} type 绑定的事件类型
     * @param {EvalExp} exp 绑定的事件回调表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindOn = function (mediator, currentTarget, target, envModels, type, exp) {
        var _this = this;
        this.addBindHandler(mediator, function () {
            var commonScope = {
                $this: mediator,
                $data: mediator.viewModel,
                $bridge: mediator.bridge,
                $currentTarget: currentTarget,
                $target: target
            };
            // 计算事件hash
            var onHash = Object(__WEBPACK_IMPORTED_MODULE_7__utils_ObjectUtil__["e" /* getObjectHashs */])(currentTarget, type, exp);
            // 如果之前添加过监听，则先移除之
            var handler = currentTarget[onHash];
            if (handler) {
                mediator.bridge.unmapListener(currentTarget, type, handler, mediator.viewModel);
                handler = null;
            }
            // 先尝试用exp当做方法名去viewModel里寻找，如果找不到则把exp当做一个执行表达式处理，外面包一层方法
            if (typeof exp === "string")
                handler = mediator.viewModel[exp];
            if (!(handler instanceof Function)) {
                var func = Object(__WEBPACK_IMPORTED_MODULE_5__Utils__["b" /* createRunFunc */])(exp, 3 + envModels.length);
                // 这里要转一手，记到闭包里一个副本，否则因为bindOn是延迟操作，到时envModel可能已被修改
                handler = function (event) {
                    func.call.apply(func, [this, commonScope].concat(envModels, [mediator.viewModel, { $event: event }]));
                };
            }
            mediator.bridge.mapListener(currentTarget, type, handler, mediator.viewModel);
            // 将事件回调记录到显示对象上
            currentTarget[onHash] = handler;
            // 如果__bind_sub_events__列表存在，则将事件记录到其上
            var nearestAncestor = _this.getNearestAncestor(mediator.bridge, target, "__bind_sub_events__");
            var events = (nearestAncestor || target).__bind_sub_events__;
            if (events) {
                events.push({
                    target: currentTarget,
                    type: type,
                    handler: handler,
                    thisArg: mediator.viewModel
                });
            }
        });
    };
    /**
     * 绑定显示
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {EvalExp} exp 绑定表达式或方法
     * @param {(value:boolean)=>void} [callback] 判断条件改变时会触发这个回调
     * @memberof BindManager
     */
    BindManager.prototype.bindIf = function (mediator, currentTarget, target, envModels, exp, callback) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        var replacer = mediator.bridge.createEmptyDisplay();
        this.addBindHandler(mediator, function () {
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定表达式
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    // 如果表达式为true则显示ui，否则移除ui
                    if (value)
                        Object(__WEBPACK_IMPORTED_MODULE_8__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, replacer, currentTarget);
                    else
                        Object(__WEBPACK_IMPORTED_MODULE_8__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, currentTarget, replacer);
                    // 触发回调
                    callback && callback(value);
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
            var _a;
        });
    };
    /**
     * 绑定循环
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} exp 循环表达式，形如："a in b"（表示a遍历b中的key）或"a of b"（表示a遍历b中的值）。b可以是个表达式
     * @param {IMediatorConstructor} [mediatorCls] 提供该参数将使用提供的中介者包装每一个渲染器
     * @param {(data:any, renderer:any, envModels:any[])=>void} [callback] 每次生成新的renderer实例时调用这个回调
     * @memberof BindManager
     */
    BindManager.prototype.bindFor = function (mediator, currentTarget, target, envModels, exp, mediatorCls, callback) {
        var _this = this;
        var watcher;
        var bindData = this._bindDict.get(mediator);
        var replacer = mediator.bridge.createEmptyDisplay();
        var subMediatorCache = [];
        this.addBindHandler(mediator, function () {
            // 解析表达式
            var res = _this._regExp.exec(exp);
            if (!res)
                return;
            // 包装渲染器创建回调
            var memento = mediator.bridge.wrapBindFor(currentTarget, function (key, value, renderer) {
                // 设置环境变量
                var commonScope = {
                    $key: key,
                    $value: value,
                    $parent: envModels[0] || mediator.viewModel
                };
                // 填入用户声明的属性
                commonScope[res[1]] = (res[2] == "in" ? key : value);
                // 生成一个环境变量的副本
                var subEnvModels = envModels.concat();
                // 插入环境变量
                subEnvModels.unshift(commonScope);
                // 如果renderer已经有事件列表了，说明renderer是被重用的，删除所有事件
                var events = renderer.__bind_sub_events__;
                for (var i in events) {
                    var data = events.pop();
                    mediator.bridge.unmapListener(data.target, data.type, data.handler, data.thisArg);
                }
                // 为renderer设置子对象事件列表
                if (!events)
                    renderer.__bind_sub_events__ = [];
                // 为renderer套一个Mediator外壳
                if (mediatorCls) {
                    var subMediator = new mediatorCls(renderer);
                    // 更新渲染器
                    if (subMediator.skin && subMediator.bridge === mediator.bridge)
                        renderer = subMediator.skin;
                    // 托管子中介者
                    mediator.delegateMediator(subMediator);
                    // 使用当前所有的数据开启该中介者
                    subMediator.open(__WEBPACK_IMPORTED_MODULE_7__utils_ObjectUtil__["b" /* extendObject */].apply(void 0, [{}].concat(subEnvModels, [value])));
                    // 缓存子中介者
                    subMediatorCache.push(subMediator);
                }
                // 触发回调，进行内部编译
                callback && callback(value, renderer, subEnvModels);
            });
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 获得要遍历的数据集合
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, res[5], function (datas) {
                    // 如果遍历的对象是个数字，则伪造一个临时数组供使用
                    if (typeof datas === "number") {
                        var tempArr = [];
                        for (var i = 0; i < datas; i++) {
                            tempArr.push(i);
                        }
                        datas = tempArr;
                    }
                    // 清空已有的子中介者
                    for (var i = 0, len = subMediatorCache.length; i < len; i++) {
                        var subMediator = subMediatorCache.shift();
                        mediator.undelegateMediator(subMediator);
                        subMediator.dispose();
                    }
                    // 赋值
                    mediator.bridge.valuateBindFor(currentTarget, datas, memento);
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
            var _a;
        });
    };
    /**
     * 绑定Message
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {IConstructor|string} type 绑定的消息类型字符串
     * @param {string} name 绑定的属性名
     * @param {EvalExp} exp 绑定的表达式或方法
     * @param {IObservable} [observable] 绑定的消息内核，默认是core
     * @memberof BindManager
     */
    BindManager.prototype.bindMessage = function (mediator, currentTarget, target, envModels, type, name, exp, observable) {
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].observable;
        var bindData = this._bindDict.get(mediator);
        var handler = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (mediator.disposed) {
                // mediator已销毁，取消监听
                observable.unlisten(type, handler);
            }
            else {
                var msg;
                if (args.length == 1 && typeof args[0] == "object" && args[0].type)
                    msg = args[0];
                else
                    msg = { $arguments: args };
                // 设置通用属性
                var commonScope = {
                    $this: mediator,
                    $data: mediator.viewModel,
                    $bridge: mediator.bridge,
                    $currentTarget: currentTarget,
                    $target: target
                };
                currentTarget[name] = __WEBPACK_IMPORTED_MODULE_5__Utils__["c" /* evalExp */].apply(void 0, [exp, mediator.viewModel, msg].concat(envModels, [mediator.viewModel, commonScope]));
            }
        };
        // 添加监听
        observable.listen(type, handler);
    };
    /**
     * 绑定Response
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {IResponseDataConstructor|string} type 绑定的通讯消息类型
     * @param {string} name 绑定的属性名
     * @param {EvalExp} exp 绑定的表达式或方法
     * @param {IObservable} [observable] 绑定的消息内核，默认是core
     * @memberof BindManager
     */
    BindManager.prototype.bindResponse = function (mediator, currentTarget, target, envModels, type, name, exp, observable) {
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].observable;
        var bindData = this._bindDict.get(mediator);
        var handler = function (response) {
            if (mediator.disposed) {
                // mediator已销毁，取消监听
                __WEBPACK_IMPORTED_MODULE_6__net_NetManager__["netManager"].unlistenResponse(type, handler, null, null, observable);
            }
            else {
                // 设置通用属性
                var commonScope = {
                    $this: mediator,
                    $data: mediator.viewModel,
                    $bridge: mediator.bridge,
                    $currentTarget: currentTarget,
                    $target: target
                };
                currentTarget[name] = __WEBPACK_IMPORTED_MODULE_5__Utils__["c" /* evalExp */].apply(void 0, [exp, mediator.viewModel, response].concat(envModels, [mediator.viewModel, commonScope]));
            }
        };
        // 添加监听
        __WEBPACK_IMPORTED_MODULE_6__net_NetManager__["netManager"].listenResponse(type, handler, null, null, observable);
        // 如果mediator所依赖的模块有初始化消息，则要额外触发初始化消息的绑定
        if (mediator["dependModuleInstance"]) {
            for (var _i = 0, _a = mediator["dependModuleInstance"].responses; _i < _a.length; _i++) {
                var response = _a[_i];
                handler(response);
            }
        }
    };
    BindManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__["Injectable"]
    ], BindManager);
    return BindManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (BindManager);
/** 再额外导出一个单例 */
var bindManager = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(BindManager);


/***/ }),
/* 35 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "commonData", function() { return commonData; });
var RequestData = /** @class */ (function () {
    function RequestData() {
        /**
         * 用户参数，可以保存任意参数到Message中，该参数中的数据不会被发送
         *
         * @type {*}
         * @memberof RequestData
         */
        this.__userData = {};
        /**
         * 是否在接到返回前使用loading类型遮罩覆盖全屏，防止用户操作，默认是true
         *
         * @type {boolean}
         * @memberof RequestData
         */
        this.__useMask = true;
        /**
         * 消息派发内核列表
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        this.__observables = [];
        // 禁掉部分本地变量的可遍历性
        Object.defineProperties(this, {
            __userData: {
                configurable: true,
                enumerable: false,
                writable: true,
                value: this.__userData
            },
            __observables: {
                configurable: true,
                enumerable: false,
                writable: true,
                value: this.__observables
            }
        });
    }
    Object.defineProperty(RequestData.prototype, "__observable", {
        /**
         * 消息当前所属内核
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        get: function () {
            return this.__observables[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RequestData.prototype, "__oriObservable", {
        /**
         * 消息所属的原始内核（第一个派发到的内核）
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        get: function () {
            return this.__observables[this.__observables.length - 1];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RequestData.prototype, "__type", {
        /**
         * 获取请求消息类型字符串
         *
         * @readonly
         * @type {string}
         * @memberof RequestData
         */
        get: function () {
            return this.__params.type;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 再次发送消息，会使用首个内核重新发送该消息
     *
     * @memberof RequestData
     */
    RequestData.prototype.redispatch = function () {
        this.__oriObservable.dispatch(this);
    };
    return RequestData;
}());
/* harmony default export */ __webpack_exports__["default"] = (RequestData);
/** 导出公共消息参数对象 */
var commonData = {};


/***/ }),
/* 36 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 表现层消息
*/
var BridgeMessage = /** @class */ (function () {
    function BridgeMessage() {
    }
    /**
     * 初始化表现层实例前的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_BEFORE_INIT = "bridgeBeforeInit";
    /**
     * 初始化表现层实例后的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_AFTER_INIT = "bridgeAfterInit";
    /**
     * 所有表现层实例都初始化完毕的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_ALL_INIT = "bridgeAllInit";
    return BridgeMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (BridgeMessage);


/***/ }),
/* 37 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return sceneManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__SceneMessage__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__ = __webpack_require__(67);






/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 弹窗管理器，包含切换场景、push场景、pop场景功能
*/
var SYNC_NAME = "SceneManager_sync";
var ChangeType;
(function (ChangeType) {
    ChangeType[ChangeType["Switch"] = 0] = "Switch";
    ChangeType[ChangeType["Push"] = 1] = "Push";
    ChangeType[ChangeType["Pop"] = 2] = "Pop";
})(ChangeType || (ChangeType = {}));
var SceneManager = /** @class */ (function () {
    function SceneManager() {
        this._sceneStack = [];
    }
    Object.defineProperty(SceneManager.prototype, "currentScene", {
        /**
         * 获取当前场景
         *
         * @readonly
         * @type {IScene}
         * @memberof SceneManager
         */
        get: function () {
            return this._sceneStack[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SceneManager.prototype, "activeCount", {
        /**
         * 获取活动场景个数
         *
         * @readonly
         * @type {number}
         * @memberof SceneManager
         */
        get: function () {
            return this._sceneStack.length;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取场景是否已经开启
     *
     * @param {IScene} scene 场景对象
     * @returns {boolean} 是否已经开启
     * @memberof SceneManager
     */
    SceneManager.prototype.isOpened = function (scene) {
        return (this._sceneStack.indexOf(scene) >= 0);
    };
    /**
     * 切换场景，替换当前场景，当前场景会被销毁
     *
     * @param {IScene} scene 要切换到的场景
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.switch = function (scene, data) {
        var _this = this;
        // 非空判断
        if (scene == null)
            return;
        // 如果切入的是第一个场景，则改用push操作
        if (this.activeCount == 0)
            return this.push(scene, data);
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */], ChangeType.Switch, function () {
            var lastScene = _this._sceneStack[0];
            // 数据先行
            _this._sceneStack[0] = scene;
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
            // 销毁
            lastScene && lastScene.dispose();
        });
        return scene;
    };
    /**
     * 推入场景，当前场景不会销毁，而是进入场景栈保存，以后可以通过popScene重新展现
     *
     * @param {IScene} scene 要推入的场景
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.push = function (scene, data) {
        var _this = this;
        // 非空判断
        if (scene == null)
            return scene;
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */], ChangeType.Push, function () {
            // 数据先行
            _this._sceneStack.unshift(scene);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
        });
        return scene;
    };
    /**
     * 弹出场景，当前场景会被销毁，当前位于栈顶的场景会重新显示
     *
     * @param {IScene} scene 要切换出的场景，如果传入的场景不是当前场景则仅移除指定场景，不会进行切换操作
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.pop = function (scene, data) {
        // 非空判断
        if (scene == null)
            return scene;
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doPop, this, scene, data);
        return scene;
    };
    SceneManager.prototype.doPop = function (scene, data) {
        var _this = this;
        // 如果没有足够的场景储备则什么都不做
        if (this.activeCount <= 1) {
            console.log("场景栈中的场景数量不足，无法执行pop操作");
            // 完成步骤
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__["a" /* notify */])(SYNC_NAME);
            return;
        }
        // 验证是否是当前场景，不是则直接移除，不使用Policy
        var to = this._sceneStack[1];
        var policy = scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */];
        if (this._sceneStack.indexOf(scene) != 0) {
            to = null;
            policy = __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */];
        }
        // 执行切换
        this.doChange(scene, to, data, policy, ChangeType.Pop, function () {
            // 数据先行
            _this._sceneStack.splice(_this._sceneStack.indexOf(scene), 1);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
        }, function () {
            // 销毁
            scene.dispose();
        });
    };
    SceneManager.prototype.doChange = function (from, to, data, policy, type, begin, complete) {
        // 如果from和to有一个为null则policy为none
        if (!from || !to)
            policy = __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */];
        // to指定的场景必须要显示
        if (to)
            to.bridge.htmlWrapper.style.display = "";
        // 如果要交替的两个场景不是同一个类型的场景，则切换HTMLWrapper显示，且Policy也采用无切换策略
        if (from && to && to.bridge.type != from.bridge.type) {
            from.bridge.htmlWrapper.style.display = "none";
            policy = __WEBPACK_IMPORTED_MODULE_3__NoneScenePolicy__["a" /* default */];
        }
        // 调用回调
        begin && begin();
        // 获取接口引用
        var prepareFunc;
        var doFunc;
        switch (type) {
            case ChangeType.Switch:
                prepareFunc = policy.prepareSwitch;
                doFunc = policy.switch;
                break;
            case ChangeType.Push:
                prepareFunc = policy.preparePush || policy.prepareSwitch;
                doFunc = policy.push || policy.switch;
                break;
            case ChangeType.Pop:
                prepareFunc = policy.preparePop || policy.prepareSwitch;
                doFunc = policy.pop || policy.switch;
                break;
        }
        // 前置处理
        to && from && from.onBeforeOut(to, data);
        to && to.onBeforeIn(from, data);
        // 派发事件
        to && __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__SceneMessage__["a" /* default */].SCENE_BEFORE_CHANGE, to, from);
        // 调用准备接口
        prepareFunc && prepareFunc.call(policy, from, to);
        // 添加显示
        to && to.bridge.addChild(to.bridge.sceneLayer, to.skin);
        // 调用切换接口
        doFunc.call(policy, from, to, function () {
            // 移除显示
            to && from && from.bridge.removeChild(from.bridge.sceneLayer, from.skin);
            // 后置处理
            to && from && from.onAfterOut(to, data);
            to && to.onAfterIn(from, data);
            // 派发事件
            to && __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__SceneMessage__["a" /* default */].SCENE_AFTER_CHANGE, to, from);
            // 调用回调
            complete && complete();
            // 完成步骤
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_SyncUtil__["a" /* notify */])(SYNC_NAME);
        });
    };
    SceneManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], SceneManager);
    return SceneManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (SceneManager);
/** 再额外导出一个单例 */
var sceneManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(SceneManager);


/***/ }),
/* 38 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 场景相关的消息
*/
var SceneMessage = /** @class */ (function () {
    function SceneMessage() {
    }
    /**
     * 切换场景前的消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_BEFORE_CHANGE = "sceneBeforeChange";
    /**
     * 切换场景后的消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_AFTER_CHANGE = "sceneAfterChange";
    /**
     * 场景栈数据变化消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_STACK_CHANGE = "sceneStackChange";
    return SceneMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (SceneMessage);


/***/ }),
/* 39 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ModuleOpenStatus; });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-01-30
 * @modify date 2018-01-30
 *
 * 该接口规定了中介者具有的模块部分功能
*/
var ModuleOpenStatus;
(function (ModuleOpenStatus) {
    ModuleOpenStatus[ModuleOpenStatus["Stop"] = 0] = "Stop";
    ModuleOpenStatus[ModuleOpenStatus["BeforeOpen"] = 1] = "BeforeOpen";
    ModuleOpenStatus[ModuleOpenStatus["AfterOpen"] = 2] = "AfterOpen";
})(ModuleOpenStatus || (ModuleOpenStatus = {}));


/***/ }),
/* 40 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = replaceDisplay;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-03-22
 * @modify date 2018-03-22
 *
 * 显示工具
*/
/**
 * 替换显示
 *
 * @export
 * @param {IBridge} bridge 要使用的桥
 * @param {*} current 被替换的显示
 * @param {*} target 替换成为的显示
 */
function replaceDisplay(bridge, current, target) {
    // 两个皮肤必须都是隶属桥的皮肤
    if (bridge.isMySkin(target) && bridge.isMySkin(current)) {
        var parent = bridge.getParent(current);
        if (parent) {
            var index = bridge.getChildIndex(parent, current);
            bridge.addChildAt(parent, target, index);
            bridge.removeChild(parent, current);
        }
    }
}


/***/ }),
/* 41 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = load;
/* unused harmony export toFormParams */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__URLUtil__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__ObjectUtil__ = __webpack_require__(3);



/**
 * 发送一个或多个HTTP请求
 *
 * @export
 * @param {IHTTPRequestParams} params 请求参数
 */
function load(params) {
    // 非空判断
    if (!params.url) {
        // 成功回调
        params.onResponse && params.onResponse();
        return;
    }
    // 数组判断
    if (params.url instanceof Array) {
        // 一次请求多个地址，需要做一个队列加载，然后一次性回调
        var urls = params.url;
        var results = [];
        var newParams = Object(__WEBPACK_IMPORTED_MODULE_2__ObjectUtil__["a" /* cloneObject */])(params);
        newParams.onResponse = function (result) {
            results.push(result);
            loadNext();
        };
        var loadNext = function () {
            if (urls.length <= 0) {
                // 成功回调
                params.onResponse && params.onResponse(results);
                return;
            }
            newParams.url = urls.shift();
            load(newParams);
        };
        loadNext();
        return;
    }
    // 一次请求一个地址
    var retryTimes = params.retryTimes || 2;
    var timeout = params.timeout || 10000;
    var method = params.method || "GET";
    var timeoutId = 0;
    var data = params.data || {};
    // 取到url
    var url = params.url;
    if (params.useCDN) {
        // 如果使用CDN则改用cdn域名
        url = __WEBPACK_IMPORTED_MODULE_0__engine_env_Environment__["environment"].toCDNHostURL(url);
    }
    else {
        // 合法化protocol
        url = Object(__WEBPACK_IMPORTED_MODULE_1__URLUtil__["e" /* validateProtocol */])(url, params.forceHTTPS ? "https:" : null);
        // 规整一下url
        url = Object(__WEBPACK_IMPORTED_MODULE_1__URLUtil__["d" /* trimURL */])(url);
    }
    // 生成xhr
    var xhr = (window["XDomainRequest"] && navigator.userAgent.indexOf("MSIE 10.") < 0 ? new window["XDomainRequest"]() : window["XMLHttpRequest"] ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"));
    // 发送
    send();
    function send() {
        var sendData = null;
        // 根据发送方式组织数据格式
        switch (method) {
            case "POST":
                switch (params.headerDict && params.headerDict["Content-Type"]) {
                    case "application/x-www-form-urlencoded":
                        sendData = toFormParams(data);
                        break;
                    default:
                        sendData = JSON.stringify(data);
                        break;
                }
                break;
            case "GET":
                // 将数据添加到url上
                url = Object(__WEBPACK_IMPORTED_MODULE_1__URLUtil__["c" /* joinQueryParams */])(url, data);
                break;
            default:
                throw new Error("暂不支持的HTTP Method：" + method);
        }
        // 打开XHR
        xhr.open(method, url, true);
        // 初始化，responseType必须在open之后设置，否则IE10和IE11会报错
        if (params.responseType)
            xhr.responseType = params.responseType;
        // 如果需要withCredentials，则设置之
        if (params.withCredentials)
            xhr.withCredentials = true;
        xhr.onload = onLoad;
        xhr.onerror = onError;
        // 添加自定义请求头，如果可以的话
        if (xhr.setRequestHeader) {
            for (var key in params.headerDict) {
                xhr.setRequestHeader(key, params.headerDict[key]);
            }
        }
        // 开始发送
        xhr.send(sendData);
        // 开始计时
        timeoutId = window.setTimeout(abortAndRetry, timeout);
    }
    function onLoad(evt) {
        // 即使是onLoad也要判断下状态码，但如果没有状态码，比如说XDomainRequest就直接认为成功了
        var statusHead = xhr.status ? Math.floor(xhr.status * 0.01) : 2;
        switch (statusHead) {
            case 2:
            case 3:
                // 2xx和3xx的状态码认为是成功
                timeoutId && clearTimeout(timeoutId);
                timeoutId = 0;
                // 成功回调
                params.onResponse && params.onResponse(xhr.response || xhr.responseText);
                break;
            case 4:
            case 5:
                // 4xx和5xx的状态码认为是错误，转调错误回调
                onError();
                break;
        }
    }
    function onError() {
        // 停止计时
        timeoutId && clearTimeout(timeoutId);
        timeoutId = 0;
        // 失败重试
        if (retryTimes > 0) {
            // 没有超过重试上限则重试
            abortAndRetry();
        }
        else {
            // 出错，如果使用CDN功能则尝试切换
            if (params.useCDN && !__WEBPACK_IMPORTED_MODULE_0__engine_env_Environment__["environment"].nextCDN()) {
                // 还没切换完，重新加载
                load(params);
            }
            else {
                // 切换完了还失败，则汇报错误
                var err = new Error(xhr.status ? xhr.status + " " + xhr.statusText : "请求错误，且无法获取错误信息");
                params.onError && params.onError(err);
            }
        }
    }
    function abortAndRetry() {
        // 重试次数递减
        retryTimes--;
        // 中止xhr
        xhr.abort();
        // 添加时间戳作为随机版本号
        url = Object(__WEBPACK_IMPORTED_MODULE_1__URLUtil__["c" /* joinQueryParams */])(url, { _r: Date.now() });
        // 重新发送
        send();
    }
}
/**
 * 将数据转换为form形式
 *
 * @export
 * @param {*} data 要转换的数据
 * @returns {string} 转换结果字符串
 */
function toFormParams(data) {
    var keys = Object.keys(data);
    var params = keys.map(function (key) {
        return encodeURIComponent(key) + "=" + encodeURIComponent(data[key]);
    });
    return params.join("&");
}


/***/ }),
/* 42 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export shuffle */
/* unused harmony export randomize */
/* unused harmony export randomizeWeight */
/* harmony export (immutable) */ __webpack_exports__["a"] = unique;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Dictionary__ = __webpack_require__(4);

/**
 * 简单数组乱序
 *
 * @export
 * @template T
 * @param {T} a
 * @returns {T}
 */
function shuffle(a) {
    var len = a.length;
    for (var i = 1; i < len; i++) {
        var end = len - i;
        var index = (Math.random() * (end + 1)) >> 0;
        var t = a[end];
        a[end] = a[index];
        a[index] = t;
    }
    return a;
}
/**
 * 从数组指定范围内随机取出指定数量的不重复元素
 * ArrayUtils.randomize([0,1,2,3,4,5,6,7,8,9], 3, 2, 7);
 * //返回[6,2,3]
 *
 * @param arr 		原始数组
 * @param count	    数量，默认为范围内全部元素
 * @param begin 	起始位置，默认为0
 * @param end		结束位置，默认为数组长度
 */
function randomize(arr, count, begin, end) {
    if (!arr || begin < 0)
        throw new Error("invalid argument");
    arr = arr.concat();
    var len = arr.length;
    end = end >> 0;
    if (!(end >= 0 && end <= len)) {
        end = len;
    }
    begin = begin >> 0;
    if (!(begin > 0)) {
        begin = 0;
    }
    count = count >> 0;
    if (!(count >= 0 && count < end - begin)) {
        count = end - begin;
    }
    var arr2 = [];
    var end2 = begin + count;
    for (var i = begin; i < end2; i++) {
        var index = (Math.random() * (end - i) + i) >> 0;
        arr2[i - begin] = arr[index];
        arr[index] = arr[i];
    }
    return arr2;
}
/**
 * 进行权重随机
 *
 * @export
 * @template T
 * @param {T[]} arr 原始数组
 * @param {number[]} weight 权重数组，应保证权重数组的元素数量不小于原始数组的元素数量
 * @returns {T} 选取的结果
 */
function randomizeWeight(arr, weight) {
    if (!arr || !weight)
        throw new Error("invalid argument");
    if (weight.length < arr.length)
        throw new Error("权重数组的元素数量不应小于原始数组的元素数量");
    // 根据权重数组建立一个区间数组
    var regions = [];
    var sum = 0;
    for (var i in arr) {
        sum += weight[i];
        regions.push(sum);
    }
    // 随机一个位置
    var ran = Math.random() * sum;
    // 搜索该位置所属区间索引
    var index;
    for (var i = 0, len = regions.length; i < len; i++) {
        if (ran < regions[i]) {
            index = i;
            break;
        }
    }
    // 返回索引处的原始数组元素
    return arr[index];
}
/**
 * 数组去重，不会修改原数组
 *
 * @export
 * @param {any[]} list
 * @returns {any[]}
 */
function unique(list) {
    if (!list)
        return list;
    // 初始化
    var hash = new __WEBPACK_IMPORTED_MODULE_0__Dictionary__["a" /* default */](), result = [];
    // 遍历当前数组
    for (var i = 0, len = list.length; i < len; i++) {
        // 如果hash表中没有当前项
        if (!hash.get(list[i])) {
            // 存入hash表
            hash.set(list[i], true);
            // 把当前数组的当前项push到临时数组里面
            result.push(list[i]);
        }
    }
    return result;
}


/***/ }),
/* 43 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__DataType__ = __webpack_require__(44);


var ResponseData = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](ResponseData, _super);
    function ResponseData() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ResponseData;
}(__WEBPACK_IMPORTED_MODULE_1__DataType__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (ResponseData);


/***/ }),
/* 44 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 请求或返回数据结构体
*/
var DataType = /** @class */ (function () {
    function DataType() {
    }
    /**
     * 解析后端返回的JSON对象，生成结构体
     *
     * @param {any} data 后端返回的JSON对象
     * @returns {DataType} 结构体对象
     * @memberof DataType
     */
    DataType.prototype.parse = function (data) {
        this.__rawData = this.doParse(data);
        return this;
    };
    return DataType;
}());
/* harmony default export */ __webpack_exports__["default"] = (DataType);


/***/ }),
/* 45 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["pushCompileCommand"] = pushCompileCommand;
/* harmony export (immutable) */ __webpack_exports__["unshiftCompileCommand"] = unshiftCompileCommand;
/* harmony export (immutable) */ __webpack_exports__["compile"] = compile;
/* harmony export (immutable) */ __webpack_exports__["compileValue"] = compileValue;
/* harmony export (immutable) */ __webpack_exports__["compileExp"] = compileExp;
/* harmony export (immutable) */ __webpack_exports__["compileFunc"] = compileFunc;
/* harmony export (immutable) */ __webpack_exports__["compileOn"] = compileOn;
/* harmony export (immutable) */ __webpack_exports__["compileIf"] = compileIf;
/* harmony export (immutable) */ __webpack_exports__["compileFor"] = compileFor;
/* harmony export (immutable) */ __webpack_exports__["compileMessage"] = compileMessage;
/* harmony export (immutable) */ __webpack_exports__["compileResponse"] = compileResponse;
/* harmony export (immutable) */ __webpack_exports__["searchUI"] = searchUI;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__ = __webpack_require__(34);

function getBindParams(currentTarget) {
    var bindParams = currentTarget.__bind_commands__;
    if (!bindParams) {
        bindParams = [];
        Object.defineProperty(currentTarget, "__bind_commands__", {
            configurable: true,
            enumerable: false,
            writable: true,
            value: bindParams
        });
    }
    return bindParams;
}
/**
 * 添加编译命令到显示对象上（正向）
 *
 * @export
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {*} target 编译命令本来所在的对象
 * @param {IBindCommand} cmd 命令函数
 * @param {...any[]} args 命令参数列表
 */
function pushCompileCommand(currentTarget, target, cmd) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    // 添加编译指令
    getBindParams(currentTarget).push({ cmd: cmd, target: target, args: args });
}
/**
 * 添加编译命令到显示对象上（反向）
 *
 * @export
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {*} target 编译命令本来所在的对象
 * @param {IBindCommand} cmd 命令函数
 * @param {...any[]} args 命令参数列表
 */
function unshiftCompileCommand(currentTarget, target, cmd) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    getBindParams(currentTarget).unshift({ cmd: cmd, target: target, args: args });
}
/**
 * 编译显示对象，会先编译自身，然后再递归编译子对象
 *
 * @export
 * @param {IMediator} mediator 显示对象所属的中介者
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {any[]} [envModels] 环境变量数组
 */
function compile(mediator, currentTarget, envModels) {
    // 取到编译参数列表
    var bindParams = currentTarget.__bind_commands__;
    // 编译currentTarget自身
    if (bindParams) {
        // 这里没有提前读取出length属性，因为需要动态判断数组长度
        for (var i = 0; i < bindParams.length;) {
            // 使用shift按顺序取出编译命令
            var params = bindParams.shift();
            // 调用编译命令，并且更新中止状态
            params.cmd.apply(params, [mediator, currentTarget, params.target, envModels || []].concat(params.args));
        }
    }
}
/**
 * 编译bindValue命令，不会中止编译
 */
function compileValue(mediator, currentTarget, target, envModels, name, exp) {
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindValue(mediator, currentTarget, target, envModels, name, exp);
}
/**
 * 编译bindExp命令，不会中止编译
 */
function compileExp(mediator, currentTarget, target, envModels, exp) {
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindExp(mediator, currentTarget, target, envModels, exp);
}
/**
 * 编译bindFunc命令，不会中止编译
 */
function compileFunc(mediator, currentTarget, target, envModels, name) {
    var argExps = [];
    for (var _i = 5; _i < arguments.length; _i++) {
        argExps[_i - 5] = arguments[_i];
    }
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindFunc.apply(__WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */], [mediator, currentTarget, target, envModels, name].concat(argExps));
}
/**
 * 编译bindOn命令，不会中止编译
 */
function compileOn(mediator, currentTarget, target, envModels, type, exp) {
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindOn(mediator, currentTarget, target, envModels, type, exp);
}
function isPosterity(mediator, target, parent) {
    var tempParent = mediator.bridge.getParent(target);
    if (!tempParent)
        return false;
    else if (tempParent === parent)
        return true;
    else
        return isPosterity(mediator, tempParent, parent);
}
function getAllSubTargets(mediator, target) {
    var bindTargets = mediator.bindTargets;
    var subTargets = [];
    for (var _i = 0, bindTargets_1 = bindTargets; _i < bindTargets_1.length; _i++) {
        var bindTarget = bindTargets_1[_i];
        bindTarget && bindTarget.forEach(function (tempTarget) {
            if (isPosterity(mediator, tempTarget, target))
                subTargets.push(tempTarget);
        });
    }
    return subTargets;
}
/**
 * 编译bindIf命令，会中止编译，直到判断条件为true时才会启动以继续编译
 */
function compileIf(mediator, currentTarget, target, envModels, exp) {
    // 将后面的编译命令缓存起来
    var bindParams = currentTarget.__bind_commands__;
    var caches = [{ target: currentTarget, params: bindParams.splice(0, bindParams.length) }];
    // 后代节点的也要缓存住
    var subTargets = getAllSubTargets(mediator, currentTarget);
    for (var _i = 0, subTargets_1 = subTargets; _i < subTargets_1.length; _i++) {
        var subTarget = subTargets_1[_i];
        var subBindParams = subTarget.__bind_commands__;
        caches.push({ target: subTarget, params: subBindParams.splice(0, subBindParams.length) });
    }
    // 绑定if命令
    var terminated = false;
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindIf(mediator, currentTarget, target, envModels, exp, function (value) {
        // 如果条件为true，则启动继续编译，但只编译一次，编译过就不需要再编译了
        if (!terminated && value) {
            // 恢复后面的命令
            for (var _i = 0, caches_1 = caches; _i < caches_1.length; _i++) {
                var cache = caches_1[_i];
                cache.target.__bind_commands__ = cache.params;
                // 继续编译
                compile(mediator, cache.target, envModels);
            }
            // 设置已终结标识
            terminated = true;
        }
    });
}
/**
 * 编译bindFor命令，会中止编译，直到生成新的renderer实例时才会继续编译新实例
 */
function compileFor(mediator, currentTarget, target, envModels, exp, mediatorCls) {
    // 将后面的编译命令缓存起来
    var leftHandlers = target.__stop_left_handlers__;
    // 绑定for命令
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindFor(mediator, currentTarget, target, envModels, exp, mediatorCls, function (data, renderer, subEnvModels) {
        var subLeftHandlers = leftHandlers.concat();
        var bindTargets = [];
        // 针对每一个renderer赋值后续编译指令
        for (var _i = 0, subLeftHandlers_1 = subLeftHandlers; _i < subLeftHandlers_1.length; _i++) {
            var leftHandler = subLeftHandlers_1[_i];
            leftHandler(renderer, bindTargets, subLeftHandlers);
        }
        // 编译renderer实例
        for (var depth in bindTargets) {
            var dict = bindTargets[depth];
            dict.forEach(function (currentTarget) { return compile(mediator, currentTarget, subEnvModels); });
        }
    });
}
/**
 * 编译bindMessage命令，不会中止编译
 */
function compileMessage(mediator, currentTarget, target, envModels, type, name, exp, observable) {
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindMessage(mediator, currentTarget, target, envModels, type, name, exp, observable);
}
/**
 * 编译bindResponse命令，不会中止编译
 */
function compileResponse(mediator, currentTarget, target, envModels, type, name, exp, observable) {
    __WEBPACK_IMPORTED_MODULE_0__bind_BindManager__["a" /* bindManager */].bindResponse(mediator, currentTarget, target, envModels, type, name, exp, observable);
}
/**
 * 搜索UI，取到目标节点，执行回调
 *
 * @export
 * @param {*} values 值结构字典
 * @param {*} ui ui实体
 * @param {(ui:any, key:string, value:any, depth?:number)=>void} callback 回调
 * @param {number} [depth=0] 遍历深度，方法会继续增加这个深度
 */
function searchUI(values, ui, callback, depth) {
    if (depth === void 0) { depth = 0; }
    for (var key in values) {
        var value = values[key];
        var index = key.indexOf(".");
        if (index >= 0) {
            // 是表达式寻址，递归寻址
            var newValue = {};
            newValue[key.substr(index + 1)] = value;
            searchUI(newValue, ui[key.substring(0, index)], callback, depth + 1);
        }
        else if (typeof value == "object" && !(value instanceof Array)) {
            // 是子对象寻址，递归寻址
            searchUI(value, ui[key], callback, depth + 1);
        }
        else {
            // 是表达式，调用回调，将调用层级也传递回去
            callback(ui, key, value, depth);
        }
    }
}


/***/ }),
/* 46 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AudioMessage__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__env_Environment__ = __webpack_require__(5);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 使用Audio标签实现IAudio接口的实现类
*/
var AudioTagImpl = /** @class */ (function () {
    function AudioTagImpl() {
        this._mute = false;
        this._playingDict = {};
        this._audioCache = {};
    }
    Object.defineProperty(AudioTagImpl.prototype, "mute", {
        /**
         * 静音状态
         *
         * @type {boolean}
         * @memberof AudioTagImpl
         */
        get: function () {
            return this._mute;
        },
        set: function (value) {
            this._mute = value;
            // 静音，暂停所有声音
            for (var url in this._playingDict) {
                if (value) {
                    // 静音，停止音频，不可调用stop方法，因为要保持播放中的音频状态
                    this._doStop(url);
                }
                else {
                    // 非静音，播放音频
                    var params = this._playingDict[url];
                    this.play(params);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载音频
     *
     * @param {string} url 音频地址
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.load = function (url) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        // 如果没有缓存才去加载
        if (!data) {
            // 使用Audio标签加载
            var node = document.createElement("audio");
            // 这里强制使用autoplay，因为在IOS的safari上如果没这个参数，则根本不会触发onloadeddata事件
            node.autoplay = true;
            node.src = toUrl;
            // 保存数据
            this._audioCache[toUrl] = data = { node: node, status: AudioStatus.LOADING, playParams: null };
            // 监听加载
            node.onloadeddata = function () {
                // 记录加载完毕
                data.status = AudioStatus.PAUSED;
                // 如果不自动播放则暂停
                if (!data.playParams)
                    node.pause();
            };
            node.onended = function () {
                // 派发播放完毕事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1__AudioMessage__["a" /* default */].AUDIO_PLAY_ENDED, url);
            };
        }
    };
    /**
     * 播放音频，如果音频没有加载则先加载再播放
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @returns {void}
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.play = function (params) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(params.url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        if (!data) {
            // 没有加载过，开始加载音频
            this.load(params.url);
            // 设置播放参数
            this._audioCache[toUrl].playParams = params;
        }
        else {
            switch (data.status) {
                case AudioStatus.LOADING:
                    // 正在加载中，替换自动播放参数
                    data.playParams = params;
                    break;
                case AudioStatus.PLAYING:
                    // 正在播放，关闭后再播放
                    this.stop(params.url);
                    this.play(params);
                    break;
                case AudioStatus.PAUSED:
                    // 已经加载完毕，暂停中，直接播放
                    if (params.stopOthers)
                        this.stopAll();
                    if (params.loop != null)
                        data.node.loop = params.loop;
                    if (params.time != null)
                        data.node.currentTime = params.time * 0.001;
                    // 监听播放进度
                    data.node.ontimeupdate = function (evt) {
                        // 只有播放状态可以派发PROGRESS事件
                        if (data.status == AudioStatus.PLAYING) {
                            // 我们规定使用毫秒值作为单位
                            var curTime = data.node.currentTime * 1000;
                            var totalTime = data.node.duration * 1000;
                            // 派发播放进度事件
                            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1__AudioMessage__["a" /* default */].AUDIO_PLAY_PROGRESS, params.url, curTime, totalTime);
                        }
                    };
                    // 开始播放，safari不支持直接play(WTF?)所以要用autoplay加load进行播放
                    data.node.autoplay = true;
                    data.node.load();
                    // 设置状态
                    data.status = AudioStatus.PLAYING;
                    // 记录播放中
                    this._playingDict[toUrl] = params;
                    // 派发播放开始事件
                    __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1__AudioMessage__["a" /* default */].AUDIO_PLAY_STARTED, params.url);
                    break;
            }
        }
    };
    AudioTagImpl.prototype._doStop = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            data.node.autoplay = false;
            data.node.pause();
            // 设置停止时间
            if (time != null)
                data.node.currentTime = time * 0.001;
            // 设置状态
            data.status = AudioStatus.PAUSED;
            // 派发播放停止事件
            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1__AudioMessage__["a" /* default */].AUDIO_PLAY_STOPPED, url);
        }
    };
    /**
     * 暂停音频（不会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.pause = function (url) {
        this._doStop(url);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止音频（会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.stop = function (url) {
        this._doStop(url, 0);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止所有音频
     *
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.stopAll = function () {
        for (var url in this._audioCache) {
            this.stop(url);
        }
    };
    /**
     * 跳转音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.seek = function (url, time) {
        var data = this._audioCache[url];
        if (data)
            data.node.currentTime = time * 0.001;
    };
    return AudioTagImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioTagImpl);
var AudioStatus;
(function (AudioStatus) {
    /**
     * 加载中
     */
    AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
    /**
     * 已暂停
     */
    AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
    /**
     * 播放中
     */
    AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
})(AudioStatus || (AudioStatus = {}));


/***/ }),
/* 47 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 音频消息
*/
var AudioMessage = /** @class */ (function () {
    function AudioMessage() {
    }
    /**
     * 音频播放开始事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_STARTED = "audioPlayStarted";
    /**
     * 音频播放停止事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_STOPPED = "audioPlayStopped";
    /**
     * 音频播放完毕事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_ENDED = "audioPlayEnded";
    /**
     * 音频播放进度事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_PROGRESS = "audioPlayProgress";
    return AudioMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioMessage);


/***/ }),
/* 48 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-01-08
 * @modify date 2018-01-08
 *
 * 引擎消息类型
*/
var EngineMessage = /** @class */ (function () {
    function EngineMessage() {
    }
    /**
     * 引擎初始化完毕消息
     *
     * @static
     * @type {string}
     * @memberof EngineMessage
     */
    EngineMessage.INITIALIZED = "initialized";
    return EngineMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (EngineMessage);


/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(50), __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Hash_1, Injector_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var IFuckModel = /** @class */ (function () {
        function IFuckModel() {
        }
        Object.defineProperty(IFuckModel.prototype, "fuck", {
            get: function () {
                return null;
            },
            enumerable: true,
            configurable: true
        });
        return IFuckModel;
    }());
    exports.IFuckModel = IFuckModel;
    var FuckModel = /** @class */ (function () {
        function FuckModel() {
            this._fuck = "Fuck";
            this.shit = "Shit";
            console.log("Fuck Model Constructed!");
        }
        Object.defineProperty(FuckModel.prototype, "fuck", {
            get: function () {
                return this._fuck;
            },
            set: function (value) {
                this._fuck = value;
            },
            enumerable: true,
            configurable: true
        });
        FuckModel.prototype.fuckYou = function () {
            return "Oye!";
        };
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", Hash_1.default)
        ], FuckModel.prototype, "hash", void 0);
        FuckModel = __decorate([
            Injector_2.ModelClass(1, IFuckModel),
            __metadata("design:paramtypes", [])
        ], FuckModel);
        return FuckModel;
    }());
    exports.default = FuckModel;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRnVja01vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRnVja01vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztJQUlBO1FBQUE7UUFNQSxDQUFDO1FBSkcsc0JBQVcsNEJBQUk7aUJBQWY7Z0JBRUksTUFBTSxDQUFDLElBQUksQ0FBQztZQUNoQixDQUFDOzs7V0FBQTtRQUNMLGlCQUFDO0lBQUQsQ0FBQyxBQU5ELElBTUM7SUFOWSxnQ0FBVTtJQVN2QjtRQWlCSTtZQVpRLFVBQUssR0FBVSxNQUFNLENBQUM7WUFVdkIsU0FBSSxHQUFVLE1BQU0sQ0FBQztZQUl4QixPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7UUFDM0MsQ0FBQztRQWRELHNCQUFXLDJCQUFJO2lCQUFmO2dCQUVJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBQ3RCLENBQUM7aUJBQ0QsVUFBZ0IsS0FBWTtnQkFFeEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7WUFDdkIsQ0FBQzs7O1dBSkE7UUFhTSwyQkFBTyxHQUFkO1lBRUksTUFBTSxDQUFDLE1BQU0sQ0FBQztRQUNsQixDQUFDO1FBdEJEO1lBREMsaUJBQU07c0NBQ00sY0FBSTsrQ0FBQztRQUhELFNBQVM7WUFEN0IscUJBQVUsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDOztXQUNMLFNBQVMsQ0EwQjdCO1FBQUQsZ0JBQUM7S0FBQSxBQTFCRCxJQTBCQztzQkExQm9CLFNBQVMifQ==

/***/ }),
/* 50 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hash", function() { return hash; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * Hash类是地址路由（网页哈希）管理器，规定哈希格式为：#[模块名]?[参数名]=[参数值]&[参数名]=[参数值]&...
*/
var Hash = /** @class */ (function () {
    function Hash() {
        this._keepHash = false;
        this._hash = window.location.hash;
        this._moduleDataDict = {};
        this._moduleDatas = [];
        var reg = /#([^\?&#]+)?(\?([^\?&=#]+=[^\?&=#]+)(&([^\?&=#]+=[^\?&=#]+))*)?/g;
        var result;
        while (result = reg.exec(this._hash)) {
            var data = {
                name: result[1],
                params: {},
                direct: false
            };
            // 解析模块参数
            var paramsStr = result[2];
            if (paramsStr != null) {
                paramsStr = paramsStr.substr(1);
                var params = paramsStr.split("&");
                for (var i = 0, len = params.length; i < len; i++) {
                    var pair = params[i];
                    if (pair != null) {
                        var temp = pair.split("=");
                        // 键和值都要做一次URL解码
                        var key = decodeURIComponent(temp[0]);
                        var value = decodeURIComponent(temp[1]);
                        data.params[key] = value;
                    }
                }
            }
            // 处理direct参数
            data.direct = (data.params.direct == "true");
            delete data.params.direct;
            // 处理keepHash参数
            this._keepHash = this._keepHash || (data.params.keepHash == "true");
            delete data.params.keepHash;
            // 记录模块跳转数据
            this._moduleDataDict[data.name] = data;
            this._moduleDatas.push(data);
        }
        // 如果keepHash不是true，则移除哈希值
        if (!this._keepHash) {
            // 要使用window.location.replace方法，不能直接设置hash属性，否则会产生历史记录
            var url = window.location.href;
            var index = url.indexOf("#");
            if (index >= 0)
                window.location.replace(url.substr(0, index + 1));
        }
    }
    Object.defineProperty(Hash.prototype, "hash", {
        /**
         * 获取原始的哈希字符串
         *
         * @readonly
         * @type {string}
         * @memberof Hash
         */
        get: function () {
            return this._hash;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "moduleDatas", {
        /**
         * 获取模块跳转数据数组
         *
         * @readonly
         * @type {IHashModuleData[]}
         * @memberof Hash
         */
        get: function () {
            return this._moduleDatas;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "firstModuleParams", {
        /**
         * 获取传递给首模块的参数，首模块数据的传递方式为位于第一个#后且不填写模块名
         *
         * @readonly
         * @type {*}
         * @memberof Hash
         */
        get: function () {
            var data = this._moduleDatas[0];
            if (!data)
                return undefined;
            // 如果传递的第一个模块有名字，则不认为是传递给首模块的
            return (data.name ? undefined : data.params);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "keepHash", {
        /**
         * 获取是否保持哈希值
         *
         * @readonly
         * @type {boolean}
         * @memberof Hash
         */
        get: function () {
            return this._keepHash;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取指定哈希参数
     *
     * @param {string} key 参数名
     * @param {string} [moduleName] 参数所属模块名，不传则获取第一个模块的参数
     * @returns {string} 参数值
     * @memberof Hash
     */
    Hash.prototype.getParam = function (key, moduleName) {
        var data = (moduleName ? this._moduleDataDict[moduleName] : this._moduleDatas[0]);
        return (data && data.params[key]);
    };
    Hash = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __metadata */]("design:paramtypes", [])
    ], Hash);
    return Hash;
}());
/* harmony default export */ __webpack_exports__["default"] = (Hash);
/** 再额外导出一个单例 */
var hash = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Hash);


/***/ }),
/* 51 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(76), __webpack_require__(43), __webpack_require__(12)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Test_1, ResponseData_1, NetManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var TestResponse = /** @class */ (function (_super) {
        __extends(TestResponse, _super);
        function TestResponse() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Object.defineProperty(TestResponse.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    protocol: "http",
                    method: "GET"
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        TestResponse.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.__params.success = data.success;
            this.test = new Test_1.default().parse(data.test);
        };
        TestResponse.prototype.pack = function () {
            return {
                test: this.test.pack()
            };
        };
        TestResponse.type = "Test";
        return TestResponse;
    }(ResponseData_1.default));
    exports.default = TestResponse;
    /** 注册返回体 */
    NetManager_1.netManager.registerResponse(TestResponse);
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJlc3BvbnNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdFJlc3BvbnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7SUFJQTs7Ozs7O01BTUU7SUFDRjtRQUEwQyxnQ0FBWTtRQUF0RDs7UUFrQ0EsQ0FBQztRQXhCRyxzQkFBVyxrQ0FBUTtpQkFBbkI7Z0JBRUksTUFBTSxDQUFDO29CQUNILElBQUksRUFBRSxNQUFNO29CQUNaLFFBQVEsRUFBRSxNQUFNO29CQUNoQixNQUFNLEVBQUUsS0FBSztpQkFDaEIsQ0FBQztZQUNOLENBQUM7OztXQUFBO1FBQUEsQ0FBQztRQUlRLDhCQUFPLEdBQWpCLFVBQWtCLElBQVE7WUFFdEIsRUFBRSxDQUFBLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQztnQkFBQyxNQUFNLENBQUM7WUFDeEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNyQyxJQUFJLENBQUMsSUFBSSxHQUFTLElBQUksY0FBSSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRCxDQUFDO1FBRU0sMkJBQUksR0FBWDtZQUVJLE1BQU0sQ0FBQztnQkFDSCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7YUFDekIsQ0FBQztRQUNOLENBQUM7UUFkYSxpQkFBSSxHQUFVLE1BQU0sQ0FBQztRQWV2QyxtQkFBQztLQUFBLEFBbENELENBQTBDLHNCQUFZLEdBa0NyRDtzQkFsQ29CLFlBQVk7SUFvQ2pDLFlBQVk7SUFDWix1QkFBVSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxDQUFDIn0=

/***/ }),
/* 52 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(14), __webpack_require__(7), __webpack_require__(53), __webpack_require__(78), __webpack_require__(10)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, SceneMediator_1, Injector_1, Injector_2, TestComp_1, ModuleManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试第二个模块
    */
    var Second = /** @class */ (function (_super) {
        __extends(Second, _super);
        function Second() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Second.prototype.listAssets = function () {
            return ["preload"];
        };
        Second.prototype.onOpen = function () {
            var _this = this;
            this.mapListener(this.btn, egret.TouchEvent.TOUCH_TAP, function () {
                // moduleManager.close(Second);
                _this.dispatch("FuckMsg", "Shit!!!");
            });
            this.viewModel = {
                onMsg: function (msg) {
                    // 表达式里使用函数可以在函数里执行复杂逻辑，并且具有代码提示
                    console.log(msg);
                    ModuleManager_1.moduleManager.close(_this);
                    return msg + " - 1";
                },
                fuck: "you",
                fuckList: ["fuck", "shit", "you", "!!!"]
            };
            // 测试消息
            this.dispatch("fuck", 123);
        };
        Second.prototype.onFuck = function (a) {
            console.log("message at Second: " + a);
        };
        Second.prototype.onTestCompMsg = function () {
            console.log("TestCompMsg Received");
        };
        Second.prototype.onTestCompMsgGlobal = function () {
            console.log("TestCompMsg Received Global");
        };
        Second.moduleName = "Second";
        __decorate([
            Injector_1.SubMediator,
            __metadata("design:type", TestComp_1.default)
        ], Second.prototype, "_testComp", void 0);
        __decorate([
            Injector_1.BindMessage("FuckMsg", { label: "onMsg($arguments[0])" }),
            Injector_1.BindFunc("getCurrentState", ["fuck", "onMsg", undefined]),
            __metadata("design:type", eui.Button)
        ], Second.prototype, "btn", void 0);
        __decorate([
            Injector_1.BindFor("i of fuckList.concat(fuckList).concat(fuckList).concat(fuckList)"),
            Injector_1.BindValue("txt.text", function (scope) {
                return scope.i;
            }),
            Injector_1.BindFor("lst", "j of fuckList"),
            Injector_1.BindValue({
                txt: {
                    text: "'i=' + i + ' & ' + 'j=' + j"
                }
            }),
            __metadata("design:type", eui.DataGroup)
        ], Second.prototype, "lst", void 0);
        __decorate([
            Injector_1.MessageHandler("fuck"),
            Injector_1.GlobalMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onFuck", null);
        __decorate([
            Injector_1.MessageHandler("TestCompMsg"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", []),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onTestCompMsg", null);
        __decorate([
            Injector_1.GlobalMessageHandler("TestCompMsg"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", []),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onTestCompMsgGlobal", null);
        Second = __decorate([
            Injector_2.EgretMediatorClass("Second", "Fuck2Skin")
        ], Second);
        return Second;
    }(SceneMediator_1.default));
    exports.default = Second;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2Vjb25kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiU2Vjb25kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFNQTs7Ozs7OztNQU9FO0lBR0Y7UUFBb0MsMEJBQWE7UUFBakQ7O1FBa0VBLENBQUM7UUE1Q1UsMkJBQVUsR0FBakI7WUFFSSxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN2QixDQUFDO1FBRU0sdUJBQU0sR0FBYjtZQUFBLGlCQW1CQztZQWpCRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxTQUFTLEVBQUU7Z0JBQ25ELCtCQUErQjtnQkFFL0IsS0FBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDeEMsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsU0FBUyxHQUFHO2dCQUNiLEtBQUssRUFBRSxVQUFBLEdBQUc7b0JBQ04sZ0NBQWdDO29CQUNoQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO29CQUNqQiw2QkFBYSxDQUFDLEtBQUssQ0FBQyxLQUFJLENBQUMsQ0FBQztvQkFDMUIsTUFBTSxDQUFDLEdBQUcsR0FBRyxNQUFNLENBQUM7Z0JBQ3hCLENBQUM7Z0JBQ0QsSUFBSSxFQUFFLEtBQUs7Z0JBQ1gsUUFBUSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDO2FBQzNDLENBQUM7WUFDRixPQUFPO1lBQ1AsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDL0IsQ0FBQztRQUlPLHVCQUFNLEdBQWQsVUFBZSxDQUFDO1lBRVosT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMzQyxDQUFDO1FBR08sOEJBQWEsR0FBckI7WUFFSSxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDeEMsQ0FBQztRQUdPLG9DQUFtQixHQUEzQjtZQUVJLE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLENBQUMsQ0FBQztRQUMvQyxDQUFDO1FBL0RhLGlCQUFVLEdBQVUsUUFBUSxDQUFDO1FBRzNDO1lBREMsc0JBQVc7c0NBQ00sa0JBQVE7aURBQUM7UUFJM0I7WUFGQyxzQkFBVyxDQUFDLFNBQVMsRUFBRSxFQUFDLEtBQUssRUFBRSxzQkFBc0IsRUFBQyxDQUFDO1lBQ3ZELG1CQUFRLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO3NDQUMvQyxHQUFHLENBQUMsTUFBTTsyQ0FBQztRQVd0QjtZQVZDLGtCQUFPLENBQUMsa0VBQWtFLENBQUM7WUFDM0Usb0JBQVMsQ0FBQyxVQUFVLEVBQUUsVUFBUyxLQUFTO2dCQUNyQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNuQixDQUFDLENBQUM7WUFDRCxrQkFBTyxDQUFDLEtBQUssRUFBRSxlQUFlLENBQUM7WUFDL0Isb0JBQVMsQ0FBQztnQkFDUCxHQUFHLEVBQUU7b0JBQ0QsSUFBSSxFQUFFLDZCQUE2QjtpQkFDdEM7YUFDSixDQUFDO3NDQUNTLEdBQUcsQ0FBQyxTQUFTOzJDQUFDO1FBOEJ6QjtZQUZDLHlCQUFjLENBQUMsTUFBTSxDQUFDO1lBQ3RCLCtCQUFvQixDQUFDLE1BQU0sQ0FBQzs7Ozs0Q0FJNUI7UUFHRDtZQURDLHlCQUFjLENBQUMsYUFBYSxDQUFDOzs7O21EQUk3QjtRQUdEO1lBREMsK0JBQW9CLENBQUMsYUFBYSxDQUFDOzs7O3lEQUluQztRQWpFZ0IsTUFBTTtZQUQxQiw2QkFBa0IsQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDO1dBQ3JCLE1BQU0sQ0FrRTFCO1FBQUQsYUFBQztLQUFBLEFBbEVELENBQW9DLHVCQUFhLEdBa0VoRDtzQkFsRW9CLE1BQU0ifQ==

/***/ }),
/* 53 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["EgretSkin"] = EgretSkin;
/* harmony export (immutable) */ __webpack_exports__["EgretMediatorClass"] = EgretMediatorClass;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__ = __webpack_require__(7);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * 负责注入的模块
*/
function EgretSkin(skin) {
    return function (cls) {
        // 监听类型实例化，转换皮肤格式
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) { return mediator.skin = skin; });
    };
}
function EgretMediatorClass(moduleName, skin) {
    return function (cls) {
        // 调用MediatorClass方法
        cls = Object(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__["MediatorClass"])(moduleName)(cls);
        // 监听类型实例化，转换皮肤格式
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) { return mediator.skin = skin; });
        // 返回结果类型
        return cls;
    };
}


/***/ }),
/* 54 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(7), __webpack_require__(80), __webpack_require__(18), __webpack_require__(10)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, PanelMediator_1, Injector_2, ModuleManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestPanel = /** @class */ (function (_super) {
        __extends(TestPanel, _super);
        function TestPanel() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TestPanel_1 = TestPanel;
        TestPanel.prototype.onOpen = function () {
            this.viewModel = {
                onClick: function () {
                    ModuleManager_1.moduleManager.close(TestPanel_1);
                }
            };
        };
        TestPanel.moduleName = "TestPanel";
        __decorate([
            Injector_1.BindOn("click", "onClick"),
            __metadata("design:type", HTMLElement)
        ], TestPanel.prototype, "skin", void 0);
        TestPanel = TestPanel_1 = __decorate([
            Injector_2.DOMMediatorClass("TestPanel", "\n    <div style=\"background:#ffffff; width:400px; height: 250px;\">\n        jlk124kl1j2\n    </div>\n")
        ], TestPanel);
        return TestPanel;
        var TestPanel_1;
    }(PanelMediator_1.default));
    exports.default = TestPanel;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFBhbmVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdFBhbmVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFVQTtRQUF1Qyw2QkFBYTtRQUFwRDs7UUFlQSxDQUFDO3NCQWZvQixTQUFTO1FBT25CLDBCQUFNLEdBQWI7WUFFSSxJQUFJLENBQUMsU0FBUyxHQUFHO2dCQUNiLE9BQU8sRUFBRTtvQkFDTCw2QkFBYSxDQUFDLEtBQUssQ0FBQyxXQUFTLENBQUMsQ0FBQztnQkFDbkMsQ0FBQzthQUNKLENBQUM7UUFDTixDQUFDO1FBWmEsb0JBQVUsR0FBVSxXQUFXLENBQUM7UUFHOUM7WUFEQyxpQkFBTSxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUM7c0NBQ2YsV0FBVzsrQ0FBQztRQUxQLFNBQVM7WUFMN0IsMkJBQWdCLENBQUMsV0FBVyxFQUFFLDBHQUk5QixDQUFDO1dBQ21CLFNBQVMsQ0FlN0I7UUFBRCxnQkFBQzs7S0FBQSxBQWZELENBQXVDLHVCQUFhLEdBZW5EO3NCQWZvQixTQUFTIn0=

/***/ }),
/* 55 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/// <reference types="olympus-r"/>
/// <reference types="olympus-r-dom"/>
/// <reference types="olympus-r-egret"/>
/// <reference path="./egret/libs/modules/egret/egret.d.ts"/>
/// <reference path="./egret/libs/modules/res/res.d.ts"/>
/// <reference path="./egret/libs/modules/eui/eui.d.ts"/>
/// <reference path="./egret/libs/modules/tween/tween.d.ts"/>
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(56), __webpack_require__(82), __webpack_require__(5), __webpack_require__(26), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, First_1, Olympus_1, Environment_1, DOMBridge_1, EgretBridge_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-08-31
     * @modify date 2017-09-01
     *
     * 测试项目
    */
    Olympus_1.default.startup({
        bridges: [
            new DOMBridge_1.default({
                container: "#rootDOM"
            }),
            new EgretBridge_1.default({
                width: 720,
                height: 1280,
                pathPrefix: "egret/",
                container: "#rootEgret",
                backgroundColor: 0,
            })
        ],
        firstModule: First_1.default,
        loadElement: "#loading",
        hostsDict: {
            dev: ["http://www.test.17zuoye.net/"],
            test: ["https://www.test.17zuoye.net/"],
            staging: ["https://www.staging.17zuoye.net/"],
            prod: ["https://www.17zuoye.com/"]
        },
        cdnsDict: {
            test: ["https://cdn-cnc.test.17zuoye.net/"],
            staging: ["https://cdn-cnc.staging.17zuoye.net/"],
            prod: ["https://cdn-cnc.17zuoye.com/"]
        },
        pathDict: {
            a: "test1.js",
            b: "test2.js"
        },
        preloads: ["a", "b"],
        onInited: function () {
            // bridgeManager.getBridge("Egret").defaultScenePolicy = none;
            console.log(Environment_1.environment.env, Environment_1.environment.getHost(), Environment_1.environment.curCDNHost);
        },
        onInitProgress: function (prg, step) {
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            console.log.apply(console, [prg, step].concat(args));
        }
    });
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsa0NBQWtDO0FBQ2xDLHNDQUFzQztBQUN0Qyx3Q0FBd0M7QUFDeEMsNkRBQTZEO0FBQzdELHlEQUF5RDtBQUN6RCx5REFBeUQ7QUFDekQsNkRBQTZEOzs7O0lBVzdEOzs7Ozs7O01BT0U7SUFDRixpQkFBTyxDQUFDLE9BQU8sQ0FBQztRQUNaLE9BQU8sRUFBRTtZQUNMLElBQUksbUJBQVMsQ0FBQztnQkFDVixTQUFTLEVBQUUsVUFBVTthQUN4QixDQUFDO1lBQ0YsSUFBSSxxQkFBVyxDQUFDO2dCQUNaLEtBQUssRUFBRSxHQUFHO2dCQUNWLE1BQU0sRUFBRSxJQUFJO2dCQUNaLFVBQVUsRUFBRSxRQUFRO2dCQUNwQixTQUFTLEVBQUUsWUFBWTtnQkFDdkIsZUFBZSxFQUFFLENBQUM7YUFFckIsQ0FBQztTQUNMO1FBQ0QsV0FBVyxFQUFFLGVBQUs7UUFDbEIsV0FBVyxFQUFFLFVBQVU7UUFDdkIsU0FBUyxFQUFFO1lBQ1AsR0FBRyxFQUFFLENBQUMsOEJBQThCLENBQUM7WUFDckMsSUFBSSxFQUFFLENBQUMsK0JBQStCLENBQUM7WUFDdkMsT0FBTyxFQUFFLENBQUMsa0NBQWtDLENBQUM7WUFDN0MsSUFBSSxFQUFFLENBQUMsMEJBQTBCLENBQUM7U0FDckM7UUFDRCxRQUFRLEVBQUU7WUFDTixJQUFJLEVBQUUsQ0FBQyxtQ0FBbUMsQ0FBQztZQUMzQyxPQUFPLEVBQUUsQ0FBQyxzQ0FBc0MsQ0FBQztZQUNqRCxJQUFJLEVBQUUsQ0FBQyw4QkFBOEIsQ0FBQztTQUN6QztRQUNELFFBQVEsRUFBRTtZQUNOLENBQUMsRUFBRSxVQUFVO1lBQ2IsQ0FBQyxFQUFFLFVBQVU7U0FDaEI7UUFDRCxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ3BCLFFBQVEsRUFBRTtZQUVOLDhEQUE4RDtZQUM5RCxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUFXLENBQUMsR0FBRyxFQUFFLHlCQUFXLENBQUMsT0FBTyxFQUFFLEVBQUUseUJBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRixDQUFDO1FBQ0QsY0FBYyxFQUFFLFVBQUMsR0FBVSxFQUFFLElBQWE7WUFBRSxjQUFPO2lCQUFQLFVBQU8sRUFBUCxxQkFBTyxFQUFQLElBQU87Z0JBQVAsNkJBQU87O1lBQy9DLE9BQU8sQ0FBQyxHQUFHLE9BQVgsT0FBTyxHQUFLLEdBQUcsRUFBRSxJQUFJLFNBQUssSUFBSSxHQUFFO1FBQ3BDLENBQUM7S0FDSixDQUFDLENBQUMifQ==

/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(18), __webpack_require__(2), __webpack_require__(72), __webpack_require__(7), __webpack_require__(10), __webpack_require__(16), __webpack_require__(14), __webpack_require__(49), __webpack_require__(75), __webpack_require__(51), __webpack_require__(52), __webpack_require__(79), __webpack_require__(81)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Injector_2, AudioManager_1, Injector_3, ModuleManager_1, ModuleMessage_1, SceneMediator_1, FuckModel_1, TestRequest_1, TestResponse_1, Second_1, TestForMediator_1, Third_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试首个模块
    */
    var First = /** @class */ (function (_super) {
        __extends(First, _super);
        function First() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        First_1 = First;
        First.prototype.listAssets = function () {
            return ["./modules/test.html"];
        };
        First.prototype.listJsFiles = function () {
            return ["test1.js", "./test2.js"];
        };
        First.prototype.onOpen = function () {
            var _this = this;
            // this.mapListener(this.btn, "click", function():void
            // {
            //     this.txt.textContent = "Fuck you!!!";
            //     this.moduleManager.open(Second);
            // }, this);
            console.log(this.fuckModel1.fuck, this.fuckModel1 === this.fuckModel2, this.fuckModel1 === this.fuckModel3);
            this.viewModel = {
                fuckList: [1, 2, "shit", "you"],
                fuckText: "fuck you",
                onClickBtn: function () {
                    _this.viewModel.fuckText = "clicked";
                    // this.moduleManager.open(Second);
                    new Second_1.default().open();
                },
                onClickFuck: function () {
                    _this.moduleManager.open(Third_1.default);
                },
                fuckModel: this.fuckModel1
            };
            AudioManager_1.audioManager.playMusic({
                url: "./test.mp3"
            });
            setTimeout(function () {
                _this.viewModel.fuckText = "1234";
                // this.viewModel.fuckList = ["hello", "world"];
                _this.viewModel.fuckList.push("jfksdjlf");
                _this.fuckModel1.fuck = "You!!!";
            }, 3000);
            this.dispatch(new TestRequest_1.default());
        };
        First.prototype.onModuleChange = function (to, from) {
            if (to == First_1)
                console.log("change to first module!");
            else if (to == Second_1.default)
                console.log("change to second module!");
        };
        First.prototype.onResponse = function (res, req) {
            alert("123");
        };
        First.prototype.onFuck = function (a) {
            console.log("message at FirstModule: " + a);
        };
        First.moduleName = "First";
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", ModuleManager_1.default)
        ], First.prototype, "moduleManager", void 0);
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", FuckModel_1.default)
        ], First.prototype, "fuckModel1", void 0);
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], First.prototype, "fuckModel2", void 0);
        __decorate([
            Injector_2.Inject(1),
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], First.prototype, "fuckModel3", void 0);
        __decorate([
            Injector_3.BindOn({ click: "onClickBtn" }),
            Injector_3.BindIf("fuckText == '1234'"),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "btn", void 0);
        __decorate([
            Injector_3.BindFor("fuck of fuckList", TestForMediator_1.default),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "txt", void 0);
        __decorate([
            Injector_3.BindOn("click", "onClickFuck"),
            Injector_3.BindValue("textContent", "fuckModel.fuck"),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "fuck", void 0);
        __decorate([
            Injector_3.MessageHandler(ModuleMessage_1.default.MODULE_CHANGE),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object, Object]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onModuleChange", null);
        __decorate([
            Injector_3.ResponseHandler,
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [TestResponse_1.default, TestRequest_1.default]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onResponse", null);
        __decorate([
            Injector_3.MessageHandler("fuck"),
            Injector_3.GlobalMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onFuck", null);
        First = First_1 = __decorate([
            Injector_1.DOMMediatorClass("First", "./modules/test.html")
        ], First);
        return First;
        var First_1;
    }(SceneMediator_1.default));
    exports.default = First;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRmlyc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJGaXJzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBY0E7Ozs7Ozs7TUFPRTtJQUdGO1FBQW1DLHlCQUFhO1FBQWhEOztRQXdGQSxDQUFDO2tCQXhGb0IsS0FBSztRQXNCZiwwQkFBVSxHQUFqQjtZQUVJLE1BQU0sQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDbkMsQ0FBQztRQUVNLDJCQUFXLEdBQWxCO1lBRUksTUFBTSxDQUFDLENBQUMsVUFBVSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ3RDLENBQUM7UUFFTSxzQkFBTSxHQUFiO1lBQUEsaUJBbUNDO1lBakNHLHNEQUFzRDtZQUN0RCxJQUFJO1lBQ0osNENBQTRDO1lBQzVDLHVDQUF1QztZQUN2QyxZQUFZO1lBQ1osT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxLQUFLLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFNUcsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDYixRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUM7Z0JBQy9CLFFBQVEsRUFBRSxVQUFVO2dCQUNwQixVQUFVLEVBQUU7b0JBQ1IsS0FBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO29CQUNwQyxtQ0FBbUM7b0JBQ25DLElBQUksZ0JBQU0sRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDO2dCQUN4QixDQUFDO2dCQUNELFdBQVcsRUFBRTtvQkFDVCxLQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxlQUFLLENBQUMsQ0FBQztnQkFDbkMsQ0FBQztnQkFDRCxTQUFTLEVBQUUsSUFBSSxDQUFDLFVBQVU7YUFDN0IsQ0FBQztZQUVGLDJCQUFZLENBQUMsU0FBUyxDQUFDO2dCQUNuQixHQUFHLEVBQUUsWUFBWTthQUNwQixDQUFDLENBQUM7WUFFSCxVQUFVLENBQUM7Z0JBQ1AsS0FBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDO2dCQUNqQyxnREFBZ0Q7Z0JBQ2hELEtBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDekMsS0FBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEdBQUcsUUFBUSxDQUFDO1lBQ3BDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUVULElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxxQkFBVyxFQUFFLENBQUMsQ0FBQztRQUNyQyxDQUFDO1FBR08sOEJBQWMsR0FBdEIsVUFBdUIsRUFBTSxFQUFFLElBQVE7WUFFbkMsRUFBRSxDQUFBLENBQUMsRUFBRSxJQUFJLE9BQUssQ0FBQztnQkFBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDdkQsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFDLEVBQUUsSUFBSSxnQkFBTSxDQUFDO2dCQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLENBQUMsQ0FBQztRQUNsRSxDQUFDO1FBR08sMEJBQVUsR0FBbEIsVUFBbUIsR0FBZ0IsRUFBRSxHQUFlO1lBRWhELEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqQixDQUFDO1FBSU8sc0JBQU0sR0FBZCxVQUFlLENBQUM7WUFFWixPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2hELENBQUM7UUFyRmEsZ0JBQVUsR0FBVSxPQUFPLENBQUM7UUFHMUM7WUFEQyxpQkFBTTtzQ0FDZSx1QkFBYTtvREFBQztRQUVwQztZQURDLGlCQUFNO3NDQUNZLG1CQUFTO2lEQUFDO1FBRTdCO1lBREMsaUJBQU07c0NBQ1ksc0JBQVU7aURBQUM7UUFFOUI7WUFEQyxpQkFBTSxDQUFDLENBQUMsQ0FBQztzQ0FDUyxzQkFBVTtpREFBQztRQUk5QjtZQUZDLGlCQUFNLENBQUMsRUFBQyxLQUFLLEVBQUUsWUFBWSxFQUFDLENBQUM7WUFDN0IsaUJBQU0sQ0FBQyxvQkFBb0IsQ0FBQztzQ0FDbEIsV0FBVzswQ0FBQTtRQUV0QjtZQURDLGtCQUFPLENBQUMsa0JBQWtCLEVBQUUseUJBQWUsQ0FBQztzQ0FDbEMsV0FBVzswQ0FBQztRQUd2QjtZQUZDLGlCQUFNLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQztZQUM5QixvQkFBUyxDQUFDLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQztzQ0FDL0IsV0FBVzsyQ0FBQztRQWtEeEI7WUFEQyx5QkFBYyxDQUFDLHVCQUFhLENBQUMsYUFBYSxDQUFDOzs7O21EQUszQztRQUdEO1lBREMsMEJBQWU7OzZDQUNPLHNCQUFZLEVBQU0scUJBQVc7OytDQUduRDtRQUlEO1lBRkMseUJBQWMsQ0FBQyxNQUFNLENBQUM7WUFDdEIsK0JBQW9CLENBQUMsTUFBTSxDQUFDOzs7OzJDQUk1QjtRQXZGZ0IsS0FBSztZQUR6QiwyQkFBZ0IsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUM7V0FDNUIsS0FBSyxDQXdGekI7UUFBRCxZQUFDOztLQUFBLEFBeEZELENBQW1DLHVCQUFhLEdBd0YvQztzQkF4Rm9CLEtBQUsifQ==

/***/ }),
/* 57 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Message__ = __webpack_require__(30);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-01
 * @modify date 2017-09-01
 *
 * 框架内核通用消息
*/
var CommonMessage = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](CommonMessage, _super);
    /**
     * Creates an instance of Message.
     * @param {string} type 消息类型
     * @param {...any[]} params 可能的消息参数列表
     * @memberof Message
     */
    function CommonMessage(type) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        var _this = _super.call(this, type) || this;
        _this.params = params;
        return _this;
    }
    return CommonMessage;
}(__WEBPACK_IMPORTED_MODULE_1__Message__["a" /* default */]));
/* harmony default export */ __webpack_exports__["a"] = (CommonMessage);


/***/ }),
/* 58 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 59 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = mutate;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Dep__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Watcher__ = __webpack_require__(33);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 变异器，将ViewModel变异为具有依赖功能的形式，也可以认为是编译过程
*/
// 记录数组中会造成数据更新的所有方法名
var arrMethods = [
    "push",
    "pop",
    "unshift",
    "shift",
    "splice",
    "sort",
    "reverse"
];
/**
 * 将用户传进来的数据“变异”成为具有截获数据变更能力的数据
 * @param data 原始数据
 * @returns {any} 变异后的数据
 */
function mutate(data) {
    // 如果是简单类型，则啥也不做
    if (!data || typeof data != "object")
        return data;
    // 递归变异所有内部变量，及其__proto__下的属性，因为getter/setter会被定义在__proto__上，而不是当前对象上
    var keys = Object.keys(data).concat(Object.keys(data.__proto__ || {}));
    // 去重
    var temp = {};
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (!temp[key]) {
            temp[key] = key;
            // 递归变异
            mutateObject(data, key);
        }
    }
    return data;
}
function onGet(dep, result, mutateSub) {
    // 如果Watcher.updating不是null，说明当前正在执行表达式，那么获取的变量自然是其需要依赖的
    var watcher = __WEBPACK_IMPORTED_MODULE_2__Watcher__["a" /* default */].updating;
    if (watcher)
        dep.watch(watcher);
    // 首次获取需要变异
    if (mutateSub) {
        // 如果是数组就走专门的数组变异方法，否则递归变异对象
        if (Array.isArray(result))
            mutateArray(result, dep);
        else
            mutate(result);
    }
}
function onSet(dep, value) {
    // 如果是数组就走专门的数组变异方法，否则递归变异对象
    if (Array.isArray(value))
        mutateArray(value, dep);
    else
        mutate(value);
    // 触发通知
    dep.notify();
}
function mutateObject(data, key) {
    var depKey = Object(__WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["e" /* getObjectHashs */])(data, key);
    // 对每个复杂类型对象都要有一个对应的依赖列表
    var dep = data[depKey];
    var mutateSub = true;
    if (!dep) {
        dep = new __WEBPACK_IMPORTED_MODULE_1__Dep__["a" /* default */]();
        // 判断本来这个属性是值属性还是getter/setter属性，要有不同的操作方式
        var desc = Object.getOwnPropertyDescriptor(data, key) || Object.getOwnPropertyDescriptor(data.__proto__ || {}, key);
        if (desc) {
            // 开始变异当前属性
            if (desc.hasOwnProperty("value")) {
                // 值属性的变异过程
                Object.defineProperty(data, key, {
                    enumerable: true,
                    configurable: true,
                    get: function () {
                        // 利用闭包保存原始值
                        var result = desc.value;
                        // 执行处理
                        onGet(dep, result, mutateSub);
                        // 设置标记
                        mutateSub = false;
                        // 返回值
                        return result;
                    },
                    set: function (value) {
                        if (!desc.writable || value === desc.value)
                            return;
                        desc.value = value;
                        // 执行处理
                        onSet(dep, value);
                    }
                });
            }
            else {
                // getter/setter属性的变异过程
                Object.defineProperty(data, key, {
                    enumerable: true,
                    configurable: false,
                    get: function () {
                        if (!desc.get)
                            return;
                        // 获取get方法结果
                        var result = desc.get.call(data);
                        // 执行处理
                        onGet(dep, result, mutateSub);
                        // 设置标记
                        mutateSub = false;
                        // 返回值
                        return result;
                    },
                    set: function (value) {
                        if (!desc.set)
                            return;
                        // 设置
                        desc.set.call(data, value);
                        // 执行处理
                        onSet(dep, value);
                    }
                });
            }
        }
        // 打一个标记表示已经变异过了
        Object.defineProperty(data, depKey, {
            value: dep,
            writable: false,
            enumerable: false,
            configurable: false
        });
    }
}
function mutateArray(arr, dep) {
    // 变异当前数组
    Object.setPrototypeOf(arr, defineReactiveArray(dep));
    // 遍历当前数组，将内容对象全部变异
    for (var i = 0, len = arr.length; i < len; i++) {
        mutate(arr[i]);
    }
}
function defineReactiveArray(dep) {
    var proto = Array.prototype;
    var result = Object.create(proto);
    // 遍历所有方法，一个一个地变异
    arrMethods.forEach(function (method) {
        // 利用闭包记录一个原始方法
        var oriMethod = proto[method];
        // 开始变异
        Object.defineProperty(result, method, {
            value: function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                // 首先调用原始方法，获取返回值
                var result = oriMethod.apply(this, args);
                // 数组插入项
                var inserted;
                switch (method) {
                    case "push":
                    case "unshift":
                        inserted = args;
                        break;
                    case "splice":
                        inserted = args.slice(2);
                        break;
                }
                // 监视数组插入项，而不是重新监视整个数组
                if (inserted && inserted.length) {
                    mutateArray(inserted, dep);
                }
                // 触发更新
                dep.notify({ method: args });
                // 返回值
                return result;
            }
        });
    });
    // 提供替换数组设置的方法，因为直接设置数组下标的方式无法变异
    Object.defineProperty(result, "$set", {
        value: function (index, value) {
            // 超出数组长度默认追加到最后
            if (index >= this.length)
                index = this.length;
            return this.splice(index, 1, value)[0];
        }
    });
    // 提供替换数组移除的方法，因为直接移除的方式无法变异
    Object.defineProperty(result, "$remove", {
        value: function (item) {
            var index = this.indexOf(item);
            if (index > -1)
                return this.splice(index, 1);
            return null;
        }
    });
    return result;
}


/***/ }),
/* 60 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__ = __webpack_require__(4);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 定义一个依赖，一个观察者实现
*/
var Dep = /** @class */ (function () {
    function Dep() {
        this._map = new __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__["a" /* default */]();
    }
    /**
     * 添加数据变更订阅者
     * @param watcher 数据变更订阅者
     */
    Dep.prototype.watch = function (watcher) {
        this._map.set(watcher, watcher);
    };
    /**
     * 数据变更，通知所有订阅者
     * @param extra 可能的额外数据
     */
    Dep.prototype.notify = function (extra) {
        var _this = this;
        this._map.forEach(function (watcher) {
            if (watcher.disposed)
                // 观察者已经销毁，移除监听
                _this._map.delete(watcher);
            else
                // 观察者依然生效，更新之
                watcher.update(extra);
        });
    };
    return Dep;
}());
/* harmony default export */ __webpack_exports__["a"] = (Dep);


/***/ }),
/* 61 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Watcher__ = __webpack_require__(33);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 一个绑定
*/
var Bind = /** @class */ (function () {
    function Bind(mediator) {
        this._watcherDict = {};
        this._mediator = mediator;
    }
    Object.defineProperty(Bind.prototype, "mediator", {
        /**
         * 获取已绑定的中介者实例
         *
         * @readonly
         * @type {IMediator}
         * @memberof Bind
         */
        get: function () {
            return this._mediator;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 创建一个观察者，在数值变更时会通知回调进行更新
     *
     * @param {*} currentTarget 作用目标，指表达式所在的显示对象
     * @param {*} target 绑定表达式本来所在的对象
     * @param {EvalExp} exp 表达式或方法
     * @param {WatcherCallback} callback 订阅器回调
     * @param {*} thisArg this指向
     * @param {...any[]} scopes 作用域列表，最后一个作用域会被当做this指向
     * @returns {IWatcher} 返回观察者本身
     * @memberof Bind
     */
    Bind.prototype.createWatcher = function (currentTarget, target, exp, callback, thisArg) {
        var scopes = [];
        for (var _i = 5; _i < arguments.length; _i++) {
            scopes[_i - 5] = arguments[_i];
        }
        var key = __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["e" /* getObjectHashs */].apply(void 0, [currentTarget, exp].concat(scopes));
        var watcher = this._watcherDict[key];
        if (!watcher)
            this._watcherDict[key] = watcher = new (__WEBPACK_IMPORTED_MODULE_1__Watcher__["a" /* default */].bind.apply(__WEBPACK_IMPORTED_MODULE_1__Watcher__["a" /* default */], [void 0, this, currentTarget, target, exp, callback, thisArg].concat(scopes)))();
        return watcher;
    };
    /**
     * 销毁绑定关系
     *
     * @memberof Bind
     */
    Bind.prototype.dispose = function () {
        for (var key in this._watcherDict) {
            var watcher = this._watcherDict[key];
            watcher.dispose();
            delete this._watcherDict[key];
        }
    };
    return Bind;
}());
/* harmony default export */ __webpack_exports__["a"] = (Bind);


/***/ }),
/* 62 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 通讯相关的消息
*/
var NetMessage = /** @class */ (function () {
    function NetMessage() {
    }
    /**
     * 发送网络请求消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_REQUEST = "netRequest";
    /**
     * 接受网络返回消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_RESPONSE = "netResponse";
    /**
     * 网络请求错误消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_ERROR = "netError";
    return NetMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (NetMessage);


/***/ }),
/* 63 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export NonePanelPolicy */
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 无任何动画的弹出策略，可应用于任何显示层实现
*/
var NonePanelPolicy = /** @class */ (function () {
    function NonePanelPolicy() {
    }
    NonePanelPolicy.prototype.pop = function (panel, callback, from) {
        setTimeout(callback, 0);
    };
    NonePanelPolicy.prototype.drop = function (panel, callback, from) {
        setTimeout(callback, 0);
    };
    return NonePanelPolicy;
}());

/** 默认导出实例 */
/* harmony default export */ __webpack_exports__["a"] = (new NonePanelPolicy());


/***/ }),
/* 64 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 弹窗相关的消息
*/
var PanelMessage = /** @class */ (function () {
    function PanelMessage() {
    }
    /**
     * 打开弹窗前的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_BEFORE_POP = "panelBeforePop";
    /**
     * 打开弹窗后的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_AFTER_POP = "panelAfterPop";
    /**
     * 关闭弹窗前的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_BEFORE_DROP = "panelBeforeDrop";
    /**
     * 关闭弹窗后的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_AFTER_DROP = "panelAfterDrop";
    return PanelMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (PanelMessage);


/***/ }),
/* 65 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ButtonType; });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 通用弹窗的各种接口
*/
var ButtonType;
(function (ButtonType) {
    ButtonType[ButtonType["normal"] = 0] = "normal";
    ButtonType[ButtonType["important"] = 1] = "important";
})(ButtonType || (ButtonType = {}));


/***/ }),
/* 66 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export NoneScenePolicy */
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 无任何动画的场景策略，可应用于任何显示层实现
*/
var NoneScenePolicy = /** @class */ (function () {
    function NoneScenePolicy() {
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    NoneScenePolicy.prototype.prepareSwitch = function (from, to) {
        // 这个策略里啥也不用准备
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    NoneScenePolicy.prototype.switch = function (from, to, callback) {
        // 直接延迟到下一帧回调（不能同步回调，否则可能会出问题）
        setTimeout(callback, 0);
    };
    return NoneScenePolicy;
}());

/** 默认导出实例 */
/* harmony default export */ __webpack_exports__["a"] = (new NoneScenePolicy());


/***/ }),
/* 67 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export isOperating */
/* harmony export (immutable) */ __webpack_exports__["b"] = wait;
/* harmony export (immutable) */ __webpack_exports__["a"] = notify;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 同步工具集，用于对多个
*/
var _cache = {};
/**
 * 判断是否正在进行操作
 *
 * @export
 * @param {string} name 队列名
 * @returns {boolean} 队列是否正在操作
 */
function isOperating(name) {
    var ctx = _cache[name];
    return (ctx != null && ctx.operating);
}
/**
 * 开始同步操作，所有传递了相同name的操作会被以队列方式顺序执行
 *
 * @export
 * @param name 一个队列的名字
 * @param {Function} fn 要执行的方法
 * @param {*} [thisArg] 方法this对象
 * @param {...any[]} [args] 方法参数
 */
function wait(name, fn, thisArg) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    var ctx = _cache[name];
    if (ctx == null) {
        _cache[name] = ctx = { operating: false, datas: [] };
    }
    if (ctx.operating) {
        // 队列正在执行，推入缓存
        ctx.datas.push({ fn: fn, thisArg: thisArg, args: args });
    }
    else {
        // 队列没有在执行，直接执行
        ctx.operating = true;
        fn.apply(thisArg, args);
    }
}
/**
 * 完成一步操作并唤醒后续操作
 *
 * @export
 * @param {string} name 队列名字
 * @returns {void}
 */
function notify(name) {
    var ctx = _cache[name];
    if (ctx == null || ctx.datas.length <= 0) {
        // 队列执行完了，直接结束
        ctx.operating = false;
        return;
    }
    var data = ctx.datas.shift();
    data.fn.apply(data.thisArg, data.args);
}


/***/ }),
/* 68 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__DOMBridge__ = __webpack_require__(26);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * DOM遮罩实现
*/
var MaskEntityImpl = /** @class */ (function () {
    function MaskEntityImpl(params) {
        this._maskAlpha = 0.5;
        this._loadingAlpha = 0.5;
        this._modalPanelAlpha = 0.5;
        this._showingMask = false;
        this._showingLoading = false;
        if (params != null) {
            this._maskAlpha = (params.maskAlpha != null ? params.maskAlpha : 0.5);
            this._loadingAlpha = (params.loadingAlpha != null ? params.loadingAlpha : 0.5);
            this._modalPanelAlpha = (params.modalPanelAlpha != null ? params.modalPanelAlpha : 0.5);
            // 初始化loading皮肤
            if (typeof params.loadingSkin == "string") {
                var temp = document.createElement("div");
                temp.innerHTML = params.loadingSkin;
                params.loadingSkin = temp;
            }
            this.loadingSkin = params.loadingSkin;
        }
        this.maskData = params || {};
        this._mask = document.createElement("div");
        this._loadingMask = document.createElement("div");
        this._modalPanelDict = new __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__["a" /* default */]();
        this._modalPanelList = [];
        this._modalPanelMask = document.createElement("div");
    }
    /**
     * 显示遮罩
     */
    MaskEntityImpl.prototype.showMask = function (alpha) {
        if (this._showingMask)
            return;
        this._showingMask = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._maskAlpha;
        this._mask.style.backgroundColor = "#000";
        this._mask.style.opacity = alpha.toString();
        this._mask.style.width = "100%";
        this._mask.style.height = "100%";
        // 添加显示
        bridge.maskLayer.appendChild(this._mask);
    };
    /**
     * 隐藏遮罩
     */
    MaskEntityImpl.prototype.hideMask = function () {
        if (!this._showingMask)
            return;
        this._showingMask = false;
        // 隐藏
        if (this._mask.parentElement != null)
            this._mask.parentElement.removeChild(this._mask);
    };
    /**当前是否在显示遮罩*/
    MaskEntityImpl.prototype.isShowingMask = function () {
        return this._showingMask;
    };
    /**
     * 显示加载图
     */
    MaskEntityImpl.prototype.showLoading = function (alpha) {
        if (this._showingLoading)
            return;
        this._showingLoading = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._loadingAlpha;
        this._loadingMask.style.backgroundColor = "#000";
        this._loadingMask.style.opacity = alpha.toString();
        this._loadingMask.style.width = "100%";
        this._loadingMask.style.height = "100%";
        // 添加显示
        bridge.maskLayer.appendChild(this._loadingMask);
        // 添加loading皮肤
        if (this.loadingSkin)
            bridge.maskLayer.appendChild(this.loadingSkin);
    };
    /**
     * 隐藏加载图
     */
    MaskEntityImpl.prototype.hideLoading = function () {
        if (!this._showingLoading)
            return;
        this._showingLoading = false;
        // 隐藏
        if (this._loadingMask.parentElement != null)
            this._loadingMask.parentElement.removeChild(this._loadingMask);
        if (this.loadingSkin != null && this.loadingSkin.parentElement != null)
            this.loadingSkin.parentElement.removeChild(this.loadingSkin);
    };
    /**当前是否在显示loading*/
    MaskEntityImpl.prototype.isShowingLoading = function () {
        return this._showingLoading;
    };
    /** 显示模态窗口遮罩 */
    MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
        if (this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.set(panel, panel);
        this._modalPanelList.push(panel);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._modalPanelAlpha;
        this._modalPanelMask.style.backgroundColor = "#000";
        this._modalPanelMask.style.opacity = alpha.toString();
        this._modalPanelMask.style.width = "100%";
        this._modalPanelMask.style.height = "100%";
        // 添加显示
        var entity = panel.skin;
        var parent = entity.parentElement;
        if (parent != null) {
            if (this._modalPanelMask.parentElement) {
                this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
            }
            var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
            var index = bridge.getChildIndex(parent, entity);
            bridge.addChildAt(parent, this._modalPanelMask, index);
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskEntityImpl.prototype.hideModalMask = function (panel) {
        if (!this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.delete(panel);
        this._modalPanelList.splice(this._modalPanelList.indexOf(panel), 1);
        // 判断是否还需要Mask
        if (this._modalPanelList.length <= 0) {
            // 隐藏
            if (this._modalPanelMask.parentElement != null)
                this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
        }
        else {
            // 移动Mask
            var entity = this._modalPanelList[this._modalPanelList.length - 1].skin;
            var parent = entity.parentElement;
            if (parent != null) {
                if (this._modalPanelMask.parentElement) {
                    this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
                }
                var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
                var index = bridge.getChildIndex(parent, entity);
                bridge.addChildAt(parent, this._modalPanelMask, index);
            }
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
        return (this._modalPanelDict.get(panel) != null);
    };
    return MaskEntityImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (MaskEntityImpl);


/***/ }),
/* 69 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["e"] = wrapSkin;
/* harmony export (immutable) */ __webpack_exports__["c"] = isDOMStr;
/* harmony export (immutable) */ __webpack_exports__["b"] = isDOMPath;
/* harmony export (immutable) */ __webpack_exports__["a"] = copyRef;
/* harmony export (immutable) */ __webpack_exports__["d"] = toHTMLElement;
/* unused harmony export getHTMLContent */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_mediator_MediatorStatus__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-26
 * @modify date 2017-10-26
 *
 * 为DOM提供皮肤转换的工具集
*/
/**
 * 为中介者包装皮肤
 *
 * @export
 * @param {IMediator} mediator 中介者
 * @param {(HTMLElement|string|string[])} skin 皮肤，可以是HTMLElement，也可以是皮肤字符串，也可以是皮肤模板地址或地址数组
 * @returns {HTMLElement} 皮肤的HTMLElement形式，可能会稍后再填充内容，如果想在皮肤加载完毕后再拿到皮肤请使用complete参数
 */
function wrapSkin(mediator, skin) {
    var result = (skin instanceof HTMLElement ? skin : document.createElement("div"));
    // 判断中介者当前状态
    if (mediator.status < __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_mediator_MediatorStatus__["a" /* default */].OPENING) {
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", doWrapSkin);
    }
    else {
        // 直接执行要执行的
        doWrapSkin();
    }
    // 同步返回皮肤
    return result;
    function doWrapSkin() {
        if (skin instanceof HTMLElement) {
            // 拷贝引用
            doCopyRef(result, skin.innerHTML, mediator);
        }
        else {
            // 转换皮肤
            skin = getHTMLContent(skin);
            // 赋值皮肤内容
            result.innerHTML = skin;
            // 拷贝引用
            doCopyRef(result, skin, mediator);
        }
    }
}
/**
 * 判断是否是DOM字符串
 *
 * @export
 * @param {string} str 字符串
 * @returns {boolean}
 */
function isDOMStr(str) {
    return str && (str.indexOf("<") >= 0 && str.indexOf(">") >= 0);
}
var reg = /(\.htm|\.html|\.tpl)$/;
/**
 * 判断是否是DOM模板路径
 *
 * @export
 * @param {string} path 路径字符串
 * @returns {boolean}
 */
function isDOMPath(path) {
    return path && reg.test(path);
}
/**
 * 将from中的所有拥有id属性的节点引用复制到to对象上
 *
 * @export
 * @param {HTMLElement} from 复制源DOM节点
 * @param {*} to 复制目标对象
 */
function copyRef(from, to) {
    doCopyRef(from, from.innerHTML, to);
}
function doCopyRef(fromEle, fromStr, to) {
    // 使用正则表达式将拥有id的节点赋值给mediator
    var reg = /id=("([^"]+)"|'([^']+)')/g;
    var res;
    while (res = reg.exec(fromStr)) {
        var id = res[2] || res[3];
        to[id] = fromEle.querySelector("#" + id);
    }
}
/**
 * 转换皮肤为HTMLElement
 *
 * @export
 * @param {(HTMLElement|string|string[])} skin 皮肤
 * @returns {HTMLElement}
 */
function toHTMLElement(skin) {
    if (skin instanceof HTMLElement)
        return skin;
    var result = document.createElement("div");
    result.innerHTML = getHTMLContent(skin);
    return result;
}
/**
 * 将皮肤字符串/字符串数组或皮肤路径转变为HTML内容字符串
 *
 * @export
 * @param {(string|string[])} skin 可以是皮肤字符串、皮肤字符串数组或皮肤路径
 * @returns {string}
 */
function getHTMLContent(skin) {
    if (skin instanceof Array) {
        // 是字符串数组，拆分后皮肤化再连接起来
        return skin.map(getHTMLContent).join("");
    }
    else if (isDOMStr(skin)) {
        // 是皮肤字符串，直接返回
        return skin;
    }
    else {
        // 是皮肤路径或路径短名称，获取后返回
        return __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_assets_AssetsManager__["b" /* assetsManager */].getAssets(skin);
    }
}


/***/ }),
/* 70 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 回弹效果
*/
var BackPanelPolicy = /** @class */ (function () {
    function BackPanelPolicy() {
        this._reg = /(\w*)(\d+)(\w*)/;
    }
    /**
     * 显示时调用
     * @param panel 弹出框对象
     * @param callback 完成回调，必须调用
     * @param from 动画起始点
     */
    BackPanelPolicy.prototype.pop = function (panel, callback, from) {
        var entity = panel.skin;
        var curStyle = getComputedStyle(entity);
        var tween = new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](entity).end().stop();
        entity.style.position = "fixed";
        entity.style.left = "calc(50% - " + curStyle.width + " * 0.5)";
        entity.style.top = "calc(50% - " + curStyle.height + " * 0.5)";
        entity.style.transform = "scale(0, 0)";
        // 开始缓动
        var key = "__tween__step__";
        entity[key] = 0;
        var props = {};
        props[key] = 1;
        tween.to(props, 300).easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Back.Out).onUpdate(function () {
            entity.style.transform = "scale(" + entity[key] + ", " + entity[key] + ")";
        }).onComplete(function () {
            delete entity[key];
            entity.style.transform = "";
            callback();
        }).start();
    };
    /**
     * 关闭时调用
     * @param popup 弹出框对象
     * @param callback 完成回调，必须调用
     * @param to 动画完结点
     */
    BackPanelPolicy.prototype.drop = function (panel, callback, to) {
        var entity = panel.skin;
        var tween = new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](entity).end().stop();
        entity.style.transform = "scale(1, 1)";
        // 开始缓动
        var key = "__tween__step__";
        entity[key] = 1;
        var props = {};
        props[key] = 0;
        tween.to(props, 300).easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Back.In).onUpdate(function () {
            entity.style.transform = "scale(" + entity[key] + ", " + entity[key] + ")";
        }).onComplete(function () {
            delete entity[key];
            entity.style.transform = "";
            callback();
        }).start();
    };
    return BackPanelPolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (BackPanelPolicy);


/***/ }),
/* 71 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 淡入淡出场景切换策略
*/
var FadeScenePolicy = /** @class */ (function () {
    function FadeScenePolicy() {
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    FadeScenePolicy.prototype.prepareSwitch = function (from, to) {
        if (from != null) {
            // 移除克隆节点
            if (this._stageClone && this._stageClone.parentElement) {
                this._stageClone.parentElement.removeChild(this._stageClone);
            }
            // 克隆当前屏幕
            var stage = from.bridge.stage;
            this._stageClone = stage.cloneNode(true);
            this._stageClone.style.position = "fixed";
            this._stageClone.style.left = "0%";
            this._stageClone.style.top = "0%";
            this._stageClone.style.zIndex = "2147483647"; // 层级要最高
            this._stageClone.style.pointerEvents = "none"; // 要屏蔽点击事件
            // 添加克隆节点
            from.bridge.htmlWrapper.appendChild(this._stageClone);
            // 移除from
            var fromDisplay = from.skin;
            if (fromDisplay.parentElement != null) {
                fromDisplay.parentElement.removeChild(fromDisplay);
            }
        }
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    FadeScenePolicy.prototype.switch = function (from, to, callback) {
        var _this = this;
        if (from != null) {
            // 开始淡出
            var key = "__tween__step__";
            this._stageClone[key] = 1;
            var props = {};
            props[key] = 0;
            new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](this._stageClone)
                .end()
                .stop()
                .to(props, 300)
                .easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Linear.None)
                .onUpdate(function () {
                _this._stageClone.style.opacity = _this._stageClone[key];
            })
                .onComplete(function () {
                delete _this._stageClone[key];
                // 移除截屏
                if (_this._stageClone.parentElement != null) {
                    _this._stageClone.parentElement.removeChild(_this._stageClone);
                }
                // 调用回调
                callback();
            })
                .start();
        }
        else {
            // 移除克隆节点
            if (this._stageClone && this._stageClone.parentElement) {
                this._stageClone.parentElement.removeChild(this._stageClone);
            }
            // 调用回调
            callback();
        }
    };
    return FadeScenePolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (FadeScenePolicy);


/***/ }),
/* 72 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "audioManager", function() { return audioManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__env_Shell__ = __webpack_require__(73);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__AudioTagImpl__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__AudioContextImpl__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__message_EngineMessage__ = __webpack_require__(48);







/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 音频管理器，音频接口被强行分为两部分：Sound和Music。
 * Sound：使用Audio标签播放，可以跨域播放但可能会被某些浏览器限制，必须在点击事件处理函数中播放
 * Music：使用AudioContext播放，可以一定程度上越过点击事件检查，但无法跨域播放，适合播放背景音乐
*/
var AudioManager = /** @class */ (function () {
    function AudioManager() {
        var _this = this;
        this._soundImpl = new __WEBPACK_IMPORTED_MODULE_4__AudioTagImpl__["a" /* default */]();
        // 为WebAudio做兼容处理
        window["AudioContext"] = window["AudioContext"] || window["webkitAudioContext"] || window["mozAudioContext"] || window["msAudioContext"];
        // 由于IE可能不支持AudioContext，因此如果是IE则要改用Audio标签实现
        this._musicImpl = (window["AudioContext"] ? new __WEBPACK_IMPORTED_MODULE_5__AudioContextImpl__["a" /* default */]() : this._soundImpl);
        __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_6__message_EngineMessage__["a" /* default */].INITIALIZED, function () {
            // 读取持久化记录
            var shell = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            _this.muteSound = (shell.localStorageGet(AudioManager_1.STORAGE_KEY_MUTE_SOUND) === "true");
            _this.muteMusic = (shell.localStorageGet(AudioManager_1.STORAGE_KEY_MUTE_MUSIC) === "true");
        });
    }
    AudioManager_1 = AudioManager;
    /**
     * 注册Sound音频实现对象
     *
     * @param {IAudio} soundImpl Sound音频实现对象
     * @memberof AudioManager
     */
    AudioManager.prototype.registerSoundImpl = function (soundImpl) {
        this._soundImpl = soundImpl;
    };
    Object.defineProperty(AudioManager.prototype, "muteSound", {
        /**
         * 获取或设置Sound类型音频静音属性
         *
         * @type {boolean}
         * @memberof AudioManager
         */
        get: function () {
            return this._soundImpl.mute;
        },
        set: function (value) {
            if (value === this._soundImpl.mute)
                return;
            this._soundImpl.mute = value;
            // 持久化
            var shell = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            shell.localStorageSet(AudioManager_1.STORAGE_KEY_MUTE_SOUND, value + "");
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.loadSound = function (url) {
        this._soundImpl.load(url);
    };
    /**
     * 播放Sound音频，如果没有加载则会先行加载
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @memberof AudioManager
     */
    AudioManager.prototype.playSound = function (params) {
        // 判断静音
        if (this.muteSound)
            return;
        // 停止其他音频
        if (params.stopOthers) {
            this.stopAllSound();
            this.stopAllMusics();
        }
        this._soundImpl.play(params);
    };
    /**
     * 跳转Sound音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioManager
     */
    AudioManager.prototype.seekSound = function (url, time) {
        this._soundImpl.seek(url, time);
    };
    /**
     * 停止Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.stopSound = function (url) {
        this._soundImpl.stop(url);
    };
    /**
     * 暂停Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.pauseSound = function (url) {
        this._soundImpl.pause(url);
    };
    /**
     * 停止所有Sound音频
     *
     * @memberof AudioManager
     */
    AudioManager.prototype.stopAllSound = function () {
        this._soundImpl.stopAll();
    };
    /**
     * 注册Music音频实现对象
     *
     * @param {IAudio} musicImpl Music音频实现对象
     * @memberof AudioManager
     */
    AudioManager.prototype.registerMusicImpl = function (musicImpl) {
        this._musicImpl = musicImpl;
    };
    Object.defineProperty(AudioManager.prototype, "muteMusic", {
        /**
         * 获取或设置Music类型音频静音属性
         *
         * @type {boolean}
         * @memberof AudioManager
         */
        get: function () {
            return this._musicImpl.mute;
        },
        set: function (value) {
            if (value === this._musicImpl.mute)
                return;
            this._musicImpl.mute = value;
            // 持久化
            var shell = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            shell.localStorageSet(AudioManager_1.STORAGE_KEY_MUTE_MUSIC, value + "");
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.loadMusic = function (url) {
        this._musicImpl.load(url);
    };
    /**
     * 播放Music音频，如果没有加载则会先行加载
     *
     * @param {AudioPlayParams} [params] 音频参数
     * @memberof AudioManager
     */
    AudioManager.prototype.playMusic = function (params) {
        // 判断静音
        if (this.muteMusic)
            return;
        // 停止其他音频
        if (params.stopOthers) {
            this.stopAllSound();
            this.stopAllMusics();
        }
        this._musicImpl.play(params);
    };
    /**
     * 跳转Music音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioManager
     */
    AudioManager.prototype.seekMusic = function (url, time) {
        this._musicImpl.seek(url, time);
    };
    /**
     * 停止Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.stopMusic = function (url) {
        this._musicImpl.stop(url);
    };
    /**
     * 暂停Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.pauseMusic = function (url) {
        this._musicImpl.pause(url);
    };
    /**
     * 停止所有Music音频
     *
     * @memberof AudioManager
     */
    AudioManager.prototype.stopAllMusics = function () {
        this._musicImpl.stopAll();
    };
    AudioManager.STORAGE_KEY_MUTE_SOUND = "AudioManager::muteSound";
    AudioManager.STORAGE_KEY_MUTE_MUSIC = "AudioManager::muteMusic";
    AudioManager = AudioManager_1 = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __metadata */]("design:paramtypes", [])
    ], AudioManager);
    return AudioManager;
    var AudioManager_1;
}());
/* harmony default export */ __webpack_exports__["default"] = (AudioManager);
/** 再额外导出一个单例 */
var audioManager = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(AudioManager);


/***/ }),
/* 73 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export shell */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__audio_AudioTagImpl__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Environment__ = __webpack_require__(5);






/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-23
 * @modify date 2017-10-23
 *
 * 外壳接口，该类既作为外壳接口的注入基类，也作为标准浏览器的实现使用
*/
var Shell = /** @class */ (function () {
    function Shell() {
    }
    Object.defineProperty(Shell.prototype, "proxy", {
        /**
         * 设置外壳代理，如果条件命中了该代理类型，则生成该代理实例并替代外壳行为
         *
         * @memberof Shell
         */
        set: function (value) {
            if (value.hit)
                this._proxy = new value();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Shell.prototype, "type", {
        /**
         * 获取当前外壳类型
         *
         * @readonly
         * @type {string}
         * @memberof Shell
         */
        get: function () {
            if (this._proxy)
                return this._proxy.type;
            else
                return "web";
        },
        enumerable: true,
        configurable: true
    });
    /*************************** 下面是页面跳转接口 ***************************/
    /**
     * 刷新页面
     *
     * @param {{
     *         forcedReload?:boolean, // false表示允许从缓存取，true表示强制从服务器取，默认是false
     *         url?:string, // 传递则使用新URL刷新页面
     *         replace?:boolean // 如果有新url，则表示是否要替换当前浏览历史
     *     }} [params]
     * @memberof Shell
     */
    Shell.prototype.reload = function (params) {
        if (this._proxy) {
            this._proxy.reload(params);
        }
        else {
            if (!params)
                window.location.reload();
            else if (!params.url)
                window.location.reload(params.forcedReload);
            else if (!params.replace)
                window.location.href = params.url;
            else
                window.location.replace(params.url);
        }
    };
    /**
     * 打开一个新页面
     *
     * @param {{
     *         url?:string, // 新页面地址，不传则不更新地址
     *         name?:string, // 给新页面命名，或导航到已有页面
     *         replace?:boolean, // 是否替换当前浏览历史条目，默认false
     *         features:{[key:string]:any} // 其他可能的参数
     *     }} [params]
     * @memberof Shell
     */
    Shell.prototype.open = function (params) {
        if (this._proxy) {
            this._proxy.open(params);
        }
        else {
            if (!params) {
                window.open();
            }
            else {
                var features = undefined;
                if (params.features) {
                    features = [];
                    for (var key in params.features) {
                        features.push(key + "=" + params.features[key]);
                    }
                }
                window.open(params.url, params.name, features && features.join(","), params.replace);
            }
        }
    };
    /**
     * 关闭窗口
     *
     * @memberof Shell
     */
    Shell.prototype.close = function () {
        if (this._proxy)
            this._proxy.close();
        else
            window.close();
    };
    /*************************** 下面是本地存储接口 ***************************/
    /**
     * 获取本地存储
     *
     * @param {string} key 要获取值的键
     * @returns {string} 获取的值
     * @memberof Shell
     */
    Shell.prototype.localStorageGet = function (key) {
        if (this._proxy)
            return this._proxy.localStorageGet(key);
        else
            return window.localStorage.getItem(key);
    };
    /**
     * 设置本地存储
     *
     * @param {string} key 要设置的键
     * @param {string} value 要设置的值
     * @memberof Shell
     */
    Shell.prototype.localStorageSet = function (key, value) {
        if (this._proxy)
            this._proxy.localStorageSet(key, value);
        else
            window.localStorage.setItem(key, value);
    };
    /**
     * 移除本地存储
     *
     * @param {string} key 要移除的键
     * @memberof Shell
     */
    Shell.prototype.localStorageRemove = function (key) {
        if (this._proxy)
            this._proxy.localStorageRemove(key);
        else
            window.localStorage.removeItem(key);
    };
    /**
     * 清空本地存储
     *
     * @memberof Shell
     */
    Shell.prototype.localStorageClear = function () {
        if (this._proxy)
            this._proxy.localStorageClear();
        else
            window.localStorage.clear();
    };
    Shell = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_1__core_injector_Injector__["Injectable"]
    ], Shell);
    return Shell;
}());
/* harmony default export */ __webpack_exports__["a"] = (Shell);
/**
 * 这是Shell在微信浏览器下的一个变形代理
 *
 * @class ShellWX
 * @extends {Shell}
 */
var ShellWX = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](ShellWX, _super);
    function ShellWX() {
        var _this = _super.call(this) || this;
        // 用来记录加载微信js间隙的音频加载请求
        var loadCache = [];
        var loadFlag = false;
        // 变异AudioTagImpl，在微信里的Audio标签需要从微信触发加载
        var oriLoad = __WEBPACK_IMPORTED_MODULE_4__audio_AudioTagImpl__["a" /* default */].prototype.load;
        __WEBPACK_IMPORTED_MODULE_4__audio_AudioTagImpl__["a" /* default */].prototype.load = function (url) {
            var _this = this;
            // 第一次进行了音频加载，如果还没加载过js，则去加载之
            if (!loadFlag) {
                loadFlag = true;
                // 去加载微信js
                __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__["b" /* assetsManager */].loadJsFiles([{
                        url: "http://res.wx.qq.com/open/js/jweixin-1.2.0.js",
                        mode: __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__["a" /* JSLoadMode */].TAG
                    }], function (err) {
                    if (err) {
                        // 发生错误了，恢复原始的操作
                        __WEBPACK_IMPORTED_MODULE_4__audio_AudioTagImpl__["a" /* default */].prototype.load = oriLoad;
                        // 移除闭包数据
                        oriLoad = null;
                    }
                    // 重新启动缓存的加载请求
                    for (var _i = 0, loadCache_1 = loadCache; _i < loadCache_1.length; _i++) {
                        var cache = loadCache_1[_i];
                        cache[1].load(cache[0]);
                    }
                    // 移除闭包数据
                    loadCache = null;
                });
            }
            // 处理url
            var toUrl = __WEBPACK_IMPORTED_MODULE_5__Environment__["environment"].toCDNHostURL(url);
            // 尝试获取缓存数据
            var data = this._audioCache[toUrl];
            // 如果没有缓存才去加载
            if (!data || data.__from_cache__) {
                // 先调用原始方法，否则行为就变了
                if (!data)
                    oriLoad.call(this, url);
                else
                    delete data.__from_cache__;
                // 如果js还没加载好则等待加载
                if (!window["wx"]) {
                    loadCache.push([url, this]);
                    // 这里记录一个从缓存来的标记
                    data = this._audioCache[toUrl];
                    data.__from_cache__ = true;
                    return;
                }
                // 从微信里触发加载操作
                window["wx"].checkJsApi({
                    jsApiList: ["checkJsApi"],
                    success: function () {
                        var data = _this._audioCache[toUrl];
                        var node = data.node;
                        node.load();
                    }
                });
            }
        };
        return _this;
    }
    Object.defineProperty(ShellWX, "hit", {
        get: function () {
            return (window.top === window &&
                /MicroMessenger/i.test(navigator.userAgent));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ShellWX.prototype, "type", {
        get: function () {
            return "weixin";
        },
        enumerable: true,
        configurable: true
    });
    ShellWX.prototype.close = function () {
        window["WeixinJSBridge"].invoke("closeWindow");
    };
    return ShellWX;
}(Shell));
/** 再额外导出一个单例 */
var shell = __WEBPACK_IMPORTED_MODULE_2__core_Core__["a" /* core */].getInject(Shell);
/** 尝试添加微信外壳代理 */
shell.proxy = ShellWX;


/***/ }),
/* 74 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__AudioMessage__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__system_System__ = __webpack_require__(25);





/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 使用AudioContext实现IAudio接口的实现类
*/
var AudioContextImpl = /** @class */ (function () {
    function AudioContextImpl() {
        var _this = this;
        this._mute = false;
        this._playingDict = {};
        this._inited = false;
        this._audioCache = {};
        this._context = new (window["AudioContext"] || window["webkitAudioContext"])();
        var onInit = function () {
            window.removeEventListener("touchstart", onInit);
            window.removeEventListener("mousedown", onInit);
            // 生成一个空的音频，播放并停止，用以解除限制
            var source = _this._context.createBufferSource();
            source.buffer = _this._context.createBuffer(1, 1, 44100);
            source.connect(_this._context.destination);
            source.start();
            source.stop();
            // 设置标识符
            _this._inited = true;
            // 如果当前有正在播放的音频，全部再播放一次
            for (var url in _this._audioCache) {
                var data = _this._audioCache[url];
                if (data.status == AudioStatus.PLAYING) {
                    // 停止播放
                    _this.stop(data.playParams.url);
                    // 重新播放
                    _this.play(data.playParams);
                }
            }
        };
        window.addEventListener("touchstart", onInit);
        window.addEventListener("mousedown", onInit);
    }
    Object.defineProperty(AudioContextImpl.prototype, "mute", {
        /**
         * 静音状态
         *
         * @type {boolean}
         * @memberof AudioTagImpl
         */
        get: function () {
            return this._mute;
        },
        set: function (value) {
            this._mute = value;
            // 静音，暂停所有声音
            for (var url in this._playingDict) {
                if (value) {
                    // 静音，停止音频，不可调用stop方法，因为要保持播放中的音频状态
                    this._doStop(url);
                }
                else {
                    // 非静音，播放音频
                    var params = this._playingDict[url];
                    this.play(params);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载音频
     *
     * @param {string} url 音频地址
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.load = function (url) {
        var _this = this;
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        // 如果没有缓存才去加载
        if (!data) {
            // 使用AudioContext加载
            this._audioCache[toUrl] = data = { buffer: null, status: AudioStatus.LOADING, playParams: null, progress: null };
            // 开始加载
            __WEBPACK_IMPORTED_MODULE_0__assets_AssetsManager__["b" /* assetsManager */].loadAssets(toUrl, function (result) {
                if (result instanceof ArrayBuffer) {
                    _this._context.decodeAudioData(result, function (buffer) {
                        data.buffer = buffer;
                        // 设置状态
                        data.status = AudioStatus.PAUSED;
                        // 如果自动播放则播放
                        if (data.playParams)
                            _this.play(data.playParams);
                    });
                }
            }, "arraybuffer");
        }
    };
    /**
     * 播放音频，如果音频没有加载则先加载再播放
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @returns {void}
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.play = function (params) {
        var _this = this;
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(params.url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        if (!data) {
            // 没有加载过，开始加载音频
            this.load(params.url);
            // 设置播放参数
            this._audioCache[toUrl].playParams = params;
        }
        else {
            switch (data.status) {
                case AudioStatus.LOADING:
                    // 正在加载中，替换自动播放参数
                    data.playParams = params;
                    break;
                case AudioStatus.PLAYING:
                    // 正在播放，关闭后再播放
                    this.stop(params.url);
                    this.play(params);
                    break;
                case AudioStatus.PAUSED:
                    // 设置状态
                    data.status = AudioStatus.PLAYING;
                    // 记录播放中
                    this._playingDict[toUrl] = params;
                    // 已经加载完毕，直接播放
                    if (this._inited) {
                        data.node = this._context.createBufferSource();
                        data.node.buffer = data.buffer;
                        if (params.loop != null)
                            data.node.loop = params.loop;
                        data.node.connect(this._context.destination);
                        // 监听播放完毕
                        data.node.onended = function () {
                            var data = _this._audioCache[toUrl];
                            if (data) {
                                // 停止播放
                                _this.stop(params.url);
                                // 派发播放完毕事件
                                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_ENDED, params.url);
                            }
                        };
                        // 开始播放，优先取参数中的时间，没有就取默认开始时间
                        var playTime;
                        if (params && params.time != null)
                            playTime = params.time * 0.001;
                        else
                            playTime = data.playTime;
                        delete data.playTime;
                        data.node.start(playTime);
                        // 开始播放进度监测
                        var lastTime = this._context.currentTime;
                        var curTime = playTime || 0;
                        data.progress = __WEBPACK_IMPORTED_MODULE_4__system_System__["a" /* system */].enterFrame(function () {
                            var nowTime = _this._context.currentTime;
                            var deltaTime = nowTime - lastTime;
                            lastTime = nowTime;
                            if (data.status == AudioStatus.PLAYING) {
                                curTime += deltaTime * 1000;
                                var totalTime = data.node.buffer.duration * 1000;
                                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_PROGRESS, params.url, curTime, totalTime);
                            }
                        });
                        // 派发播放开始事件
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_STARTED, params.url);
                    }
                    break;
            }
        }
    };
    AudioContextImpl.prototype._doStop = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            // 设置状态
            data.status = AudioStatus.PAUSED;
            // 取消进度监测
            if (data.progress)
                data.progress.cancel();
            // 结束播放
            if (data.node) {
                data.node.stop(time);
                // 派发播放停止事件
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_STOPPED, url);
            }
        }
    };
    /**
     * 暂停音频（不会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.pause = function (url) {
        this._doStop(url);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止音频（会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.stop = function (url) {
        this._doStop(url, 0);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止所有音频
     *
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.stopAll = function () {
        for (var url in this._audioCache) {
            this.stop(url);
        }
    };
    /**
     * 跳转音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.seek = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_3__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            var params = data.playParams;
            if (data.status == AudioStatus.PLAYING) {
                // 停止重新播放
                this.stop(url);
                params.time = time;
                this.play(params);
            }
            else {
                data.playTime = time;
            }
        }
    };
    return AudioContextImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioContextImpl);
var AudioStatus;
(function (AudioStatus) {
    /**
     * 加载中
     */
    AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
    /**
     * 已暂停
     */
    AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
    /**
     * 播放中
     */
    AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
})(AudioStatus || (AudioStatus = {}));


/***/ }),
/* 75 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(51), __webpack_require__(35), __webpack_require__(77)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, TestResponse_1, RequestData_1, HTTPRequestPolicy_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var TestRequest = /** @class */ (function (_super) {
        __extends(TestRequest, _super);
        function TestRequest() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.__policy = HTTPRequestPolicy_1.default;
            return _this;
        }
        Object.defineProperty(TestRequest.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    path: "/test",
                    protocol: "http",
                    response: TestResponse_1.default,
                    data: {
                        test: this.test // string - 测试
                    }
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        return TestRequest;
    }(RequestData_1.default));
    exports.default = TestRequest;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJlcXVlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUZXN0UmVxdWVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0lBS0E7Ozs7OztNQU1FO0lBQ0Y7UUFBeUMsK0JBQVc7UUFBcEQ7WUFBQSxxRUF1QkM7WUFEVSxjQUFRLEdBQWtCLDJCQUFNLENBQUM7O1FBQzVDLENBQUM7UUFiRyxzQkFBVyxpQ0FBUTtpQkFBbkI7Z0JBRUksTUFBTSxDQUFDO29CQUNILElBQUksRUFBRSxNQUFNO29CQUNyQixJQUFJLEVBQUUsT0FBTztvQkFDSixRQUFRLEVBQUUsTUFBTTtvQkFDaEIsUUFBUSxFQUFFLHNCQUFZO29CQUN0QixJQUFJLEVBQUU7d0JBQ0YsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUEsY0FBYztxQkFDaEM7aUJBQ0osQ0FBQztZQUNOLENBQUM7OztXQUFBO1FBQUEsQ0FBQztRQUVOLGtCQUFDO0lBQUQsQ0FBQyxBQXZCRCxDQUF5QyxxQkFBVyxHQXVCbkQifQ==

/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(44)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, DataType_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var Test = /** @class */ (function (_super) {
        __extends(Test, _super);
        function Test() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Test.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.test = data.test;
        };
        Test.prototype.pack = function () {
            return {
                test: this.test
            };
        };
        return Test;
    }(DataType_1.default));
    exports.default = Test;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztJQUVBOzs7Ozs7TUFNRTtJQUNGO1FBQWtDLHdCQUFRO1FBQTFDOztRQXNCQSxDQUFDO1FBWmEsc0JBQU8sR0FBakIsVUFBa0IsSUFBUTtZQUV0QixFQUFFLENBQUEsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDO2dCQUFDLE1BQU0sQ0FBQztZQUN4QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDMUIsQ0FBQztRQUVNLG1CQUFJLEdBQVg7WUFFSSxNQUFNLENBQUM7Z0JBQ0gsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO2FBQ2xCLENBQUM7UUFDTixDQUFDO1FBQ0wsV0FBQztJQUFELENBQUMsQUF0QkQsQ0FBa0Msa0JBQVEsR0FzQnpDIn0=

/***/ }),
/* 77 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPRequestPolicy", function() { return HTTPRequestPolicy; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_HTTPUtil__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__NetManager__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ObjectUtil__ = __webpack_require__(3);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * HTTP请求策略
*/
var HTTPRequestPolicy = /** @class */ (function () {
    function HTTPRequestPolicy() {
    }
    /**
     * 发送请求逻辑
     *
     * @param {RequestData} request 请求数据
     * @memberof HTTPRequestPolicy
     */
    HTTPRequestPolicy.prototype.sendRequest = function (request) {
        // 取到参数
        var params = request.__params;
        // 修改数据
        var httpParams = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ObjectUtil__["b" /* extendObject */])({
            url: __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toHostURL(params.path, params.hostIndex),
            onResponse: function (result) { return __WEBPACK_IMPORTED_MODULE_2__NetManager__["netManager"].__onResponse(request.__params.response.type, result, request); },
            onError: function (err) { return __WEBPACK_IMPORTED_MODULE_2__NetManager__["netManager"].__onError(request.__params.response.type, err, request); },
            headerDict: {}
        }, params);
        // 发送
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_HTTPUtil__["a" /* load */])(httpParams);
    };
    return HTTPRequestPolicy;
}());

/** 再额外导出一个实例 */
/* harmony default export */ __webpack_exports__["default"] = (new HTTPRequestPolicy());


/***/ }),
/* 78 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(8), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Mediator_1, Injector_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestComp = /** @class */ (function (_super) {
        __extends(TestComp, _super);
        function TestComp() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TestComp.prototype.onOpen = function () {
            this.skin.x = 100;
            this.skin.y = 100;
            this.parent.skin.addChild(this.skin);
            this.dispatch("TestCompMsg");
        };
        TestComp.prototype.onDispose = function () {
            this.parent.skin.removeChild(this.skin);
        };
        TestComp = __decorate([
            Injector_1.EgretMediatorClass("TestComp", "TestCompSkin")
        ], TestComp);
        return TestComp;
    }(Mediator_1.default));
    exports.default = TestComp;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdENvbXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUZXN0Q29tcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBSUE7UUFBc0MsNEJBQVE7UUFBOUM7O1FBZUEsQ0FBQztRQWJVLHlCQUFNLEdBQWI7WUFFSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQ2xCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUNqQyxDQUFDO1FBRU0sNEJBQVMsR0FBaEI7WUFFSSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLENBQUM7UUFkZ0IsUUFBUTtZQUQ1Qiw2QkFBa0IsQ0FBQyxVQUFVLEVBQUUsY0FBYyxDQUFDO1dBQzFCLFFBQVEsQ0FlNUI7UUFBRCxlQUFDO0tBQUEsQUFmRCxDQUFzQyxrQkFBUSxHQWU3QztzQkFmb0IsUUFBUSJ9

/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(18), __webpack_require__(7), __webpack_require__(8), __webpack_require__(10), __webpack_require__(54)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Injector_2, Mediator_1, ModuleManager_1, TestPanel_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestForMediator = /** @class */ (function (_super) {
        __extends(TestForMediator, _super);
        function TestForMediator(skin) {
            return _super.call(this, skin) || this;
        }
        TestForMediator.prototype.onOpen = function (data) {
            this.viewModel = {
                data: data,
                onClickText: function () {
                    ModuleManager_1.moduleManager.open(TestPanel_1.default);
                }
            };
            console.log("asdfasdf - " + data);
        };
        __decorate([
            Injector_2.BindOn("click", "onClickText"),
            __metadata("design:type", Object)
        ], TestForMediator.prototype, "skin", void 0);
        __decorate([
            Injector_2.BindValue({ innerHTML: "'这是替换后的渲染器内层 - ' + data.fuck + '<br/>'" }),
            __metadata("design:type", HTMLElement)
        ], TestForMediator.prototype, "asdf", void 0);
        TestForMediator = __decorate([
            Injector_1.DOMMediatorClass("TestForMediator", "<div>这是替换后的渲染器外层<div id='asdf'></div></div>"),
            __metadata("design:paramtypes", [Object])
        ], TestForMediator);
        return TestForMediator;
    }(Mediator_1.default));
    exports.default = TestForMediator;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdEZvck1lZGlhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdEZvck1lZGlhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFPQTtRQUE2QyxtQ0FBUTtRQVFqRCx5QkFBbUIsSUFBSTttQkFFbkIsa0JBQU0sSUFBSSxDQUFDO1FBQ2YsQ0FBQztRQUVNLGdDQUFNLEdBQWIsVUFBYyxJQUFJO1lBRWQsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDYixJQUFJLEVBQUUsSUFBSTtnQkFDVixXQUFXLEVBQUU7b0JBQ1QsNkJBQWEsQ0FBQyxJQUFJLENBQUMsbUJBQVMsQ0FBQyxDQUFDO2dCQUNsQyxDQUFDO2FBQ0osQ0FBQTtZQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQ3RDLENBQUM7UUFuQkQ7WUFEQyxpQkFBTSxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUM7O3FEQUNmO1FBR2hCO1lBREMsb0JBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSx3Q0FBd0MsRUFBQyxDQUFDO3NDQUNyRCxXQUFXO3FEQUFDO1FBTlAsZUFBZTtZQURuQywyQkFBZ0IsQ0FBQyxpQkFBaUIsRUFBRSw2Q0FBNkMsQ0FBQzs7V0FDOUQsZUFBZSxDQXVCbkM7UUFBRCxzQkFBQztLQUFBLEFBdkJELENBQTZDLGtCQUFRLEdBdUJwRDtzQkF2Qm9CLGVBQWUifQ==

/***/ }),
/* 80 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__PanelManager__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mediator_MediatorMessage__ = __webpack_require__(24);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 实现了IPanel接口的弹窗中介者基类
*/
var PanelMediator = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](PanelMediator, _super);
    function PanelMediator(skin, policy) {
        var _this = _super.call(this, skin) || this;
        _this.policy = policy;
        return _this;
    }
    PanelMediator.prototype.__afterOnOpen = function (data, isModel, from) {
        __WEBPACK_IMPORTED_MODULE_2__PanelManager__["a" /* panelManager */].pop(this, data, isModel, from);
    };
    PanelMediator.prototype.__afterOnClose = function (data, to) {
        var _this = this;
        // 篡改onAfterDrop，等待关闭动画结束后再执行
        var oriOnAfterDrop = this.onAfterDrop;
        this.onAfterDrop = function (data, to) {
            oriOnAfterDrop.call(_this, data, to);
            // 派发关闭事件
            _this.dispatch(__WEBPACK_IMPORTED_MODULE_3__mediator_MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, _this);
        };
        __WEBPACK_IMPORTED_MODULE_2__PanelManager__["a" /* panelManager */].drop(this, data, to);
    };
    /** 在弹出前调用的方法 */
    PanelMediator.prototype.onBeforePop = function (data, isModel, from) {
        // 可重写
    };
    /** 在弹出后调用的方法 */
    PanelMediator.prototype.onAfterPop = function (data, isModel, from) {
        // 可重写
    };
    /** 在关闭前调用的方法 */
    PanelMediator.prototype.onBeforeDrop = function (data, to) {
        // 可重写
    };
    /** 在关闭后调用的方法 */
    PanelMediator.prototype.onAfterDrop = function (data, to) {
        // 可重写
    };
    return PanelMediator;
}(__WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (PanelMediator);


/***/ }),
/* 81 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(52), __webpack_require__(49), __webpack_require__(14), __webpack_require__(2), __webpack_require__(10), __webpack_require__(7), __webpack_require__(18), __webpack_require__(54)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Second_1, FuckModel_1, SceneMediator_1, Injector_1, ModuleManager_1, Injector_2, Injector_3, TestPanel_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试首个模块
    */
    var Third = /** @class */ (function (_super) {
        __extends(Third, _super);
        function Third() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Third_1 = Third;
        Third.prototype.listAssets = function () {
            return ["./modules/test.html"];
        };
        Third.prototype.onOpen = function () {
            var _this = this;
            this.viewModel = {
                fuckList: [1, 2, "shit", "you"],
                fuckText: "fuck you",
                onClickBtn: function () {
                    _this.viewModel.fuckText = "clicked";
                    _this.moduleManager.open(Second_1.default, null, true);
                },
                onClickText: function () {
                    _this.moduleManager.open(TestPanel_1.default);
                },
                onClickFuck: function () {
                    _this.moduleManager.close(Third_1);
                },
                fuckModel: this.fuckModel1
            };
        };
        Third.moduleName = "Third";
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", ModuleManager_1.default)
        ], Third.prototype, "moduleManager", void 0);
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", FuckModel_1.default)
        ], Third.prototype, "fuckModel1", void 0);
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], Third.prototype, "fuckModel2", void 0);
        __decorate([
            Injector_1.Inject(1),
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], Third.prototype, "fuckModel3", void 0);
        __decorate([
            Injector_2.BindOn({ click: "onClickBtn" }),
            Injector_2.BindIf("fuckText == '1234'"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "btn", void 0);
        __decorate([
            Injector_2.BindFor("fuck in fuckList"),
            Injector_2.BindValue({ textContent: "fuck + ' - ' + fuckText + ' - 1'" }),
            Injector_2.BindOn("click", "onClickText"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "txt", void 0);
        __decorate([
            Injector_2.BindOn("click", "onClickFuck"),
            Injector_2.BindValue("textContent", "fuckModel.fuck"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "fuck", void 0);
        Third = Third_1 = __decorate([
            Injector_3.DOMMediatorClass("Third", "./modules/test.html")
        ], Third);
        return Third;
        var Third_1;
    }(SceneMediator_1.default));
    exports.default = Third;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGhpcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUaGlyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBYUE7Ozs7Ozs7TUFPRTtJQUdGO1FBQW1DLHlCQUFhO1FBQWhEOztRQStDQSxDQUFDO2tCQS9Db0IsS0FBSztRQXdCZiwwQkFBVSxHQUFqQjtZQUVJLE1BQU0sQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDbkMsQ0FBQztRQUVNLHNCQUFNLEdBQWI7WUFBQSxpQkFpQkM7WUFmRyxJQUFJLENBQUMsU0FBUyxHQUFHO2dCQUNiLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQztnQkFDL0IsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLFVBQVUsRUFBRTtvQkFDUixLQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsR0FBRyxTQUFTLENBQUM7b0JBQ3BDLEtBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLGdCQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO2dCQUNoRCxDQUFDO2dCQUNELFdBQVcsRUFBRTtvQkFDVCxLQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxtQkFBUyxDQUFDLENBQUM7Z0JBQ3ZDLENBQUM7Z0JBQ0QsV0FBVyxFQUFFO29CQUNULEtBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE9BQUssQ0FBQyxDQUFDO2dCQUNwQyxDQUFDO2dCQUNELFNBQVMsRUFBRSxJQUFJLENBQUMsVUFBVTthQUM3QixDQUFDO1FBQ04sQ0FBQztRQTVDYSxnQkFBVSxHQUFVLE9BQU8sQ0FBQztRQUcxQztZQURDLGlCQUFNO3NDQUNlLHVCQUFhO29EQUFDO1FBRXBDO1lBREMsaUJBQU07c0NBQ1ksbUJBQVM7aURBQUM7UUFFN0I7WUFEQyxpQkFBTTtzQ0FDWSxzQkFBVTtpREFBQztRQUU5QjtZQURDLGlCQUFNLENBQUMsQ0FBQyxDQUFDO3NDQUNTLHNCQUFVO2lEQUFDO1FBSTlCO1lBRkMsaUJBQU0sQ0FBQyxFQUFDLEtBQUssRUFBRSxZQUFZLEVBQUMsQ0FBQztZQUM3QixpQkFBTSxDQUFDLG9CQUFvQixDQUFDO3NDQUNsQixXQUFXOzBDQUFBO1FBSXRCO1lBSEMsa0JBQU8sQ0FBQyxrQkFBa0IsQ0FBQztZQUMzQixvQkFBUyxDQUFDLEVBQUMsV0FBVyxFQUFFLGtDQUFrQyxFQUFDLENBQUM7WUFDNUQsaUJBQU0sQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDO3NDQUNwQixXQUFXOzBDQUFDO1FBR3ZCO1lBRkMsaUJBQU0sQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDO1lBQzlCLG9CQUFTLENBQUMsYUFBYSxFQUFFLGdCQUFnQixDQUFDO3NDQUMvQixXQUFXOzJDQUFDO1FBdEJQLEtBQUs7WUFEekIsMkJBQWdCLENBQUMsT0FBTyxFQUFFLHFCQUFxQixDQUFDO1dBQzVCLEtBQUssQ0ErQ3pCO1FBQUQsWUFBQzs7S0FBQSxBQS9DRCxDQUFtQyx1QkFBYSxHQStDL0M7c0JBL0NvQixLQUFLIn0=

/***/ }),
/* 82 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine_Engine__ = __webpack_require__(83);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "core", function() { return __WEBPACK_IMPORTED_MODULE_1__core_Core__["a"]; });


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * Olympus框架便捷启动与框架外观模块
*/
var Olympus = /** @class */ (function () {
    function Olympus() {
    }
    /**
     * 启动Olympus框架
     *
     * @static
     * @param {IInitParams} params 启动参数
     * @memberof Olympus
     */
    Olympus.startup = function (params) {
        // 初始化引擎模块
        __WEBPACK_IMPORTED_MODULE_0__engine_Engine__["a" /* engine */].initialize(params);
    };
    return Olympus;
}());
/* harmony default export */ __webpack_exports__["default"] = (Olympus);


/***/ }),
/* 83 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return engine; });
/* unused harmony export InitStep */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeMessage__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__module_ModuleManager__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__env_Hash__ = __webpack_require__(50);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__version_Version__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__message_EngineMessage__ = __webpack_require__(48);












/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * Engine模组是开发框架的引擎部分，包括业务模块系统、应用程序启动和初始化、弹窗和场景管理器等与项目开发相关的逻辑都在这个模组中
 * 这个模组的逻辑都高度集成在子模组中了，因此也只是收集相关子模组
*/
var Engine = /** @class */ (function () {
    function Engine() {
    }
    /**
     * 初始化Engine
     *
     * @param {IInitParams} params 初始化参数
     * @memberof Engine
     */
    Engine.prototype.initialize = function (params) {
        var self = this;
        // 调用进度回调，初始化为0%
        params.onInitProgress && params.onInitProgress(0, InitStep.ReadyToInit);
        // 执行初始化
        if (document.readyState == "loading")
            document.addEventListener("readystatechange", doInitialize);
        else
            doInitialize();
        function doInitialize() {
            // 调用进度回调，开始初始化为10%
            params.onInitProgress && params.onInitProgress(0.1, InitStep.StartInit);
            // 移除事件
            if (this == document)
                document.removeEventListener("readystatechange", doInitialize);
            // 要判断document是否初始化完毕
            self._initParams = params;
            // 加载页
            self._loadElement = (typeof params.loadElement == "string" ? document.querySelector(params.loadElement) : params.loadElement);
            // 监听错误事件
            if (params.onError)
                self.listenError(params.onError);
            // 初始化环境参数
            __WEBPACK_IMPORTED_MODULE_7__env_Environment__["environment"].initialize(params.env, params.hostsDict, params.cdnsDict);
            // 初始化版本号工具
            __WEBPACK_IMPORTED_MODULE_9__version_Version__["a" /* version */].initialize(function () {
                // 调用进度回调，版本号初始化完毕为20%
                params.onInitProgress && params.onInitProgress(0.2, InitStep.VersionInited);
                // 监听Bridge初始化完毕事件，显示第一个模块
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_4__bridge_BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT, self.onAllBridgesInit, self);
                // 注册并初始化表现层桥实例
                __WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */].registerBridge.apply(__WEBPACK_IMPORTED_MODULE_3__bridge_BridgeManager__["a" /* bridgeManager */], params.bridges);
            }, params.version);
        }
    };
    /**
     * 添加错误监听函数
     *
     * @param {(evt?:ErrorEvent)=>void} handler 错误监听函数
     * @memberof Engine
     */
    Engine.prototype.listenError = function (handler) {
        if (handler)
            window.addEventListener("error", handler);
    };
    Engine.prototype.onAllBridgesInit = function () {
        var _this = this;
        // 调用进度回调，表现层桥初始化完毕为30%
        this._initParams.onInitProgress && this._initParams.onInitProgress(0.3, InitStep.BridgesInited);
        // 注销监听
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].unlisten(__WEBPACK_IMPORTED_MODULE_4__bridge_BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT, this.onAllBridgesInit, this);
        // 初始化插件
        if (this._initParams.plugins) {
            for (var _i = 0, _a = this._initParams.plugins; _i < _a.length; _i++) {
                var plugin = _a[_i];
                plugin.initPlugin();
            }
        }
        // 注册短名称
        __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["b" /* assetsManager */].configPath(this._initParams.pathDict);
        // 开始预加载过程
        var preloads = this._initParams.preloads;
        if (preloads) {
            // 去加载
            var curIndex = 0;
            var totalCount = preloads.length;
            __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["b" /* assetsManager */].loadAssets(preloads, this.onPreloadOK.bind(this), null, function (key, value) {
                curIndex++;
                // 调用进度回调，每个预加载文件平分30%-90%的进度
                var progress = 0.3 + 0.6 * curIndex / totalCount;
                // 保留2位小数
                progress = Math.round(progress * 100) * 0.01;
                _this._initParams.onInitProgress && _this._initParams.onInitProgress(progress, InitStep.Preload, key, value);
            });
        }
        else {
            // 没有预加载，直接完成
            this.onPreloadOK();
        }
    };
    Engine.prototype.onPreloadOK = function () {
        // 调用进度回调，打开首个模块为90%
        this._initParams.onInitProgress && this._initParams.onInitProgress(0.9, InitStep.OpenFirstModule);
        // 派发事件
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_11__message_EngineMessage__["a" /* default */].INITIALIZED);
        // 调用初始化完成回调
        this._initParams.onInited && this._initParams.onInited();
        // 监听首个模块开启
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__["default"].MODULE_CHANGE, this.onModuleChange, this);
        // 打开首个模块
        __WEBPACK_IMPORTED_MODULE_5__module_ModuleManager__["moduleManager"].open(this._initParams.firstModule, __WEBPACK_IMPORTED_MODULE_8__env_Hash__["hash"].firstModuleParams);
        // 如果有哈希模块则打开之
        for (var i in __WEBPACK_IMPORTED_MODULE_8__env_Hash__["hash"].moduleDatas) {
            var data = __WEBPACK_IMPORTED_MODULE_8__env_Hash__["hash"].moduleDatas[i];
            // 如果模块没有名字则不进行操作
            if (data.name)
                __WEBPACK_IMPORTED_MODULE_5__module_ModuleManager__["moduleManager"].open(data.name, data.params, data.direct);
        }
    };
    Engine.prototype.onModuleChange = function (from) {
        // 调用进度回调，全部过程完毕，100%
        this._initParams.onInitProgress && this._initParams.onInitProgress(1, InitStep.Inited);
        // 注销监听
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].unlisten(__WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__["default"].MODULE_CHANGE, this.onModuleChange, this);
        // 移除loadElement显示
        if (this._loadElement) {
            var parent = this._loadElement.parentElement;
            parent && parent.removeChild(this._loadElement);
        }
    };
    Engine = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Engine);
    return Engine;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Engine);
/** 再额外导出一个单例 */
var engine = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Engine);
var InitStep;
(function (InitStep) {
    /** 框架已准备好初始化 */
    InitStep[InitStep["ReadyToInit"] = 0] = "ReadyToInit";
    /** 开始执行初始化 */
    InitStep[InitStep["StartInit"] = 1] = "StartInit";
    /** 版本号系统初始化完毕 */
    InitStep[InitStep["VersionInited"] = 2] = "VersionInited";
    /** 表现层桥初始化完毕 */
    InitStep[InitStep["BridgesInited"] = 3] = "BridgesInited";
    /** 预加载，可能会触发多次，每次传递两个参数：预加载文件名或路径、预加载文件内容 */
    InitStep[InitStep["Preload"] = 4] = "Preload";
    /** 开始打开首个模块 */
    InitStep[InitStep["OpenFirstModule"] = 5] = "OpenFirstModule";
    /** 首个模块打开完毕，初始化流程完毕 */
    InitStep[InitStep["Inited"] = 6] = "Inited";
})(InitStep || (InitStep = {}));


/***/ }),
/* 84 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * 渲染模式枚举
*/
var RenderMode;
(function (RenderMode) {
    RenderMode[RenderMode["AUTO"] = 0] = "AUTO";
    RenderMode[RenderMode["CANVAS"] = 1] = "CANVAS";
    RenderMode[RenderMode["WEBGL"] = 2] = "WEBGL";
})(RenderMode || (RenderMode = {}));
/* harmony default export */ __webpack_exports__["a"] = (RenderMode);


/***/ }),
/* 85 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export ResourceVersionController */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_panel_PanelManager__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_platform_PlatformManager__ = __webpack_require__(86);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_olympus_r_engine_version_Version__ = __webpack_require__(23);





var ResourceVersionController = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](ResourceVersionController, _super);
    function ResourceVersionController() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ResourceVersionController.prototype.getVirtualUrl = function (url) {
        // 添加imgDomain
        url = __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__["environment"].toCDNHostURL(url);
        // 添加版本号，有哈希值就用哈希值加载，没有就用编译版本号加载
        url = __WEBPACK_IMPORTED_MODULE_4_olympus_r_engine_version_Version__["a" /* version */].wrapHashUrl(url);
        // 返回url
        return url;
    };
    return ResourceVersionController;
}(RES.VersionController));

// 这里直接注册一下
RES.registerVersionController(new ResourceVersionController());
var AssetsLoader = /** @class */ (function () {
    function AssetsLoader(handler) {
        this._retryDict = {};
        this._handler = handler;
    }
    AssetsLoader.prototype.loadGroups = function (groups) {
        // 调用回调
        this._handler.start && this._handler.start();
        // 组名如果是空字符串则会导致Egret什么都不干，所以要移除空字符串的组名
        groups = groups && groups.filter(function (group) {
            if (typeof group == "string")
                return (group != "");
            else
                return (group.name != "");
        });
        // 开始加载
        var groupDict = {};
        var pgsDict;
        var len = groups ? groups.length : 0;
        if (len == 0) {
            this._handler.complete && this._handler.complete(groupDict);
        }
        else {
            RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
            RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
            RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
            var temp = groups.concat();
            pgsDict = {};
            for (var i in groups) {
                var group = groups[i];
                if (typeof group == "string") {
                    pgsDict[group] = 0;
                    RES.loadGroup(group);
                }
                else {
                    pgsDict[group.name] = 0;
                    RES.loadGroup(group.name, group.priority);
                }
            }
        }
        function onProgress(evt) {
            // 填充资源字典
            var itemDict = groupDict[evt.groupName];
            if (!itemDict)
                groupDict[evt.groupName] = itemDict = {};
            itemDict[evt.resItem.name] = evt.resItem;
            // 计算总进度
            pgsDict[evt.groupName] = evt.itemsLoaded / evt.itemsTotal;
            var pgs = 0;
            for (var key in pgsDict) {
                pgs += pgsDict[key];
            }
            pgs /= len;
            // 回调
            this._handler.progress && this._handler.progress(evt.resItem, pgs);
        }
        function onOneComplete(evt) {
            // 调用单一完毕回调
            this._handler.oneComplete && this._handler.oneComplete(groupDict[evt.groupName]);
            // 测试是否全部完毕
            var index = temp.indexOf(evt.groupName);
            if (index >= 0) {
                // 移除加载组名
                temp.splice(index, 1);
                // 判断是否全部完成
                if (temp.length == 0) {
                    // 移除事件监听
                    RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                    // 调用回调
                    this._handler.complete && this._handler.complete(groupDict);
                }
            }
        }
        function onOneError(evt) {
            var groupName = evt.groupName;
            var retryTimes = this._retryDict[groupName];
            if (retryTimes == null)
                retryTimes = 0;
            if (retryTimes < 3) {
                this._retryDict[groupName] = ++retryTimes;
                // 打印日志
                console.warn("加载失败，重试第" + retryTimes + "次: " + groupName);
                // 没到最大重试次数，将为url添加一个随机时间戳重新加回加载队列
                RES.loadGroup(evt.groupName);
            }
            else {
                // 打印日志
                console.warn("加载失败3次，正在尝试切换CDN...");
                // 尝试切换CDN
                var allDone = __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__["environment"].nextCDN();
                if (!allDone) {
                    // 重新加载
                    RES.loadGroup(evt.groupName);
                }
                else {
                    // 移除事件监听
                    RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                    // 调用模板方法
                    this._handler.oneError && this._handler.oneError(evt);
                    // 切换CDN失败了，弹出提示，使用户可以手动刷新页面
                    __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_panel_PanelManager__["a" /* panelManager */].confirm("资源组加载失败[" + groupName + "]，点击确定刷新页面", function () {
                        __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_platform_PlatformManager__["a" /* platformManager */].reload();
                    });
                }
            }
        }
    };
    return AssetsLoader;
}());
/* harmony default export */ __webpack_exports__["a"] = (AssetsLoader);


/***/ }),
/* 86 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return platformManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__WebPlatform__ = __webpack_require__(87);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 平台接口管理器，通过桥接模式统一不同平台的不同接口，从而实现对框架其他模块透明化
*/
var PlatformManager = /** @class */ (function () {
    function PlatformManager() {
        /**
         * 平台接口实现对象，默认是普通网页平台，也可以根据需要定制
         *
         * @type {IPlatform}
         * @memberof PlatformManager
         */
        this.platform = new __WEBPACK_IMPORTED_MODULE_3__WebPlatform__["a" /* default */]();
    }
    /**
     * 刷新当前页面
     *
     * @memberof PlatformManager
     */
    PlatformManager.prototype.reload = function () {
        this.platform.reload();
    };
    PlatformManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], PlatformManager);
    return PlatformManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (PlatformManager);
/** 再额外导出一个单例 */
var platformManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(PlatformManager);


/***/ }),
/* 87 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 网页平台接口实现类，也是平台接口的默认类
*/
var WebPlatform = /** @class */ (function () {
    function WebPlatform() {
    }
    WebPlatform.prototype.reload = function () {
        window.location.reload(true);
    };
    return WebPlatform;
}());
/* harmony default export */ __webpack_exports__["a"] = (WebPlatform);


/***/ }),
/* 88 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__ = __webpack_require__(89);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 回弹效果
*/
var BackPanelPolicy = /** @class */ (function () {
    function BackPanelPolicy() {
    }
    /**
     * 显示时调用
     * @param panel 弹出框对象
     * @param callback 完成回调，必须调用
     * @param from 动画起始点
     */
    BackPanelPolicy.prototype.pop = function (panel, callback, from) {
        // 开始动画弹出
        var entity = panel.skin;
        egret.Tween.removeTweens(entity);
        // 恢复体积
        entity.scaleX = 1;
        entity.scaleY = 1;
        var fromX = 0;
        var fromY = 0;
        if (from != null) {
            fromX = from.x;
            fromY = from.y;
        }
        else {
            fromX = entity.stage.stageWidth * 0.5;
            fromY = entity.stage.stageHeight * 0.5;
        }
        // 更新弹出后位置
        entity.x = fromX - entity.width * 0.5;
        entity.y = fromY - entity.height * 0.5;
        // 开始缓动
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__["a" /* tweenFrom */])(entity, {
            x: fromX,
            y: fromY,
            scaleX: 0,
            scaleY: 0
        }, 300, egret.Ease.backOut).call(callback);
    };
    /**
     * 关闭时调用
     * @param popup 弹出框对象
     * @param callback 完成回调，必须调用
     * @param to 动画完结点
     */
    BackPanelPolicy.prototype.drop = function (panel, callback, to) {
        // 开始动画关闭
        var entity = panel.skin;
        egret.Tween.removeTweens(entity);
        var toX = 0;
        var toY = 0;
        if (to != null) {
            toX = to.x;
            toY = to.y;
        }
        else {
            toX = entity.x + entity.width * 0.5;
            toY = entity.y + entity.height * 0.5;
        }
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__["b" /* tweenTo */])(entity, {
            x: toX,
            y: toY,
            scaleX: 0,
            scaleY: 0
        }, 300, egret.Ease.backIn).call(function () {
            // 恢复体积
            entity.scaleX = 1;
            entity.scaleY = 1;
            if (callback != null)
                callback();
        });
    };
    return BackPanelPolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (BackPanelPolicy);


/***/ }),
/* 89 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = tweenTo;
/* harmony export (immutable) */ __webpack_exports__["a"] = tweenFrom;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * Egret缓动工具集，用来弥补Egret的Tween的不足
*/
function tweenTo(target, props, duration, ease) {
    return egret.Tween.get(target).to(props, duration, ease);
}
function tweenFrom(target, props, duration, ease) {
    // 对换参数状态
    var toProps = {};
    for (var key in props) {
        toProps[key] = target[key];
        target[key] = props[key];
    }
    // 开始缓动
    return egret.Tween.get(target).to(toProps, duration, ease);
}


/***/ }),
/* 90 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 淡入淡出场景切换策略
*/
var FadeScenePolicy = /** @class */ (function () {
    function FadeScenePolicy() {
        this._tempSnapshot = new egret.Bitmap();
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    FadeScenePolicy.prototype.prepareSwitch = function (from, to) {
        if (from != null) {
            var root = from.bridge.root;
            // 截取当前屏幕
            var texture = new egret.RenderTexture();
            texture.drawToTexture(root);
            this._tempSnapshot.texture = texture;
            this._tempSnapshot.alpha = 1;
            root.addChild(this._tempSnapshot);
            // 移除from
            var fromDisplay = from.skin;
            if (fromDisplay.parent != null) {
                fromDisplay.parent.removeChild(fromDisplay);
            }
        }
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    FadeScenePolicy.prototype.switch = function (from, to, callback) {
        if (from != null) {
            // 开始淡出
            egret.Tween.removeTweens(this._tempSnapshot);
            egret.Tween.get(this._tempSnapshot).to({
                alpha: 0
            }, 300).call(function () {
                // 移除截屏
                if (this._tempSnapshot.parent != null) {
                    this._tempSnapshot.parent.removeChild(this._tempSnapshot);
                }
                // 回收资源
                if (this._tempSnapshot.texture != null) {
                    this._tempSnapshot.texture.dispose();
                    this._tempSnapshot.texture = null;
                }
                // 调用回调
                callback();
            }, this);
        }
        else {
            // 移除截屏
            if (this._tempSnapshot.parent != null) {
                this._tempSnapshot.parent.removeChild(this._tempSnapshot);
            }
            // 调用回调
            callback();
        }
    };
    return FadeScenePolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (FadeScenePolicy);


/***/ }),
/* 91 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__EgretBridge__ = __webpack_require__(28);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * Egret遮罩实现
*/
var MaskEntityImpl = /** @class */ (function () {
    function MaskEntityImpl(params) {
        this._maskAlpha = 0.5;
        this._loadingAlpha = 0.5;
        this._modalPanelAlpha = 0.5;
        this._showingMask = false;
        this._showingLoading = false;
        if (params != null) {
            this._maskAlpha = (params.maskAlpha != null ? params.maskAlpha : 0.5);
            this._loadingAlpha = (params.loadingAlpha != null ? params.loadingAlpha : 0.5);
            this._modalPanelAlpha = (params.modalPanelAlpha != null ? params.modalPanelAlpha : 0.5);
            this._loadingSkinFactory = params.loadingSkinFactory;
        }
        this.maskData = params || {};
        this._mask = new egret.Shape();
        this._mask.touchEnabled = true;
        this._loadingMask = new egret.Shape();
        this._loadingMask.touchEnabled = true;
        this._modalPanelDict = new __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__["a" /* default */]();
        this._modalPanelList = [];
        this._modalPanelMask = new egret.Shape();
        this._modalPanelMask.touchEnabled = true;
    }
    Object.defineProperty(MaskEntityImpl.prototype, "loadingSkin", {
        get: function () {
            // 初始化皮肤
            if (!this._loadingSkin && this._loadingSkinFactory)
                this._loadingSkin = this._loadingSkinFactory();
            return this._loadingSkin;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 显示遮罩
     */
    MaskEntityImpl.prototype.showMask = function (alpha) {
        if (this._showingMask)
            return;
        this._showingMask = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._maskAlpha;
        this._mask.graphics.clear();
        this._mask.graphics.beginFill(0, alpha);
        this._mask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._mask.graphics.endFill();
        // 添加显示
        bridge.maskLayer.addChild(this._mask);
    };
    /**
     * 隐藏遮罩
     */
    MaskEntityImpl.prototype.hideMask = function () {
        if (!this._showingMask)
            return;
        this._showingMask = false;
        // 隐藏
        if (this._mask.parent != null)
            this._mask.parent.removeChild(this._mask);
    };
    /**当前是否在显示遮罩*/
    MaskEntityImpl.prototype.isShowingMask = function () {
        return this._showingMask;
    };
    /**
     * 显示加载图
     */
    MaskEntityImpl.prototype.showLoading = function (alpha) {
        if (this._showingLoading)
            return;
        this._showingLoading = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._loadingAlpha;
        this._loadingMask.graphics.clear();
        this._loadingMask.graphics.beginFill(0, alpha);
        this._loadingMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._loadingMask.graphics.endFill();
        // 添加显示
        bridge.maskLayer.addChild(this._loadingMask);
        // 添加loading皮肤
        if (this.loadingSkin)
            bridge.maskLayer.addChild(this.loadingSkin);
    };
    /**
     * 隐藏加载图
     */
    MaskEntityImpl.prototype.hideLoading = function () {
        if (!this._showingLoading)
            return;
        this._showingLoading = false;
        // 隐藏
        if (this._loadingMask.parent != null)
            this._loadingMask.parent.removeChild(this._loadingMask);
        if (this.loadingSkin != null && this.loadingSkin.parent != null)
            this.loadingSkin.parent.removeChild(this._loadingSkin);
    };
    /**当前是否在显示loading*/
    MaskEntityImpl.prototype.isShowingLoading = function () {
        return this._showingLoading;
    };
    /** 显示模态窗口遮罩 */
    MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
        if (this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.set(panel, panel);
        this._modalPanelList.push(panel);
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._modalPanelAlpha;
        this._modalPanelMask.graphics.clear();
        this._modalPanelMask.graphics.beginFill(0, alpha);
        this._modalPanelMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._modalPanelMask.graphics.endFill();
        // 添加显示
        var entity = panel.skin;
        var parent = entity.parent;
        if (parent != null) {
            if (this._modalPanelMask.parent) {
                this._modalPanelMask.parent.removeChild(this._modalPanelMask);
            }
            var index = parent.getChildIndex(entity);
            parent.addChildAt(this._modalPanelMask, index);
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskEntityImpl.prototype.hideModalMask = function (panel) {
        if (!this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.delete(panel);
        this._modalPanelList.splice(this._modalPanelList.indexOf(panel), 1);
        // 判断是否还需要Mask
        if (this._modalPanelList.length <= 0) {
            // 隐藏
            if (this._modalPanelMask.parent != null)
                this._modalPanelMask.parent.removeChild(this._modalPanelMask);
        }
        else {
            // 移动Mask
            var entity = this._modalPanelList[this._modalPanelList.length - 1].skin;
            var parent = entity.parent;
            if (parent != null) {
                if (this._modalPanelMask.parent) {
                    this._modalPanelMask.parent.removeChild(this._modalPanelMask);
                }
                var index = parent.getChildIndex(entity);
                parent.addChildAt(this._modalPanelMask, index);
            }
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
        return (this._modalPanelDict.get(panel) != null);
    };
    return MaskEntityImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (MaskEntityImpl);


/***/ }),
/* 92 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = wrapEUIList;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-17
 * @modify date 2017-10-17
 *
 * UI工具集
*/

/**
 * 包装EUI的DataGroup组件，使用传入的处理函数处理每个渲染器更新的逻辑
 *
 * @export
 * @param {eui.DataGroup} group 被包装的DataGroup组件
 * @param {(data?:any, renderer?:any)=>void} rendererHandler 渲染器处理函数，每次数据更新时会被调用，处理单个渲染器的渲染逻辑
 * @param {(datas?:eui.ICollection, group?:eui.DataGroup)=>void} [updateHandler] 数据更新处理函数，每次显示更新时会被调用，处理列表显示更新后的渲染逻辑
 */
function wrapEUIList(group, rendererHandler, updateHandler) {
    group.itemRenderer = ItemRenderer.bind(null, group.itemRendererSkinName, rendererHandler);
    if (updateHandler) {
        // 监听group尺寸是否改变
        var enterFrameHandler = function () {
            if (group.contentWidth > 0 || group.contentHeight > 0) {
                // 移除事件监听
                group.removeEventListener(egret.Event.ENTER_FRAME, enterFrameHandler, this);
                // 调用回调
                updateHandler(group.dataProvider, group);
            }
        };
        group.addEventListener(egret.Event.ENTER_FRAME, enterFrameHandler, this);
    }
}
var ItemRenderer = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](ItemRenderer, _super);
    function ItemRenderer(skinName, rendererHandler) {
        var _this = _super.call(this) || this;
        _this.skinName = skinName;
        _this._rendererHandler = rendererHandler;
        return _this;
    }
    ItemRenderer.prototype.dataChanged = function () {
        _super.prototype.dataChanged.call(this);
        this._rendererHandler(this.data, this);
    };
    return ItemRenderer;
}(eui.ItemRenderer));


/***/ }),
/* 93 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_core_command_Command__ = __webpack_require__(94);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__EgretBridge__ = __webpack_require__(28);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-02-05
 * @modify date 2018-02-05
 *
 * 这个命令是为了修复egret在display==none时获取自身尺寸是空尺寸的bug
*/
var UpdateScreenSizeCommand = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __extends */](UpdateScreenSizeCommand, _super);
    function UpdateScreenSizeCommand() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UpdateScreenSizeCommand.prototype.exec = function () {
        var params = this.msg.params;
        var to = params[0];
        var from = params[1];
        if (to && to.bridge.type === __WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE && from && from.bridge.type !== __WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE) {
            // 是从其他类型场景跳转回来的，为了防止在其他场景触发过resize导致egret尺寸失效，更新一次屏幕尺寸
            egret.updateAllScreens();
        }
    };
    return UpdateScreenSizeCommand;
}(__WEBPACK_IMPORTED_MODULE_1_olympus_r_core_command_Command__["a" /* default */]));
/* harmony default export */ __webpack_exports__["a"] = (UpdateScreenSizeCommand);


/***/ }),
/* 94 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Core__ = __webpack_require__(0);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-01
 * @modify date 2017-09-01
 *
 * 内核命令类，内核命令在注册了消息后可以在消息派发时被执行
*/
var Command = /** @class */ (function () {
    function Command(msg) {
        this.msg = msg;
    }
    Command.prototype.dispatch = function (typeOrMsg) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].dispatch.apply(__WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */], [typeOrMsg].concat(params));
    };
    return Command;
}());
/* harmony default export */ __webpack_exports__["a"] = (Command);


/***/ }),
/* 95 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = wrapSkin;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_mediator_MediatorStatus__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_scene_SceneMediator__ = __webpack_require__(14);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * Egret皮肤工具集
*/
function wrapSkin(mediator, skin) {
    var result;
    var comp = getComponent(skin);
    if (!comp && !(skin instanceof egret.DisplayObject)) {
        var compCls = ((mediator.skin instanceof eui.Component && mediator.skin.constructor) || eui.Component);
        comp = new compCls();
        comp.skinName = skin;
        result = comp;
    }
    else {
        result = skin;
    }
    // 判断中介者当前状态
    if (mediator.status < __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_mediator_MediatorStatus__["a" /* default */].OPENING) {
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", doWrapSkin);
    }
    else {
        // 直接执行要执行的
        doWrapSkin();
    }
    return result;
    function doWrapSkin() {
        // 场景需要拉伸到与stage同宽高
        if (mediator instanceof __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_scene_SceneMediator__["default"]) {
            comp.percentWidth = 100;
            comp.percentHeight = 100;
        }
        // 启动引用转发
        if (result instanceof egret.DisplayObjectContainer && comp && comp.skin) {
            // 转发ui引用，如果传入的是显示对象，则需要判断目标是否属于该对象的后裔
            var needJudgeDescendant = (skin instanceof egret.DisplayObjectContainer);
            for (var _i = 0, _a = comp.skin.skinParts; _i < _a.length; _i++) {
                var name = _a[_i];
                var target = comp[name];
                if (!needJudgeDescendant || isDescendant(target, skin))
                    mediator[name] = target;
            }
        }
    }
}
function getComponent(skin) {
    if (!(skin instanceof egret.DisplayObject))
        return null;
    if (skin instanceof eui.Component && skin.skin)
        return skin;
    return getComponent(skin.parent);
}
function isDescendant(descendant, ascendant) {
    return (descendant !== ascendant && contains(descendant, ascendant));
}
function contains(target, parent) {
    if (!target || !parent)
        return false;
    if (target === parent)
        return true;
    return contains(target.parent, parent);
}


/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMDExM2MzZGY0OTMwMGE1MWUwYjIiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvQ29yZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL09iamVjdFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnkuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvRW52aXJvbm1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3Rvci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYnJpZGdlL0JyaWRnZU1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L05ldE1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL1VSTFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lZGlhdG9yLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWFzay9NYXNrTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3JTdGF0dXMuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvcmVmbGVjdC1tZXRhZGF0YS9SZWZsZWN0LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL2dsb2JhbC9QYXRjaC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvVXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS92ZXJzaW9uL1ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvck1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zeXN0ZW0vU3lzdGVtLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vRE9NQnJpZGdlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL0B0d2VlbmpzL3R3ZWVuLmpzL3NyYy9Ud2Vlbi5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvRWdyZXRCcmlkZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvb2JzZXJ2YWJsZS9PYnNlcnZhYmxlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9tZXNzYWdlL0NvcmVNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL1dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0JpbmRNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L1JlcXVlc3REYXRhLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYnJpZGdlL0JyaWRnZU1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9JTWVkaWF0b3JNb2R1bGVQYXJ0LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci91dGlscy9EaXNwbGF5VXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvSFRUUFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0FycmF5VXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9SZXNwb25zZURhdGEuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvRGF0YVR5cGUuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9CaW5kVXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2F1ZGlvL0F1ZGlvVGFnSW1wbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2F1ZGlvL0F1ZGlvTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lc3NhZ2UvRW5naW5lTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZGVscy9GdWNrTW9kZWwudHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvSGFzaC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25ldC9yZXNwb25zZS9UZXN0UmVzcG9uc2UudHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9tb2R1bGVzL1NlY29uZC50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvaW5qZWN0b3IvSW5qZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9tb2R1bGVzL1Rlc3RQYW5lbC50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9tb2R1bGVzL0ZpcnN0LnRzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvQ29tbW9uTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9NdXRhdG9yLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9EZXAuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0JpbmQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvTmV0TWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BhbmVsL05vbmVQYW5lbFBvbGljeS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BhbmVsL1BhbmVsTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BhbmVsL0lQcm9tcHRQYW5lbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3NjZW5lL05vbmVTY2VuZVBvbGljeS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvU3luY1V0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vbWFzay9NYXNrRW50aXR5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vZG9tL3V0aWxzL1NraW5VdGlsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vZG9tL3BhbmVsL0JhY2tQYW5lbFBvbGljeS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9zY2VuZS9GYWRlU2NlbmVQb2xpY3kuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hdWRpby9BdWRpb01hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvU2hlbGwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hdWRpby9BdWRpb0NvbnRleHRJbXBsLmpzIiwid2VicGFjazovLy8uL3Rlc3QvbmV0L3JlcXVlc3QvVGVzdFJlcXVlc3QudHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9uZXQvdHlwZS9UZXN0LnRzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L3BvbGljaWVzL0hUVFBSZXF1ZXN0UG9saWN5LmpzIiwid2VicGFjazovLy8uL3Rlc3QvbW9kdWxlcy9UZXN0Q29tcC50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvVGVzdEZvck1lZGlhdG9yLnRzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvUGFuZWxNZWRpYXRvci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvVGhpcmQudHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL09seW1wdXMuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9FbmdpbmUuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L1JlbmRlck1vZGUuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L0Fzc2V0c0xvYWRlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BsYXRmb3JtL1BsYXRmb3JtTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BsYXRmb3JtL1dlYlBsYXRmb3JtLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9wYW5lbC9CYWNrUGFuZWxQb2xpY3kuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3V0aWxzL1R3ZWVuVXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvc2NlbmUvRmFkZVNjZW5lUG9saWN5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9tYXNrL01hc2tFbnRpdHkuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3V0aWxzL1VJVXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvY29tbWFuZC9VcGRhdGVTY3JlZW5TaXplQ29tbWFuZC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9jb21tYW5kL0NvbW1hbmQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3V0aWxzL1NraW5VdGlsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCx3QkFBd0I7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQscUZBQWtELEVBQUU7QUFDM0c7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLEVBQUU7QUFDYixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxvQkFBb0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFFBQVE7QUFDM0M7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFFBQVE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy90QmU7QUFDZjtBQUNBO0FBQ2lCO0FBQ0s7QUFDQTtBQUNFO0FBQ0g7QUFDckI7QUFDMkI7QUFDVjtBQUNqQjtBQUN5QjtBQUNSO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLHFCQUFxQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFdBQVc7QUFDdEIsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxnQkFBZ0I7QUFDakU7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGdCQUFnQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsZ0JBQWdCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxlQUFlLG1CQUFtQjtBQUNsQyxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG1CQUFtQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxtQkFBbUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE1BQU07QUFDckI7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsU0FBUztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxrQkFBa0I7QUFDakMsZUFBZSxFQUFFO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzsrREFDRDtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFTQTtBQUNxQjtBQUNOO0FBQ0E7QUFDVTtBQUNQO0FBQ0k7QUFDTDtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDOVBBO0FBQ0E7QUFDdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7Ozs7O0FDbkVBO0FBQ3FCO0FBQ047QUFDUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixZQUFZO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixZQUFZO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOzs7Ozs7OztBQ3hLQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0NBQXdDO0FBQ3pDOzs7Ozs7Ozs7Ozs7OztBQ2xCd0I7QUFDQTtBQUNlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsdUJBQXVCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDeENBO0FBQ0E7QUFDQSwrREFBK0Q7QUFDL0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsbURBQW1EO0FBQzNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRTtBQUNqRSw2QkFBNkIsZ0JBQWdCLGtCQUFrQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0Q0FBNEM7QUFDM0U7QUFDQSxtQ0FBbUMsd0JBQXdCLGtCQUFrQixFQUFFO0FBQy9FLG1DQUFtQyx5QkFBeUIsRUFBRSxFQUFFO0FBQ2hFO0FBQ0EsdUNBQXVDLDhCQUE4QjtBQUNyRSx1Q0FBdUMsbUJBQW1CLEVBQUU7QUFDNUQ7QUFDQSx1Q0FBdUMscURBQXFEO0FBQzVGLHVDQUF1QyxpQkFBaUIsRUFBRTtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBQzNDLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQywyQ0FBMkM7QUFDM0MsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVHQUF1RztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQywyQ0FBMkM7QUFDM0MsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUMzQyw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBQzNDLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFFQUFxRTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQywyQ0FBMkM7QUFDM0MsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBQzNDLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUMzQyw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUU7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBQzNDLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsUUFBUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsdUJBQXVCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDBCQUEwQjtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLGFBQWE7QUFDaEYscUVBQXFFLGFBQWE7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0EsYUFBYTtBQUNi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QTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7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QTtBQUNBO0FBQ0EsdUNBQXVDLGFBQWE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7OzsrQ0Nsa0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUgsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0IscUJBQXFCOztBQUV2Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsdUNBQXVDO0FBQ3ZDOztBQUVBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUEsZ0VBQWdFLHNCQUFzQjtBQUN0RjtBQUNBOztBQUVBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUEsSUFBSTs7QUFFSjs7QUFFQTtBQUNBOztBQUVBLGtFQUFrRSxzQkFBc0I7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7O0FBR0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFBQTs7QUFFSCxFQUFFOztBQUVGO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwNUJEO0FBQUE7QUFDZTtBQUNmO0FBQ0E7QUFDc0I7QUFDSztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3NCO0FBQ3RCO0FBQ21CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFD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RUFBRTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0IsZUFBZSxFQUFFO0FBQ2pCLGVBQWUsRUFBRTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOzs7Ozs7Ozs7O0FDNXhCRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7OztBQ3JCQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7MEVBQ0Q7QUFDQTtBQUNBOzs7Ozs7OztBQzFOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7O0FDckNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRDQUE0Qzs7Ozs7Ozs7QUNiN0M7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxFQUFFO0FBQ2IsV0FBVyxFQUFFO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDMUJzQjtBQUMrQjtBQUMvQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbUJBQW1CO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrQ0FBa0M7Ozs7Ozs7O0FDeE5uQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7OztBQ3JC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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7OztBQ2xFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7O0FDckNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNPO0FBQ1I7QUFDQTs7Ozs7Ozs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7OztBQzdDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDOzs7Ozs7OztBQ1pqQztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTztBQUNSO0FBQ0E7Ozs7Ozs7Ozs7QUNqQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEIsV0FBVyxFQUFFO0FBQ2IsV0FBVyxTQUFTO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVDQUF1QztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ2hFd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZLd0I7QUFDeEI7QUFDc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxVQUFVO0FBQ3JCLFdBQVcsOEJBQThCO0FBQ3pDLGFBQWEsWUFBWTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkIsV0FBVyxFQUFFO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOEJBQThCO0FBQ3pDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGtCQUFrQjtBQUM3QixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FDeEh3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7OztBQ2pFd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQ7QUFDekQsMERBQTBEO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwRkE7QUFDcUI7QUFDTjtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzsrREFDRDtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7OztBQ3BPQTtBQUNxQjtBQUNOO0FBQ3FCO0FBQ3BDO0FBQ3NCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRCQUE0Qjs7Ozs7Ozs7QUNwSzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQ0FBZ0M7QUFDakM7Ozs7Ozs7Ozs7Ozs7O0FDZEE7QUFDc0I7QUFDQztBQUNHO0FBQ1I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTztBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7Ozs7Ozs7QUN4SUE7QUFDZTtBQUNNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOzs7Ozs7OztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7OztBQ2hCNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7OztBQ2pGQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7Ozs7QUN0RXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7O0FDOUtBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGNBQWM7QUFDekIsV0FBVyxpQ0FBaUM7QUFDNUMsV0FBVyxxREFBcUQ7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7Ozs7Ozs7Ozs7O0FDN0NEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7OztBQzNCZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7Ozs7OztBQ3RCQTtBQUNBO0FBQ3NCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxnQkFBZ0I7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDU1KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAwMTEzYzNkZjQ5MzAwYTUxZTBiMiIsImltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuLi91dGlscy9EaWN0aW9uYXJ5XCI7XHJcbmltcG9ydCBPYnNlcnZhYmxlIGZyb20gXCIuL29ic2VydmFibGUvT2JzZXJ2YWJsZVwiO1xyXG5pbXBvcnQgXCJyZWZsZWN0LW1ldGFkYXRhXCI7XHJcbmltcG9ydCAqIGFzIFBhdGNoIGZyb20gXCIuL2dsb2JhbC9QYXRjaFwiO1xyXG5QYXRjaDtcclxuLyoqXHJcbiAqIOaguOW/g+S4iuS4i+aWh+Wvueixoe+8jOi0n+i0o+WGheaguOa2iOaBr+i9rOWPkeOAgeWvueixoeazqOWFpeetieaguOW/g+WKn+iDveeahOWunueOsFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBjbGFzcyBDb3JlXHJcbiAqL1xyXG52YXIgQ29yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENvcmUoKSB7XHJcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqIOS4i+mdouaYr+WGheaguOa2iOaBr+ezu+e7nyAqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlID0gbmV3IE9ic2VydmFibGUoKTtcclxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5LiL6Z2i5piv5L6d6LWW5rOo5YWl57O757ufICoqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiusOW9leW3sue7j+azqOWFpei/h+eahOWvueixoeWNleS+i1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAdHlwZSB7RGljdGlvbmFyeTxGdW5jdGlvbiwgYW55Pn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2luamVjdERpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOazqOWFpeWtl+espuS4suexu+Wei+Wtl+WFuO+8jOiusOW9leazqOWFpeWtl+espuS4suWSjOexu+Wei+aehOmAoOWHveaVsOeahOaYoOWwhFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAdHlwZSB7RGljdGlvbmFyeTxhbnksIElDb25zdHJ1Y3Rvcj59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9pbmplY3RTdHJEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICAvLyDov5vooYzljZXkvovliKTmlq1cclxuICAgICAgICBpZiAoQ29yZS5faW5zdGFuY2UpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIuW3sueUn+aIkOi/h0NvcmXlrp7kvovvvIzkuI3lhYHorrjlpJrmrKHnlJ/miJBcIik7XHJcbiAgICAgICAgLy8g6LWL5YC85Y2V5L6LXHJcbiAgICAgICAgQ29yZS5faW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIC8vIOazqOWFpeiHqui6q1xyXG4gICAgICAgIHRoaXMubWFwSW5qZWN0VmFsdWUodGhpcyk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29yZS5wcm90b3R5cGUsIFwiZGlzcG9zZWRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvcmXnmoRkaXNwb3NlZOWxnuaAp+ayoeacieS7u+S9leS9nOeUqO+8jOS7heS4uuS6huWunueOsOaOpeWPo++8jOWni+e7iOS8mui/lOWbnmZhbHNlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29yZS5wcm90b3R5cGUsIFwib2JzZXJ2YWJsZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5bCGSU9ic2VydmFibGXmmrTpnLLlh7rmnaVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJT2JzZXJ2YWJsZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2YWJsZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb3JlLnByb3RvdHlwZSwgXCJwYXJlbnRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWIsOeItue6p0lPYnNlcnZhYmxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKiogZGlzcGF0Y2jmlrnms5Xlrp7njrAgKi9cclxuICAgIENvcmUucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBwYXJhbXNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZS5kaXNwYXRjaC5hcHBseSh0aGlzLl9vYnNlcnZhYmxlLCBwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog55uR5ZCs5YaF5qC45raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOa2iOaBr+WkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10g5raI5oGvdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0g5piv5ZCm5piv5LiA5qyh5oCn55uR5ZCsXHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAodHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSkge1xyXG4gICAgICAgIGlmIChvbmNlID09PSB2b2lkIDApIHsgb25jZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZS5saXN0ZW4odHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTlhoXmoLjmtojmga/nm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbmmK/kuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgKi9cclxuICAgIENvcmUucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUudW5saXN0ZW4odHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozlkb3ku6TliLDnibnlrprmtojmga/nsbvlnovkuIrvvIzlvZPov5nkuKrnsbvlnovnmoTmtojmga/mtL7lj5HliLDmoYbmnrblhoXmoLjml7bkvJrop6blj5FDb21tYW5k6L+Q6KGMXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo5YaM55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqO+8jOWPr+S7peaYr+aWueazleW9ouW8j++8jOS5n+WPr+S7peS9v+exu+W9ouW8j1xyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUubWFwQ29tbWFuZCA9IGZ1bmN0aW9uICh0eXBlLCBjbWQpIHtcclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLm1hcENvbW1hbmQodHlwZSwgY21kKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOWRveS7pFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOimgeazqOmUgOeahOa2iOaBr+exu+Wei1xyXG4gICAgICogQHBhcmFtIHsoSUNvbW1hbmRDb25zdHJ1Y3Rvcil9IGNtZCDlkb3ku6TlpITnkIblmahcclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUudW5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUudW5tYXBDb21tYW5kKHR5cGUsIGNtZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDkuIDkuKrnsbvlnovms6jlhaXvvIzkvJrnq4vljbPnlJ/miJDkuIDkuKrlrp7kvovlubbms6jlhaXliLDmoYbmnrblhoXmoLjkuK1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcn0gdGFyZ2V0IOimgeazqOWFpeeahOexu+Wei++8iOazqOaEj+S4jeaYr+WunuS+i++8iVxyXG4gICAgICogQHBhcmFtIHsqfSBbdHlwZV0g5aaC5p6c5o+Q5L6b6K+l5Y+C5pWw77yM5YiZ5L2/55So6K+l57G75Z6L5Luj5pu/5rOo5YWl57G75Z6L55qEa2V577yM5ZCm5YiZ5L2/55So5rOo5YWl57G75Z6L6Ieq6Lqr5L2c5Li6a2V5XHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS5tYXBJbmplY3QgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5bey57uP5rOo5YWl6L+H5LqG77yM5YiZ5L2/55So5bey57uP5rOo5YWl55qE5Y2V5L6L5YaN5qyh5rOo5YWlXHJcbiAgICAgICAgdmFyIG9yaVRhcmdldCA9IHRhcmdldFtcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgdGFyZ2V0O1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX2luamVjdERpY3QuZ2V0KG9yaVRhcmdldCkgfHwgbmV3IHRhcmdldCgpO1xyXG4gICAgICAgIHRoaXMubWFwSW5qZWN0VmFsdWUodmFsdWUsIHR5cGUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo5YWl5LiA5Liq5a+56LGh5a6e5L6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSDopoHms6jlhaXnmoTlr7nosaHlrp7kvotcclxuICAgICAqIEBwYXJhbSB7Kn0gW3R5cGVdIOWmguaenOaPkOS+m+ivpeWPguaVsO+8jOWImeS9v+eUqOivpeexu+Wei+S7o+abv+azqOWFpeexu+Wei+eahGtlee+8jOWQpuWImeS9v+eUqOazqOWFpeWunuS+i+eahOaehOmAoOWHveaVsOS9nOS4umtleVxyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUubWFwSW5qZWN0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcclxuICAgICAgICAvLyDlpoLmnpzmmK/lrZfnrKbkuLLliJnorrDlvZXnsbvlnovmnoTpgKDlh73mlbDmmKDlsIRcclxuICAgICAgICBpZiAoISh0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHx8ICF0eXBlLnByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9pbmplY3RTdHJEaWN0LnNldCh0eXBlLCB2YWx1ZS5jb25zdHJ1Y3Rvcik7XHJcbiAgICAgICAgICAgIHR5cGUgPSB2YWx1ZS5jb25zdHJ1Y3RvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6K6w5b2V5bey5rOo5YWl55qE5Y2V5L6LXHJcbiAgICAgICAgdGhpcy5faW5qZWN0RGljdC5zZXQodmFsdWUuY29uc3RydWN0b3IsIHZhbHVlKTtcclxuICAgICAgICAvLyDlvIDlp4vms6jlhaVcclxuICAgICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgdmFsdWUsIHR5cGVbXCJfX29yaV9jb25zdHJ1Y3Rvcl9fXCJdIHx8IHR5cGUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk57G75Z6L5rOo5YWlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSB0eXBlIOimgeenu+mZpOazqOWFpeeahOexu+Wei1xyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUudW5tYXBJbmplY3QgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+Wtl+espuS4suWImeiusOW9leexu+Wei+aehOmAoOWHveaVsOaYoOWwhFxyXG4gICAgICAgIGlmICghKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbikgfHwgIXR5cGUucHJvdG90eXBlKVxyXG4gICAgICAgICAgICB0eXBlID0gdGhpcy5faW5qZWN0U3RyRGljdC5nZXQodHlwZSk7XHJcbiAgICAgICAgUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHR5cGVbXCJfX29yaV9jb25zdHJ1Y3Rvcl9fXCJdIHx8IHR5cGUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5rOo5YWl55qE5a+56LGh5a6e5L6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSB0eXBlIOazqOWFpeWvueixoeeahOexu+Wei1xyXG4gICAgICogQHJldHVybnMgeyp9IOazqOWFpeeahOWvueixoeWunuS+i1xyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUuZ2V0SW5qZWN0ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgICBpZiAoISh0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHx8ICF0eXBlLnByb3RvdHlwZSlcclxuICAgICAgICAgICAgdHlwZSA9IHRoaXMuX2luamVjdFN0ckRpY3QuZ2V0KHR5cGUpO1xyXG4gICAgICAgIGlmICh0eXBlKSB7XHJcbiAgICAgICAgICAgIC8vIOmcgOimgeeUqOWOn+Wni+eahOaehOmAoOWHveaVsOWPllxyXG4gICAgICAgICAgICB0eXBlID0gdHlwZVtcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgdHlwZTtcclxuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCB0eXBlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb3Jl55qEZGlzcG9zZeaWueazleayoeacieS7u+S9leS9nOeUqO+8jOS7heS4uuS6huWunueOsOaOpeWPo1xyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgKi9cclxuICAgIENvcmUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENvcmU7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IENvcmU7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBjb3JlID0gbmV3IENvcmUoKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9Db3JlLmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gWzAsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7ICB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAob1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uL0NvcmVcIjtcclxuaW1wb3J0IHsgZGVjb3JhdGVUaGlzIH0gZnJvbSBcIi4uL2dsb2JhbC9QYXRjaFwiO1xyXG5pbXBvcnQgeyBsaXN0ZW5Db25zdHJ1Y3QgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RydWN0VXRpbFwiO1xyXG5pbXBvcnQgXCJyZWZsZWN0LW1ldGFkYXRhXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOVxyXG4gKlxyXG4gKiBDb3Jl5qih57uE55qE6KOF6aWw5Zmo5rOo5YWl5qih5Z2XXHJcbiovXHJcbi8qKiDnlJ/miJDnsbvlnovlrp7kvovlubbms6jlhaXvvIzlj6/ku6Xov5vooYznsbvlnovovazmjaLms6jlhaXvvIjljbPms6jlhaXnsbvlnovlj6/ku6Xlkozms6jlhoznsbvlnovkuI3kuIDoh7TvvIzph4fnlKhASW5qZWN0YWJsZShBbm90aGVyQ2xhc3Mp55qE5b2i5byP5Y2z5Y+v77yJICovXHJcbmV4cG9ydCBmdW5jdGlvbiBJbmplY3RhYmxlKCkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMgPT09IGRlY29yYXRlVGhpcykge1xyXG4gICAgICAgIC8vIOS4jemcgOimgei9rOaNouazqOWGjOexu+Wei++8jOebtOaOpeazqOWGjFxyXG4gICAgICAgIGNvcmUubWFwSW5qZWN0KGFyZ3NbMF0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g6ZyA6KaB6L2s5o2i5rOo5YaM57G75Z6L77yM6ZyA6KaB6L+U5Zue5LiA5LiqQ2xhc3NEZWNvcmF0b3JcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHJlYWxDbHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhcmdzXzEgPSBhcmdzOyBfaSA8IGFyZ3NfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbHMgPSBhcmdzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgLy8g5rOo5YWl57G75Z6LXHJcbiAgICAgICAgICAgICAgICBjb3JlLm1hcEluamVjdChyZWFsQ2xzLCBjbHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOmcgOimgei9rOaNoueahOS5n+imgemineWkluWwhuiHqui6q+azqOWFpeS4gOS4qlxyXG4gICAgICAgICAgICBjb3JlLm1hcEluamVjdChyZWFsQ2xzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbjtcclxuZXhwb3J0IGZ1bmN0aW9uIEluamVjdCh0YXJnZXQsIGtleSkge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICAgIHZhciBjbHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgdGFyZ2V0LCBrZXkpO1xyXG4gICAgICAgIGRvSW5qZWN0KHRhcmdldC5jb25zdHJ1Y3Rvciwga2V5LCBjbHMpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGRvSW5qZWN0KHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgcHJvcGVydHlLZXksIHRhcmdldCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG47XHJcbmZ1bmN0aW9uIGRvSW5qZWN0KGNscywga2V5LCB0eXBlKSB7XHJcbiAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgIHZhciB0YXJnZXQ7XHJcbiAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaW5zdGFuY2UsIGtleSwge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGFyZ2V0IHx8ICh0YXJnZXQgPSBjb3JlLmdldEluamVjdCh0eXBlKSk7IH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTExXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTExXHJcbiAqXHJcbiAqIOWvueixoeW3peWFt+mbhlxyXG4qL1xyXG4vKipcclxuICogcG9wdWxhdGUgcHJvcGVydGllc1xyXG4gKiBAcGFyYW0gdGFyZ2V0ICAgICAgICDnm67moIdvYmpcclxuICogQHBhcmFtIHNvdXJjZXMgICAgICAg5p2l5rqQb2JqXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kT2JqZWN0KHRhcmdldCkge1xyXG4gICAgdmFyIHNvdXJjZXMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgc291cmNlc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIHNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlKSB7XHJcbiAgICAgICAgaWYgKCFzb3VyY2UpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBmb3IgKHZhciBwcm9wTmFtZSBpbiBzb3VyY2UpIHtcclxuICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wTmFtZV0gPSBzb3VyY2VbcHJvcE5hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG59XHJcbi8qKlxyXG4gKiDlpI3liLblr7nosaFcclxuICogQHBhcmFtIHRhcmdldCDopoHlpI3liLbnmoTlr7nosaFcclxuICogQHBhcmFtIGRlZXAg5piv5ZCm5rex6KGo5aSN5Yi277yM6buY6K6k5rWF6KGo5aSN5Yi2XHJcbiAqIEByZXR1cm5zIHthbnl9IOWkjeWItuWQjueahOWvueixoVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lT2JqZWN0KHRhcmdldCwgZGVlcCkge1xyXG4gICAgaWYgKGRlZXAgPT09IHZvaWQgMCkgeyBkZWVwID0gZmFsc2U7IH1cclxuICAgIGlmICh0YXJnZXQgPT0gbnVsbClcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIHZhciBuZXdPYmplY3QgPSBPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpKTtcclxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXModGFyZ2V0KTtcclxuICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGFyZ2V0W2tleV07XHJcbiAgICAgICAgaWYgKGRlZXAgJiYgdHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5piv5rex6KGo5aSN5Yi277yM5YiZ6ZyA6KaB6YCS5b2S5aSN5Yi25a2Q5a+56LGhXHJcbiAgICAgICAgICAgIHZhbHVlID0gY2xvbmVPYmplY3QodmFsdWUsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmplY3QsIGtleSwgZGVzYyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3T2JqZWN0O1xyXG59XHJcbi8qKlxyXG4gKiDnlJ/miJDkuIDkuKrpmo/mnLpJRFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEdVSUQoKSB7XHJcbiAgICB2YXIgcyA9IFtdO1xyXG4gICAgdmFyIGhleERpZ2l0cyA9IFwiMDEyMzQ1Njc4OWFiY2RlZlwiO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzNjsgaSsrKSB7XHJcbiAgICAgICAgc1tpXSA9IGhleERpZ2l0cy5zdWJzdHIoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMHgxMCksIDEpO1xyXG4gICAgfVxyXG4gICAgc1sxNF0gPSBcIjRcIjsgLy8gYml0cyAxMi0xNSBvZiB0aGUgdGltZV9oaV9hbmRfdmVyc2lvbiBmaWVsZCB0byAwMDEwXHJcbiAgICBzWzE5XSA9IGhleERpZ2l0cy5zdWJzdHIoKHBhcnNlSW50KHNbMTldKSAmIDB4MykgfCAweDgsIDEpOyAvLyBiaXRzIDYtNyBvZiB0aGUgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZCB0byAwMVxyXG4gICAgc1s4XSA9IHNbMTNdID0gc1sxOF0gPSBzWzIzXSA9IFwiLVwiO1xyXG4gICAgcmV0dXJuIHMuam9pbihcIlwiKTtcclxufVxyXG52YXIgX2dldEF1dG9JbmNJZE1hcCA9IHt9O1xyXG4vKipcclxuICog55Sf5oiQ6Ieq5aKeaWTvvIjku44w5byA5aeL77yJXHJcbiAqIEBwYXJhbSB0eXBlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXV0b0luY0lkKHR5cGUpIHtcclxuICAgIHZhciBpbmRleCA9IF9nZXRBdXRvSW5jSWRNYXBbdHlwZV0gfHwgMDtcclxuICAgIF9nZXRBdXRvSW5jSWRNYXBbdHlwZV0gPSBpbmRleCsrO1xyXG4gICAgcmV0dXJuIHR5cGUgKyBcIi1cIiArIGluZGV4O1xyXG59XHJcbi8qKlxyXG4gKiDliKTmlq3lr7nosaHmmK/lkKbkuLpudWxs5oiW6ICF56m65a+56LGhXHJcbiAqIEBwYXJhbSBvYmog6KaB5Yik5pat55qE5a+56LGhXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKbkuLpudWxs5oiW6ICF56m65a+56LGhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuICAgIHZhciByZXN1bHQgPSB0cnVlO1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKipcclxuICog56e76ZmkZGF0YeS4reWMheWQq+eahOepuuW8leeUqOaIluacquWumuS5iVxyXG4gKiBAcGFyYW0gZGF0YSDopoHooqvnp7vpmaTnqbrlvJXnlKjmiJbmnKrlrprkuYnnmoTlr7nosaFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmltRGF0YShkYXRhKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhW2tleV0gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkZWxldGUgZGF0YVtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBkYXRhO1xyXG59XHJcbi8qKlxyXG4gKiDorqljaGlsZOexu+e7p+aJv+iHqnBhcmVudOexu1xyXG4gKiBAcGFyYW0gY2hpbGQg5a2Q57G7XHJcbiAqIEBwYXJhbSBwYXJlbnQg54i257G7XHJcbiAqL1xyXG5leHBvcnQgdmFyIGV4dGVuZHNDbGFzcyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdFtcInNldFByb3RvdHlwZU9mXCJdIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYilcclxuICAgICAgICAgICAgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpXHJcbiAgICAgICAgICAgICAgICBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxudmFyIGhhc2ggPSAwO1xyXG52YXIgaGFzaFR5cGVzID0gW1wib2JqZWN0XCIsIFwiZnVuY3Rpb25cIl07XHJcbi8qKlxyXG4gKiDojrflj5bkuIDkuKrlr7nosaHnmoTlr7nosaHlk4jluIzlrZfnrKbkuLJcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyp9IHRhcmdldCDku7vmhI/lr7nosaHvvIzlj6/ku6XmmK/ln7rnoYDnsbvlnovmiJZudWxsXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IOWTiOW4jOWAvFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdEhhc2godGFyZ2V0KSB7XHJcbiAgICBpZiAodGFyZ2V0ID09IG51bGwpXHJcbiAgICAgICAgcmV0dXJuIFwiX19vYmplY3RfaGFzaF8wX19cIjtcclxuICAgIHZhciBrZXkgPSBcIl9fb2JqZWN0X2hhc2hfX1wiO1xyXG4gICAgdmFyIHZhbHVlO1xyXG4gICAgLy8g5Y+q5pyJ5b2T5YmN5a+56LGh5LiK5pyJa2V55omN566XXHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRhcmdldCwga2V5KSlcclxuICAgICAgICB2YWx1ZSA9IHRhcmdldFtrZXldO1xyXG4gICAgLy8g5aaC5p6c5bey57uP5pyJ5ZOI5biM5YC85YiZ55u05o6l6L+U5ZueXHJcbiAgICBpZiAodmFsdWUpXHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgLy8g5aaC5p6c5piv5Z+656GA57G75Z6L5YiZ55u05o6l6L+U5Zue5a+55bqU5a2X56ym5LiyXHJcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiB0YXJnZXQ7XHJcbiAgICBpZiAoaGFzaFR5cGVzLmluZGV4T2YodHlwZSkgPCAwKVxyXG4gICAgICAgIHJldHVybiB0eXBlICsgXCI6XCIgKyB0YXJnZXQ7XHJcbiAgICAvLyDlpoLmnpzmmK/lpI3mnYLnsbvlnovliJnov5Tlm57orqHnrpfnmoTlk4jluIzlgLzlubbmiZPkuIrmoIfnrb5cclxuICAgIHZhciB2YWx1ZSA9IFwiX19vYmplY3RfaGFzaF9cIiArICgrK2hhc2gpICsgXCJfX1wiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcclxuICAgICAgICB2YWx1ZTogdmFsdWVcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5blpJrkuKrlr7nosaHnmoTlk4jluIzlrZfnrKbkuLLvvIzkvJrlr7nmr4/kuKrlr7nosaHosIPnlKhnZXRPYmplY3RIYXNo55Sf5oiQ5Y2V5Liq5ZOI5biM5YC877yM5bm255SofOi/nuaOpVxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7Li4uYW55W119IHRhcmdldHMg5biM5pyb6I635Y+W5ZOI5biM5YC855qE5a+56LGh5YiX6KGoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IOWkmuS4quWvueixoeWFseWQjOS9nOeUqOS4i+eahOWTiOW4jOWAvFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdEhhc2hzKCkge1xyXG4gICAgdmFyIHRhcmdldHMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdGFyZ2V0c1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgdmFyIHZhbHVlcyA9IHRhcmdldHMubWFwKGZ1bmN0aW9uICh0YXJnZXQpIHsgcmV0dXJuIGdldE9iamVjdEhhc2godGFyZ2V0KTsgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzLmpvaW4oXCJ8XCIpO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL09iamVjdFV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZ2V0T2JqZWN0SGFzaCB9IGZyb20gXCIuL09iamVjdFV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE1XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE1XHJcbiAqXHJcbiAqIOWtl+WFuO+8jOaUr+aMgWtleeS4uuS7u+aEj+exu+Wei+eahOWvueixoVxyXG4qL1xyXG52YXIgRGljdGlvbmFyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERpY3Rpb25hcnkoKSB7XHJcbiAgICAgICAgdGhpcy5fa2V5RGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlRGljdCA9IHt9O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERpY3Rpb25hcnkucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWtl+WFuOWGheeahOWFg+e0oOaVsOmHj1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRGljdGlvbmFyeVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2l6ZSA9IDA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdClcclxuICAgICAgICAgICAgICAgIHNpemUrKztcclxuICAgICAgICAgICAgcmV0dXJuIHNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGljdGlvbmFyeS5wcm90b3R5cGUsIFwia2V5c1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5a2X5YW4a2V555qE6ZuG5ZCIXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7S1tdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBEaWN0aW9uYXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdCkge1xyXG4gICAgICAgICAgICAgICAga2V5cy5wdXNoKHRoaXMuX2tleURpY3RbaGFzaF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERpY3Rpb25hcnkucHJvdG90eXBlLCBcInZhbHVlc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5a2X5YW45YC855qE6ZuG5ZCIXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7VltdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBEaWN0aW9uYXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaGFzaCBpbiB0aGlzLl92YWx1ZURpY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHRoaXMuX3ZhbHVlRGljdFtoYXNoXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5LiA5Liq6ZSu5YC85a+5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtLfSBrZXkg6ZSuXHJcbiAgICAgKiBAcGFyYW0ge1Z9IHZhbHVlIOWAvFxyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaGFzaCA9IGdldE9iamVjdEhhc2goa2V5KTtcclxuICAgICAgICB0aGlzLl9rZXlEaWN0W2hhc2hdID0ga2V5O1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlRGljdFtoYXNoXSA9IHZhbHVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5LiA5Liq5YC8XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtLfSBrZXkg6ZSuXHJcbiAgICAgKiBAcmV0dXJucyB7Vn0g5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgRGljdGlvbmFyeVxyXG4gICAgICovXHJcbiAgICBEaWN0aW9uYXJ5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGhhc2ggPSBnZXRPYmplY3RIYXNoKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlRGljdFtoYXNoXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIoOmZpOS4gOS4qumUruWAvOWvuVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7S30ga2V5IOmUrlxyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBoYXNoID0gZ2V0T2JqZWN0SGFzaChrZXkpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9rZXlEaWN0W2hhc2hdO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl92YWx1ZURpY3RbaGFzaF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpgY3ljoblrZflhbhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhrZXk6SywgdmFsdWU6Vik9PnZvaWR9IGNhbGxiYWNrIOavj+asoemBjeWOhueahOWbnuiwg1xyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdCkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5RGljdFtoYXNoXTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fdmFsdWVEaWN0W2hhc2hdO1xyXG4gICAgICAgICAgICBjYWxsYmFjayhrZXksIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERpY3Rpb25hcnk7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IERpY3Rpb25hcnk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnkuanNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCB7IHdyYXBIb3N0LCBnZXRDdXJPcmlnaW4gfSBmcm9tIFwiLi4vLi4vdXRpbHMvVVJMVXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjFcclxuICpcclxuICog546v5aKD5Y+C5pWwXHJcbiovXHJcbnZhciBFbnZpcm9ubWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEVudmlyb25tZW50KCkge1xyXG4gICAgICAgIHRoaXMuX2VudiA9IFwiZGV2XCI7XHJcbiAgICAgICAgdGhpcy5faG9zdHNEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fY2Ruc0RpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9jdXJDRE5JbmRleCA9IDA7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRW52aXJvbm1lbnQucHJvdG90eXBlLCBcImVudlwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5b2T5YmN546v5aKD5a2X56ym5LiyXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFbnZpcm9ubWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW52O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVudmlyb25tZW50LnByb3RvdHlwZSwgXCJob3N0c0RpY3RcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWfn+WQjeWtl+WFuFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3tbZW52OnN0cmluZ106c3RyaW5nW119fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFbnZpcm9ubWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faG9zdHNEaWN0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blvZPliY3njq/looPkuIvmn5DntKLlvJXlpITnmoTmtojmga/ln5/lkI1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2luZGV4PTBdIOWfn+WQjeWtl+WFuOe0ouW8le+8jOm7mOiupOaYrzBcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOWfn+WQjeWtl+espuS4su+8jOWmguaenOWPluS4jeWIsOWImeS9v+eUqOW9k+WJjeWfn+WQjVxyXG4gICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgKi9cclxuICAgIEVudmlyb25tZW50LnByb3RvdHlwZS5nZXRIb3N0ID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgaWYgKGluZGV4ID09PSB2b2lkIDApIHsgaW5kZXggPSAwOyB9XHJcbiAgICAgICAgdmFyIGhvc3RzID0gdGhpcy5faG9zdHNEaWN0W3RoaXMuX2Vudl07XHJcbiAgICAgICAgaWYgKCFob3N0cylcclxuICAgICAgICAgICAgcmV0dXJuIGdldEN1ck9yaWdpbigpO1xyXG4gICAgICAgIHJldHVybiAoaG9zdHNbaW5kZXhdIHx8IGdldEN1ck9yaWdpbigpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRW52aXJvbm1lbnQucHJvdG90eXBlLCBcImNkbnNEaWN0XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5ZDRE7lrZflhbhcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHt7W2VudjpzdHJpbmddOnN0cmluZ1tdfX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NkbnNEaWN0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVudmlyb25tZW50LnByb3RvdHlwZSwgXCJjdXJDRE5Ib3N0XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3kvb/nlKjnmoRDRE7ln5/lkI1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjZG5zID0gdGhpcy5fY2Ruc0RpY3RbdGhpcy5fZW52XTtcclxuICAgICAgICAgICAgaWYgKCFjZG5zKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEN1ck9yaWdpbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gKGNkbnNbdGhpcy5fY3VyQ0ROSW5kZXhdIHx8IGdldEN1ck9yaWdpbigpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5LiL5LiA5LiqQ0ROXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IOaYr+WQpuW3sue7j+WIsOi+vkNETuWIl+ihqOeahOe7iOeCue+8jOWbnuWIsOS6hui1t+eCuVxyXG4gICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgKi9cclxuICAgIEVudmlyb25tZW50LnByb3RvdHlwZS5uZXh0Q0ROID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjZG5zID0gdGhpcy5fY2Ruc0RpY3RbdGhpcy5fZW52XTtcclxuICAgICAgICBpZiAoIWNkbnMpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2N1ckNETkluZGV4Kys7XHJcbiAgICAgICAgaWYgKHRoaXMuX2N1ckNETkluZGV4ID49IGNkbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1ckNETkluZGV4ID0gMDtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMlkVudmlyb25tZW505a+56LGh77yM5Zug5Li66K+l5a+56LGh5L+d5a2Y55qE5pWw5o2u5Z+65pys5p2l6Ieq6aG555uu5Yid5aeL5Y+C5pWw77yM5omA5Lul5b+F6aG75pyJaW5pdGlhbGl6ZeaWueazlVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbZW52XSDlvZPliY3miYDlsZ7njq/looPlrZfnrKbkuLJcclxuICAgICAqIEBwYXJhbSB7e1tlbnY6c3RyaW5nXTpzdHJpbmdbXX19IFtob3N0c0RpY3RdIGhvc3TmlbDnu4TlrZflhbhcclxuICAgICAqIEBwYXJhbSB7e1tlbnY6c3RyaW5nXTpzdHJpbmdbXX19IFtjZG5zRGljdF0gY2Ru5pWw57uE5a2X5YW4XHJcbiAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAqL1xyXG4gICAgRW52aXJvbm1lbnQucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoZW52LCBob3N0c0RpY3QsIGNkbnNEaWN0KSB7XHJcbiAgICAgICAgdGhpcy5fZW52ID0gZW52IHx8IFwiZGV2XCI7XHJcbiAgICAgICAgdGhpcy5faG9zdHNEaWN0ID0gaG9zdHNEaWN0IHx8IHt9O1xyXG4gICAgICAgIHRoaXMuX2NkbnNEaWN0ID0gY2Ruc0RpY3QgfHwge307XHJcbiAgICAgICAgdGhpcy5fY3VyQ0ROSW5kZXggPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6pdXJs55qE5Z+f5ZCN5Y+Y5oiQ5raI5oGv5Z+f5ZCNXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDopoHovazlj5jnmoR1cmxcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbaW5kZXg9MF0gaG9zdOe0ouW8le+8jOm7mOiupDBcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOi9rOWPmOWQjueahHVybFxyXG4gICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgKi9cclxuICAgIEVudmlyb25tZW50LnByb3RvdHlwZS50b0hvc3RVUkwgPSBmdW5jdGlvbiAodXJsLCBpbmRleCkge1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gMDsgfVxyXG4gICAgICAgIC8vIOWKoOS4imRvbWFpblxyXG4gICAgICAgIHVybCA9IHdyYXBIb3N0KHVybCwgdGhpcy5nZXRIb3N0KGluZGV4KSk7XHJcbiAgICAgICAgLy8g6L+U5ZuedXJsXHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiuqXVybOeahOWfn+WQjeWPmOaIkENETuWfn+WQjVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6KaB6L2s5Y+Y55qEdXJsXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmb3JjZWQ9ZmFsc2VdIOaYr+WQpuW8uuWItuabv+aNomhvc3RcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2luZml4PXRydWVdIOaYr+WQpuWKoOWFpei3r+W+hOS4ree8gO+8jOWNs2hvc3TkuYvlkI7vvIxpbmRleC5odG1s5LmL5YmN55qE6YOo5YiG77yM6buY6K6k5Yqg5YWlXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDovazlj5jlkI7nmoR1cmxcclxuICAgICAqIEBtZW1iZXJvZiBFbnZpcm9ubWVudFxyXG4gICAgICovXHJcbiAgICBFbnZpcm9ubWVudC5wcm90b3R5cGUudG9DRE5Ib3N0VVJMID0gZnVuY3Rpb24gKHVybCwgZm9yY2VkLCBpbmZpeCkge1xyXG4gICAgICAgIGlmIChmb3JjZWQgPT09IHZvaWQgMCkgeyBmb3JjZWQgPSBmYWxzZTsgfVxyXG4gICAgICAgIGlmIChpbmZpeCA9PT0gdm9pZCAwKSB7IGluZml4ID0gdHJ1ZTsgfVxyXG4gICAgICAgIGlmIChpbmZpeCkge1xyXG4gICAgICAgICAgICAvLyDnu4Tnu4fkuK3nvIBcclxuICAgICAgICAgICAgdmFyIG1pZG5hbWVJbmRleCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5sYXN0SW5kZXhPZihcIi9cIik7XHJcbiAgICAgICAgICAgIHZhciBtaWRuYW1lID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnN1YnN0cmluZygwLCBtaWRuYW1lSW5kZXggKyAxKTtcclxuICAgICAgICAgICAgcmV0dXJuIHdyYXBIb3N0KHVybCwgdGhpcy5jdXJDRE5Ib3N0ICsgXCIvXCIgKyBtaWRuYW1lLCBmb3JjZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5Y+q5pu/5o2i5Z+f5ZCNXHJcbiAgICAgICAgICAgIHJldHVybiB3cmFwSG9zdCh1cmwsIHRoaXMuY3VyQ0ROSG9zdCwgZm9yY2VkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRW52aXJvbm1lbnQgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIEVudmlyb25tZW50KTtcclxuICAgIHJldHVybiBFbnZpcm9ubWVudDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRW52aXJvbm1lbnQ7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBlbnZpcm9ubWVudCA9IGNvcmUuZ2V0SW5qZWN0KEVudmlyb25tZW50KTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Vudi9FbnZpcm9ubWVudC5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyBleHRlbmRzQ2xhc3MgfSBmcm9tIFwiLi4vdXRpbHMvT2JqZWN0VXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTNcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTNcclxuICpcclxuICog6KOF6aWw5Zmo5bel5YW36ZuGXHJcbiovXHJcbi8vIOeUqOadpeWIpOaWreaYr+WQpuaUr+aMgVByb3h5XHJcbnZhciBoYXNQcm94eSA9ICh3aW5kb3dbXCJQcm94eVwiXSAmJiBQcm94eS5yZXZvY2FibGUgaW5zdGFuY2VvZiBGdW5jdGlvbik7XHJcbnZhciBpbnN0YW5jZURpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG5mdW5jdGlvbiBoYW5kbGVJbnN0YW5jZShpbnN0YW5jZSkge1xyXG4gICAgdmFyIGNscyA9IGluc3RhbmNlLmNvbnN0cnVjdG9yO1xyXG4gICAgY2xzID0gY2xzW1wiX19vcmlfY29uc3RydWN0b3JfX1wiXSB8fCBjbHM7XHJcbiAgICB2YXIgZnVuY3MgPSBpbnN0YW5jZURpY3QuZ2V0KGNscyk7XHJcbiAgICBpZiAoZnVuY3MpXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBmdW5jc18xID0gZnVuY3M7IF9pIDwgZnVuY3NfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZ1bmMgPSBmdW5jc18xW19pXTtcclxuICAgICAgICAgICAgZnVuYyhpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG59XHJcbi8qKlxyXG4gKiDljIXoo4XkuIDkuKrnsbvlnovvvIznm5HlkKznsbvlnovnmoTlrp7kvovljJbmk43kvZxcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcn0gY2xzIOimgeebkeWQrOaehOmAoOeahOexu+Wei+aehOmAoOWZqFxyXG4gKiBAcmV0dXJucyB7SUNvbnN0cnVjdG9yfSDmlrDnmoTmnoTpgKDlh73mlbBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3cmFwQ29uc3RydWN0KGNscykge1xyXG4gICAgaWYgKGhhc1Byb3h5KSB7XHJcbiAgICAgICAgLy8g5L2/55SoUHJveHnnm5HlkKznsbvlnovmnoTlu7pcclxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KGNscywge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Q6IGZ1bmN0aW9uICh0YXJnZXQsIGFyZ3MsIG5ld1RhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KHRhcmdldCwgYXJncywgbmV3VGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdUYXJnZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNvbnN0cnVjdG9yID0gbmV3VGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5zdGFuY2UocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIOWIm+W7uuS4gOS4quaWsOeahOaehOmAoOWHveaVsFxyXG4gICAgICAgIHZhciBmdW5jO1xyXG4gICAgICAgIGV2YWwoJ2Z1bmMgPSBmdW5jdGlvbiAnICsgY2xzW1wibmFtZVwiXSArICcoKXtvbkNvbnN0cnVjdC5jYWxsKHRoaXMsIGFyZ3VtZW50cyl9Jyk7XHJcbiAgICAgICAgLy8g5Yqo5oCB6K6+572u57un5om/XHJcbiAgICAgICAgZXh0ZW5kc0NsYXNzKGZ1bmMsIGNscyk7XHJcbiAgICAgICAgLy8g5Li65paw55qE5p6E6YCg5Ye95pWw5omT5LiA5Liq5qCH562+77yM55So5Lul6K6w5b2V5Y6f5aeL55qE5p6E6YCg5Ye95pWwXHJcbiAgICAgICAgZnVuY1tcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gPSBjbHM7XHJcbiAgICAgICAgLy8g5Li65Y6f5aeL5p6E6YCg5Ye95pWw5Lmf5omT5LiA5Liq5qCH562+77yM55So5Lul6K6w5b2V5paw5p6E6YCg5Ye95pWwXHJcbiAgICAgICAgY2xzW1wiX193cmFwX2NvbnN0cnVjdG9yX19cIl0gPSBmdW5jO1xyXG4gICAgICAgIC8vIOi/lOWbnuaWsOeahOaehOmAoOWHveaVsFxyXG4gICAgICAgIHJldHVybiBmdW5jO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb25Db25zdHJ1Y3QoYXJncykge1xyXG4gICAgICAgIC8vIOaBouWkjV9fcHJvdG9fX1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9fcHJvdG9fX1wiLCB7XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICB2YWx1ZTogY2xzLnByb3RvdHlwZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOiwg+eUqOeItuexu+aehOmAoOWHveaVsOaehOmAoOWunuS+i1xyXG4gICAgICAgIGNscy5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICBoYW5kbGVJbnN0YW5jZSh0aGlzKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5aaC5p6c5Lyg5YWl55qE57G75pyJ5YyF6KOF57G777yM5YiZ6L+U5Zue5YyF6KOF57G777yM5ZCm5YiZ6L+U5Zue5YW25pys6LqrXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29uc3RydWN0b3J9IGNscyDopoHojrflj5bljIXoo4XnsbvnmoTnsbvmnoTpgKDlh73mlbBcclxuICogQHJldHVybnMge0lDb25zdHJ1Y3Rvcn1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDb25zdHJ1Y3RvcihjbHMpIHtcclxuICAgIHJldHVybiAoY2xzW1wiX193cmFwX2NvbnN0cnVjdG9yX19cIl0gfHwgY2xzKTtcclxufVxyXG4vKipcclxuICog55uR5ZCs57G75Z6L55qE5a6e5L6L5YyWXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29uc3RydWN0b3J9IGNscyDopoHnm5HlkKzlrp7kvovljJbnmoTnsbtcclxuICogQHBhcmFtIHsoaW5zdGFuY2U/OmFueSk9PnZvaWR9IGhhbmRsZXIg5aSE55CG5Ye95pWwXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuQ29uc3RydWN0KGNscywgaGFuZGxlcikge1xyXG4gICAgY2xzID0gY2xzW1wiX19vcmlfY29uc3RydWN0b3JfX1wiXSB8fCBjbHM7XHJcbiAgICB2YXIgbGlzdCA9IGluc3RhbmNlRGljdC5nZXQoY2xzKTtcclxuICAgIGlmICghbGlzdClcclxuICAgICAgICBpbnN0YW5jZURpY3Quc2V0KGNscywgbGlzdCA9IFtdKTtcclxuICAgIGlmIChsaXN0LmluZGV4T2YoaGFuZGxlcikgPCAwKVxyXG4gICAgICAgIGxpc3QucHVzaChoYW5kbGVyKTtcclxufVxyXG4vKipcclxuICog56e76Zmk5a6e5L6L5YyW55uR5ZCsXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29uc3RydWN0b3J9IGNscyDopoHnp7vpmaTnm5HlkKzlrp7kvovljJbnmoTnsbtcclxuICogQHBhcmFtIHsoaW5zdGFuY2U/OmFueSk9PnZvaWR9IGhhbmRsZXIg5aSE55CG5Ye95pWwXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5saXN0ZW5Db25zdHJ1Y3QoY2xzLCBoYW5kbGVyKSB7XHJcbiAgICBjbHMgPSBjbHNbXCJfX29yaV9jb25zdHJ1Y3Rvcl9fXCJdIHx8IGNscztcclxuICAgIHZhciBsaXN0ID0gaW5zdGFuY2VEaWN0LmdldChjbHMpO1xyXG4gICAgaWYgKGxpc3QpIHtcclxuICAgICAgICB2YXIgaW5kZXggPSBsaXN0LmluZGV4T2YoaGFuZGxlcik7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IDApXHJcbiAgICAgICAgICAgIGxpc3Quc3BsaWNlKGluZGV4LCAxKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog55uR5ZCs57G75Z6L6ZSA5q+B77yI5aaC5p6c6IO95aSf6ZSA5q+B55qE6K+d77yM6ZyA6KaB57G75Z6L5YW35pyJZGlzcG9zZeaWueazle+8ie+8jOivpeebkeWQrOS4jemcgOimgeenu+mZpFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfSBjbHMg6KaB55uR5ZCs6ZSA5q+B55qE57G7XHJcbiAqIEBwYXJhbSB7KGluc3RhbmNlPzphbnkpPT52b2lkfSBoYW5kbGVyIOWkhOeQhuWHveaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbkRpc3Bvc2UoY2xzLCBoYW5kbGVyKSB7XHJcbiAgICB2YXIgZGlzcG9zZSA9IGNscy5wcm90b3R5cGUuZGlzcG9zZTtcclxuICAgIC8vIOWIpOaWreexu+Wei+aYr+WQpuWFt+aciWRpc3Bvc2Xmlrnms5VcclxuICAgIGlmIChkaXNwb3NlKSB7XHJcbiAgICAgICAgLy8g5pu/5o2iZGlzcG9zZeaWueazlVxyXG4gICAgICAgIGNscy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGhhbmRsZXIodGhpcyk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWOn+Wni2Rpc3Bvc2Xmlrnms5XmiafooYzplIDmr4FcclxuICAgICAgICAgICAgcmV0dXJuIGRpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDnm5HlkKzmn5DkuKrlrp7kvovnmoTmn5DkuKrmlrnms5XosIPnlKjvvIzlubbmj5LlhaXpgLvovpFcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcnxhbnl9IHRhcmdldCDopoHnm5HlkKznmoTlr7nosaHnsbvlnovmiJblrp7kvotcclxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg6KaB55uR5ZCs6LCD55So55qE5pa55rOV5ZCNXHJcbiAqIEBwYXJhbSB7KGluc3RhbmNlOmFueSwgYXJncz86YW55W10pPT5hbnlbXXx2b2lkfSBbYmVmb3JlXSDmiafooYzliY3osIPnlKjnmoTlm57osIPvvIzlpoLmnpzmnInov5Tlm57lgLzliJnmm7/mjaLmjonmraPlvI/mlrnms5XmiafooYzml7bnmoTlj4LmlbBcclxuICogQHBhcmFtIHsoaW5zdGFuY2U6YW55LCBhcmdzPzphbnlbXSwgcmVzdWx0PzphbnkpPT5hbnl9IFthZnRlcl0g5omn6KGM5ZCO6LCD55So55qE5Zue6LCD77yM5Y+v5Lul5o6l5pS25q2j5byP5pa55rOV55qE6L+U5Zue5YC877yM5aaC5p6cYWZ0ZXLmnInov5Tlm57lgLzliJnmm7/mjaLmjonmraPlvI/mlrnms5XnmoTov5Tlm57lgLxcclxuICogQHBhcmFtIHtib29sZWFufSBbb25jZT10cnVlXSDmmK/lkKbmmK/kuIDmrKHmgKfnm5HlkKzvvIzpu5jorqTmmK90cnVlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuQXBwbHkodGFyZ2V0LCBuYW1lLCBiZWZvcmUsIGFmdGVyLCBvbmNlKSB7XHJcbiAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSB0cnVlOyB9XHJcbiAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgRnVuY3Rpb24pXHJcbiAgICAgICAgLy8g5piv5Liq57G75Z6L77yM55uR5ZCs5p6E5bu65ZCO5YaN5omn6KGM5aSE55CGXHJcbiAgICAgICAgbGlzdGVuQ29uc3RydWN0KHRhcmdldCwgb25HZXRJbnN0YW5jZSk7XHJcbiAgICBlbHNlXHJcbiAgICAgICAgLy8g5piv5Liq5a6e5L6L77yM55u05o6l5omn6KGM5aSE55CGXHJcbiAgICAgICAgb25HZXRJbnN0YW5jZSh0YXJnZXQpO1xyXG4gICAgZnVuY3Rpb24gb25HZXRJbnN0YW5jZShpbnN0YW5jZSkge1xyXG4gICAgICAgIC8vIOevoeaUueaMh+WumuaWueazlVxyXG4gICAgICAgIHZhciBvcmlGdW5jID0gaW5zdGFuY2UuaGFzT3duUHJvcGVydHkobmFtZSkgPyBpbnN0YW5jZVtuYW1lXSA6IG51bGw7XHJcbiAgICAgICAgaW5zdGFuY2VbbmFtZV0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIHZhciB0ZW1wQXJncyA9IGJlZm9yZSAmJiBiZWZvcmUoaW5zdGFuY2UsIGFyZ3MpO1xyXG4gICAgICAgICAgICAvLyDmm7/mjaLlj4LmlbBcclxuICAgICAgICAgICAgaWYgKHRlbXBBcmdzKVxyXG4gICAgICAgICAgICAgICAgYXJncyA9IHRlbXBBcmdzO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmmK/kuIDmrKHmgKfnm5HlkKzvvIzliJnmgaLlpI3ljp/lp4vmlrnms5VcclxuICAgICAgICAgICAgaWYgKG9uY2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcmlGdW5jKVxyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlW25hbWVdID0gb3JpRnVuYztcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgaW5zdGFuY2VbbmFtZV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6LCD55So5Y6f5aeL5pa55rOVXHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBpbnN0YW5jZVtuYW1lXS5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIHZhciB0ZW1wUmVzdWx0ID0gYWZ0ZXIgJiYgYWZ0ZXIoaW5zdGFuY2UsIGFyZ3MsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIC8vIOabv+aNoue7k+aenFxyXG4gICAgICAgICAgICBpZiAodGVtcFJlc3VsdClcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRlbXBSZXN1bHQ7XHJcbiAgICAgICAgICAgIC8vIOi/lOWbnue7k+aenFxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvQ29uc3RydWN0VXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgXCJyZWZsZWN0LW1ldGFkYXRhXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IGRlY29yYXRlVGhpcyB9IGZyb20gXCIuLi8uLi9jb3JlL2dsb2JhbC9QYXRjaFwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IE1lc3NhZ2UgZnJvbSBcIi4uLy4uL2NvcmUvbWVzc2FnZS9NZXNzYWdlXCI7XHJcbmltcG9ydCB7IGxpc3RlbkFwcGx5LCBsaXN0ZW5Db25zdHJ1Y3QsIGxpc3RlbkRpc3Bvc2UsIHdyYXBDb25zdHJ1Y3QgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RydWN0VXRpbFwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyByZXBsYWNlRGlzcGxheSB9IGZyb20gXCIuLi8uLi91dGlscy9EaXNwbGF5VXRpbFwiO1xyXG5pbXBvcnQgeyBldmFsRXhwIH0gZnJvbSBcIi4uL2JpbmQvVXRpbHNcIjtcclxuaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCIuLi9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG5pbXBvcnQgTWVkaWF0b3IsIHsgcmVnaXN0ZXJNb2R1bGUgfSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JcIjtcclxuaW1wb3J0IE1lZGlhdG9yU3RhdHVzIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclN0YXR1c1wiO1xyXG5pbXBvcnQgeyBuZXRNYW5hZ2VyIH0gZnJvbSBcIi4uL25ldC9OZXRNYW5hZ2VyXCI7XHJcbmltcG9ydCBSZXNwb25zZURhdGEgZnJvbSBcIi4uL25ldC9SZXNwb25zZURhdGFcIjtcclxuaW1wb3J0ICogYXMgQmluZFV0aWwgZnJvbSBcIi4vQmluZFV0aWxcIjtcclxuaW1wb3J0IHsgc2VhcmNoVUkgfSBmcm9tIFwiLi9CaW5kVXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTlcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTlcclxuICpcclxuICog6LSf6LSj5rOo5YWl55qE5qih5Z2XXHJcbiovXHJcbi8qKiDlrprkuYnmlbDmja7mqKHlnovvvIzmlK/mjIHlrp7kvovms6jlhaXvvIzlubbkuJToh6rouqvkuZ/kvJrooqvms6jlhaUgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIE1vZGVsQ2xhc3MoKSB7XHJcbiAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICAvLyDovazosINJbmplY3RhYmxl5pa55rOVXHJcbiAgICBpZiAodGhpcyA9PT0gZGVjb3JhdGVUaGlzKSB7XHJcbiAgICAgICAgdmFyIGNscyA9IHdyYXBDb25zdHJ1Y3QoYXJnc1swXSk7XHJcbiAgICAgICAgSW5qZWN0YWJsZS5jYWxsKHRoaXMsIGNscyk7XHJcbiAgICAgICAgcmV0dXJuIGNscztcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBJbmplY3RhYmxlLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocmVhbENscykge1xyXG4gICAgICAgICAgICByZWFsQ2xzID0gd3JhcENvbnN0cnVjdChyZWFsQ2xzKTtcclxuICAgICAgICAgICAgcmVzdWx0LmNhbGwodGhpcywgcmVhbENscyk7XHJcbiAgICAgICAgICAgIHJldHVybiByZWFsQ2xzO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuLyoqIOWumuS5ieeVjOmdouS4reS7i+iAhe+8jOaUr+aMgeWunuS+i+azqOWFpe+8jOW5tuWPr+agueaNruaJgOi1i+aYvuekuuWvueixoeiHquWKqOiwg+aVtOaJgOS9v+eUqOeahOihqOeOsOWxguahpSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gTWVkaWF0b3JDbGFzcyhtb2R1bGVOYW1lKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xyXG4gICAgICAgIC8vIOWIpOaWreS4gOS4i01lZGlhdG9y5piv5ZCm5pyJZGlzcG9zZeaWueazle+8jOayoeacieeahOivneW8ueS4gOS4quitpuWRilxyXG4gICAgICAgIGlmICghY2xzLnByb3RvdHlwZS5kaXNwb3NlKVxyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJNZWRpYXRvcltcIiArIGNsc1tcIm5hbWVcIl0gKyBcIl3kuI3lhbfmnIlkaXNwb3Nl5pa55rOV77yM5Y+v6IO95Lya6YCg5oiQ5YaF5a2Y6Zeu6aKY77yM6K+36K6p6K+lTWVkaWF0b3Llrp7njrBJRGlzcG9zYWJsZeaOpeWPo1wiKTtcclxuICAgICAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgICAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgLy8g5pu/5o2ic2tpbuWxnuaAp1xyXG4gICAgICAgICAgICB2YXIgJHNraW47XHJcbiAgICAgICAgICAgIHZhciBvcmlTa2luID0gaW5zdGFuY2Uuc2tpbjtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGluc3RhbmNlLCBcInNraW5cIiwge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2tpbjtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJHNraW4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdEJyaWRnZSA9IHRoaXMuYnJpZGdlO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOagueaNrnNraW7nsbvlnovpgInlj5booajnjrDlsYLmoaVcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlQnlTa2luKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXlgLxcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5icmlkZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYnJpZGdlID09PSBsYXN0QnJpZGdlICYmICRza2luKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDpnIDopoHliKTmlq3moaXnmoTnsbvlnovmmK/lkKbnm7jlkIzvvIzkuJTkuYvliY3mnInnmq7ogqTvvIzliJnmm7/mjaLnmq7ogqRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRza2luID0gdGhpcy5icmlkZ2UucmVwbGFjZVNraW4odGhpcywgJHNraW4sIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWQpuWImeebtOaOpeWMheijheS4gOS4i+earuiCpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNraW4gPSB0aGlzLmJyaWRnZS53cmFwU2tpbih0aGlzLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS4jeiupOivhueahOearuiCpOexu+Wei++8jOebtOaOpei1i+WAvFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2tpbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOacrOadpeWwseacieearuiCpO+8jOWImei1i+WAvOearuiCpFxyXG4gICAgICAgICAgICBpZiAob3JpU2tpbilcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnNraW4gPSBvcmlTa2luO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOWMheijheexu1xyXG4gICAgICAgIHZhciB3cmFwcGVyQ2xzID0gd3JhcENvbnN0cnVjdChjbHMpO1xyXG4gICAgICAgIC8vIOazqOWGjOaooeWdl++8jOavj+S4gOS4qk1lZGlhdG9y6YO95pyJ5oiQ5Li654us56uLTW9kdWxl55qE6IO95YqbXHJcbiAgICAgICAgcmVnaXN0ZXJNb2R1bGUobW9kdWxlTmFtZSwgd3JhcHBlckNscyk7XHJcbiAgICAgICAgLy8g6L+U5Zue5YyF6KOF57G7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBwZXJDbHM7XHJcbiAgICB9O1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBNZXNzYWdlSGFuZGxlcih0YXJnZXQsIGtleSkge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICAgIHZhciBkZWZzID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIHRhcmdldCwga2V5KTtcclxuICAgICAgICB2YXIgcmVzQ2xhc3MgPSBkZWZzWzBdO1xyXG4gICAgICAgIGlmICghKHJlc0NsYXNzLnByb3RvdHlwZSBpbnN0YW5jZW9mIE1lc3NhZ2UpKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJATWVzc2FnZUhhbmRsZXLoo4XppbDlmajoo4XppbDnmoTmlrnms5XnmoTpppbkuKrlj4LmlbDlv4XpobvmmK9NZXNzYWdlXCIpO1xyXG4gICAgICAgIGRvTWVzc2FnZUhhbmRsZXIodGFyZ2V0LmNvbnN0cnVjdG9yLCBrZXksIHJlc0NsYXNzLCB0cnVlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBkb01lc3NhZ2VIYW5kbGVyKHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgcHJvcGVydHlLZXksIHRhcmdldCwgdHJ1ZSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG47XHJcbmV4cG9ydCBmdW5jdGlvbiBHbG9iYWxNZXNzYWdlSGFuZGxlcih0YXJnZXQsIGtleSkge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICAgIHZhciBkZWZzID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIHRhcmdldCwga2V5KTtcclxuICAgICAgICB2YXIgcmVzQ2xhc3MgPSBkZWZzWzBdO1xyXG4gICAgICAgIGlmICghKHJlc0NsYXNzLnByb3RvdHlwZSBpbnN0YW5jZW9mIE1lc3NhZ2UpKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJAR2xvYmFsTWVzc2FnZUhhbmRsZXLoo4XppbDlmajoo4XppbDnmoTmlrnms5XnmoTpppbkuKrlj4LmlbDlv4XpobvmmK9NZXNzYWdlXCIpO1xyXG4gICAgICAgIGRvTWVzc2FnZUhhbmRsZXIodGFyZ2V0LmNvbnN0cnVjdG9yLCBrZXksIHJlc0NsYXNzLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpIHtcclxuICAgICAgICAgICAgZG9NZXNzYWdlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCB0YXJnZXQsIGZhbHNlKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbjtcclxuZnVuY3Rpb24gZG9NZXNzYWdlSGFuZGxlcihjbHMsIGtleSwgdHlwZSwgaW5Nb2R1bGUpIHtcclxuICAgIC8vIOebkeWQrOWunuS+i+WMllxyXG4gICAgbGlzdGVuQ29uc3RydWN0KGNscywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgaWYgKGluc3RhbmNlIGluc3RhbmNlb2YgTWVkaWF0b3IgJiYgaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOaYr+iiq+aJmOeuoeeahE1lZGlhdG9y77yM5YiZ6ZyA6KaB562J5Yiw6KKr5omY566h5ZCO5YaN5omn6KGM5rOo5YaMXHJcbiAgICAgICAgICAgIGFkZFN1YkhhbmRsZXIoaW5zdGFuY2UsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlID0gaW5Nb2R1bGUgPyBpbnN0YW5jZS5vYnNlcnZhYmxlIHx8IGNvcmUub2JzZXJ2YWJsZSA6IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICAgICAgICAgIG9ic2VydmFibGUubGlzdGVuKHR5cGUsIGluc3RhbmNlW2tleV0sIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IGluTW9kdWxlID8gaW5zdGFuY2Uub2JzZXJ2YWJsZSB8fCBjb3JlLm9ic2VydmFibGUgOiBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgICAgIG9ic2VydmFibGUubGlzdGVuKHR5cGUsIGluc3RhbmNlW2tleV0sIGluc3RhbmNlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8vIOebkeWQrOmUgOavgVxyXG4gICAgbGlzdGVuRGlzcG9zZShjbHMsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIHZhciBvYnNlcnZhYmxlID0gaW5Nb2R1bGUgPyBpbnN0YW5jZS5vYnNlcnZhYmxlIHx8IGNvcmUub2JzZXJ2YWJsZSA6IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICBvYnNlcnZhYmxlLnVubGlzdGVuKHR5cGUsIGluc3RhbmNlW2tleV0sIGluc3RhbmNlKTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBSZXNwb25zZUhhbmRsZXIodGFyZ2V0LCBrZXkpIHtcclxuICAgIGlmIChrZXkpIHtcclxuICAgICAgICB2YXIgZGVmcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCB0YXJnZXQsIGtleSk7XHJcbiAgICAgICAgdmFyIHJlc0NsYXNzID0gZGVmc1swXTtcclxuICAgICAgICBpZiAoIShyZXNDbGFzcy5wcm90b3R5cGUgaW5zdGFuY2VvZiBSZXNwb25zZURhdGEpKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLml6Dlj4LmlbBAUmVzcG9uc2VIYW5kbGVy6KOF6aWw5Zmo6KOF6aWw55qE5pa55rOV55qE6aaW5Liq5Y+C5pWw5b+F6aG75pivUmVzcG9uc2VEYXRhXCIpO1xyXG4gICAgICAgIGRvUmVzcG9uc2VIYW5kbGVyKHRhcmdldC5jb25zdHJ1Y3Rvciwga2V5LCBkZWZzWzBdLCB0cnVlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCB0YXJnZXQsIHRydWUpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIEdsb2JhbFJlc3BvbnNlSGFuZGxlcih0YXJnZXQsIGtleSkge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICAgIHZhciBkZWZzID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIHRhcmdldCwga2V5KTtcclxuICAgICAgICB2YXIgcmVzQ2xhc3MgPSBkZWZzWzBdO1xyXG4gICAgICAgIGlmICghKHJlc0NsYXNzLnByb3RvdHlwZSBpbnN0YW5jZW9mIFJlc3BvbnNlRGF0YSkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIuaXoOWPguaVsEBHbG9iYWxSZXNwb25zZUhhbmRsZXLoo4XppbDlmajoo4XppbDnmoTmlrnms5XnmoTpppbkuKrlj4LmlbDlv4XpobvmmK9SZXNwb25zZURhdGFcIik7XHJcbiAgICAgICAgZG9SZXNwb25zZUhhbmRsZXIodGFyZ2V0LmNvbnN0cnVjdG9yLCBrZXksIGRlZnNbMF0sIGZhbHNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCB0YXJnZXQsIGZhbHNlKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGRvUmVzcG9uc2VIYW5kbGVyKGNscywga2V5LCB0eXBlLCBpbk1vZHVsZSkge1xyXG4gICAgLy8g55uR5ZCs5a6e5L6L5YyWXHJcbiAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBpZiAoaW5zdGFuY2UgaW5zdGFuY2VvZiBNZWRpYXRvciAmJiBpbnN0YW5jZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5piv6KKr5omY566h55qETWVkaWF0b3LvvIzliJnpnIDopoHnrYnliLDooqvmiZjnrqHlkI7lho3miafooYzms6jlhoxcclxuICAgICAgICAgICAgYWRkU3ViSGFuZGxlcihpbnN0YW5jZSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbmV0TWFuYWdlci5saXN0ZW5SZXNwb25zZSh0eXBlLCBpbnN0YW5jZVtrZXldLCBpbnN0YW5jZSwgZmFsc2UsIChpbk1vZHVsZSA/IGluc3RhbmNlLm9ic2VydmFibGUgOiB1bmRlZmluZWQpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBuZXRNYW5hZ2VyLmxpc3RlblJlc3BvbnNlKHR5cGUsIGluc3RhbmNlW2tleV0sIGluc3RhbmNlLCBmYWxzZSwgKGluTW9kdWxlID8gaW5zdGFuY2Uub2JzZXJ2YWJsZSA6IHVuZGVmaW5lZCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8g55uR5ZCs6ZSA5q+BXHJcbiAgICBsaXN0ZW5EaXNwb3NlKGNscywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgbmV0TWFuYWdlci51bmxpc3RlblJlc3BvbnNlKHR5cGUsIGluc3RhbmNlW2tleV0sIGluc3RhbmNlLCBmYWxzZSwgKGluTW9kdWxlID8gaW5zdGFuY2Uub2JzZXJ2YWJsZSA6IHVuZGVmaW5lZCkpO1xyXG4gICAgfSk7XHJcbn1cclxudmFyIHN1YkhhbmRsZXJEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuZnVuY3Rpb24gYWRkU3ViSGFuZGxlcihpbnN0YW5jZSwgaGFuZGxlcikge1xyXG4gICAgaWYgKCFpbnN0YW5jZSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICB2YXIgaGFuZGxlcnMgPSBzdWJIYW5kbGVyRGljdC5nZXQoaW5zdGFuY2UpO1xyXG4gICAgaWYgKCFoYW5kbGVycylcclxuICAgICAgICBzdWJIYW5kbGVyRGljdC5zZXQoaW5zdGFuY2UsIGhhbmRsZXJzID0gW10pO1xyXG4gICAgaWYgKGhhbmRsZXJzLmluZGV4T2YoaGFuZGxlcikgPCAwKVxyXG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIFN1Yk1lZGlhdG9yKGFyZzEsIGFyZzIsIGFyZzMpIHtcclxuICAgIHZhciBza2luO1xyXG4gICAgdmFyIG1lZGlhdG9yQ2xzO1xyXG4gICAgdmFyIGRhdGFFeHA7XHJcbiAgICAvLyDliKTmlq3mmK/lkKbmmK/lj4LmlbDljJboo4XppbBcclxuICAgIGlmICh0aGlzID09PSBkZWNvcmF0ZVRoaXMpIHtcclxuICAgICAgICAvLyDml6Dlj4LmlbBcclxuICAgICAgICBkb1N1Yk1lZGlhdG9yKGFyZzEsIGFyZzIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g5pyJ5Y+C5pWw77yM5YiG6YWN5Y+C5pWwXHJcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09PSBcInN0cmluZ1wiICYmICFhcmcyICYmICFhcmczKSB7XHJcbiAgICAgICAgICAgIGRhdGFFeHAgPSBhcmcxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChhcmcxIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgbWVkaWF0b3JDbHMgPSBhcmcxO1xyXG4gICAgICAgICAgICBkYXRhRXhwID0gYXJnMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNraW4gPSBhcmcxO1xyXG4gICAgICAgICAgICBtZWRpYXRvckNscyA9IGFyZzI7XHJcbiAgICAgICAgICAgIGRhdGFFeHAgPSBhcmczO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDov5Tlm57oo4XppbDlmajmlrnms5VcclxuICAgICAgICByZXR1cm4gZG9TdWJNZWRpYXRvcjtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGRvU3ViTWVkaWF0b3IocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIGlmIChwcm90b3R5cGUuZGVsZWdhdGVNZWRpYXRvciBpbnN0YW5jZW9mIEZ1bmN0aW9uICYmIHByb3RvdHlwZS51bmRlbGVnYXRlTWVkaWF0b3IgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgICAgICAgICAgbGlzdGVuQ29uc3RydWN0KHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3I7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGluc3RhbmNlW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgICAgIC8vIOevoeaUueWxnuaAp1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGluc3RhbmNlLCBwcm9wZXJ0eUtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVkaWF0b3I7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBNZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Y+W5raI5omY566h5Lit5LuL6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7kuK3ku4vogIVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiZjnrqHmlrDnmoTkuK3ku4vogIVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeS4reS7i+iAheayoeacieearuiCpOWwseeUqOijhemlsOWZqOearuiCpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChza2luICYmICFtZWRpYXRvci5za2luKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5za2luID0gc2tpbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LWL5YC855qu6IKkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2luID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzlrZjlnKjkuK3ku4vogIXvvIzliJnpop3lpJbotYvlgLzkuK3ku4vogIXnmq7ogqRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvci5za2luICYmIG1lZGlhdG9yLnN0YXR1cyA8IE1lZGlhdG9yU3RhdHVzLk9QRU5FRCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlvZPliY3mnInnmq7ogqTkuJTkuK3ku4vogIXlsJrmnKrmiZPlvIDlrozmr5XvvIzor7TmmI7mmK/njrDlnKjmmK/nmq7ogqTovazlj5HpmLbmrrXvvIzopoHnlKjogIHnmq7ogqTmm7/mjaLmlrDnmq7ogqTnmoTkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZURpc3BsYXkobWVkaWF0b3IuYnJpZGdlLCB2YWx1ZSwgbWVkaWF0b3Iuc2tpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWQjOatpeS9jee9rlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5icmlkZ2Uuc3luY1NraW4odmFsdWUsIG1lZGlhdG9yLnNraW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5b2T5YmN5rKh55qu6IKk77yM5oiW6ICF5Lit5LuL6ICF5bey57uP5omT5byA5a6M5q+V5LqG77yM6K+05piO5paw55qu6IKk5bCx5piv6KaB5pu/5o2i6ICB55qu6IKkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yLnNraW4gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtZWRpYXRvcuWSjHNraW7pg73otYvlgLzkuLrnqbpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraW4gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yLnNraW4gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeS4reS7i+iAheW3sue7j+S4uuato+WcqOaJk+W8gOaIluW3suaJk+W8gOeKtuaAge+8jOWImemineWkluiwg+eUqG9wZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiZjnrqHkuK3ku4vogIVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzlvZPliY3kuK3ku4vogIXlt7Lnu4/kuLrmraPlnKjmiZPlvIDmiJblt7LmiZPlvIDnirbmgIHvvIzliJnpop3lpJbosIPnlKhvcGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3Iuc2tpbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvci5zdGF0dXMgPT09IE1lZGlhdG9yU3RhdHVzLlVOT1BFTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0Q29tbW9uU2NvcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzOiBfdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0YTogX3RoaXMudmlld01vZGVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRicmlkZ2U6IF90aGlzLmJyaWRnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3VycmVudFRhcmdldDogbWVkaWF0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldDogbWVkaWF0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWtkE1lZGlhdG9y6L+Y5rKh5pyJb3Blbu+8jG9wZW7kuYtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBNZWRpYXRvclN0YXR1cy5PUEVORUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeItk1lZGlhdG9y5bey57uPb3BlbuS6hu+8jOebtOaOpW9wZW7kuYtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YUV4cCA/IGV2YWxFeHAoZGF0YUV4cCwgdGhpcy52aWV3TW9kZWwsIHRoaXMudmlld01vZGVsLCB0aGlzLmRhdGEsIGdldENvbW1vblNjb3BlKCkpIDogdGhpcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiafooYxvcGVu5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5vcGVuKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdHVzIDwgTWVkaWF0b3JTdGF0dXMuT1BFTkVEICYmIGRhdGFFeHApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeItk1lZGlhdG9y5Lmf5rKh5pyJb3Blbu+8jOebkeWQrOWtkE1lZGlhdG9y55qEb3Blbu+8jOevoeaUueWPguaVsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuQXBwbHkobWVkaWF0b3IsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBldmFsRXhwKGRhdGFFeHAsIF90aGlzLnZpZXdNb2RlbCwgX3RoaXMudmlld01vZGVsLCBfdGhpcy5kYXRhLCBnZXRDb21tb25TY29wZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkYXRhXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDlrp7kvovljJZcclxuICAgICAgICAgICAgICAgIGlmICh0ZW1wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlLZXldID0gdGVtcDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRlbXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS8mOWFiOS9v+eUqOijhemlsOWZqOaPkOS+m+eahOS4reS7i+iAheexu+Wei++8jOWmguaenOayoeacieWImeS9v+eUqOWFg+aVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjbHMgPSBtZWRpYXRvckNscyB8fCBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgcHJvdG90eXBlLCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlLZXldID0gdGVtcCA9IG5ldyBjbHMoc2tpbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDmiafooYzlm57osINcclxuICAgICAgICAgICAgICAgIHZhciBoYW5kbGVycyA9IHN1YkhhbmRsZXJEaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGhhbmRsZXJzXzEgPSBoYW5kbGVyczsgX2kgPCBoYW5kbGVyc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKG1lZGlhdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk6K6w5b2VXHJcbiAgICAgICAgICAgICAgICAgICAgc3ViSGFuZGxlckRpY3QuZGVsZXRlKG1lZGlhdG9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOebkeWQrOmUgOavgVxyXG4gICAgICAgICAgICBsaXN0ZW5EaXNwb3NlKHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBpbnN0YW5jZVtwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTlrp7kvotcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZVtwcm9wZXJ0eUtleV0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG52YXIgb25PcGVuRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbmZ1bmN0aW9uIF9saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBiZWZvcmUsIGFmdGVyKSB7XHJcbiAgICBsaXN0ZW5BcHBseShwcm90b3R5cGUuY29uc3RydWN0b3IsIFwib25PcGVuXCIsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIC8vIOiusOW9lW9uT3BlbuevoeaUueasoeaVsFxyXG4gICAgICAgIHZhciBjb3VudCA9IG9uT3BlbkRpY3QuZ2V0KG1lZGlhdG9yKSB8fCAwO1xyXG4gICAgICAgIG9uT3BlbkRpY3Quc2V0KG1lZGlhdG9yLCBjb3VudCArIDEpO1xyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIGJlZm9yZSAmJiBiZWZvcmUobWVkaWF0b3IpO1xyXG4gICAgfSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgYWZ0ZXIgJiYgYWZ0ZXIobWVkaWF0b3IpO1xyXG4gICAgICAgIC8vIOmAkuWHj+evoeaUueasoeaVsFxyXG4gICAgICAgIHZhciBjb3VudCA9IG9uT3BlbkRpY3QuZ2V0KG1lZGlhdG9yKSAtIDE7XHJcbiAgICAgICAgb25PcGVuRGljdC5zZXQobWVkaWF0b3IsIGNvdW50KTtcclxuICAgICAgICAvLyDliKTmlq3mmK/lkKbmiYDmnIlvbk9wZW7pg73osIPnlKjlrozmr5XvvIzlpoLmnpzlrozmr5XkuobvvIzliJnlkK/liqjnvJbor5Hov4fnqItcclxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTmlbDmja5cclxuICAgICAgICAgICAgb25PcGVuRGljdC5kZWxldGUobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAvLyDlhajosIPnlKjlrozmr5XkuobvvIzmjInlsYLnuqfpobrluo/nlLHmtYXlhaXmt7HnvJbor5FcclxuICAgICAgICAgICAgdmFyIGJpbmRUYXJnZXRzID0gbWVkaWF0b3IuYmluZFRhcmdldHM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGRlcHRoIGluIGJpbmRUYXJnZXRzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGljdCA9IGJpbmRUYXJnZXRzW2RlcHRoXTtcclxuICAgICAgICAgICAgICAgIGRpY3QuZm9yRWFjaChmdW5jdGlvbiAoY3VycmVudFRhcmdldCkgeyByZXR1cm4gQmluZFV0aWwuY29tcGlsZShtZWRpYXRvciwgY3VycmVudFRhcmdldCk7IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluaYvuekuuWvueixoeWcqG1lZGlhdG9yLnNraW7kuK3nmoTltYzlpZflsYLnuqdcclxuICpcclxuICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gKiBAcGFyYW0geyp9IHRhcmdldCDnm67moIfmmL7npLrlr7nosaFcclxuICogQHJldHVybnMge251bWJlcn1cclxuICovXHJcbmZ1bmN0aW9uIGdldERlcHRoKG1lZGlhdG9yLCB0YXJnZXQpIHtcclxuICAgIHZhciBza2luID0gbWVkaWF0b3Iuc2tpbjtcclxuICAgIHZhciBicmlkZ2UgPSBtZWRpYXRvci5icmlkZ2U7XHJcbiAgICB2YXIgZGVwdGggPSAwO1xyXG4gICAgaWYgKGJyaWRnZS5pc015U2tpbih0YXJnZXQpKSB7XHJcbiAgICAgICAgd2hpbGUgKHRhcmdldCAmJiB0YXJnZXQgIT09IHNraW4pIHtcclxuICAgICAgICAgICAgZGVwdGgrKztcclxuICAgICAgICAgICAgdGFyZ2V0ID0gYnJpZGdlLmdldFBhcmVudCh0YXJnZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpzmmL7npLrlr7nosaHmmK/msqHmnInmoLnnmoTvvIzmiJbogIXkuI3lnKhza2lu55qE5pi+56S65qCR5Lit77yM5YiZ6L+U5ZueMFxyXG4gICAgICAgIGlmICghdGFyZ2V0KVxyXG4gICAgICAgICAgICBkZXB0aCA9IDA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVwdGg7XHJcbn1cclxuZnVuY3Rpb24gc2VhcmNoVUlEZXB0aCh2YWx1ZXMsIG1lZGlhdG9yLCB0YXJnZXQsIGNhbGxiYWNrLCBhZGRyZXNzaW5nKSB7XHJcbiAgICBpZiAoYWRkcmVzc2luZyA9PT0gdm9pZCAwKSB7IGFkZHJlc3NpbmcgPSBmYWxzZTsgfVxyXG4gICAgLy8g6I635Y+W5pi+56S65bGC57qnXHJcbiAgICB2YXIgZGVwdGggPSBnZXREZXB0aChtZWRpYXRvciwgdGFyZ2V0KTtcclxuICAgIC8vIOWmguaenOacieS4reaWree8luivkeWImeWwhumBjeWOhueahOW3peS9nOaOqOi/n+WIsOS4reaWremHjeWQr+WQju+8jOWQpuWImeebtOaOpeW8gOWni+mBjeWOhlxyXG4gICAgdmFyIHN0b3BMZWZ0SGFuZGxlcnMgPSB0YXJnZXQuX19zdG9wX2xlZnRfaGFuZGxlcnNfXztcclxuICAgIGlmIChzdG9wTGVmdEhhbmRsZXJzKVxyXG4gICAgICAgIHN0b3BMZWZ0SGFuZGxlcnMucHVzaChoYW5kbGVyKTtcclxuICAgIGVsc2VcclxuICAgICAgICBoYW5kbGVyKHRhcmdldCwgbWVkaWF0b3IuYmluZFRhcmdldHMsIHN0b3BMZWZ0SGFuZGxlcnMpO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih0YXJnZXQsIGJpbmRUYXJnZXRzLCBsZWZ0SGFuZGxlcnMpIHtcclxuICAgICAgICB2YXIgaW5kZXggPSAtMTtcclxuICAgICAgICBpZiAobGVmdEhhbmRsZXJzKVxyXG4gICAgICAgICAgICBpbmRleCA9IGxlZnRIYW5kbGVycy5pbmRleE9mKGhhbmRsZXIpO1xyXG4gICAgICAgIC8vIOmBjeWOhue7keWumueahOebruagh++8jOWwhue8luivkeaMh+S7pOe7keWumuWIsOebruagh+i6q+S4iu+8jOiAjOS4jeaYr+aMh+S7pOaJgOWcqOeahOaYvuekuuWvueixoei6q+S4ilxyXG4gICAgICAgIHNlYXJjaFVJKHZhbHVlcywgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgbmFtZSwgZXhwLCBkZXB0aCkge1xyXG4gICAgICAgICAgICBpZiAoYWRkcmVzc2luZylcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQgPSBjdXJyZW50VGFyZ2V0W25hbWVdO1xyXG4gICAgICAgICAgICAvLyDorrDlvZXlvZPliY3nvJbor5Hnm67moIflkozlkb3ku6TmnKzkvZPnm67moIfliLBiaW5kVGFyZ2V0c+S4rVxyXG4gICAgICAgICAgICB2YXIgZGljdCA9IGJpbmRUYXJnZXRzW2RlcHRoXTtcclxuICAgICAgICAgICAgaWYgKCFkaWN0KVxyXG4gICAgICAgICAgICAgICAgYmluZFRhcmdldHNbZGVwdGhdID0gZGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgICAgIGRpY3Quc2V0KGN1cnJlbnRUYXJnZXQsIHRhcmdldCk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBjYWxsYmFjayhjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCwgbGVmdEhhbmRsZXJzLCBpbmRleCk7XHJcbiAgICAgICAgfSwgZGVwdGgpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRWYWx1ZShhcmcxLCBhcmcyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICBfbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOe7hOe7h+WPguaVsOWtl+WFuFxyXG4gICAgICAgICAgICB2YXIgdWlEaWN0O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdWlEaWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICB1aURpY3RbYXJnMV0gPSBhcmcyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdWlEaWN0ID0gYXJnMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgc2VhcmNoVUlEZXB0aCh1aURpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5re75Yqg57yW6K+R5oyH5LukXHJcbiAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlVmFsdWUsIG5hbWUsIGV4cCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kRXhwKGV4cCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgX2xpc3Rlbk9uT3Blbihwcm90b3R5cGUsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAvLyDnu4Tnu4flj4LmlbDlrZflhbhcclxuICAgICAgICAgICAgdmFyIHVpRGljdCA9IHt9O1xyXG4gICAgICAgICAgICBpZiAoZXhwIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBleHApIHtcclxuICAgICAgICAgICAgICAgICAgICB1aURpY3Rba2V5XSA9IGV4cFtrZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdWlEaWN0W1wiXCJdID0gZXhwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOmBjeWOhue7keWumueahOebruagh++8jOWwhue8luivkeaMh+S7pOe7keWumuWIsOebruagh+i6q+S4iu+8jOiAjOS4jeaYr+aMh+S7pOaJgOWcqOeahOaYvuekuuWvueixoei6q+S4ilxyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICBzZWFyY2hVSURlcHRoKHVpRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVFeHAsIGV4cCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kRnVuYyhhcmcxLCBhcmcyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICBfbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOe7hOe7h+WPguaVsOWtl+WFuFxyXG4gICAgICAgICAgICB2YXIgZnVuY0RpY3Q7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBmdW5jRGljdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZnVuY0RpY3RbYXJnMV0gPSBhcmcyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZnVuY0RpY3QgPSBhcmcxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOmBjeWOhue7keWumueahOebruagh++8jOWwhue8luivkeaMh+S7pOe7keWumuWIsOebruagh+i6q+S4iu+8jOiAjOS4jeaYr+aMh+S7pOaJgOWcqOeahOaYvuekuuWvueixoei6q+S4ilxyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICBzZWFyY2hVSURlcHRoKGZ1bmNEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBhcmdFeHBzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDnu5/kuIDlj4LmlbDnsbvlnovkuLrlrZfnrKbkuLLmlbDnu4RcclxuICAgICAgICAgICAgICAgIGlmICghKGFyZ0V4cHMgaW5zdGFuY2VvZiBBcnJheSkpXHJcbiAgICAgICAgICAgICAgICAgICAgYXJnRXhwcyA9IFthcmdFeHBzXTtcclxuICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kLmFwcGx5KEJpbmRVdGlsLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlRnVuYywgbmFtZV0uY29uY2F0KGFyZ0V4cHMpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRPbihhcmcxLCBhcmcyLCBhcmczKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICBfbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPlue8luivkeWQr+WKqOebruagh1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICAvLyDnu4Tnu4flj4LmlbDlrZflhbhcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhcmczKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5oyH5a6a5LqGVUnlr7nosaHvvIzlhYjljrvlr7vmib5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZURpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lRGljdFthcmcxXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoVUlEZXB0aChuYW1lRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgdHlwZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlT24sIGFyZzIsIGFyZzMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2dERpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBldnREaWN0W2FyZzFdID0gYXJnMjtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hVSURlcHRoKGV2dERpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIHR5cGUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZU9uLCB0eXBlLCBleHApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgICAgICBzZWFyY2hVSURlcHRoKGFyZzEsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIHR5cGUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVPbiwgdHlwZSwgZXhwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRJZihhcmcxLCBhcmcyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICBfbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PT0gXCJzdHJpbmdcIiB8fCBhcmcxIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmICghYXJnMikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOayoeacieaMh+WumuWvu+WdgOi3r+W+hO+8jOWwseaYr+imgeaTjeS9nOW9k+WJjeWvueixoe+8jOS9huS5n+imgee7j+i/h+S4gOasoXNlYXJjaFVJRGVwdGjmk43kvZxcclxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hVSURlcHRoKHsgcjogMTMgfSwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlSWYsIGFyZzEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5oyH5a6a5LqG5a+75Z2A6Lev5b6E77yM6ZyA6KaB5a+75Z2AXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVpRGljdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIHVpRGljdFthcmcxXSA9IGFyZzI7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoVUlEZXB0aCh1aURpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUlmLCBleHApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgICAgICBzZWFyY2hVSURlcHRoKGFyZzEsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVJZiwgZXhwKTtcclxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRGb3IoYXJnMSwgYXJnMiwgYXJnMykge1xyXG4gICAgLy8g57uE57uH5Y+C5pWwXHJcbiAgICB2YXIgdWlEaWN0O1xyXG4gICAgdmFyIG5hbWU7XHJcbiAgICB2YXIgZXhwO1xyXG4gICAgdmFyIG1lZGlhdG9yQ2xzO1xyXG4gICAgaWYgKHR5cGVvZiBhcmcxID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcyID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBhcmcxO1xyXG4gICAgICAgICAgICBleHAgPSBhcmcyO1xyXG4gICAgICAgICAgICBtZWRpYXRvckNscyA9IGFyZzM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBleHAgPSBhcmcxO1xyXG4gICAgICAgICAgICBtZWRpYXRvckNscyA9IGFyZzI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdWlEaWN0ID0gYXJnMTtcclxuICAgIH1cclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIF9saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgLy8g5Y+W5Yiw57yW6K+R55uu5qCH5a+56LGhXHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+i1i+WAvOaMh+S7pFxyXG4gICAgICAgICAgICBpZiAoIXVpRGljdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rKh5pyJ5oyH5a6a5a+75Z2A6Lev5b6E77yM5bCx5piv6KaB5pON5L2c5b2T5YmN5a+56LGh77yM5L2G5Lmf6KaB57uP6L+H5LiA5qyhc2VhcmNoVUlEZXB0aOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFVJRGVwdGgoeyByOiAxMyB9LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBfbmFtZSwgX2V4cCwgbGVmdEhhbmRsZXJzLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUZvciwgZXhwLCBtZWRpYXRvckNscyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruS4reaWree8luivkVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuX19zdG9wX2xlZnRfaGFuZGxlcnNfXyA9IGxlZnRIYW5kbGVycyA/IGxlZnRIYW5kbGVycy5zcGxpY2UoaW5kZXggKyAxLCBsZWZ0SGFuZGxlcnMubGVuZ3RoIC0gaW5kZXggLSAxKSA6IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5oyH5a6a5LqG5a+75Z2A6Lev5b6E77yM6ZyA6KaB5a+75Z2AXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVpRGljdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIHVpRGljdFtuYW1lXSA9IGV4cDtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hVSURlcHRoKHVpRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgX25hbWUsIF9leHAsIGxlZnRIYW5kbGVycywgaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5re75Yqg57yW6K+R5oyH5LukXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVGb3IsIF9leHAsIG1lZGlhdG9yQ2xzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Lit5pat57yW6K+RXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fID0gbGVmdEhhbmRsZXJzID8gbGVmdEhhbmRsZXJzLnNwbGljZShpbmRleCArIDEsIGxlZnRIYW5kbGVycy5sZW5ndGggLSBpbmRleCAtIDEpIDogW107XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgIHNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBfbmFtZSwgX2V4cCwgbGVmdEhhbmRsZXJzLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVGb3IsIF9leHAsIG1lZGlhdG9yQ2xzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7kuK3mlq3nvJbor5FcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuX19zdG9wX2xlZnRfaGFuZGxlcnNfXyA9IGxlZnRIYW5kbGVycyA/IGxlZnRIYW5kbGVycy5zcGxpY2UoaW5kZXggKyAxLCBsZWZ0SGFuZGxlcnMubGVuZ3RoIC0gaW5kZXggLSAxKSA6IFtdO1xyXG4gICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuZnVuY3Rpb24gZG9CaW5kTWVzc2FnZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCB1aURpY3QsIG9ic2VydmFibGUpIHtcclxuICAgIHNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBleHApIHtcclxuICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlTWVzc2FnZSwgdHlwZSwgbmFtZSwgZXhwLCBvYnNlcnZhYmxlKTtcclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRNZXNzYWdlKGFyZzEsIGFyZzIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIF9saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09IFwic3RyaW5nXCIgfHwgYXJnMSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK/nsbvlnovmlrnlvI9cclxuICAgICAgICAgICAgICAgIGRvQmluZE1lc3NhZ2UobWVkaWF0b3IsIHRhcmdldCwgYXJnMSwgYXJnMiwgbWVkaWF0b3Iub2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK/lrZflhbjmlrnlvI9cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gYXJnMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvQmluZE1lc3NhZ2UobWVkaWF0b3IsIHRhcmdldCwgdHlwZSwgYXJnMVt0eXBlXSwgbWVkaWF0b3Iub2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gQmluZEdsb2JhbE1lc3NhZ2UoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgX2xpc3Rlbk9uT3Blbihwcm90b3R5cGUsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIiB8fCBhcmcxIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+exu+Wei+aWueW8j1xyXG4gICAgICAgICAgICAgICAgZG9CaW5kTWVzc2FnZShtZWRpYXRvciwgdGFyZ2V0LCBhcmcxLCBhcmcyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+Wtl+WFuOaWueW8j1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBhcmcxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9CaW5kTWVzc2FnZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCBhcmcxW3R5cGVdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCB1aURpY3QsIG9ic2VydmFibGUpIHtcclxuICAgIHNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBleHApIHtcclxuICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlUmVzcG9uc2UsIHR5cGUsIG5hbWUsIGV4cCwgb2JzZXJ2YWJsZSk7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kUmVzcG9uc2UoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgLy8gUmVzcG9uc2XpnIDopoHlnKhvbk9wZW7kuYvlkI7miafooYzvvIzlm6DkuLrlj6/og73mnInliJ3lp4vljJbmtojmga/pnIDopoHnu5HlrprvvIzopoHlnKhvbk9wZW7lkI7mnInkuoZ2aWV3TW9kZWzlho3pppbmrKHmm7TmlrDmmL7npLpcclxuICAgICAgICBfbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PSBcInN0cmluZ1wiIHx8IGFyZzEgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv57G75Z6L5pa55byPXHJcbiAgICAgICAgICAgICAgICBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCBhcmcxLCBhcmcyLCBtZWRpYXRvci5vYnNlcnZhYmxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+Wtl+WFuOaWueW8j1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBhcmcxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9CaW5kUmVzcG9uc2UobWVkaWF0b3IsIHRhcmdldCwgdHlwZSwgYXJnMVt0eXBlXSwgbWVkaWF0b3Iub2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gQmluZEdsb2JhbFJlc3BvbnNlKGFyZzEsIGFyZzIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIF9saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09IFwic3RyaW5nXCIgfHwgYXJnMSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK/nsbvlnovmlrnlvI9cclxuICAgICAgICAgICAgICAgIGRvQmluZFJlc3BvbnNlKG1lZGlhdG9yLCB0YXJnZXQsIGFyZzEsIGFyZzIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv5a2X5YW45pa55byPXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIGFyZzEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCBhcmcxW3R5cGVdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IE9ic2VydmFibGUgZnJvbSBcIi4uLy4uL2NvcmUvb2JzZXJ2YWJsZS9PYnNlcnZhYmxlXCI7XHJcbmltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuLi8uLi91dGlscy9EaWN0aW9uYXJ5XCI7XHJcbmltcG9ydCB7IG11dGF0ZSB9IGZyb20gXCIuLi9iaW5kL011dGF0b3JcIjtcclxuaW1wb3J0IHsgYmluZE1hbmFnZXIgfSBmcm9tIFwiLi4vYmluZC9CaW5kTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBtYXNrTWFuYWdlciB9IGZyb20gXCIuLi9tYXNrL01hc2tNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IGFzc2V0c01hbmFnZXIgfSBmcm9tIFwiLi4vYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IHsgbmV0TWFuYWdlciB9IGZyb20gXCIuLi9uZXQvTmV0TWFuYWdlclwiO1xyXG5pbXBvcnQgTWVkaWF0b3JTdGF0dXMgZnJvbSBcIi4vTWVkaWF0b3JTdGF0dXNcIjtcclxuaW1wb3J0IHsgTW9kdWxlT3BlblN0YXR1cyB9IGZyb20gXCIuL0lNZWRpYXRvck1vZHVsZVBhcnRcIjtcclxuaW1wb3J0IHsgdW5pcXVlIH0gZnJvbSBcIi4uLy4uL3V0aWxzL0FycmF5VXRpbFwiO1xyXG5pbXBvcnQgTWVkaWF0b3JNZXNzYWdlIGZyb20gXCIuL01lZGlhdG9yTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyBnZXRDb25zdHJ1Y3RvciB9IGZyb20gXCIuLi8uLi91dGlscy9Db25zdHJ1Y3RVdGlsXCI7XHJcbmltcG9ydCB7IHN5c3RlbSB9IGZyb20gXCIuLi9zeXN0ZW0vU3lzdGVtXCI7XHJcbnZhciBtb2R1bGVEaWN0ID0ge307XHJcbnZhciBtb2R1bGVOYW1lRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbi8qKlxyXG4gKiDms6jlhozmqKHlnZdcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbW9kdWxlTmFtZSDmqKHlnZflkI1cclxuICogQHBhcmFtIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcn0gY2xzIOaooeWdl+exu+Wei1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyTW9kdWxlKG1vZHVsZU5hbWUsIGNscykge1xyXG4gICAgbW9kdWxlRGljdFttb2R1bGVOYW1lXSA9IGNscztcclxuICAgIG1vZHVsZU5hbWVEaWN0LnNldChjbHMsIG1vZHVsZU5hbWUpO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5bmqKHlnZfnsbvlnotcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbW9kdWxlTmFtZSDmqKHlnZflkI1cclxuICogQHJldHVybnMge0lNZWRpYXRvckNvbnN0cnVjdG9yfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vZHVsZShtb2R1bGVOYW1lKSB7XHJcbiAgICByZXR1cm4gbW9kdWxlRGljdFttb2R1bGVOYW1lXTtcclxufVxyXG4vKipcclxuICog6I635Y+W5qih5Z2X5ZCNXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtNb2R1bGVUeXBlfSB0eXBlIOaooeWdl+WunuS+i+aIluaooeWdl+exu+Wei1xyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSDmqKHlnZflkI1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2R1bGVOYW1lKHR5cGUpIHtcclxuICAgIHZhciBjbHMgPSBnZXRDb25zdHJ1Y3Rvcih0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb24gPyB0eXBlIDogdHlwZS5jb25zdHJ1Y3Rvcik7XHJcbiAgICByZXR1cm4gbW9kdWxlTmFtZURpY3QuZ2V0KGNscyk7XHJcbn1cclxudmFyIE1lZGlhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVkaWF0b3Ioc2tpbikge1xyXG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IE1lZGlhdG9yU3RhdHVzLlVOT1BFTjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnu5Hlrprnm67moIfmlbDnu4TvvIznrKzkuIDlsYJrZXnmmK/osIPnlKjlsYLnuqfvvIznrKzkuozlsYLmmK/or6XlsYLnuqfpnIDopoHnvJbor5HnmoTlr7nosaHmlbDnu4RcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtEaWN0aW9uYXJ5PGFueSwgYW55PltdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuYmluZFRhcmdldHMgPSBbXTtcclxuICAgICAgICB0aGlzLl9vcGVuTWFzayA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5fZGlzcG9zZURpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeItuS4reS7i+iAhVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lNZWRpYXRvcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5LiL6Z2i5piv5qih5Z2X5raI5oGv57O757ufICoqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZShjb3JlKTtcclxuICAgICAgICAvLyDotYvlgLzmqKHlnZflkI3np7BcclxuICAgICAgICB0aGlzLl9tb2R1bGVOYW1lID0gZ2V0TW9kdWxlTmFtZSh0aGlzKTtcclxuICAgICAgICAvLyDotYvlgLznmq7ogqRcclxuICAgICAgICBpZiAoc2tpbilcclxuICAgICAgICAgICAgdGhpcy5za2luID0gc2tpbjtcclxuICAgICAgICB0aGlzLm9yaVNraW4gPSBza2luO1xyXG4gICAgICAgIC8vIOWIneWni+WMlue7keWumlxyXG4gICAgICAgIGJpbmRNYW5hZ2VyLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcInN0YXR1c1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Lit5LuL6ICF54q25oCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7TWVkaWF0b3JTdGF0dXN9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcInZpZXdNb2RlbFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5oiW6K6+572uVmlld01vZGVsXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Kn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdNb2RlbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIOiuvue9rueahOaXtuWAmei/m+ihjOS4gOasoeWPmOW8glxyXG4gICAgICAgICAgICB0aGlzLl92aWV3TW9kZWwgPSBtdXRhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICAvLyDmm7TmlrDnu5HlrppcclxuICAgICAgICAgICAgYmluZE1hbmFnZXIuYmluZCh0aGlzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZWRpYXRvci5wcm90b3R5cGUsIFwiZGlzcG9zZWRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluS4reS7i+iAheaYr+WQpuW3suiiq+mUgOavgVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fc3RhdHVzID09PSBNZWRpYXRvclN0YXR1cy5ESVNQT1NFRCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcImRhdGFcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaJk+W8gOaXtuS8oOmAkueahGRhdGHlr7nosaFcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHsqfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RhdGEgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g6YCS5b2S6K6+572u5a2Q5Lit5LuL6ICF55qEZGF0YVxyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fY2hpbGRyZW47IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci5kYXRhID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZWRpYXRvci5wcm90b3R5cGUsIFwib3Blbk1hc2tcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOW8gOWQr+aXtuaYr+WQpuinpuWPkeWFqOWxj+mBrue9qe+8jOmYsuatoueUqOaIt+aTjeS9nO+8jOiuvue9ruaTjeS9nOS8muW9seWTjeaJgOacieWtkOWtmeS4reS7i+iAheOAgum7mOiupOaYr3RydWVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3Blbk1hc2s7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9vcGVuTWFzayA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvLyDpgJLlvZLorr7nva7miYDmnInlrZDkuK3ku4vogIXnmoRvcGVuTWFza1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fY2hpbGRyZW47IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5vcGVuTWFzayA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcInJlc3BvbnNlc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qih5Z2X5Yid5aeL5raI5oGv55qE6L+U5Zue5pWw5o2uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7UmVzcG9uc2VEYXRhW119XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXNwb25zZXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNwb25zZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g6YCS5b2S6K6+572u5a2Q5Lit5LuL6ICF55qEZGF0YVxyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fY2hpbGRyZW47IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci5yZXNwb25zZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJtb2R1bGVOYW1lXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmqKHlnZflkI1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGVOYW1lO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3ku45saXN0QXNzZXRz5Lit6I635Y+W5Yiw55qE5omA5pyJ6LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Yqg6L295a6M5q+V5ZCO55qE5Zue6LCD77yM5aaC5p6c5Ye66ZSZ5YiZ5Lya57uZ5Ye6ZXJy5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubG9hZEFzc2V0cyA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbWVkaWF0b3JzID0gdGhpcy5fY2hpbGRyZW4uY29uY2F0KCk7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnIgfHwgbWVkaWF0b3JzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkxvYWRBc3NldHPmjqXlj6NcclxuICAgICAgICAgICAgICAgIF90aGlzLm9uTG9hZEFzc2V0cyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDliqDovb3kuIDkuKrlrZDkuK3ku4vogIXnmoTotYTmupBcclxuICAgICAgICAgICAgICAgIHZhciBtZWRpYXRvciA9IG1lZGlhdG9ycy5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgbWVkaWF0b3IubG9hZEFzc2V0cyh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5Yqg6L296Ieq6Lqr6LWE5rqQXHJcbiAgICAgICAgdmFyIGFzc2V0cyA9IHRoaXMubGlzdEFzc2V0cygpO1xyXG4gICAgICAgIGlmIChhc3NldHMgJiYgYXNzZXRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8g5Y676YeNXHJcbiAgICAgICAgICAgIGFzc2V0cyA9IHVuaXF1ZShhc3NldHMpO1xyXG4gICAgICAgICAgICAvLyDlvIDlp4vliqDovb1cclxuICAgICAgICAgICAgdGhpcy5icmlkZ2UubG9hZEFzc2V0cyhhc3NldHMsIHRoaXMsIHRlbXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5rKh5pyJ6LWE5rqQ77yM55u05o6l6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3ku45saXN0U3R5bGVGaWxlc+S4reiOt+WPluWIsOeahOaJgOaciei1hOa6kFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KGVycj86RXJyb3IpPT52b2lkfSBoYW5kbGVyIOWKoOi9veWujOavleWQjueahOWbnuiwg++8jOWmguaenOWHuumUmeWImeS8mue7meWHumVycuWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIElNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubG9hZFN0eWxlRmlsZXMgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG1lZGlhdG9ycyA9IHRoaXMuX2NoaWxkcmVuLmNvbmNhdCgpO1xyXG4gICAgICAgIHZhciB0ZW1wID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBpZiAoZXJyIHx8IG1lZGlhdG9ycy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55Sob25Mb2FkU3R5bGVGaWxlc+aOpeWPo1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub25Mb2FkU3R5bGVGaWxlcyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDliqDovb3kuIDkuKrlrZDkuK3ku4vogIXnmoTotYTmupBcclxuICAgICAgICAgICAgICAgIHZhciBtZWRpYXRvciA9IG1lZGlhdG9ycy5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgbWVkaWF0b3IubG9hZFN0eWxlRmlsZXModGVtcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOW8gOWni+WKoOi9vWNzc+aWh+S7tlxyXG4gICAgICAgIHZhciBjc3NGaWxlcyA9IHRoaXMubGlzdFN0eWxlRmlsZXMoKTtcclxuICAgICAgICAvLyDljrvph41cclxuICAgICAgICBjc3NGaWxlcyA9IHVuaXF1ZShjc3NGaWxlcyk7XHJcbiAgICAgICAgLy8g5Yqg6L29XHJcbiAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkU3R5bGVGaWxlcyhjc3NGaWxlcywgdGVtcCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3ku45saXN0SnNGaWxlc+S4reiOt+WPluWIsOeahOaJgOaciei1hOa6kFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KGVycj86RXJyb3IpPT52b2lkfSBoYW5kbGVyIOWKoOi9veWujOavleWQjueahOWbnuiwg++8jOWmguaenOWHuumUmeWImeS8mue7meWHumVycuWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIElNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubG9hZEpzRmlsZXMgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG1lZGlhdG9ycyA9IHRoaXMuX2NoaWxkcmVuLmNvbmNhdCgpO1xyXG4gICAgICAgIHZhciB0ZW1wID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBpZiAoZXJyIHx8IG1lZGlhdG9ycy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55Sob25Mb2FkSnNGaWxlc+aOpeWPo1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub25Mb2FkSnNGaWxlcyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDliqDovb3kuIDkuKrlrZDkuK3ku4vogIXnmoRqc1xyXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gbWVkaWF0b3JzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci5sb2FkSnNGaWxlcyh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5byA5aeL5Yqg6L29anPmlofku7ZcclxuICAgICAgICB2YXIganNGaWxlcyA9IHRoaXMubGlzdEpzRmlsZXMoKTtcclxuICAgICAgICAvLyDljrvph41cclxuICAgICAgICBqc0ZpbGVzID0gdW5pcXVlKGpzRmlsZXMpO1xyXG4gICAgICAgIC8vIOWKoOi9vVxyXG4gICAgICAgIGFzc2V0c01hbmFnZXIubG9hZEpzRmlsZXMoanNGaWxlcywgdGVtcCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj5HpgIHku45saXN0SW5pdFJlcXVlc3Rz5Lit6I635Y+W5Yiw55qE5omA5pyJ6LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Yqg6L295a6M5q+V5ZCO55qE5Zue6LCD77yM5aaC5p6c5Ye66ZSZ5YiZ5Lya57uZ5Ye6ZXJy5Y+C5pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgSU1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5zZW5kSW5pdFJlcXVlc3RzID0gZnVuY3Rpb24gKGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBtZWRpYXRvcnMgPSB0aGlzLl9jaGlsZHJlbi5jb25jYXQoKTtcclxuICAgICAgICB2YXIgdGVtcCA9IGZ1bmN0aW9uIChyZXNwb25zZXMpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlcyBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXJyID0gcmVzcG9uc2VzIGluc3RhbmNlb2YgRXJyb3IgPyByZXNwb25zZXMgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKhvblNlbmRJbml0UmVxdWVzdHPmjqXlj6NcclxuICAgICAgICAgICAgICAgIF90aGlzLm9uU2VuZEluaXRSZXF1ZXN0cyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNNaW5lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNNaW5lID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LWL5YC86L+U5Zue5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVzcG9uc2VzID0gcmVzcG9uc2VzO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9wID0gX3RoaXMub25HZXRSZXNwb25zZXMocmVzcG9uc2VzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKFwi55So5oi35Lit5q2i5omT5byA5qih5Z2X5pON5L2cXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvblNlbmRJbml0UmVxdWVzdHPmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub25TZW5kSW5pdFJlcXVlc3RzKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3JzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55Sob25TZW5kSW5pdFJlcXVlc3Rz5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub25TZW5kSW5pdFJlcXVlc3RzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5Y+R6YCB5LiA5Liq5a2Q5Lit5LuL6ICF55qE5Yid5aeL5YyW5raI5oGvXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gbWVkaWF0b3JzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3Iuc2VuZEluaXRSZXF1ZXN0cyh0ZW1wKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5Y+R6YCB5omA5pyJ5qih5Z2X5raI5oGv77yM5qih5Z2X5raI5oGv6buY6K6k5Y+R6YCB5YWo5bGA5YaF5qC4XHJcbiAgICAgICAgdmFyIGlzTWluZSA9IHRydWU7XHJcbiAgICAgICAgbmV0TWFuYWdlci5zZW5kTXVsdGlSZXF1ZXN0cyh0aGlzLmxpc3RJbml0UmVxdWVzdHMoKSwgdGVtcCwgdGhpcywgdGhpcy5vYnNlcnZhYmxlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+aJgOmcgOi1hOa6kOWKoOi9veWujOavleWQjuiwg+eUqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RXJyb3J9IFtlcnJdIOWKoOi9veWHuumUmeS8mue7meWHuumUmeivr+Wvueixoe+8jOayoemUmeWImeS4jee7mVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbkxvYWRBc3NldHMgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPmiYDpnIBDU1PliqDovb3lrozmr5XlkI7osIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0Vycm9yfSBbZXJyXSDliqDovb3lh7rplJnkvJrnu5nlh7rplJnor6/lr7nosaHvvIzmsqHplJnliJnkuI3nu5lcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25Mb2FkU3R5bGVGaWxlcyA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+aJgOmcgGpz5Yqg6L295a6M5q+V5ZCO6LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFcnJvcn0gW2Vycl0g5Yqg6L295Ye66ZSZ5Lya57uZ5Ye66ZSZ6K+v5a+56LGh77yM5rKh6ZSZ5YiZ5LiN57uZXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uTG9hZEpzRmlsZXMgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPmiYDpnIDotYTmupDliqDovb3lrozmr5XlkI7osIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0Vycm9yfSBbZXJyXSDliqDovb3lh7rplJnkvJrnu5nlh7rplJnor6/lr7nosaHvvIzmsqHplJnliJnkuI3nu5lcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25TZW5kSW5pdFJlcXVlc3RzID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5b2T6I635Y+W5Yiw5omA5pyJ5Yid5aeL5YyW6K+35rGC6L+U5Zue5pe26LCD55So77yM5Y+v5Lul6YCa6L+H6L+U5Zue5LiA5LiqdHJ1ZeadpemYu+atouaooeWdl+eahOaJk+W8gFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7UmVzcG9uc2VEYXRhW119IHJlc3BvbnNlcyDov5Tlm57nu5PmnoTmlbDnu4RcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDov5Tlm550cnVl5YiZ6KGo56S65YGc5q2i5qih5Z2X5omT5byAXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uR2V0UmVzcG9uc2VzID0gZnVuY3Rpb24gKHJlc3BvbnNlcykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gO+8jOS4uuS6huWunueOsElPcGVuQ2xvc2XmjqXlj6NcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlvIDlkK/mlbDmja5cclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5YW25LuW5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0g6L+U5Zue6Ieq6Lqr5byV55SoXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliKTmlq3nirbmgIFcclxuICAgICAgICBpZiAodGhpcy5fc3RhdHVzID09PSBNZWRpYXRvclN0YXR1cy5VTk9QRU4pIHtcclxuICAgICAgICAgICAgLy8g5L+u5pS554q25oCBXHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IE1lZGlhdG9yU3RhdHVzLk9QRU5JTkc7XHJcbiAgICAgICAgICAgIC8vIOi1i+WAvOWPguaVsFxyXG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAvLyDorrDkuIDkuKrmmK/lkKbpnIDopoHpga7nvannmoRmbGFnXHJcbiAgICAgICAgICAgIHZhciBtYXNrRmxhZyA9IHRoaXMub3Blbk1hc2s7XHJcbiAgICAgICAgICAgIC8vIOWPkemAgeWIneWni+WMlua2iOaBr1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRJbml0UmVxdWVzdHMoZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIgJiYgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIoTW9kdWxlT3BlblN0YXR1cy5TdG9wLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5Yqg6L295omA5pyJ5bey5omY566h5Lit5LuL6ICF55qE6LWE5rqQXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9hZEFzc2V0cyhmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1hc2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIgJiYgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIoTW9kdWxlT3BlblN0YXR1cy5TdG9wLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yqg6L29Y3Nz5paH5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkU3R5bGVGaWxlcyhmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTpga7nvalcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1hc2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyICYmIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuU3RvcCwgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWKoOi9vWpz5paH5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmxvYWRKc0ZpbGVzKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1hc2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIpOaWremUmeivr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyICYmIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuU3RvcCwgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOimgeWFiOW8gOWQr+iHqui6q++8jOWGjeW8gOWQr+WtkOS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyICYmIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuQmVmb3JlT3Blbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5qih5p2/5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX19iZWZvcmVPbk9wZW4uYXBwbHkoX3RoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOiHqui6q29uT3BlbuaWueazlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBfdGhpcy5vbk9wZW4uYXBwbHkoX3RoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGF0YSA9IGRhdGEgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yid5aeL5YyW57uR5a6a77yM5aaC5p6c5a2Q57G75bm25rKh5pyJ5Zyob25PcGVu5Lit6K6+572udmlld01vZGVs77yM5YiZ57uZ5LiA5Liq6buY6K6k5YC85Lul5ZCv5Yqo57uR5a6a5Yqf6IO9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5fdmlld01vZGVsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3TW9kZWwgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXlrZDkuK3ku4vogIXmlbDph4/vvIzlubbnm5HlkKzlhbblvIDlkK/lrozmr5Xkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViQ291bnQgPSBfdGhpcy5fY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5omA5pyJ5bey5omY566h5Lit5LuL6ICF55qEb3BlbuaWueazlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gX3RoaXMuX2NoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3Iub3BlbihkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fc3RhdHVzID0gTWVkaWF0b3JTdGF0dXMuT1BFTkVEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOaooeadv+aWueazlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9fYWZ0ZXJPbk9wZW4uYXBwbHkoX3RoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyICYmIF90aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuQWZ0ZXJPcGVuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaChNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfT1BFTkVELCBfdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyDmmL7npLpMb2FkaW5nXHJcbiAgICAgICAgICAgIGlmIChtYXNrRmxhZykge1xyXG4gICAgICAgICAgICAgICAgbWFza01hbmFnZXIuc2hvd0xvYWRpbmcobnVsbCwgXCJtZWRpYXRvck9wZW5cIik7XHJcbiAgICAgICAgICAgICAgICBtYXNrRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/lOWbnuiHqui6q+W8leeUqFxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIGZ1bmN0aW9uIGhpZGVNYXNrKCkge1xyXG4gICAgICAgICAgICAvLyDpmpDol49Mb2FkaW5nXHJcbiAgICAgICAgICAgIGlmICghbWFza0ZsYWcpXHJcbiAgICAgICAgICAgICAgICBtYXNrTWFuYWdlci5oaWRlTG9hZGluZyhcIm1lZGlhdG9yT3BlblwiKTtcclxuICAgICAgICAgICAgbWFza0ZsYWcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLl9fYmVmb3JlT25PcGVuID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOe7meWtkOexu+eUqOeahOaooeadv+aWueazlVxyXG4gICAgfTtcclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25PcGVuID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOe7meWtkOexu+eUqOeahOaooeadv+aWueazlVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet77yM5Li65LqG5a6e546wSU9wZW5DbG9zZeaOpeWPo1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWFs+mXreaVsOaNrlxyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDlhbbku5blj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHsqfSDov5Tlm57oh6rouqvlvJXnlKhcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fc3RhdHVzID09PSBNZWRpYXRvclN0YXR1cy5PUEVORUQpIHtcclxuICAgICAgICAgICAgdmFyIGRvQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjmqKHmnb/mlrnms5VcclxuICAgICAgICAgICAgICAgIF90aGlzLl9fYmVmb3JlT25DbG9zZS5hcHBseShfdGhpcywgW2RhdGFdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgIF90aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5DTE9TSU5HO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So6Ieq6Lqrb25DbG9zZeaWueazlVxyXG4gICAgICAgICAgICAgICAgX3RoaXMub25DbG9zZS5hcHBseShfdGhpcywgW2RhdGFdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgIF90aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5DTE9TRUQ7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjmqKHmnb/mlrnms5VcclxuICAgICAgICAgICAgICAgIF90aGlzLl9fYWZ0ZXJPbkNsb3NlLmFwcGx5KF90aGlzLCBbZGF0YV0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIHN1YkNvdW50ID0gdGhpcy5fY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAoc3ViQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW4uaW5kZXhPZihtZWRpYXRvcikgPj0gMCAmJiAtLXN1YkNvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPlua2iOebkeWQrFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51bmxpc3RlbihNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfQ0xPU0VELCBoYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omn6KGM5YWz6ZetXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvQ2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW4oTWVkaWF0b3JNZXNzYWdlLk1FRElBVE9SX0NMT1NFRCwgaGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjmiYDmnInlt7LmiZjnrqHkuK3ku4vogIXnmoRjbG9zZeaWueazlVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IHRoaXMuX2NoaWxkcmVuLmNvbmNhdCgpOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZWRpYXRvciA9IF9iW19hXTtcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5jbG9zZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOayoeacieWtkOS4reS7i+iAhe+8jOebtOaOpeaJp+ihjFxyXG4gICAgICAgICAgICAgICAgZG9DbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/lOWbnuiHqui6q+W8leeUqFxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5fX2JlZm9yZU9uQ2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g57uZ5a2Q57G755So55qE5qih5p2/5pa55rOVXHJcbiAgICB9O1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLl9fYWZ0ZXJPbkNsb3NlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa0vuWPkeWFs+mXreS6i+S7tlxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goTWVkaWF0b3JNZXNzYWdlLk1FRElBVE9SX0NMT1NFRCwgdGhpcyk7XHJcbiAgICAgICAgLy8g57uZ5a2Q57G755So55qE5qih5p2/5pa55rOVXHJcbiAgICAgICAgdGhpcy5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPmiZPlvIDml7bosIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTmiZPlvIDlj4LmlbBcclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5YW25LuW5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0g6Iul6L+U5Zue5a+56LGh5YiZ5L2/55So6K+l5a+56LGh5pu/5o2i5Lyg5YWl55qEZGF0Yei/m+ihjOWQjue7reW8gOWQr+aTjeS9nFxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPlhbPpl63ml7bosIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlhbPpl63lj4LmlbBcclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5YW25LuW5Y+C5pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzkuovku7bvvIzku47ov5nkuKrmlrnms5Xnm5HlkKznmoTkuovku7bkvJrlnKjkuK3ku4vogIXplIDmr4Hml7booqvoh6rliqjnp7vpmaTnm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDkuovku7bnm67moIflr7nosaFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOS6i+S7tuexu+Wei1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDkuovku7blpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJHlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubWFwTGlzdGVuZXIgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0ID09IHRhcmdldCAmJiBkYXRhLnR5cGUgPT0gdHlwZSAmJiBkYXRhLmhhbmRsZXIgPT0gaGFuZGxlciAmJiBkYXRhLnRoaXNBcmcgPT0gdGhpc0FyZykge1xyXG4gICAgICAgICAgICAgICAgLy8g5bey57uP5a2Y5Zyo5LiA5qC355qE55uR5ZCs77yM5LiN5YaN55uR5ZCsXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6K6w5b2V55uR5ZCsXHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzLnB1c2goeyB0YXJnZXQ6IHRhcmdldCwgdHlwZTogdHlwZSwgaGFuZGxlcjogaGFuZGxlciwgdGhpc0FyZzogdGhpc0FyZyB9KTtcclxuICAgICAgICAvLyDosIPnlKjmoaXmjqXlj6NcclxuICAgICAgICB0aGlzLmJyaWRnZS5tYXBMaXN0ZW5lcih0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA55uR5ZCs5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg5LqL5Lu255uu5qCH5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5LqL5Lu25aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCR5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubWFwTGlzdGVuZXIgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0ID09IHRhcmdldCAmJiBkYXRhLnR5cGUgPT0gdHlwZSAmJiBkYXRhLmhhbmRsZXIgPT0gaGFuZGxlciAmJiBkYXRhLnRoaXNBcmcgPT0gdGhpc0FyZykge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5qGl5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZS51bm1hcExpc3RlbmVyKHRhcmdldCwgdHlwZSwgaGFuZGxlciwgdGhpc0FyZyk7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTorrDlvZVcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOaJgOacieazqOWGjOWcqOW9k+WJjeS4reS7i+iAheS4iueahOS6i+S7tuebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUudW5tYXBBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVycy5wb3AoKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5qGl5o6l5Y+jXHJcbiAgICAgICAgICAgIHRoaXMuYnJpZGdlLnVubWFwTGlzdGVuZXIoZGF0YS50YXJnZXQsIGRhdGEudHlwZSwgZGF0YS5oYW5kbGVyLCBkYXRhLnRoaXNBcmcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuZGlzcG9zZUNoaWxkID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBvcmlEaXNwb3NlKSB7XHJcbiAgICAgICAgLy8g6LCD55So5Y6f5aeL6ZSA5q+B5pa55rOVXHJcbiAgICAgICAgb3JpRGlzcG9zZS5jYWxsKG1lZGlhdG9yKTtcclxuICAgICAgICAvLyDlj5bmtojmiZjnrqFcclxuICAgICAgICB0aGlzLnVuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICB9O1xyXG4gICAgO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJyb290XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmoLnnuqfkuK3ku4vogIXvvIjlvZPlgZrmqKHlnZfnm7TmjqXooqvmiZPlvIDnmoTkuK3ku4vogIXvvIlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJTWVkaWF0b3J9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIElNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMucGFyZW50ID8gdGhpcy5wYXJlbnQucm9vdCA6IHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJjaGlsZHJlblwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5omA5pyJ5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU1lZGlhdG9yW119XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5omY566h5a2Q5Lit5LuL6ICFXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOimgeaJmOeuoeeahOS4reS7i+iAhVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5kZWxlZ2F0ZU1lZGlhdG9yID0gZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NoaWxkcmVuLmluZGV4T2YobWVkaWF0b3IpIDwgMCkge1xyXG4gICAgICAgICAgICAvLyDmiZjnrqHmlrDnmoTkuK3ku4vogIVcclxuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4ucHVzaChtZWRpYXRvcik7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWFs+ezu1xyXG4gICAgICAgICAgICBtZWRpYXRvci5wYXJlbnQgPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyDorr7nva5vYnNlcnZhYmxl5YWz57O7XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLm9ic2VydmFibGUucGFyZW50ID0gdGhpcy5fb2JzZXJ2YWJsZTtcclxuICAgICAgICAgICAgLy8g56+h5pS5ZGlzcG9zZeaWueazle+8jOS7peebkeWQrOWFtmRpc3Bvc2VcclxuICAgICAgICAgICAgaWYgKG1lZGlhdG9yLmhhc093blByb3BlcnR5KFwiZGlzcG9zZVwiKSlcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3Bvc2VEaWN0LnNldChtZWRpYXRvciwgbWVkaWF0b3IuZGlzcG9zZSk7XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLmRpc3Bvc2UgPSB0aGlzLmRpc3Bvc2VDaGlsZC5iaW5kKHRoaXMsIG1lZGlhdG9yLCBtZWRpYXRvci5kaXNwb3NlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojmiZjnrqHlrZDkuK3ku4vogIVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig6KaB5Y+W5raI5omY566h55qE5Lit5LuL6ICFXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVuZGVsZWdhdGVNZWRpYXRvciA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2NoaWxkcmVuLmluZGV4T2YobWVkaWF0b3IpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOaJmOeuoeS4reS7i+iAhVxyXG4gICAgICAgICAgICB0aGlzLl9jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTlhbPns7tcclxuICAgICAgICAgICAgbWVkaWF0b3IucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgLy8g56e76Zmkb2JzZXJ2YWJsZeWFs+ezu1xyXG4gICAgICAgICAgICBpZiAobWVkaWF0b3Iub2JzZXJ2YWJsZSlcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLm9ic2VydmFibGUucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgLy8g5oGi5aSNZGlzcG9zZeaWueazle+8jOWPlua2iOebkeWQrGRpc3Bvc2VcclxuICAgICAgICAgICAgdmFyIG9yaURpc3Bvc2UgPSB0aGlzLl9kaXNwb3NlRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICBpZiAob3JpRGlzcG9zZSlcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLmRpc3Bvc2UgPSBvcmlEaXNwb3NlO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgbWVkaWF0b3IuZGlzcG9zZTtcclxuICAgICAgICAgICAgdGhpcy5fZGlzcG9zZURpY3QuZGVsZXRlKG1lZGlhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3mjIflrprkuK3ku4vogIXmmK/lkKbljIXlkKvlnKjor6XkuK3ku4vogIXph4zvvIjliKTmlq3ojIPlm7TljIXmi6zlvZPliY3kuK3ku4vogIXlkozlrZDlrZnnuqfkuK3ku4vogIXvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig6KaB5Yik5pat55qE5Lit5LuL6ICFXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuY29udGFpbnNNZWRpYXRvciA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIC8vIOmmluWFiOWIpOaWreiHqui6q1xyXG4gICAgICAgIGlmIChtZWRpYXRvciA9PT0gdGhpcylcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8g5Yik5pat5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgdmFyIGNvbnRhaW5zID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX2NoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5jb250YWluc01lZGlhdG9yKG1lZGlhdG9yKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5zO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YW25LuW5qih5Z2X6KKr5YWz6Zet5Zue5Yiw5b2T5YmN5qih5Z2X5pe26LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5Zue5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUud2FrZVVwID0gZnVuY3Rpb24gKGZyb20sIGRhdGEpIHtcclxuICAgICAgICAvLyDosIPnlKjoh6rouqvmlrnms5VcclxuICAgICAgICB0aGlzLm9uV2FrZVVwKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIC8vIOmAkuW9kuiwg+eUqOWtkOS4reS7i+iAheaWueazlVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBtZWRpYXRvci5vbldha2VVcChmcm9tLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmqKHlnZfliIfmjaLliLDliY3lj7Dml7bosIPnlKjvvIjkuI53YWtlVXDnmoTljLrliKvmmK9vcGVu5pe2YWN0aXZhdGXkvJrop6blj5HvvIzkvYZ3YWtlVXDkuI3kvJrvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhJTWVkaWF0b3J8dW5kZWZpbmVkKX0gZnJvbSDku47lk6rkuKrmqKHlnZfmnaXliLDlvZPliY3mqKHlnZdcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWPr+iDveeahOWPguaVsOS8oOmAklxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uIChmcm9tLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g6LCD55So6Ieq6Lqr5pa55rOVXHJcbiAgICAgICAgdGhpcy5vbkFjdGl2YXRlKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIC8vIOmAkuW9kuiwg+eUqOWtkOS4reS7i+iAheaWueazlVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBtZWRpYXRvci5vbkFjdGl2YXRlKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaooeWdl+WIh+aNouWIsOWQjuWPsOaXtuiwg+eUqO+8iGNsb3Nl5LmL5ZCO5oiW6ICF5YW25LuW5qih5Z2X5omT5byA5pe277yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IHRvIOWwhuimgeWOu+W+gOWTquS4quaooeWdl1xyXG4gICAgICogQHBhcmFtIHsqfSBbZGF0YV0g5Y+v6IO955qE5Y+C5pWw5Lyg6YCSXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbiAodG8sIGRhdGEpIHtcclxuICAgICAgICAvLyDosIPnlKjoh6rouqvmlrnms5VcclxuICAgICAgICB0aGlzLm9uRGVhY3RpdmF0ZSh0bywgZGF0YSk7XHJcbiAgICAgICAgLy8g6YCS5b2S6LCD55So5a2Q5Lit5LuL6ICF5pa55rOVXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX2NoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLm9uRGVhY3RpdmF0ZSh0bywgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiX5Ye65Lit5LuL6ICF5omA6ZyA55qE6LWE5rqQ5pWw57uE77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0QXNzZXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiX5Ye65omA6ZyAQ1NT6LWE5rqQVVJM77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0U3R5bGVGaWxlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIl+WHuuaJgOmcgEpT6LWE5rqQVVJM77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0SnNGaWxlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIl+WHuuaooeWdl+WIneWni+WMluivt+axgu+8jOWPr+mHjeWGmVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtSZXF1ZXN0RGF0YVtdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0SW5pdFJlcXVlc3RzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YW25LuW5qih5Z2X6KKr5YWz6Zet5Zue5Yiw5b2T5YmN5qih5Z2X5pe26LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5Zue5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25XYWtlVXAgPSBmdW5jdGlvbiAoZnJvbSwgZGF0YSkge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5qih5Z2X5YiH5o2i5Yiw5YmN5Y+w5pe26LCD55So77yI5LiOb25XYWtlVXDnmoTljLrliKvmmK9vcGVu5pe2b25BY3RpdmF0ZeS8muinpuWPke+8jOS9hm9uV2FrZVVw5LiN5Lya77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5p2l5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChmcm9tLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmqKHlnZfliIfmjaLliLDlkI7lj7Dml7bosIPnlKjvvIhjbG9zZeS5i+WQjuaIluiAheWFtuS7luaooeWdl+aJk+W8gOaXtu+8iVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KElNZWRpYXRvcnx1bmRlZmluZWQpfSB0byDlsIbopoHljrvlvoDlk6rkuKrmqKHlnZdcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWPr+iDveeahOWPguaVsOS8oOmAklxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbkRlYWN0aXZhdGUgPSBmdW5jdGlvbiAodG8sIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcIm9ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaatOmcsklPYnNlcnZhYmxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZhYmxlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqIGRpc3BhdGNo5pa55rOV5a6e546wICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLmRpc3BhdGNoLmFwcGx5KHRoaXMuX29ic2VydmFibGUsIHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbmmK/kuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUubGlzdGVuKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5raI5oGv55uR5ZCsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOa2iOaBr+WkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10g5raI5oGvdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0g5piv5ZCm5piv5LiA5qyh5oCn55uR5ZCsXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUudW5saXN0ZW4odHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozlkb3ku6TliLDnibnlrprmtojmga/nsbvlnovkuIrvvIzlvZPov5nkuKrnsbvlnovnmoTmtojmga/mtL7lj5HliLDmoYbmnrblhoXmoLjml7bkvJrop6blj5FDb21tYW5k6L+Q6KGMXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo5YaM55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqO+8jOWPr+S7peaYr+aWueazleW9ouW8j++8jOS5n+WPr+S7peS9v+exu+W9ouW8j1xyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUubWFwQ29tbWFuZCh0eXBlLCBjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA5ZG95LukXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo6ZSA55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqFxyXG4gICAgICogQHJldHVybnMge3ZvaWR9XHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubWFwQ29tbWFuZCA9IGZ1bmN0aW9uICh0eXBlLCBjbWQpIHtcclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLnVubWFwQ29tbWFuZCh0eXBlLCBjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZSA5q+B5Lit5LuL6ICFXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8g5Yik5pat54q25oCBXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IE1lZGlhdG9yU3RhdHVzLkRJU1BPU0lORylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOS/ruaUueeKtuaAgVxyXG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IE1lZGlhdG9yU3RhdHVzLkRJU1BPU0lORztcclxuICAgICAgICAvLyDnp7vpmaTnu5HlrppcclxuICAgICAgICBiaW5kTWFuYWdlci51bmJpbmQodGhpcyk7XHJcbiAgICAgICAgLy8g5rOo6ZSA5LqL5Lu255uR5ZCsXHJcbiAgICAgICAgdGhpcy51bm1hcEFsbExpc3RlbmVycygpO1xyXG4gICAgICAgIC8vIOiwg+eUqOaooeadv+aWueazlVxyXG4gICAgICAgIHRoaXMub25EaXNwb3NlKCk7XHJcbiAgICAgICAgLy8g56e76Zmk5pi+56S677yM5Y+q56e76Zmk5rKh5pyJ5Y6f5aeL55qu6IKk55qE77yM5Zug5Li65aaC5p6c5pyJ5Y6f5aeL55qu6IKk77yM5YW25Y6f5aeLcGFyZW505Y+v6IO95LiN5biM5pyb5a2Q6IqC54K56KKr56e76ZmkXHJcbiAgICAgICAgaWYgKCF0aGlzLm9yaVNraW4pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbiAmJiB0aGlzLmJyaWRnZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuYnJpZGdlLmdldFBhcmVudCh0aGlzLnNraW4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZS5yZW1vdmVDaGlsZChwYXJlbnQsIHRoaXMuc2tpbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g56e76Zmk6KGo546w5bGC5qGlXHJcbiAgICAgICAgdGhpcy5icmlkZ2UgPSBudWxsO1xyXG4gICAgICAgIC8vIOenu+mZpFZpZXdNb2RlbFxyXG4gICAgICAgIHRoaXMuX3ZpZXdNb2RlbCA9IG51bGw7XHJcbiAgICAgICAgLy8g56e76Zmk57uR5a6a55uu5qCH5pWw57uEXHJcbiAgICAgICAgdGhpcy5iaW5kVGFyZ2V0cyA9IG51bGw7XHJcbiAgICAgICAgLy8g56e76Zmk55qu6IKkXHJcbiAgICAgICAgdGhpcy5za2luID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9yaVNraW4gPSBudWxsO1xyXG4gICAgICAgIC8vIOWwhuaJgOacieWtkOS4reS7i+iAhemUgOavgVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSB0aGlzLl9jaGlsZHJlbi5wb3AoKTtcclxuICAgICAgICAgICAgdGhpcy51bmRlbGVnYXRlTWVkaWF0b3IobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICBtZWRpYXRvci5kaXNwb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWwhm9ic2VydmFibGXnmoTplIDmr4Hmi5blu7bliLDkuIvkuIDluKfvvIzlm6DkuLromb3nhLbmiafooYzkuobplIDmr4HvvIzkvYbmnInlj6/og73ov5nkuYvlkI7ov5jkvJrkvb/nlKhvYnNlcnZhYmxl5Y+R6YCB5raI5oGvXHJcbiAgICAgICAgc3lzdGVtLm5leHRGcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpG9ic2VydmFibGVcclxuICAgICAgICAgICAgX3RoaXMuX29ic2VydmFibGUuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICBfdGhpcy5fb2JzZXJ2YWJsZSA9IG51bGw7XHJcbiAgICAgICAgICAgIC8vIOS/ruaUueeKtuaAgVxyXG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzID0gTWVkaWF0b3JTdGF0dXMuRElTUE9TRUQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPplIDmr4Hml7bosIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uRGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVkaWF0b3I7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1lZGlhdG9yO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCBNZWRpYXRvciBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JcIjtcclxuaW1wb3J0IEJyaWRnZU1lc3NhZ2UgZnJvbSBcIi4vQnJpZGdlTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyBwYW5lbE1hbmFnZXIgfSBmcm9tIFwiLi4vcGFuZWwvUGFuZWxNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IHNjZW5lTWFuYWdlciB9IGZyb20gXCIuLi9zY2VuZS9TY2VuZU1hbmFnZXJcIjtcclxuaW1wb3J0IHsgbW9kdWxlTWFuYWdlciB9IGZyb20gXCIuLi9tb2R1bGUvTW9kdWxlTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBtYXNrTWFuYWdlciB9IGZyb20gXCIuLi9tYXNrL01hc2tNYW5hZ2VyXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiDnlKjmnaXnrqHnkIbmiYDmnInooajnjrDlsYLlr7nosaFcclxuKi9cclxudmFyIEJyaWRnZU1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCcmlkZ2VNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX2JyaWRnZURpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9icmlkZ2VMaXN0ID0gW107XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnJpZGdlTWFuYWdlci5wcm90b3R5cGUsIFwiY3VycmVudEJyaWRnZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5b2T5YmN55qE6KGo546w5bGC5qGl5a6e5L6L77yI6KeE5YiZ5piv5Y+W5b2T5YmN5qih5Z2X55qE56ys5LiA5Liq5oul5pyJYnJpZGdl5bGe5oCn55qETWVkaWF0b3LnmoRicmlkZ2XvvIlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJQnJpZGdlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBCcmlkZ2VNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOaJvuWHuuW9k+WJjeeahOWcuuaZr+aIluaooeWdl1xyXG4gICAgICAgICAgICB2YXIgY3VySGFzQnJpZGdlID0gc2NlbmVNYW5hZ2VyLmN1cnJlbnRTY2VuZSB8fCBtb2R1bGVNYW5hZ2VyLmN1cnJlbnRNb2R1bGVJbnN0YW5jZTtcclxuICAgICAgICAgICAgLy8g5YWI55So5b2T5YmN6aaW5LiqSUhhc0JyaWRnZeeahGJyaWRnZVxyXG4gICAgICAgICAgICBpZiAoY3VySGFzQnJpZGdlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzQnJpZGdlcyA9IHRoaXMuZ2V0QWxsSGFzQnJpZGdlcyhjdXJIYXNCcmlkZ2UpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBoYXNCcmlkZ2VzXzEgPSBoYXNCcmlkZ2VzOyBfaSA8IGhhc0JyaWRnZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaGFzQnJpZGdlID0gaGFzQnJpZGdlc18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQnJpZGdlLmJyaWRnZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhhc0JyaWRnZS5icmlkZ2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5rKh5om+5Yiw77yM5YaN55So56ys5LiA5Liq5qGl5Luj5pu/XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fYnJpZGdlTGlzdFswXSAmJiB0aGlzLl9icmlkZ2VMaXN0WzBdWzBdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJyaWRnZU1hbmFnZXIucHJvdG90eXBlLmdldEFsbEhhc0JyaWRnZXMgPSBmdW5jdGlvbiAoaGFzQnJpZGdlKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtoYXNCcmlkZ2VdO1xyXG4gICAgICAgIC8vIOWmguaenOaYr+S4reS7i+iAhe+8jOWImemineWkluaPkOS+m+WtkOS4reS7i+iAhVxyXG4gICAgICAgIGlmIChoYXNCcmlkZ2UgaW5zdGFuY2VvZiBNZWRpYXRvcikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gaGFzQnJpZGdlLmNoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KHRoaXMuZ2V0QWxsSGFzQnJpZGdlcyh0ZW1wKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluihqOeOsOWxguahpeWunuS+i1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOihqOeOsOWxguexu+Wei1xyXG4gICAgICogQHJldHVybnMge0lCcmlkZ2V9IOihqOeOsOWxguahpeWunuS+i1xyXG4gICAgICogQG1lbWJlcm9mIEJyaWRnZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQnJpZGdlTWFuYWdlci5wcm90b3R5cGUuZ2V0QnJpZGdlID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2JyaWRnZURpY3RbdHlwZV07XHJcbiAgICAgICAgcmV0dXJuIChkYXRhICYmIGRhdGFbMF0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6YCa6L+H57uZ5Ye65LiA5Liq5pi+56S65a+56LGh55qu6IKk5a6e5L6L5p2l6I635Y+W5ZCI6YCC55qE6KGo546w5bGC5qGl5a6e5L6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSBza2luIOearuiCpOWunuS+i1xyXG4gICAgICogQHJldHVybnMge0lCcmlkZ2V8bnVsbH0g55qu6IKk5omA5bGe6KGo546w5bGC5qGl5a6e5L6LXHJcbiAgICAgKiBAbWVtYmVyb2YgQnJpZGdlTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCcmlkZ2VNYW5hZ2VyLnByb3RvdHlwZS5nZXRCcmlkZ2VCeVNraW4gPSBmdW5jdGlvbiAoc2tpbikge1xyXG4gICAgICAgIGlmIChza2luKSB7XHJcbiAgICAgICAgICAgIC8vIOmBjeWOhuaJgOacieW3suazqOWGjOeahOihqOeOsOWxguahpei/m+ihjOWIpOaWrVxyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fYnJpZGdlTGlzdDsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJyaWRnZSA9IGRhdGFbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoYnJpZGdlLmlzTXlTa2luKHNraW4pKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozkuIDkuKrooajnjrDlsYLmoaXlrp7kvovliLDmoYbmnrbkuK1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gey4uLklCcmlkZ2VbXX0gYnJpZGdlcyDopoHms6jlhoznmoTmiYDmnInooajnjrDlsYLmoaVcclxuICAgICAqIEBtZW1iZXJvZiBCcmlkZ2VNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyQnJpZGdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJyaWRnZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBicmlkZ2VzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/m+ihjERPTeWIneWni+WMluWIpOaWrVxyXG4gICAgICAgIGlmICghZG9jdW1lbnQuYm9keSkge1xyXG4gICAgICAgICAgICB2YXIgb25Mb2FkID0gZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uTG9hZCk7XHJcbiAgICAgICAgICAgICAgICAvLyDph43mlrDosIPnlKjms6jlhozmlrnms5VcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlZ2lzdGVyQnJpZGdlLmFwcGx5KF90aGlzLCBicmlkZ2VzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uTG9hZCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6L+b6KGM5Yid5aeL5YyWXHJcbiAgICAgICAgaWYgKGJyaWRnZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIC8vIOiusOW9lVxyXG4gICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIGJyaWRnZXNfMSA9IGJyaWRnZXM7IF9hIDwgYnJpZGdlc18xLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZXNfMVtfYV07XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGJyaWRnZS50eXBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9icmlkZ2VEaWN0W3R5cGVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBbYnJpZGdlLCBmYWxzZV07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnJpZGdlRGljdFt0eXBlXSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnJpZGdlTGlzdC5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+WIneWni+WMllxyXG4gICAgICAgICAgICBmb3IgKHZhciBfYiA9IDAsIGJyaWRnZXNfMiA9IGJyaWRnZXM7IF9iIDwgYnJpZGdlc18yLmxlbmd0aDsgX2IrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZXNfMltfYl07XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQnJpZGdlTWVzc2FnZS5CUklER0VfQkVGT1JFX0lOSVQsIGJyaWRnZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDliJ3lp4vljJZNYXNrXHJcbiAgICAgICAgICAgICAgICBtYXNrTWFuYWdlci5yZWdpc3Rlck1hc2soYnJpZGdlLnR5cGUsIGJyaWRnZS5tYXNrRW50aXR5KTtcclxuICAgICAgICAgICAgICAgIC8vIOazqOWGjOmAmueUqOaPkOekuuahhlxyXG4gICAgICAgICAgICAgICAgcGFuZWxNYW5hZ2VyLnJlZ2lzdGVyUHJvbXB0KGJyaWRnZS50eXBlLCBicmlkZ2UucHJvbXB0Q2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgLy8g5Yid5aeL5YyW6K+l6KGo546w5bGC5a6e5L6LXHJcbiAgICAgICAgICAgICAgICBpZiAoYnJpZGdlLmluaXQpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJpZGdlLmluaXQoYWZ0ZXJJbml0QnJpZGdlKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBhZnRlckluaXRCcmlkZ2UoYnJpZGdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50ZXN0QWxsSW5pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBhZnRlckluaXRCcmlkZ2UoYnJpZGdlKSB7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FGVEVSX0lOSVQsIGJyaWRnZSk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWIneWni+WMluWujOavleWxnuaAp1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHNlbGYuX2JyaWRnZURpY3RbYnJpZGdlLnR5cGVdO1xyXG4gICAgICAgICAgICBkYXRhWzFdID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8g5YWI6ZqQ6JeP6KGo546w5bGC5qGl55qEaHRtbFdyYXBwZXJcclxuICAgICAgICAgICAgYnJpZGdlLmh0bWxXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgLy8g5rWL6K+V5piv5ZCm5YWo6YOo5Yid5aeL5YyW5a6M5q+VXHJcbiAgICAgICAgICAgIHNlbGYudGVzdEFsbEluaXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQnJpZGdlTWFuYWdlci5wcm90b3R5cGUudGVzdEFsbEluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFsbEluaXRlZCA9IHRydWU7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX2JyaWRnZUxpc3Q7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBhbGxJbml0ZWQgPSBhbGxJbml0ZWQgJiYgZGF0YVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFsbEluaXRlZClcclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChCcmlkZ2VNZXNzYWdlLkJSSURHRV9BTExfSU5JVCk7XHJcbiAgICB9O1xyXG4gICAgQnJpZGdlTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgQnJpZGdlTWFuYWdlcik7XHJcbiAgICByZXR1cm4gQnJpZGdlTWFuYWdlcjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQnJpZGdlTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGJyaWRnZU1hbmFnZXIgPSBjb3JlLmdldEluamVjdChCcmlkZ2VNYW5hZ2VyKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBnZXRDb25zdHJ1Y3RvciB9IGZyb20gXCIuLi8uLi91dGlscy9Db25zdHJ1Y3RVdGlsXCI7XHJcbmltcG9ydCBNb2R1bGVNZXNzYWdlIGZyb20gXCIuL01vZHVsZU1lc3NhZ2VcIjtcclxuaW1wb3J0IHsgTW9kdWxlT3BlblN0YXR1cyB9IGZyb20gXCIuLi9tZWRpYXRvci9JTWVkaWF0b3JNb2R1bGVQYXJ0XCI7XHJcbmltcG9ydCB7IGdldE1vZHVsZSB9IGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTRcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTVcclxuICpcclxuICog5qih5Z2X566h55CG5Zmo77yM566h55CG5qih5Z2X55u45YWz55qE5omA5pyJ5pON5L2c44CC5qih5Z2X5YW35pyJ5ZSv5LiA5oCn77yM5ZCM5LiA5pe26Ze05LiN5Y+v5Lul5omT5byA5Lik5Liq55u45ZCM5qih5Z2X77yM5aaC5p6c5omT5byA5YiZ5Lya6YCA5Zue5Yiw5YWI5YmN55qE5qih5Z2X5aSEXHJcbiovXHJcbnZhciBNb2R1bGVNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTW9kdWxlTWFuYWdlcigpIHtcclxuICAgICAgICB0aGlzLl9tb2R1bGVTdGFjayA9IFtdO1xyXG4gICAgICAgIHRoaXMuX29wZW5DYWNoZSA9IFtdO1xyXG4gICAgICAgIHRoaXMuX29wZW5pbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2J1c3kgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZSwgXCJjdXJyZW50TW9kdWxlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3mqKHlnZdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcnx1bmRlZmluZWR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGN1ckRhdGEgPSB0aGlzLmdldEN1cnJlbnQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIChjdXJEYXRhICYmIGN1ckRhdGFbMF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLCBcImN1cnJlbnRNb2R1bGVJbnN0YW5jZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5b2T5YmN5qih5Z2X55qE5a6e5L6LXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7KElNZWRpYXRvcnx1bmRlZmluZWQpfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJEYXRhID0gdGhpcy5nZXRDdXJyZW50KCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoY3VyRGF0YSAmJiBjdXJEYXRhWzFdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZSwgXCJhY3RpdmVDb3VudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5rS75Yqo5qih5Z2X5pWw6YePXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGVTdGFjay5sZW5ndGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaooeWdl+WcqOagiOS4reeahOe0ouW8lVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yQ29uc3RydWN0b3J9IGNscyDmqKHlnZfnsbvlnotcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IOe0ouW8leWAvFxyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZ2V0SW5kZXggPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX21vZHVsZVN0YWNrLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb2R1bGVTdGFja1tpXVswXSA9PSBjbHMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W57Si5byV5aSE5qih5Z2X57G75Z6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOaooeWdl+e0ouW8leWAvFxyXG4gICAgICogQHJldHVybnMge0lNZWRpYXRvckNvbnN0cnVjdG9yfSDmqKHlnZfnsbvlnotcclxuICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLmdldE1vZHVsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fbW9kdWxlU3RhY2tbaW5kZXhdO1xyXG4gICAgICAgIHJldHVybiBkYXRhICYmIGRhdGFbMF07XHJcbiAgICB9O1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZ2V0QWZ0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9tb2R1bGVTdGFjazsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKG1vZHVsZVswXSA9PSBjbHMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChtb2R1bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZS5nZXRDdXJyZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOaMiemhuuW6j+mBjeWOhuaooeWdl++8jOWPluWHuuacgOaWsOeahOayoeacieWcqOW8gOWQr+S4reeahOaooeWdl1xyXG4gICAgICAgIHZhciB0YXJnZXQ7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX21vZHVsZVN0YWNrOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKHRlbXBbMF0gIT09IHRoaXMuX29wZW5pbmcpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRlbXA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5qih5Z2X5piv5ZCm5byA5ZCv5LitXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcn0gY2xzIOimgeWIpOaWreeahOaooeWdl+exu+Wei1xyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IOaYr+WQpuW8gOWQr1xyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuaXNPcGVuZWQgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9tb2R1bGVTdGFjay5maWx0ZXIoZnVuY3Rpb24gKHRlbXApIHsgcmV0dXJuIHRlbXBbMF0gPT0gY2xzOyB9KS5sZW5ndGggPiAwKTtcclxuICAgIH07XHJcbiAgICBNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZS5hY3RpdmF0ZU1vZHVsZSA9IGZ1bmN0aW9uIChtb2R1bGUsIGZyb20sIGRhdGEpIHtcclxuICAgICAgICBpZiAobW9kdWxlKSB7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqGFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgIG1vZHVsZS5hY3RpdmF0ZShmcm9tLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZGVhY3RpdmF0ZU1vZHVsZSA9IGZ1bmN0aW9uIChtb2R1bGUsIHRvLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKG1vZHVsZSkge1xyXG4gICAgICAgICAgICAvLyDosIPnlKhkZWFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgIG1vZHVsZS5kZWFjdGl2YXRlKHRvLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDmqKHlnZdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge01vZHVsZVR5cGV8c3RyaW5nfSBjbHNPck5hbWUg5qih5Z2X57G75Z6L5oiW5ZCN56ewXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj4LmlbBcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3JlcGxhY2U9ZmFsc2VdIOaYr+WQpuabv+aNouW9k+WJjeaooeWdl1xyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChtb2R1bGUsIGRhdGEsIHJlcGxhY2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChyZXBsYWNlID09PSB2b2lkIDApIHsgcmVwbGFjZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5a2X56ym5Liy5YiZ6I635Y+W5byV55SoXHJcbiAgICAgICAgdmFyIHR5cGUgPSAodHlwZW9mIG1vZHVsZSA9PSBcInN0cmluZ1wiID8gZ2V0TW9kdWxlKG1vZHVsZSkgOiBtb2R1bGUpO1xyXG4gICAgICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgICAgIGlmICghdHlwZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuato+WcqOaJk+W8gOaooeWdl1xyXG4gICAgICAgIGlmICh0aGlzLl9idXN5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5DYWNoZS5wdXNoKFt0eXBlLCBkYXRhLCByZXBsYWNlXSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYnVzeSA9IHRydWU7XHJcbiAgICAgICAgLy8g5Y+W5Yiw57G75Z6LXHJcbiAgICAgICAgdmFyIGNscyA9IGdldENvbnN0cnVjdG9yKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IHR5cGUgOiB0eXBlLmNvbnN0cnVjdG9yKTtcclxuICAgICAgICB2YXIgYWZ0ZXIgPSB0aGlzLmdldEFmdGVyKGNscyk7XHJcbiAgICAgICAgaWYgKCFhZnRlcikge1xyXG4gICAgICAgICAgICAvLyDorrDlvZXmraPlnKjmiZPlvIDnmoTmqKHlnZfnsbvlnotcclxuICAgICAgICAgICAgdGhpcy5fb3BlbmluZyA9IHR5cGU7XHJcbiAgICAgICAgICAgIC8vIOWwmuacquaJk+W8gOi/h++8jOato+W4uOW8gOWQr+aooeWdl1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdHlwZSBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gbmV3IGNscygpIDogdHlwZTtcclxuICAgICAgICAgICAgLy8g6LWL5YC85omT5byA5Y+C5pWwXHJcbiAgICAgICAgICAgIHRhcmdldC5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgLy8g5pWw5o2u5YWI6KGMXHJcbiAgICAgICAgICAgIHZhciBmcm9tID0gdGhpcy5nZXRDdXJyZW50KCk7XHJcbiAgICAgICAgICAgIHZhciBmcm9tTW9kdWxlID0gZnJvbSAmJiBmcm9tWzFdO1xyXG4gICAgICAgICAgICB2YXIgbW9kdWxlRGF0YSA9IFtjbHMsIHRhcmdldCwgbnVsbF07XHJcbiAgICAgICAgICAgIHRoaXMuX21vZHVsZVN0YWNrLnVuc2hpZnQobW9kdWxlRGF0YSk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWbnuiwg1xyXG4gICAgICAgICAgICB0YXJnZXQubW9kdWxlT3BlbkhhbmRsZXIgPSBmdW5jdGlvbiAoc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2R1bGVPcGVuU3RhdHVzLlN0b3A6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOWFiOihjOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcERhdGEgPSBfdGhpcy5fbW9kdWxlU3RhY2suc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6ZSA5q+B5qih5Z2XXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBEYXRhWzFdLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5aSx6LSl5raI5oGvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFX0ZBSUxFRCwgY2xzLCBmcm9tICYmIGZyb21bMF0sIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOe7k+adn+S4gOasoeaooeWdl+W8gOWQr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5vbkZpbmlzaE9wZW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2R1bGVPcGVuU3RhdHVzLkJlZm9yZU9wZW46XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOi/memHjOimgeS8mOWFiOWFs+mXreagh+ivhuespu+8jOWQpuWImeWcqOW8gOWQr+eahOaooeWdl+eahG9uT3BlbuaWueazlemHjOWmguaenOacieaTjeS9nE1hc2vnmoTliqjkvZzlsLHkvJrooqvov5nkuKrmoIfor4bpmLvloZ7kvY9cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX29wZW5pbmcgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDnr6HmlLl0YXJnZXTnmoRjbG9zZeaWueazle+8jOS9v+WFtuaUueS4uuinpuWPkU1vZHVsZU1hbmFnZXLnmoRjbG9zZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVEYXRhWzJdID0gdGFyZ2V0Lmhhc093blByb3BlcnR5KFwiY2xvc2VcIikgPyB0YXJnZXQuY2xvc2UgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuY2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlTWFuYWdlci5jbG9zZSh0YXJnZXQsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZHVsZU9wZW5TdGF0dXMuQWZ0ZXJPcGVuOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkRlYWN0aXZhdGXmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGVhY3RpdmF0ZU1vZHVsZShmcm9tTW9kdWxlLCB0YXJnZXQsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmFjdGl2YXRlTW9kdWxlKHRhcmdldCwgZnJvbU1vZHVsZSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenHJlcGxhY2XmmK90cnVl77yM5YiZ5YWz5o6J5LiK5LiA5Liq5qih5Z2XXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xvc2UoZnJvbSAmJiBmcm9tWzBdLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5raI5oGvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFLCBjbHMsIGZyb21Nb2R1bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub25GaW5pc2hPcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDosIPnlKhvcGVu5o6l5Y+jXHJcbiAgICAgICAgICAgIHRhcmdldC5vcGVuKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChhZnRlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIOW3sue7j+aJk+W8gOS4lOS4jeaYr+W9k+WJjeaooeWdl++8jOWFiOWFs+mXreW9k+WJjeaooeWdl+WIsOebruagh+aooeWdl+S5i+mXtOeahOaJgOacieaooeWdl1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMSwgbGVuID0gYWZ0ZXIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoYWZ0ZXJbaV1bMF0sIGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOacgOWQjuWFs+mXreW9k+WJjeaooeWdl++8jOS7peWunueOsOS7juW9k+WJjeaooeWdl+ebtOaOpei3s+WbnuWIsOebruagh+aooeWdl1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKGFmdGVyWzBdWzBdLCBkYXRhKTtcclxuICAgICAgICAgICAgLy8g57uT5p2f5LiA5qyh5qih5Z2X5byA5ZCvXHJcbiAgICAgICAgICAgIHRoaXMub25GaW5pc2hPcGVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgdGhpcy5vbkZpbmlzaE9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUub25GaW5pc2hPcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOWFs+mXreagh+ivhuesplxyXG4gICAgICAgIHRoaXMuX29wZW5pbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2J1c3kgPSBmYWxzZTtcclxuICAgICAgICAvLyDlpoLmnpzmnInnvJPlrZjnmoTmqKHlnZfpnIDopoHmiZPlvIDliJnmiZPlvIDkuYtcclxuICAgICAgICBpZiAodGhpcy5fb3BlbkNhY2hlLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgIHRoaXMub3Blbi5hcHBseSh0aGlzLCB0aGlzLl9vcGVuQ2FjaGUuc2hpZnQoKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhbPpl63mqKHlnZfvvIzlj6rmnInlhbPpl63nmoTmmK/lvZPliY3mqKHlnZfml7bmiY3kvJrop6blj5FvbkRlYWN0aXZhdGXlkoxvbkFjdGl2YXRl77yM5ZCm5YiZ5Y+q5Lya6Kem5Y+RY2xvc2VcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge01vZHVsZVR5cGV8c3RyaW5nfSBjbHNPck5hbWUg5qih5Z2X57G75Z6L5oiW5ZCN56ewXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKG1vZHVsZSwgZGF0YSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+Wtl+espuS4suWImeiOt+WPluW8leeUqFxyXG4gICAgICAgIHZhciB0eXBlID0gKHR5cGVvZiBtb2R1bGUgPT0gXCJzdHJpbmdcIiA/IGdldE1vZHVsZShtb2R1bGUpIDogbW9kdWxlKTtcclxuICAgICAgICAvLyDpnZ7nqbrliKTmlq1cclxuICAgICAgICBpZiAoIXR5cGUpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyDmlbDph4/liKTmlq3vvIzkuI3otrPkuIDkuKrmqKHlnZfml7bkuI3lhbPpl61cclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVDb3VudCA8PSAxKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g5Y+W5Yiw57G75Z6LXHJcbiAgICAgICAgdmFyIGNscyA9IGdldENvbnN0cnVjdG9yKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IHR5cGUgOiB0eXBlLmNvbnN0cnVjdG9yKTtcclxuICAgICAgICAvLyDlrZjlnKjmgKfliKTmlq1cclxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmdldEluZGV4KGNscyk7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOWPluWIsOebruagh+aooeWdl1xyXG4gICAgICAgIHZhciBtb2R1bGVEYXRhID0gdGhpcy5fbW9kdWxlU3RhY2tbaW5kZXhdO1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSBtb2R1bGVEYXRhWzFdO1xyXG4gICAgICAgIC8vIOaBouWkjeWOn+Wni2Nsb3Nl5pa55rOVXHJcbiAgICAgICAgdmFyIG9yaUNsb3NlID0gbW9kdWxlRGF0YVsyXTtcclxuICAgICAgICBpZiAob3JpQ2xvc2UpXHJcbiAgICAgICAgICAgIHRhcmdldC5jbG9zZSA9IG9yaUNsb3NlO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgZGVsZXRlIHRhcmdldC5jbG9zZTtcclxuICAgICAgICAvLyDlpoLmnpzmmK/lvZPliY3mqKHlnZfvvIzliJnpnIDopoHosIPnlKhvbkRlYWN0aXZhdGXlkoxvbkFjdGl2YXRl5o6l5Y+j77yM5ZCm5YiZ5LiN55SoXHJcbiAgICAgICAgaWYgKGluZGV4ID09IDApIHtcclxuICAgICAgICAgICAgLy8g5pWw5o2u5YWI6KGMXHJcbiAgICAgICAgICAgIHRoaXMuX21vZHVsZVN0YWNrLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluWJjeS4gOS4quaooeWdl1xyXG4gICAgICAgICAgICB2YXIgdG8gPSB0aGlzLl9tb2R1bGVTdGFja1swXTtcclxuICAgICAgICAgICAgdmFyIHRvTW9kdWxlID0gdG8gJiYgdG9bMV07XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqG9uRGVhY3RpdmF0ZeaOpeWPo1xyXG4gICAgICAgICAgICB0aGlzLmRlYWN0aXZhdGVNb2R1bGUodGFyZ2V0LCB0b01vZHVsZSwgZGF0YSk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqGNsb3Nl5o6l5Y+jXHJcbiAgICAgICAgICAgIHRhcmdldC5jbG9zZShkYXRhKTtcclxuICAgICAgICAgICAgLy8g6LCD55Sob25BY3RpdmF0ZeaOpeWPo1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlTW9kdWxlKHRvTW9kdWxlLCB0YXJnZXQsIGRhdGEpO1xyXG4gICAgICAgICAgICAvLyDosIPnlKhvbldha2VVcOaOpeWPo1xyXG4gICAgICAgICAgICB0b01vZHVsZS53YWtlVXAodGFyZ2V0LCBkYXRhKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5raI5oGvXHJcbiAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFLCB0byAmJiB0b1swXSwgY2xzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICB0aGlzLl9tb2R1bGVTdGFjay5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAvLyDosIPnlKhjbG9zZeaOpeWPo1xyXG4gICAgICAgICAgICB0YXJnZXQuY2xvc2UoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1vZHVsZU1hbmFnZXIgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIE1vZHVsZU1hbmFnZXIpO1xyXG4gICAgcmV0dXJuIE1vZHVsZU1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1vZHVsZU1hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBtb2R1bGVNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoTW9kdWxlTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IGxvYWQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvSFRUUFV0aWxcIjtcclxuaW1wb3J0IHsgaXNBYnNvbHV0ZVBhdGggfSBmcm9tIFwiLi4vLi4vdXRpbHMvVVJMVXRpbFwiO1xyXG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIi4uL3ZlcnNpb24vVmVyc2lvblwiO1xyXG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCIuLi9lbnYvRW52aXJvbm1lbnRcIjtcclxuaW1wb3J0IHsgdW5pcXVlIH0gZnJvbSBcIi4uLy4uL3V0aWxzL0FycmF5VXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMjZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMjZcclxuICpcclxuICog6LWE5rqQ566h55CG5ZmoXHJcbiovXHJcbnZhciBBc3NldHNNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXNzZXRzTWFuYWdlcigpIHtcclxuICAgICAgICB0aGlzLl9rZXlEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fYXNzZXRzRGljdCA9IHt9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBBc3NldHNNYW5hZ2VyLnByb3RvdHlwZS5jb25maWdQYXRoID0gZnVuY3Rpb24gKGFyZzEsIGFyZzIpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICB0aGlzLl9rZXlEaWN0W2FyZzFdID0gYXJnMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmcxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9rZXlEaWN0W2tleV0gPSBhcmcxW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5botYTmupDvvIzlkIzmraXnmoTvvIzkuJTlpoLmnpzmib7kuI3liLDotYTmupDlubbkuI3kvJrop6blj5HliqDovb1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5T3JQYXRoIOi1hOa6kOeahOefreWQjeensOaIlui3r+W+hFxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXNzZXRzTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBc3NldHNNYW5hZ2VyLnByb3RvdHlwZS5nZXRBc3NldHMgPSBmdW5jdGlvbiAoa2V5T3JQYXRoKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSB0aGlzLl9rZXlEaWN0W2tleU9yUGF0aF0gfHwga2V5T3JQYXRoO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hc3NldHNEaWN0W3BhdGhdO1xyXG4gICAgICAgIC8vIOWmguaenOaYr+S4quaVsOe7hOWImeihqOekuuato+WcqOWKoOi9veS4re+8jOi/lOWbnnVuZGVmaW5lZFxyXG4gICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBBcnJheSlcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3otYTmupDvvIzlpoLmnpzlt7LliqDovb3ov4fliJnlkIzmraXlm57osIPvvIzlpoLmnpzmnKrliqDovb3liJnliqDovb3lkI7lvILmraXlm57osINcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xzdHJpbmdbXX0ga2V5T3JQYXRoIOi1hOa6kOefreWQjeensOaIlui1hOa6kOi3r+W+hFxyXG4gICAgICogQHBhcmFtIHsoYXNzZXRzPzphbnl8YW55W10pPT52b2lkfSBjb21wbGV0ZSDlrozmiJDlm57osIPvvIzlpoLmnpzliqDovb3lpLHotKXliJnlj4LmlbDmmK/kuKpFcnJvcuWvueixoVxyXG4gICAgICogQHBhcmFtIHtYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZX0gW3Jlc3BvbnNlVHlwZV0g5Yqg6L2957G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhrZXlPclBhdGg/OnN0cmluZywgYXNzZXRzPzphbnkpPT52b2lkfSBbb25lQ29tcGxldGVdIOS4gOS4qui1hOa6kOWKoOi9veWujOavleS8muiwg+eUqOi/meS4quWbnuiwg++8jOWmguaenOacieeahOivneOAguS7heWcqGtleU9yUGF0aOaYr+aVsOe7hOaDheWGteS4i+eUn+aViFxyXG4gICAgICogQHJldHVybnMge3ZvaWR9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXNzZXRzTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBc3NldHNNYW5hZ2VyLnByb3RvdHlwZS5sb2FkQXNzZXRzID0gZnVuY3Rpb24gKGtleU9yUGF0aCwgY29tcGxldGUsIHJlc3BvbnNlVHlwZSwgb25lQ29tcGxldGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgICAgIGlmICgha2V5T3JQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbXBsZXRlICYmIGNvbXBsZXRlKHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDojrflj5bot6/lvoRcclxuICAgICAgICBpZiAoa2V5T3JQYXRoIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgLy8g5pWw57uE5Y676YeNXHJcbiAgICAgICAgICAgIGtleU9yUGF0aCA9IHVuaXF1ZShrZXlPclBhdGgpO1xyXG4gICAgICAgICAgICAvLyDmmK/kuKrmlbDnu4TvvIzovazmjaLmiJDljZXkuIDlkI3np7DmiJblr7nosaFcclxuICAgICAgICAgICAgdmFyIGNvdW50ID0ga2V5T3JQYXRoLmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICAgICAgLy8g5Yik5pat5pWw6YePXHJcbiAgICAgICAgICAgIGlmIChjb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOWjsOaYjuWbnuiwg1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAocGF0aCwgYXNzZXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgb25lQ29tcGxldGUgJiYgb25lQ29tcGxldGUocGF0aCwgYXNzZXRzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDloavlhYXmlbDnu4RcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBrZXlPclBhdGguaW5kZXhPZihwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzW2luZGV4XSA9IGFzc2V0cztcclxuICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3lrozmiJBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoLS1jb3VudCA9PT0gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGUgJiYgY29tcGxldGUocmVzdWx0cyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy8g5bm26KGM5Yqg6L296LWE5rqQXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY291bnQ7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0ga2V5T3JQYXRoW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEFzc2V0cyhwYXRoLCBudWxsLCBudWxsLCBoYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOebtOaOpeWujOaIkFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGUgJiYgY29tcGxldGUocmVzdWx0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOaYr+WNleS4gOWQjeensOaIluWvueixoVxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2tleURpY3Rba2V5T3JQYXRoXSB8fCBrZXlPclBhdGg7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluWAvFxyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLl9hc3NldHNEaWN0W3BhdGhdO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgLy8g5q2j5Zyo5Yqg6L295Lit77yM562J5b6F5LmLXHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5wdXNoKGNvbXBsZXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgLy8g5bey57uP5Yqg6L296L+H5LqG77yM55u05o6l6L+U5ZueXHJcbiAgICAgICAgICAgICAgICBvbmVDb21wbGV0ZSAmJiBvbmVDb21wbGV0ZShrZXlPclBhdGgsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlICYmIGNvbXBsZXRlKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOayoeacieWwseWOu+WKoOi9vVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXRzRGljdFtwYXRoXSA9IHZhbHVlID0gW2Z1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25lQ29tcGxldGUgJiYgb25lQ29tcGxldGUoa2V5T3JQYXRoLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZSAmJiBjb21wbGV0ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1dO1xyXG4gICAgICAgICAgICAgICAgbG9hZCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB2ZXJzaW9uLndyYXBIYXNoVXJsKHBhdGgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZUNETjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IHJlc3BvbnNlVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiusOW9lee7k+aenFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYXNzZXRzRGljdFtwYXRoXSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6YCa55+l5ZCE5Liq5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVfMSA9IHZhbHVlOyBfaSA8IHZhbHVlXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHZhbHVlXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOe7k+aenFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMuX2Fzc2V0c0RpY3RbcGF0aF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmAmuefpeWQhOS4quWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlXzIgPSB2YWx1ZTsgX2kgPCB2YWx1ZV8yLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB2YWx1ZV8yW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L29Q1NT5qC35byP5paH5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gY3NzRmlsZXMg5qC35byP5paH5Lu2VVJM5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0geyhlcnI/OkVycm9yKT0+dm9pZH0gaGFuZGxlciDlrozmiJDlm57osINcclxuICAgICAqIEBtZW1iZXJvZiBBc3NldHNNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEFzc2V0c01hbmFnZXIucHJvdG90eXBlLmxvYWRTdHlsZUZpbGVzID0gZnVuY3Rpb24gKGNzc0ZpbGVzLCBoYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKCFjc3NGaWxlcyB8fCBjc3NGaWxlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb3VudCA9IGNzc0ZpbGVzLmxlbmd0aDtcclxuICAgICAgICB2YXIgc3RvcCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY3NzRmlsZXNfMSA9IGNzc0ZpbGVzOyBfaSA8IGNzc0ZpbGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjc3NGaWxlID0gY3NzRmlsZXNfMVtfaV07XHJcbiAgICAgICAgICAgIHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XHJcbiAgICAgICAgICAgIGNzc05vZGUucmVsID0gXCJzdHlsZXNoZWV0XCI7XHJcbiAgICAgICAgICAgIGNzc05vZGUudHlwZSA9IFwidGV4dC9jc3NcIjtcclxuICAgICAgICAgICAgY3NzTm9kZS5ocmVmID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHZlcnNpb24ud3JhcEhhc2hVcmwoY3NzRmlsZSkpO1xyXG4gICAgICAgICAgICBjc3NOb2RlLm9ubG9hZCA9IG9uTG9hZE9uZTtcclxuICAgICAgICAgICAgY3NzTm9kZS5vbmVycm9yID0gb25FcnJvck9uZTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjc3NOb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25Mb2FkT25lKCkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzlhajpg6jliqDovb3lrozmr5XliJnosIPnlKjlm57osINcclxuICAgICAgICAgICAgaWYgKCFzdG9wICYmIC0tY291bnQgPT09IDApXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRXJyb3JPbmUoZXZ0KSB7XHJcbiAgICAgICAgICAgIGlmICghc3RvcCkge1xyXG4gICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKG5ldyBFcnJvcihcIkNTU+WKoOi9veWksei0pVwiKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb1KU+aWh+S7tlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SlNGaWxlW119IGpzRmlsZXMganPmlofku7bliJfooahcclxuICAgICAqIEBwYXJhbSB7KGVycj86RXJyb3IpPT52b2lkfSBoYW5kbGVyIOWujOaIkOWbnuiwg1xyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3JkZXJlZD1mYWxzZV0g5piv5ZCm5L+d6K+B5qCH562+5b2i5byPanPnmoTmiafooYzpobrluo/vvIzkv53or4HmiafooYzpobrluo/kvJrpmY3kvY7moIfnrb7lvaLlvI9qc+eahOWKoOi9vemAn+W6pu+8jOWboOS4uuW/hemhu+S4suihjOWKoOi9veOAguivpeWPguaVsOS4jeS8muW9seWTjUpTT05Q5b2i5byP55qE5Yqg6L296YCf5bqm5ZKM5omn6KGM6aG65bqP77yMSlNPTlDlvaLlvI/ohJrmnKzmgLvmmK/lubbooYzliqDovb3kuJTpobrluo/miafooYznmoTjgILpu5jorqTmmK90cnVlXHJcbiAgICAgKiBAbWVtYmVyb2YgQXNzZXRzTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBc3NldHNNYW5hZ2VyLnByb3RvdHlwZS5sb2FkSnNGaWxlcyA9IGZ1bmN0aW9uIChqc0ZpbGVzLCBoYW5kbGVyLCBvcmRlcmVkKSB7XHJcbiAgICAgICAgaWYgKG9yZGVyZWQgPT09IHZvaWQgMCkgeyBvcmRlcmVkID0gdHJ1ZTsgfVxyXG4gICAgICAgIGlmICghanNGaWxlcyB8fCBqc0ZpbGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAganNGaWxlcyA9IGpzRmlsZXMuY29uY2F0KCk7XHJcbiAgICAgICAgdmFyIGNvdW50ID0ganNGaWxlcy5sZW5ndGg7XHJcbiAgICAgICAgdmFyIGpzb25wQ291bnQgPSAwO1xyXG4gICAgICAgIHZhciBzdG9wID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIG5vZGVzID0gW107XHJcbiAgICAgICAgLy8g6YGN5Y6G5Yqg6L29anNcclxuICAgICAgICBmb3IgKHZhciBpIGluIGpzRmlsZXMpIHtcclxuICAgICAgICAgICAgdmFyIGpzRmlsZSA9IGpzRmlsZXNbaV07XHJcbiAgICAgICAgICAgIC8vIOe7n+S4gOexu+Wei1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGpzRmlsZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv566A5Y2V6Lev5b6E77yM5Y+Y5oiQSlNGaWxlRGF0YVxyXG4gICAgICAgICAgICAgICAganNGaWxlc1tpXSA9IGpzRmlsZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IGpzRmlsZSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlOiBKU0xvYWRNb2RlLkFVVE9cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5Yib5bu65LiA5Liq56m655qEc2NyaXB05qCH562+XHJcbiAgICAgICAgICAgIHZhciBqc05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xyXG4gICAgICAgICAgICBqc05vZGUudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XHJcbiAgICAgICAgICAgIG5vZGVzLnB1c2goanNOb2RlKTtcclxuICAgICAgICAgICAgLy8g5byA5aeL5Yqg6L29XHJcbiAgICAgICAgICAgIGlmIChqc0ZpbGUubW9kZSA9PT0gSlNMb2FkTW9kZS5KU09OUCB8fCAoanNGaWxlLm1vZGUgPT09IEpTTG9hZE1vZGUuQVVUTyAmJiAhaXNBYnNvbHV0ZVBhdGgoanNGaWxlLnVybCkpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRBc3NldHMoanNGaWxlLnVybCwgbnVsbCwgbnVsbCwgb25Db21wbGV0ZU9uZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDpgJLlop7mlbDph49cclxuICAgICAgICAgICAgICAgIGpzb25wQ291bnQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOS9v+eUqHNjcmlwdOagh+etvuaWueW8j+WKoOi9ve+8jOS4jeeUqOWcqOaEj+mhuuW6j1xyXG4gICAgICAgICAgICAgICAganNOb2RlLm9ubG9hZCA9IG9uTG9hZE9uZTtcclxuICAgICAgICAgICAgICAgIGpzTm9kZS5vbmVycm9yID0gb25FcnJvck9uZTtcclxuICAgICAgICAgICAgICAgIGpzTm9kZS5zcmMgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodmVyc2lvbi53cmFwSGFzaFVybChqc0ZpbGUudXJsKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Yik5pat5LiA5qyhXHJcbiAgICAgICAgdmFyIGFwcGVuZEluZGV4ID0gMDtcclxuICAgICAgICBqdWRnZUFwcGVuZCgpO1xyXG4gICAgICAgIGZ1bmN0aW9uIGp1ZGdlQXBwZW5kKCkge1xyXG4gICAgICAgICAgICBpZiAoanNvbnBDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6L+Z6YeM57uf5LiA5bCG5omA5pyJc2NyaXB05qCH562+5re75Yqg5YiwRE9N5Lit77yM5Lul5q2k5L+d5oyB6aG65bqPXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gYXBwZW5kSW5kZXgsIGxlbiA9IG5vZGVzLmxlbmd0aDsgaSA8IGxlbjspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IG5vZGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V5re75Yqg57Si5byVXHJcbiAgICAgICAgICAgICAgICAgICAgYXBwZW5kSW5kZXggPSArK2k7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c6ZyA6KaB5L+d5oyB6aG65bqP5LiU5b2T5YmN5piv5qCH562+5b2i5byPanPvvIzliJnlgZzmraLmt7vliqDvvIznrYnlvoXliqDovb3lrozmr5Xlho3nu6fnu61cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3JkZXJlZCAmJiBub2RlLnNyYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25Db21wbGV0ZU9uZSh1cmwsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWksei0pVxyXG4gICAgICAgICAgICAgICAgb25FcnJvck9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+W5Yiw57Si5byVXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAtMTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBqc0ZpbGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpzRmlsZSA9IGpzRmlsZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzRmlsZS51cmwgPT09IHVybCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOWhq+WFhXNjcmlwdOagh+etvuWGheWuuVxyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIganNOb2RlID0gbm9kZXNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgIGpzTm9kZS5pbm5lckhUTUwgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDpgJLlh49qc29ucOaVsOmHj1xyXG4gICAgICAgICAgICAgICAganNvbnBDb3VudC0tO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICBvbkxvYWRPbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkxvYWRPbmUoKSB7XHJcbiAgICAgICAgICAgIC8vIOa3u+WKoOagh+etvlxyXG4gICAgICAgICAgICBqdWRnZUFwcGVuZCgpO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzlhajpg6jliqDovb3lrozmr5XliJnosIPnlKjlm57osINcclxuICAgICAgICAgICAgaWYgKCFzdG9wICYmIC0tY291bnQgPT09IDApXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRXJyb3JPbmUoKSB7XHJcbiAgICAgICAgICAgIGlmICghc3RvcCkge1xyXG4gICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKG5ldyBFcnJvcihcIkpT5Yqg6L295aSx6LSlXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBc3NldHNNYW5hZ2VyID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBBc3NldHNNYW5hZ2VyKTtcclxuICAgIHJldHVybiBBc3NldHNNYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBc3NldHNNYW5hZ2VyO1xyXG5leHBvcnQgdmFyIEpTTG9hZE1vZGU7XHJcbihmdW5jdGlvbiAoSlNMb2FkTW9kZSkge1xyXG4gICAgSlNMb2FkTW9kZVtKU0xvYWRNb2RlW1wiQVVUT1wiXSA9IDBdID0gXCJBVVRPXCI7XHJcbiAgICBKU0xvYWRNb2RlW0pTTG9hZE1vZGVbXCJKU09OUFwiXSA9IDFdID0gXCJKU09OUFwiO1xyXG4gICAgSlNMb2FkTW9kZVtKU0xvYWRNb2RlW1wiVEFHXCJdID0gMl0gPSBcIlRBR1wiO1xyXG59KShKU0xvYWRNb2RlIHx8IChKU0xvYWRNb2RlID0ge30pKTtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGFzc2V0c01hbmFnZXIgPSBjb3JlLmdldEluamVjdChBc3NldHNNYW5hZ2VyKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IENvcmVNZXNzYWdlIGZyb20gXCIuLi8uLi9jb3JlL21lc3NhZ2UvQ29yZU1lc3NhZ2VcIjtcclxuaW1wb3J0IHsgZXh0ZW5kT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IFJlcXVlc3REYXRhLCB7IGNvbW1vbkRhdGEgfSBmcm9tIFwiLi9SZXF1ZXN0RGF0YVwiO1xyXG5pbXBvcnQgTmV0TWVzc2FnZSBmcm9tIFwiLi9OZXRNZXNzYWdlXCI7XHJcbmltcG9ydCB7IG1hc2tNYW5hZ2VyIH0gZnJvbSBcIi4uL21hc2svTWFza01hbmFnZXJcIjtcclxudmFyIE5ldE1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOZXRNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlTGlzdGVuZXJzID0ge307XHJcbiAgICAgICAgY29yZS5saXN0ZW4oQ29yZU1lc3NhZ2UuTUVTU0FHRV9ESVNQQVRDSEVELCB0aGlzLm9uTXNnRGlzcGF0Y2hlZCwgY29yZSk7XHJcbiAgICB9XHJcbiAgICBOZXRNYW5hZ2VyLnByb3RvdHlwZS5vbk1zZ0Rpc3BhdGNoZWQgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgdmFyIG9ic2VydmFibGUgPSB0aGlzLm9ic2VydmFibGU7XHJcbiAgICAgICAgLy8g5aaC5p6c5raI5oGv5piv6YCa6K6v5raI5oGv5YiZ5YGa5aSE55CGXHJcbiAgICAgICAgaWYgKG1zZyBpbnN0YW5jZW9mIFJlcXVlc3REYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIOa3u+WKoOmBrue9qVxyXG4gICAgICAgICAgICBpZiAobXNnLl9fdXNlTWFzaylcclxuICAgICAgICAgICAgICAgIG1hc2tNYW5hZ2VyLnNob3dMb2FkaW5nKG51bGwsIFwibmV0XCIpO1xyXG4gICAgICAgICAgICAvLyDmjIflrprmtojmga/lj4LmlbDov57mjqXkuIrlhazlhbHlj4LmlbDkvZzkuLrlj4LmlbBcclxuICAgICAgICAgICAgZXh0ZW5kT2JqZWN0KG1zZy5fX3BhcmFtcy5kYXRhLCBjb21tb25EYXRhKTtcclxuICAgICAgICAgICAgLy8g5Y+R6YCB5raI5oGvXHJcbiAgICAgICAgICAgIG1zZy5fX3BvbGljeS5zZW5kUmVxdWVzdChtc2cpO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hns7vnu5/mtojmga9cclxuICAgICAgICAgICAgb2JzZXJ2YWJsZS5kaXNwYXRjaChOZXRNZXNzYWdlLk5FVF9SRVFVRVNULCBtc2cpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOS4gOS4qui/lOWbnue7k+aehOS9k1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOi/lOWbnuexu+Wei1xyXG4gICAgICogQHBhcmFtIHtJUmVzcG9uc2VEYXRhQ29uc3RydWN0b3J9IGNscyDov5Tlm57nu5PmnoTkvZPmnoTpgKDlmahcclxuICAgICAqIEBtZW1iZXJvZiBOZXRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VEaWN0W2Nscy50eXBlXSA9IGNscztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOS4gOS4qumAmuiur+i/lOWbnuebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KElSZXNwb25zZURhdGFDb25zdHJ1Y3RvcnxzdHJpbmcpfSBjbHNPclR5cGUg6KaB55uR5ZCs55qE6L+U5Zue57uT5p6E5p6E6YCg5Zmo5oiW6ICF57G75Z6L5a2X56ym5LiyXHJcbiAgICAgKiBAcGFyYW0ge1Jlc3BvbnNlSGFuZGxlcn0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9ZmFsc2VdIOaYr+WQpuS4gOasoeaAp+ebkeWQrFxyXG4gICAgICogQHBhcmFtIHtJT2JzZXJ2YWJsZX0gW29ic2VydmFibGVdIOimgeWPkemAgeWIsOeahOWGheaguFxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTmV0TWFuYWdlci5wcm90b3R5cGUubGlzdGVuUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2xzT3JUeXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlLCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIHR5cGUgPSAodHlwZW9mIGNsc09yVHlwZSA9PSBcInN0cmluZ1wiID8gY2xzT3JUeXBlIDogY2xzT3JUeXBlLnR5cGUpO1xyXG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9yZXNwb25zZUxpc3RlbmVyc1t0eXBlXTtcclxuICAgICAgICBpZiAoIWxpc3RlbmVycylcclxuICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2VMaXN0ZW5lcnNbdHlwZV0gPSBsaXN0ZW5lcnMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGxpc3RlbmVyc18xID0gbGlzdGVuZXJzOyBfaSA8IGxpc3RlbmVyc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNfMVtfaV07XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyID09IGxpc3RlbmVyWzBdICYmIHRoaXNBcmcgPT0gbGlzdGVuZXJbMV0gJiYgb25jZSA9PSBsaXN0ZW5lclsyXSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGlzdGVuZXJzLnB1c2goW2hhbmRsZXIsIHRoaXNBcmcsIG9uY2UsIG9ic2VydmFibGVdKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOS4gOS4qumAmuiur+i/lOWbnuebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KElSZXNwb25zZURhdGFDb25zdHJ1Y3RvcnxzdHJpbmcpfSBjbHNPclR5cGUg6KaB56e76Zmk55uR5ZCs55qE6L+U5Zue57uT5p6E5p6E6YCg5Zmo5oiW6ICF57G75Z6L5a2X56ym5LiyXHJcbiAgICAgKiBAcGFyYW0ge1Jlc3BvbnNlSGFuZGxlcn0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9ZmFsc2VdIOaYr+WQpuS4gOasoeaAp+ebkeWQrFxyXG4gICAgICogQHBhcmFtIHtJT2JzZXJ2YWJsZX0gW29ic2VydmFibGVdIOimgeWPkemAgeWIsOeahOWGheaguFxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTmV0TWFuYWdlci5wcm90b3R5cGUudW5saXN0ZW5SZXNwb25zZSA9IGZ1bmN0aW9uIChjbHNPclR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UsIG9ic2VydmFibGUpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIGlmICghb2JzZXJ2YWJsZSlcclxuICAgICAgICAgICAgb2JzZXJ2YWJsZSA9IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICB2YXIgdHlwZSA9ICh0eXBlb2YgY2xzT3JUeXBlID09IFwic3RyaW5nXCIgPyBjbHNPclR5cGUgOiBjbHNPclR5cGUudHlwZSk7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX3Jlc3BvbnNlTGlzdGVuZXJzW3R5cGVdO1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIgPT0gbGlzdGVuZXJbMF0gJiYgdGhpc0FyZyA9PSBsaXN0ZW5lclsxXSAmJiBvbmNlID09IGxpc3RlbmVyWzJdICYmIG9ic2VydmFibGUgPT0gbGlzdGVuZXJbM10pIHtcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Y+R6YCB5aSa5p2h6K+35rGC77yM5bm25LiU562J5b6F6L+U5Zue57uT5p6c77yI5aaC5p6c5pyJ55qE6K+d77yJ77yM6LCD55So5Zue6LCDXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtSZXF1ZXN0RGF0YVtdfSBbcmVxdWVzdHMg6KaB5Y+R6YCB55qE6K+35rGC5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0geyhyZXNwb25zZXM/OlJlc3BvbnNlRGF0YVtdfEVycm9yKT0+dm9pZH0gW2hhbmRsZXJdIOaUtuWIsOi/lOWbnue7k+aenOaIlumUmeivr+WQjueahOWbnuiwg+WHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtJT2JzZXJ2YWJsZX0gW29ic2VydmFibGVdIOimgeWPkemAgeWIsOeahOWGheaguFxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTmV0TWFuYWdlci5wcm90b3R5cGUuc2VuZE11bHRpUmVxdWVzdHMgPSBmdW5jdGlvbiAocmVxdWVzdHMsIGhhbmRsZXIsIHRoaXNBcmcsIG9ic2VydmFibGUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlcyA9IFtdO1xyXG4gICAgICAgIHZhciBsZWZ0UmVzQ291bnQgPSAwO1xyXG4gICAgICAgIGlmICghb2JzZXJ2YWJsZSlcclxuICAgICAgICAgICAgb2JzZXJ2YWJsZSA9IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gcmVxdWVzdHMgfHwgW107IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSByZXF1ZXN0Ll9fcGFyYW1zLnJlc3BvbnNlO1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIC8vIOebkeWQrOS4gOasoeaAp+i/lOWbnlxyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5SZXNwb25zZShyZXNwb25zZSwgb25SZXNwb25zZSwgcmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICAvLyDorrDlvZXov5Tlm57nm5HlkKxcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlcy5wdXNoKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgIC8vIOiusOW9leaVsOmHj1xyXG4gICAgICAgICAgICAgICAgbGVmdFJlc0NvdW50Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5Y+R6YCB6K+35rGCXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUuZGlzcGF0Y2gocmVxdWVzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa1i+ivleWbnuiwg1xyXG4gICAgICAgIHRlc3RDYWxsYmFjaygpO1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uUmVzcG9uc2UocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWHuumUmeS6hu+8jOebtOaOpeiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlciAmJiBoYW5kbGVyLmNhbGwodGhpc0FyZywgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5oiQ5Yqf5LqGXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcmVzcG9uc2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSByZXNwb25zZXNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCA9PSByZXNwb25zZS5jb25zdHJ1Y3RvciAmJiB0aGlzID09PSByZXNwb25zZS5fX3BhcmFtcy5yZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudW5saXN0ZW5SZXNwb25zZSh0ZW1wLCBvblJlc3BvbnNlLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VzW2tleV0gPSByZXNwb25zZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdFJlc0NvdW50LS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa1i+ivleWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXN0Q2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHRlc3RDYWxsYmFjaygpIHtcclxuICAgICAgICAgICAgLy8g5Yik5pat5piv5ZCm5YWo6YOo5pu/5o2i5a6M5q+VXHJcbiAgICAgICAgICAgIGlmIChsZWZ0UmVzQ291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlciAmJiBoYW5kbGVyLmNhbGwodGhpc0FyZywgcmVzcG9uc2VzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog6L+Z6YeM5a+85Ye65LiN5biM5pyb55So5oi35L2/55So55qE5pa55rOV77yM5L6b5qGG5p625YaF5L2/55SoICovXHJcbiAgICBOZXRNYW5hZ2VyLnByb3RvdHlwZS5fX29uUmVzcG9uc2UgPSBmdW5jdGlvbiAodHlwZSwgcmVzdWx0LCByZXF1ZXN0KSB7XHJcbiAgICAgICAgLy8g56e76Zmk6YGu572pXHJcbiAgICAgICAgaWYgKHJlcXVlc3QgJiYgcmVxdWVzdC5fX3VzZU1hc2spXHJcbiAgICAgICAgICAgIG1hc2tNYW5hZ2VyLmhpZGVMb2FkaW5nKFwibmV0XCIpO1xyXG4gICAgICAgIC8vIOino+aekOe7k+aenFxyXG4gICAgICAgIHZhciBjbHMgPSB0aGlzLl9yZXNwb25zZURpY3RbdHlwZV07XHJcbiAgICAgICAgaWYgKGNscykge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgY2xzKCk7XHJcbiAgICAgICAgICAgIC8vIOaJp+ihjOino+aekFxyXG4gICAgICAgICAgICByZXNwb25zZS5wYXJzZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAvLyDorr7nva7phY3lr7nor7fmsYLlkozlj5HpgIHlhoXmoLhcclxuICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5fX3BhcmFtcy5yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICAgICAgICAgICAgICAgIC8vIOeUseS4iuiHs+S4i+aJvuWIsOacgOi/nOeahOS4gOS4quacieaViOWGheaguFxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJlcXVlc3QuX19vYnNlcnZhYmxlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcmVxdWVzdC5fX29ic2VydmFibGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGVtcCB8fCB0ZW1wLmRpc3Bvc2VkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmFibGUgPSB0ZW1wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkeS6i+S7tlxyXG4gICAgICAgICAgICBvYnNlcnZhYmxlLmRpc3BhdGNoKE5ldE1lc3NhZ2UuTkVUX1JFU1BPTlNFLCByZXNwb25zZSwgcmVxdWVzdCk7XHJcbiAgICAgICAgICAgIC8vIOmAkuW9kuWkhOeQhuS6i+S7tuebkeWQrFxyXG4gICAgICAgICAgICB0aGlzLnJlY3Vyc2VSZXNwb25zZSh0eXBlLCByZXNwb25zZSwgcmVxdWVzdCwgb2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLmsqHmnInmib7liLDov5Tlm57nu5PmnoTkvZPlrprkuYnvvJpcIiArIHR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBOZXRNYW5hZ2VyLnByb3RvdHlwZS5fX29uRXJyb3IgPSBmdW5jdGlvbiAodHlwZSwgZXJyLCByZXF1ZXN0KSB7XHJcbiAgICAgICAgLy8g56e76Zmk6YGu572pXHJcbiAgICAgICAgaWYgKHJlcXVlc3QgJiYgcmVxdWVzdC5fX3VzZU1hc2spXHJcbiAgICAgICAgICAgIG1hc2tNYW5hZ2VyLmhpZGVMb2FkaW5nKFwibmV0XCIpO1xyXG4gICAgICAgIC8vIOWmguaenOaciemFjeWvueivt+axgu+8jOWImeWwhui/lOWbnuWAvOWPkemAgeWIsOivt+axguaJgOWcqOeahOWOn+Wni+WGheaguOmHjFxyXG4gICAgICAgIHZhciBvYnNlcnZhYmxlID0gcmVxdWVzdCAmJiByZXF1ZXN0Ll9fb3JpT2JzZXJ2YWJsZTtcclxuICAgICAgICAvLyDmtL7lj5Hkuovku7ZcclxuICAgICAgICBvYnNlcnZhYmxlLmRpc3BhdGNoKE5ldE1lc3NhZ2UuTkVUX0VSUk9SLCBlcnIsIHJlcXVlc3QpO1xyXG4gICAgICAgIC8vIOmAkuW9kuWkhOeQhuS6i+S7tuebkeWQrFxyXG4gICAgICAgIHRoaXMucmVjdXJzZVJlc3BvbnNlKHR5cGUsIGVyciwgcmVxdWVzdCwgb2JzZXJ2YWJsZSk7XHJcbiAgICB9O1xyXG4gICAgTmV0TWFuYWdlci5wcm90b3R5cGUucmVjdXJzZVJlc3BvbnNlID0gZnVuY3Rpb24gKHR5cGUsIHJlc3BvbnNlLCByZXF1ZXN0LCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgLy8g5YWI6YCS5b2S54i257qn77yM5LiO5raI5oGv5Y+R6YCB5pe26aG65bqP55u45Y+NXHJcbiAgICAgICAgaWYgKG9ic2VydmFibGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVjdXJzZVJlc3BvbnNlKHR5cGUsIHJlc3BvbnNlLCByZXF1ZXN0LCBvYnNlcnZhYmxlLnBhcmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOinpuWPkeS6i+S7tuW9ouW8j+ebkeWQrFxyXG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9yZXNwb25zZUxpc3RlbmVyc1t0eXBlXTtcclxuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5jb25jYXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaXN0ZW5lcnNfMiA9IGxpc3RlbmVyczsgX2kgPCBsaXN0ZW5lcnNfMi5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc18yW19pXTtcclxuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lclszXSA9PSBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5b+F6aG75piv5ZCM5qC45raI5oGv5omN6IO96Kem5Y+R5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJbMF0uY2FsbChsaXN0ZW5lclsxXSwgcmVzcG9uc2UsIHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOaYr+S4gOasoeaAp+ebkeWQrOWImeenu+mZpOS5i1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lclsyXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxpc3RlblJlc3BvbnNlKHR5cGUsIGxpc3RlbmVyWzBdLCBsaXN0ZW5lclsxXSwgbGlzdGVuZXJbMl0sIGxpc3RlbmVyWzNdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBOZXRNYW5hZ2VyID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlLFxyXG4gICAgICAgIHRzbGliXzEuX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxyXG4gICAgXSwgTmV0TWFuYWdlcik7XHJcbiAgICByZXR1cm4gTmV0TWFuYWdlcjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTmV0TWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIG5ldE1hbmFnZXIgPSBjb3JlLmdldEluamVjdChOZXRNYW5hZ2VyKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9OZXRNYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAxMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBleHRlbmRPYmplY3QgfSBmcm9tIFwiLi9PYmplY3RVdGlsXCI7XHJcbi8qKlxyXG4gKiDojrflj5blvZPliY3pobXpnaLnmoRvcmlnaW7vvIzkvJrlhbzlrrlJRTEw5Lul5LiLXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJPcmlnaW4oKSB7XHJcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLm9yaWdpbilcclxuICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLm9yaWdpbjtcclxuICAgIHJldHVybiAod2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QpO1xyXG59XHJcbi8qKlxyXG4gKiDop4TmlbR1cmxcclxuICogQHBhcmFtIHVybFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRyaW1VUkwodXJsKSB7XHJcbiAgICAvLyDljrvpmaTlpJrkvZnnmoRcIi9cIlxyXG4gICAgdXJsID0gdXJsLnJlcGxhY2UoLyhbXjpcXC9dfCg6XFwvKSlcXC8rL2csIFwiJDEvXCIpO1xyXG4gICAgaWYgKHVybC5jaGFyQXQoMCkgPT0gXCIvXCIpXHJcbiAgICAgICAgdXJsID0gdXJsLnN1YnN0cigxKTtcclxuICAgIC8vIOWkhOeQhumdnue0p+i0tOWfn+WQjeeahFwiL3h4Ly4uL1wiXHJcbiAgICB2YXIgcmVnID0gLyg/ITpcXC97Mix9W15cXC9dK1xcLykoW15cXC9cXC5dKylcXC9bXlxcL1xcLl0rP1xcL1xcLlxcLlxcLy87XHJcbiAgICB3aGlsZSAocmVnLnRlc3QodXJsKSkge1xyXG4gICAgICAgIHVybCA9IHVybC5yZXBsYWNlKHJlZywgXCIvJDFcIik7XHJcbiAgICB9XHJcbiAgICAvLyDlpITnkIZcIi8uL1wi5ZKM5Ymp5L2Z55qEXCIvLi4vXCLvvIznm7TmjqXkuKLlvIPkuYtcclxuICAgIHZhciByZWcgPSAvXFwvXFwuezEsMn1cXC8vO1xyXG4gICAgd2hpbGUgKHJlZy50ZXN0KHVybCkpIHtcclxuICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShyZWcsIFwiL1wiKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1cmw7XHJcbn1cclxuLyoqXHJcbiAqIOajgOafpVVSTOaYr+WQpuaYr+e7neWvuei3r+W+hO+8iOWFt+acieWNj+iuruWktO+8iVxyXG4gKiBAcGFyYW0gdXJsIOimgeWIpOaWreeahFVSTFxyXG4gKiBAcmV0dXJucyB7YW55fSDmmK/lkKbmmK/nu53lr7not6/lvoRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0Fic29sdXRlUGF0aCh1cmwpIHtcclxuICAgIGlmICh1cmwgPT0gbnVsbClcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICByZXR1cm4gKHVybC5pbmRleE9mKFwiOi8vXCIpID49IDApO1xyXG59XHJcbi8qKlxyXG4gKiDlpoLmnpx1cmzmnIlwcm90b2NvbO+8jOS9v+WFtuS4juW9k+WJjeWfn+WQjeeahHByb3RvY29s57uf5LiA77yM5ZCm5YiZ5Lya6Leo5Z+fXHJcbiAqIEBwYXJhbSB1cmwg6KaB57uf5LiAcHJvdG9jb2znmoR1cmxcclxuICogQHBhcmFtIHtzdHJpbmd9IFtwcm90b2NvbF0g6KaB57uf5LiA5oiQ55qEcHJvdG9jb2zvvIzkuI3kvKDliJnmoLnmja7lvZPliY3pobXpnaLnmoRwcm90b2NvbOS9v+eUqOOAguagueaNruagh+WHhu+8jHByb3RvY29s5piv6KaB5pC65bimOueahO+8jOavlOWmguKAnGh0dHA64oCdXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQcm90b2NvbCh1cmwsIHByb3RvY29sKSB7XHJcbiAgICBpZiAodXJsID09IG51bGwpXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB2YXIgaW5kZXggPSB1cmwuaW5kZXhPZihcIjovL1wiKTtcclxuICAgIGlmIChpbmRleCA8IDApXHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIC8vIOWboOS4unByb3RvY29s5piv6KaB5pC65bimOueahO+8jOaJgOS7pWluZGV46Ieq5YqgMVxyXG4gICAgaW5kZXgrKztcclxuICAgIGlmIChwcm90b2NvbCkge1xyXG4gICAgICAgIC8vIOebtOaOpeS9v+eUqOS8oOmAkueahHByb3RvY29sXHJcbiAgICAgICAgcmV0dXJuIHByb3RvY29sICsgdXJsLnN1YnN0cihpbmRleCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBwcm90b2NvbCA9IHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgICAgIC8vIOiwg+aVtGh0dHDlkoxodHRwc1xyXG4gICAgICAgIGlmIChwcm90b2NvbCA9PSBcImh0dHA6XCIgfHwgcHJvdG9jb2wgPT0gXCJodHRwczpcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgdXJsLnN1YnN0cihpbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiwg+aVtHdz5ZKMd3NzXHJcbiAgICAgICAgaWYgKHByb3RvY29sID09IFwid3M6XCIgfHwgcHJvdG9jb2wgPT0gXCJ3c3M6XCIpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PSBcImh0dHBzOlwiKVxyXG4gICAgICAgICAgICAgICAgcHJvdG9jb2wgPSBcIndzczpcIjtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgcHJvdG9jb2wgPSBcIndzOlwiO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvdG9jb2wgKyB1cmwuc3Vic3RyKGluZGV4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5LiN6ZyA6KaB6LCD5pW0XHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5pu/5o2idXJs5Lit55qEaG9zdFxyXG4gKiBAcGFyYW0gdXJsICAgICAgIHVybFxyXG4gKiBAcGFyYW0gaG9zdCAgICAgIOimgeabv+aNoueahGhvc3RcclxuICogQHBhcmFtIGZvcmNlZCAgICDmmK/lkKblvLrliLbmm7/mjaLvvIjpu5jorqRmYWxzZe+8iVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBIb3N0KHVybCwgaG9zdCwgZm9yY2VkKSB7XHJcbiAgICBpZiAoZm9yY2VkID09PSB2b2lkIDApIHsgZm9yY2VkID0gZmFsc2U7IH1cclxuICAgIGhvc3QgPSBob3N0IHx8IGdldEN1ck9yaWdpbigpO1xyXG4gICAgdmFyIHJlID0gL14oPzpbXlxcL10rKTpcXC97Mix9KD86W15cXC9dKylcXC8vO1xyXG4gICAgdmFyIGFyciA9IHVybC5tYXRjaChyZSk7XHJcbiAgICBpZiAoYXJyICYmIGFyci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgaWYgKGZvcmNlZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB1cmwuc3Vic3RyKGFyclswXS5sZW5ndGgpO1xyXG4gICAgICAgICAgICB1cmwgPSBob3N0ICsgXCIvXCIgKyB1cmw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdXJsID0gaG9zdCArIFwiL1wiICsgdXJsO1xyXG4gICAgfVxyXG4gICAgLy8g5ZCI5rOV5YyW5LiA5LiLcHJvdG9jb2xcclxuICAgIHVybCA9IHZhbGlkYXRlUHJvdG9jb2wodXJsKTtcclxuICAgIC8vIOacgOWQjuinhOaVtOS4gOS4i3VybFxyXG4gICAgdXJsID0gdHJpbVVSTCh1cmwpO1xyXG4gICAgcmV0dXJuIHVybDtcclxufVxyXG4vKipcclxuICog5bCG55u45a+55LqO5b2T5YmN6aG16Z2i55qE55u45a+56Lev5b6E5YyF6KOF5oiQ57ud5a+56Lev5b6EXHJcbiAqIEBwYXJhbSByZWxhdGl2ZVBhdGgg55u45a+55LqO5b2T5YmN6aG16Z2i55qE55u45a+56Lev5b6EXHJcbiAqIEBwYXJhbSBob3N0IOS8oOmAkuivpeWPguaVsOS8mueUqOivpWhvc3Tmm7/mjaLlvZPliY1ob3N0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gd3JhcEFic29sdXRlUGF0aChyZWxhdGl2ZVBhdGgsIGhvc3QpIHtcclxuICAgIC8vIOiOt+WPluW9k+WJjemhtemdoueahHVybFxyXG4gICAgdmFyIGN1clBhdGggPSBnZXRQYXRoKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcclxuICAgIHZhciB1cmwgPSB0cmltVVJMKGN1clBhdGggKyBcIi9cIiArIHJlbGF0aXZlUGF0aCk7XHJcbiAgICBpZiAoaG9zdCAhPSBudWxsKSB7XHJcbiAgICAgICAgdXJsID0gd3JhcEhvc3QodXJsLCBob3N0LCB0cnVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1cmw7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPllVSTOeahGhvc3QrcGF0aG5hbWXpg6jliIbvvIzljbPpl67lj7coPynku6XliY3nmoTpg6jliIZcclxuICpcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRIb3N0QW5kUGF0aG5hbWUodXJsKSB7XHJcbiAgICBpZiAodXJsID09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidXJs5LiN6IO95Li656m6XCIpO1xyXG4gICAgLy8g5Y675o6JZ2V05Y+C5pWw5ZKMaGFzaFxyXG4gICAgdXJsID0gdXJsLnNwbGl0KFwiI1wiKVswXS5zcGxpdChcIj9cIilbMF07XHJcbiAgICAvLyDljrvmjonlpJrkvZnnmoQvXHJcbiAgICB1cmwgPSB0cmltVVJMKHVybCk7XHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5ZVUkzot6/lvoTvvIjmlofku7blkI3liY3nmoTpg6jliIbvvIlcclxuICogQHBhcmFtIHVybCDopoHliIbmnpDnmoRVUkxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXRoKHVybCkge1xyXG4gICAgLy8g6aaW5YWI5Y675o6J5aSa5L2Z55qEL1xyXG4gICAgdXJsID0gZ2V0SG9zdEFuZFBhdGhuYW1lKHVybCk7XHJcbiAgICAvLyDnhLblkI7ojrflj5bliLDot6/lvoRcclxuICAgIHZhciB1cmxBcnIgPSB1cmwuc3BsaXQoXCIvXCIpO1xyXG4gICAgdXJsQXJyLnBvcCgpO1xyXG4gICAgcmV0dXJuIHVybEFyci5qb2luKFwiL1wiKSArIFwiL1wiO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5ZVUkznmoTmlofku7blkI1cclxuICogQHBhcmFtIHVybCDopoHliIbmnpDnmoRVUkxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXROYW1lKHVybCkge1xyXG4gICAgLy8g5YWI5Y675o6JZ2V05Y+C5pWw5ZKMaGFzaFxyXG4gICAgdXJsID0gdXJsLnNwbGl0KFwiI1wiKVswXS5zcGxpdChcIj9cIilbMF07XHJcbiAgICAvLyDnhLblkI7ojrflj5bliLDmlofku7blkI1cclxuICAgIHZhciB1cmxBcnIgPSB1cmwuc3BsaXQoXCIvXCIpO1xyXG4gICAgdmFyIGZpbGVOYW1lID0gdXJsQXJyW3VybEFyci5sZW5ndGggLSAxXTtcclxuICAgIHJldHVybiBmaWxlTmFtZTtcclxufVxyXG4vKipcclxuICog6Kej5p6QVVJMXHJcbiAqIEBwYXJhbSB1cmwg6KaB6KKr6Kej5p6Q55qEVVJM5a2X56ym5LiyXHJcbiAqIEByZXR1cm5zIHthbnl9IOino+aekOWQjueahFVSTExvY2F0aW9u57uT5p6E5L2TXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVcmwodXJsKSB7XHJcbiAgICB2YXIgcmVnRXhwID0gLygoW146XSs6KVxcL3syLH0oKFteOlxcL1xcPyNdKykoOihcXGQrKSk/KSkoXFwvW14/I10qKT8oXFw/W14jXSopPygjLiopPy87XHJcbiAgICB2YXIgbWF0Y2ggPSByZWdFeHAuZXhlYyh1cmwpO1xyXG4gICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaHJlZjogbWF0Y2hbMF0gfHwgXCJcIixcclxuICAgICAgICAgICAgb3JpZ2luOiBtYXRjaFsxXSB8fCBcIlwiLFxyXG4gICAgICAgICAgICBwcm90b2NvbDogbWF0Y2hbMl0gfHwgXCJcIixcclxuICAgICAgICAgICAgaG9zdDogbWF0Y2hbM10gfHwgXCJcIixcclxuICAgICAgICAgICAgaG9zdG5hbWU6IG1hdGNoWzRdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIHBvcnQ6IG1hdGNoWzZdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIHBhdGhuYW1lOiBtYXRjaFs3XSB8fCBcIlwiLFxyXG4gICAgICAgICAgICBzZWFyY2g6IG1hdGNoWzhdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIGhhc2g6IChtYXRjaFs5XSA9PSBcIiNcIiA/IFwiXCIgOiBtYXRjaFs5XSkgfHwgXCJcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLkvKDlhaVwYXJzZVVybOaWueazleeahOWPguaVsOS4jeaYr+S4gOS4quWujOaVtOeahFVSTO+8mlwiICsgdXJsKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog6Kej5p6QdXJs5p+l6K+i5Y+C5pWwXHJcbiAqIEBUT0RPIOa3u+WKoOWvuWpxdWVyeee8lueggeaWueW8j+eahOaUr+aMgVxyXG4gKiBAcGFyYW0gdXJsIHVybFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKHVybCkge1xyXG4gICAgdmFyIGluZGV4ID0gdXJsLmluZGV4T2YoXCIjXCIpO1xyXG4gICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICB1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KTtcclxuICAgIH1cclxuICAgIGluZGV4ID0gdXJsLmluZGV4T2YoXCI/XCIpO1xyXG4gICAgaWYgKGluZGV4IDwgMClcclxuICAgICAgICByZXR1cm4ge307XHJcbiAgICB2YXIgcXVlcnlTdHJpbmcgPSB1cmwuc3Vic3RyaW5nKGluZGV4ICsgMSk7XHJcbiAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICB2YXIga3ZzID0gcXVlcnlTdHJpbmcuc3BsaXQoXCImXCIpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrdnNfMSA9IGt2czsgX2kgPCBrdnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga3YgPSBrdnNfMVtfaV07XHJcbiAgICAgICAgdmFyIHBhaXIgPSBrdi5zcGxpdChcIj1cIiwgMik7XHJcbiAgICAgICAgaWYgKHBhaXIubGVuZ3RoICE9PSAyIHx8ICFwYWlyWzBdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW1VSTFV0aWxdIGludmFsaWQgcXVlcnkgcGFyYW1zOiBcIiArIGt2KTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuYW1lID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcclxuICAgICAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXM7XHJcbn1cclxuLyoqXHJcbiAqIOWwhuWPguaVsOi/nuaOpeWIsOaMh+WumlVSTOWQjumdolxyXG4gKiBAcGFyYW0gdXJsIHVybFxyXG4gKiBAcGFyYW0gcGFyYW1zIOS4gOS4qm1hcO+8jOWMheWQq+imgei/nuaOpeeahOWPguaVsFxyXG4gKiBAcmV0dXJuIHN0cmluZyDov57mjqXlkI7nmoRVUkzlnLDlnYBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBqb2luUXVlcnlQYXJhbXModXJsLCBwYXJhbXMpIHtcclxuICAgIGlmICh1cmwgPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1cmzkuI3og73kuLrnqbpcIik7XHJcbiAgICB2YXIgb3JpUGFyYW1zID0gZ2V0UXVlcnlQYXJhbXModXJsKTtcclxuICAgIHZhciB0YXJnZXRQYXJhbXMgPSBleHRlbmRPYmplY3Qob3JpUGFyYW1zLCBwYXJhbXMpO1xyXG4gICAgdmFyIGhhc2ggPSBwYXJzZVVybCh1cmwpLmhhc2g7XHJcbiAgICB1cmwgPSBnZXRIb3N0QW5kUGF0aG5hbWUodXJsKTtcclxuICAgIHZhciBpc0ZpcnN0ID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGtleSBpbiB0YXJnZXRQYXJhbXMpIHtcclxuICAgICAgICBpZiAoaXNGaXJzdCkge1xyXG4gICAgICAgICAgICB1cmwgKz0gXCI/XCIgKyBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHRhcmdldFBhcmFtc1trZXldKTtcclxuICAgICAgICAgICAgaXNGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXJsICs9IFwiJlwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh0YXJnZXRQYXJhbXNba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5Yqg5LiKaGFzaFxyXG4gICAgdXJsICs9IGhhc2g7XHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcbi8qKlxyXG4gKiDlsIblj4LmlbDpk77mjqXliLBVUkznmoRoYXNo5ZCO6Z2iXHJcbiAqIEBwYXJhbSB1cmwg5aaC5p6c5Lyg5YWl55qEdXJs5rKh5pyJ5rOo5piOaGFzaOaooeWdl++8jOWImeS4jeS8mui/m+ihjOaTjeS9nFxyXG4gKiBAcGFyYW0gcGFyYW1zIOS4gOS4qm1hcO+8jOWMheWQq+imgei/nuaOpeeahOWPguaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGpvaW5IYXNoUGFyYW1zKHVybCwgcGFyYW1zKSB7XHJcbiAgICBpZiAodXJsID09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidXJs5LiN6IO95Li656m6XCIpO1xyXG4gICAgdmFyIGhhc2ggPSBwYXJzZVVybCh1cmwpLmhhc2g7XHJcbiAgICBpZiAoaGFzaCA9PSBudWxsIHx8IGhhc2ggPT0gXCJcIilcclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgZm9yICh2YXIga2V5IGluIHBhcmFtcykge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHBhcmFtc1trZXldO1xyXG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgIT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgICAgIGhhc2ggKz0gKChoYXNoLmluZGV4T2YoXCI/XCIpIDwgMCA/IFwiP1wiIDogXCImXCIpICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICh1cmwuc3BsaXQoXCIjXCIpWzBdICsgaGFzaCk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvVVJMVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IE1lZGlhdG9yIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclwiO1xyXG5pbXBvcnQgeyBzY2VuZU1hbmFnZXIgfSBmcm9tIFwiLi9TY2VuZU1hbmFnZXJcIjtcclxuaW1wb3J0IE1lZGlhdG9yTWVzc2FnZSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JNZXNzYWdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDlrp7njrDkuoZJU2NlbmXmjqXlj6PnmoTlnLrmma/kuK3ku4vogIXln7rnsbtcclxuKi9cclxudmFyIFNjZW5lTWVkaWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTY2VuZU1lZGlhdG9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2NlbmVNZWRpYXRvcihza2luLCBwb2xpY3kpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBza2luKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnBvbGljeSA9IHBvbGljeTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25PcGVuID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBzY2VuZU1hbmFnZXIucHVzaCh0aGlzLCBkYXRhKTtcclxuICAgIH07XHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25DbG9zZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDnr6HmlLlvbkFmdGVyT3V077yM562J5b6F5YWz6Zet5Yqo55S757uT5p2f5ZCO5YaN5omn6KGMXHJcbiAgICAgICAgdmFyIG9yaU9uQWZ0ZXJPdXQgPSB0aGlzLm9uQWZ0ZXJPdXQ7XHJcbiAgICAgICAgdGhpcy5vbkFmdGVyT3V0ID0gZnVuY3Rpb24gKHRvU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAgICAgb3JpT25BZnRlck91dC5jYWxsKF90aGlzLCB0b1NjZW5lLCBkYXRhKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKE1lZGlhdG9yTWVzc2FnZS5NRURJQVRPUl9DTE9TRUQsIF90aGlzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHNjZW5lTWFuYWdlci5wb3AodGhpcywgZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIflhaXlnLrmma/lvIDlp4vliY3osIPnlKhcclxuICAgICAqIEBwYXJhbSBmcm9tU2NlbmUg5LuO5ZOq5Liq5Zy65pmv5YiH5YWlXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDliIflnLrmma/ml7blj6/og73nmoTlj4LmlbBcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZWRpYXRvci5wcm90b3R5cGUub25CZWZvcmVJbiA9IGZ1bmN0aW9uIChmcm9tU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+WFpeWcuuaZr+W8gOWni+WQjuiwg+eUqFxyXG4gICAgICogQHBhcmFtIGZyb21TY2VuZSDku47lk6rkuKrlnLrmma/liIflhaVcclxuICAgICAqIEBwYXJhbSBkYXRhIOWIh+WcuuaZr+aXtuWPr+iDveeahOWPguaVsFxyXG4gICAgICovXHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5vbkFmdGVySW4gPSBmdW5jdGlvbiAoZnJvbVNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIflh7rlnLrmma/lvIDlp4vliY3osIPnlKhcclxuICAgICAqIEBwYXJhbSB0b1NjZW5lIOimgeWIh+WFpeWIsOWTquS4quWcuuaZr1xyXG4gICAgICogQHBhcmFtIGRhdGEg5YiH5Zy65pmv5pe25Y+v6IO955qE5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWVkaWF0b3IucHJvdG90eXBlLm9uQmVmb3JlT3V0ID0gZnVuY3Rpb24gKHRvU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+WHuuWcuuaZr+W8gOWni+WQjuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHRvU2NlbmUg6KaB5YiH5YWl5Yiw5ZOq5Liq5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDliIflnLrmma/ml7blj6/og73nmoTlj4LmlbBcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZWRpYXRvci5wcm90b3R5cGUub25BZnRlck91dCA9IGZ1bmN0aW9uICh0b1NjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNjZW5lTWVkaWF0b3I7XHJcbn0oTWVkaWF0b3IpKTtcclxuZXhwb3J0IGRlZmF1bHQgU2NlbmVNZWRpYXRvcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDE0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBicmlkZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0yNVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0yNVxyXG4gKlxyXG4gKiDpga7nvannrqHnkIblmahcclxuKi9cclxudmFyIE1hc2tNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWFza01hbmFnZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fZW50aXR5RGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrRGljdCA9IHt9O1xyXG4gICAgfVxyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLmdldExvYWRpbmdNYXNrQ291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5fbG9hZGluZ01hc2tEaWN0KSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV07XHJcbiAgICAgICAgICAgIGlmICh0ZW1wID4gMClcclxuICAgICAgICAgICAgICAgIGNvdW50ICs9IHRlbXA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb3VudDtcclxuICAgIH07XHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUucGx1c0xvYWRpbmdNYXNrQ291bnQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV0gfHwgMDtcclxuICAgICAgICBpZiAoY291bnQgPCAwKVxyXG4gICAgICAgICAgICBjb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV0gPSArK2NvdW50O1xyXG4gICAgICAgIHJldHVybiBjb3VudDtcclxuICAgIH07XHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUubWludXNMb2FkaW5nTWFza0NvdW50ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBjb3VudCA9IHRoaXMuX2xvYWRpbmdNYXNrRGljdFtrZXldIHx8IDA7XHJcbiAgICAgICAgY291bnQtLTtcclxuICAgICAgICBpZiAoY291bnQgPCAwKVxyXG4gICAgICAgICAgICBjb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV0gPSBjb3VudDtcclxuICAgICAgICBpZiAoY291bnQgPT0gMClcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2xvYWRpbmdNYXNrRGljdFtrZXldO1xyXG4gICAgICAgIHJldHVybiBjb3VudDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMlk1hc2tVdGlsXHJcbiAgICAgKiBAcGFyYW0gdHlwZSDmiYDlsZ7ooajnjrDlsYLmoaVcclxuICAgICAqIEBwYXJhbSBlbnRpdHkg6YGu572p5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5yZWdpc3Rlck1hc2sgPSBmdW5jdGlvbiAodHlwZSwgZW50aXR5KSB7XHJcbiAgICAgICAgdGhpcy5fZW50aXR5RGljdFt0eXBlXSA9IGVudGl0eTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuumBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuc2hvd01hc2sgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgICB2YXIgdHlwZSA9IGJyaWRnZU1hbmFnZXIuY3VycmVudEJyaWRnZS50eXBlO1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChlbnRpdHkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDmmL7npLrpga7nvalcclxuICAgICAgICAgICAgZW50aXR5LnNob3dNYXNrKGFscGhhKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vblNob3dNYXNrICYmIGVudGl0eS5tYXNrRGF0YS5vblNob3dNYXNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZqQ6JeP6YGu572pXHJcbiAgICAgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5oaWRlTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdHlwZSA9IGJyaWRnZU1hbmFnZXIuY3VycmVudEJyaWRnZS50eXBlO1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChlbnRpdHkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgZW50aXR5Lm1hc2tEYXRhLm9uSGlkZU1hc2sgJiYgZW50aXR5Lm1hc2tEYXRhLm9uSGlkZU1hc2soKTtcclxuICAgICAgICAgICAgLy8g6ZqQ6JeP6YGu572pXHJcbiAgICAgICAgICAgIGVudGl0eS5oaWRlTWFzaygpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKirlvZPliY3mmK/lkKblnKjmmL7npLrpga7nvakqL1xyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLmlzU2hvd2luZ01hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSBicmlkZ2VNYW5hZ2VyLmN1cnJlbnRCcmlkZ2UudHlwZTtcclxuICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5RGljdFt0eXBlXTtcclxuICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBlbnRpdHkuaXNTaG93aW5nTWFzaygpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuWKoOi9veWbvlxyXG4gICAgICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuc2hvd0xvYWRpbmcgPSBmdW5jdGlvbiAoYWxwaGEsIGtleSkge1xyXG4gICAgICAgIGlmIChrZXkgPT09IHZvaWQgMCkgeyBrZXkgPSBudWxsOyB9XHJcbiAgICAgICAgLy8g6Iul5b2T5YmN5L2g5rKh5pyJbG9hZGluZ+WImeaYvuekumxvYWRpbmdcclxuICAgICAgICBpZiAodGhpcy5nZXRMb2FkaW5nTWFza0NvdW50KCkgPT0gMCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IGJyaWRnZU1hbmFnZXIuY3VycmVudEJyaWRnZS50eXBlO1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5RGljdFt0eXBlXTtcclxuICAgICAgICAgICAgaWYgKGVudGl0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmL7npLrpga7nvalcclxuICAgICAgICAgICAgICAgIGVudGl0eS5zaG93TG9hZGluZyhhbHBoYSk7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vblNob3dMb2FkaW5nICYmIGVudGl0eS5tYXNrRGF0YS5vblNob3dMb2FkaW5nKGVudGl0eS5sb2FkaW5nU2tpbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5aKe6K6h5pWwXHJcbiAgICAgICAgdGhpcy5wbHVzTG9hZGluZ01hc2tDb3VudChrZXkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZqQ6JeP5Yqg6L295Zu+XHJcbiAgICAgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5oaWRlTG9hZGluZyA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBpZiAoa2V5ID09PSB2b2lkIDApIHsga2V5ID0gbnVsbDsgfVxyXG4gICAgICAgIC8vIOWHj+iuoeaVsFxyXG4gICAgICAgIHRoaXMubWludXNMb2FkaW5nTWFza0NvdW50KGtleSk7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0TG9hZGluZ01hc2tDb3VudCgpID09IDApIHtcclxuICAgICAgICAgICAgLy8g56e76ZmkbG9hZGluZ1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IGJyaWRnZU1hbmFnZXIuY3VycmVudEJyaWRnZS50eXBlO1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5RGljdFt0eXBlXTtcclxuICAgICAgICAgICAgaWYgKGVudGl0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVMb2FkaW5nICYmIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVMb2FkaW5nKGVudGl0eS5sb2FkaW5nU2tpbik7XHJcbiAgICAgICAgICAgICAgICAvLyDpmpDol4/pga7nvalcclxuICAgICAgICAgICAgICAgIGVudGl0eS5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKuW9k+WJjeaYr+WQpuWcqOaYvuekumxvYWRpbmcqL1xyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLmlzU2hvd2luZ0xvYWRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSBicmlkZ2VNYW5hZ2VyLmN1cnJlbnRCcmlkZ2UudHlwZTtcclxuICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5RGljdFt0eXBlXTtcclxuICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBlbnRpdHkuaXNTaG93aW5nTG9hZGluZygpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKiog5pi+56S65qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuc2hvd01vZGFsTWFzayA9IGZ1bmN0aW9uIChwb3B1cCwgYWxwaGEpIHtcclxuICAgICAgICB2YXIgdHlwZSA9IHBvcHVwLmJyaWRnZS50eXBlO1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChlbnRpdHkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDmmL7npLrpga7nvalcclxuICAgICAgICAgICAgZW50aXR5LnNob3dNb2RhbE1hc2socG9wdXAsIGFscGhhKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vblNob3dNb2RhbE1hc2sgJiYgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd01vZGFsTWFzayhwb3B1cCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDpmpDol4/mqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5oaWRlTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBvcHVwKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSBwb3B1cC5icmlkZ2UudHlwZTtcclxuICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5RGljdFt0eXBlXTtcclxuICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVNb2RhbE1hc2sgJiYgZW50aXR5Lm1hc2tEYXRhLm9uSGlkZU1vZGFsTWFzayhwb3B1cCk7XHJcbiAgICAgICAgICAgIC8vIOmakOiXj+mBrue9qVxyXG4gICAgICAgICAgICBlbnRpdHkuaGlkZU1vZGFsTWFzayhwb3B1cCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDlvZPliY3mmK/lkKblnKjmmL7npLrmqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5pc1Nob3dpbmdNb2RhbE1hc2sgPSBmdW5jdGlvbiAocG9wdXApIHtcclxuICAgICAgICB2YXIgdHlwZSA9IHBvcHVwLmJyaWRnZS50eXBlO1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChlbnRpdHkgIT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuIGVudGl0eS5pc1Nob3dpbmdNb2RhbE1hc2socG9wdXApO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBNYXNrTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgTWFza01hbmFnZXIpO1xyXG4gICAgcmV0dXJuIE1hc2tNYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBNYXNrTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIG1hc2tNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoTWFza01hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWFzay9NYXNrTWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqXHJcbiAqIOaooeWdl+a2iOaBr1xyXG4qL1xyXG52YXIgTW9kdWxlTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1vZHVsZU1lc3NhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouaooeWdl+a2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgTW9kdWxlTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNb2R1bGVNZXNzYWdlLk1PRFVMRV9DSEFOR0UgPSBcIm1vZHVsZUNoYW5nZVwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIfmjaLmqKHlnZflpLHotKXmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFX0ZBSUxFRCA9IFwibW9kdWxlQ2hhbmdlRmFpbGVkXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veaooeWdl+Wksei0pea2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgTW9kdWxlTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNb2R1bGVNZXNzYWdlLk1PRFVMRV9MT0FEX0FTU0VUU19FUlJPUiA9IFwibW9kdWxlTG9hZEFzc2V0c0Vycm9yXCI7XHJcbiAgICByZXR1cm4gTW9kdWxlTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTW9kdWxlTWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTgtMDItMjRcclxuICogQG1vZGlmeSBkYXRlIDIwMTgtMDItMjRcclxuICpcclxuICog5Lit5LuL6ICF54q25oCB5p6a5Li+XHJcbiovXHJcbnZhciBNZWRpYXRvclN0YXR1cztcclxuKGZ1bmN0aW9uIChNZWRpYXRvclN0YXR1cykge1xyXG4gICAgTWVkaWF0b3JTdGF0dXNbTWVkaWF0b3JTdGF0dXNbXCJVTk9QRU5cIl0gPSAwXSA9IFwiVU5PUEVOXCI7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIk9QRU5JTkdcIl0gPSAxXSA9IFwiT1BFTklOR1wiO1xyXG4gICAgTWVkaWF0b3JTdGF0dXNbTWVkaWF0b3JTdGF0dXNbXCJPUEVORURcIl0gPSAyXSA9IFwiT1BFTkVEXCI7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIkNMT1NJTkdcIl0gPSAzXSA9IFwiQ0xPU0lOR1wiO1xyXG4gICAgTWVkaWF0b3JTdGF0dXNbTWVkaWF0b3JTdGF0dXNbXCJDTE9TRURcIl0gPSA0XSA9IFwiQ0xPU0VEXCI7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIkRJU1BPU0lOR1wiXSA9IDVdID0gXCJESVNQT1NJTkdcIjtcclxuICAgIE1lZGlhdG9yU3RhdHVzW01lZGlhdG9yU3RhdHVzW1wiRElTUE9TRURcIl0gPSA2XSA9IFwiRElTUE9TRURcIjtcclxufSkoTWVkaWF0b3JTdGF0dXMgfHwgKE1lZGlhdG9yU3RhdHVzID0ge30pKTtcclxuZXhwb3J0IGRlZmF1bHQgTWVkaWF0b3JTdGF0dXM7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvclN0YXR1cy5qc1xuLy8gbW9kdWxlIGlkID0gMTdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IE1lZGlhdG9yQ2xhc3MgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBsaXN0ZW5Db25zdHJ1Y3QsIGxpc3RlbkFwcGx5IH0gZnJvbSBcIm9seW1wdXMtci91dGlscy9Db25zdHJ1Y3RVdGlsXCI7XHJcbmltcG9ydCBET01CcmlkZ2UgZnJvbSBcIi4uLy4uL0RPTUJyaWRnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMDlcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMDlcclxuICpcclxuICog6LSf6LSj5rOo5YWl55qE5qih5Z2XXHJcbiovXHJcbmV4cG9ydCBmdW5jdGlvbiBET01NZWRpYXRvckNsYXNzKG1vZHVsZU5hbWUsIHNraW4pIHtcclxuICAgIHZhciBza2lucyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBza2luc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgLy8g6LCD55SoTWVkaWF0b3JDbGFzc+aWueazlVxyXG4gICAgICAgIGNscyA9IE1lZGlhdG9yQ2xhc3MobW9kdWxlTmFtZSkoY2xzKTtcclxuICAgICAgICAvLyDnm5HlkKznsbvlnovlrp7kvovljJbvvIzovazmjaLnmq7ogqTmoLzlvI9cclxuICAgICAgICB2YXIgZmluYWxTa2luO1xyXG4gICAgICAgIGlmIChza2lucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgZmluYWxTa2luID0gc2tpbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNraW5zLnVuc2hpZnQoc2tpbik7XHJcbiAgICAgICAgICAgIGZpbmFsU2tpbiA9IHNraW5zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgLy8g5YWI6LWL5YC85qGlXHJcbiAgICAgICAgICAgIG1lZGlhdG9yLmJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKERPTUJyaWRnZS5UWVBFKTtcclxuICAgICAgICAgICAgLy8g54S25ZCO55uR5ZCsb25PcGVu77yM5Zyob25PcGVu5Lit6K6+572u55qu6IKkXHJcbiAgICAgICAgICAgIGxpc3RlbkFwcGx5KG1lZGlhdG9yLCBcIm9uT3BlblwiLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLnNraW4gPSBmaW5hbFNraW47XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOi/lOWbnue7k+aenOexu+Wei1xyXG4gICAgICAgIHJldHVybiBjbHM7XHJcbiAgICB9O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDE4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKEMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbnZhciBSZWZsZWN0O1xyXG4oZnVuY3Rpb24gKFJlZmxlY3QpIHtcclxuICAgIC8vIE1ldGFkYXRhIFByb3Bvc2FsXHJcbiAgICAvLyBodHRwczovL3JidWNrdG9uLmdpdGh1Yi5pby9yZWZsZWN0LW1ldGFkYXRhL1xyXG4gICAgKGZ1bmN0aW9uIChmYWN0b3J5KSB7XHJcbiAgICAgICAgdmFyIHJvb3QgPSB0eXBlb2YgZ2xvYmFsID09PSBcIm9iamVjdFwiID8gZ2xvYmFsIDpcclxuICAgICAgICAgICAgdHlwZW9mIHNlbGYgPT09IFwib2JqZWN0XCIgPyBzZWxmIDpcclxuICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzID09PSBcIm9iamVjdFwiID8gdGhpcyA6XHJcbiAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb24oXCJyZXR1cm4gdGhpcztcIikoKTtcclxuICAgICAgICB2YXIgZXhwb3J0ZXIgPSBtYWtlRXhwb3J0ZXIoUmVmbGVjdCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiByb290LlJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgcm9vdC5SZWZsZWN0ID0gUmVmbGVjdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGV4cG9ydGVyID0gbWFrZUV4cG9ydGVyKHJvb3QuUmVmbGVjdCwgZXhwb3J0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmYWN0b3J5KGV4cG9ydGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBtYWtlRXhwb3J0ZXIodGFyZ2V0LCBwcmV2aW91cykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0W2tleV0gIT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgeyBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXMpXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfSkoZnVuY3Rpb24gKGV4cG9ydGVyKSB7XHJcbiAgICAgICAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XHJcbiAgICAgICAgLy8gZmVhdHVyZSB0ZXN0IGZvciBTeW1ib2wgc3VwcG9ydFxyXG4gICAgICAgIHZhciBzdXBwb3J0c1N5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIjtcclxuICAgICAgICB2YXIgdG9QcmltaXRpdmVTeW1ib2wgPSBzdXBwb3J0c1N5bWJvbCAmJiB0eXBlb2YgU3ltYm9sLnRvUHJpbWl0aXZlICE9PSBcInVuZGVmaW5lZFwiID8gU3ltYm9sLnRvUHJpbWl0aXZlIDogXCJAQHRvUHJpbWl0aXZlXCI7XHJcbiAgICAgICAgdmFyIGl0ZXJhdG9yU3ltYm9sID0gc3VwcG9ydHNTeW1ib2wgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciAhPT0gXCJ1bmRlZmluZWRcIiA/IFN5bWJvbC5pdGVyYXRvciA6IFwiQEBpdGVyYXRvclwiO1xyXG4gICAgICAgIHZhciBzdXBwb3J0c0NyZWF0ZSA9IHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSBcImZ1bmN0aW9uXCI7IC8vIGZlYXR1cmUgdGVzdCBmb3IgT2JqZWN0LmNyZWF0ZSBzdXBwb3J0XHJcbiAgICAgICAgdmFyIHN1cHBvcnRzUHJvdG8gPSB7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5OyAvLyBmZWF0dXJlIHRlc3QgZm9yIF9fcHJvdG9fXyBzdXBwb3J0XHJcbiAgICAgICAgdmFyIGRvd25MZXZlbCA9ICFzdXBwb3J0c0NyZWF0ZSAmJiAhc3VwcG9ydHNQcm90bztcclxuICAgICAgICB2YXIgSGFzaE1hcCA9IHtcclxuICAgICAgICAgICAgLy8gY3JlYXRlIGFuIG9iamVjdCBpbiBkaWN0aW9uYXJ5IG1vZGUgKGEuay5hLiBcInNsb3dcIiBtb2RlIGluIHY4KVxyXG4gICAgICAgICAgICBjcmVhdGU6IHN1cHBvcnRzQ3JlYXRlXHJcbiAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuIE1ha2VEaWN0aW9uYXJ5KE9iamVjdC5jcmVhdGUobnVsbCkpOyB9XHJcbiAgICAgICAgICAgICAgICA6IHN1cHBvcnRzUHJvdG9cclxuICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuIE1ha2VEaWN0aW9uYXJ5KHsgX19wcm90b19fOiBudWxsIH0pOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgOiBmdW5jdGlvbiAoKSB7IHJldHVybiBNYWtlRGljdGlvbmFyeSh7fSk7IH0sXHJcbiAgICAgICAgICAgIGhhczogZG93bkxldmVsXHJcbiAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChtYXAsIGtleSkgeyByZXR1cm4gaGFzT3duLmNhbGwobWFwLCBrZXkpOyB9XHJcbiAgICAgICAgICAgICAgICA6IGZ1bmN0aW9uIChtYXAsIGtleSkgeyByZXR1cm4ga2V5IGluIG1hcDsgfSxcclxuICAgICAgICAgICAgZ2V0OiBkb3duTGV2ZWxcclxuICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKG1hcCwga2V5KSB7IHJldHVybiBoYXNPd24uY2FsbChtYXAsIGtleSkgPyBtYXBba2V5XSA6IHVuZGVmaW5lZDsgfVxyXG4gICAgICAgICAgICAgICAgOiBmdW5jdGlvbiAobWFwLCBrZXkpIHsgcmV0dXJuIG1hcFtrZXldOyB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gTG9hZCBnbG9iYWwgb3Igc2hpbSB2ZXJzaW9ucyBvZiBNYXAsIFNldCwgYW5kIFdlYWtNYXBcclxuICAgICAgICB2YXIgZnVuY3Rpb25Qcm90b3R5cGUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRnVuY3Rpb24pO1xyXG4gICAgICAgIHZhciB1c2VQb2x5ZmlsbCA9IHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52W1wiUkVGTEVDVF9NRVRBREFUQV9VU0VfTUFQX1BPTFlGSUxMXCJdID09PSBcInRydWVcIjtcclxuICAgICAgICB2YXIgX01hcCA9ICF1c2VQb2x5ZmlsbCAmJiB0eXBlb2YgTWFwID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIE1hcC5wcm90b3R5cGUuZW50cmllcyA9PT0gXCJmdW5jdGlvblwiID8gTWFwIDogQ3JlYXRlTWFwUG9seWZpbGwoKTtcclxuICAgICAgICB2YXIgX1NldCA9ICF1c2VQb2x5ZmlsbCAmJiB0eXBlb2YgU2V0ID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFNldC5wcm90b3R5cGUuZW50cmllcyA9PT0gXCJmdW5jdGlvblwiID8gU2V0IDogQ3JlYXRlU2V0UG9seWZpbGwoKTtcclxuICAgICAgICB2YXIgX1dlYWtNYXAgPSAhdXNlUG9seWZpbGwgJiYgdHlwZW9mIFdlYWtNYXAgPT09IFwiZnVuY3Rpb25cIiA/IFdlYWtNYXAgOiBDcmVhdGVXZWFrTWFwUG9seWZpbGwoKTtcclxuICAgICAgICAvLyBbW01ldGFkYXRhXV0gaW50ZXJuYWwgc2xvdFxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5LW9iamVjdC1pbnRlcm5hbC1tZXRob2RzLWFuZC1pbnRlcm5hbC1zbG90c1xyXG4gICAgICAgIHZhciBNZXRhZGF0YSA9IG5ldyBfV2Vha01hcCgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFwcGxpZXMgYSBzZXQgb2YgZGVjb3JhdG9ycyB0byBhIHByb3BlcnR5IG9mIGEgdGFyZ2V0IG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0gZGVjb3JhdG9ycyBBbiBhcnJheSBvZiBkZWNvcmF0b3JzLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSB0byBkZWNvcmF0ZS5cclxuICAgICAgICAgKiBAcGFyYW0gYXR0cmlidXRlcyAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yIGZvciB0aGUgdGFyZ2V0IGtleS5cclxuICAgICAgICAgKiBAcmVtYXJrcyBEZWNvcmF0b3JzIGFyZSBhcHBsaWVkIGluIHJldmVyc2Ugb3JkZXIuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBFeGFtcGxlID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiLFxyXG4gICAgICAgICAqICAgICAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKSkpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnNBcnJheSwgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFeGFtcGxlLnByb3RvdHlwZSwgXCJtZXRob2RcIikpKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwgcHJvcGVydHlLZXksIGF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghSXNBcnJheShkZWNvcmF0b3JzKSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc09iamVjdChhdHRyaWJ1dGVzKSAmJiAhSXNVbmRlZmluZWQoYXR0cmlidXRlcykgJiYgIUlzTnVsbChhdHRyaWJ1dGVzKSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoSXNOdWxsKGF0dHJpYnV0ZXMpKVxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERlY29yYXRlUHJvcGVydHkoZGVjb3JhdG9ycywgdGFyZ2V0LCBwcm9wZXJ0eUtleSwgYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUlzQXJyYXkoZGVjb3JhdG9ycykpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc0NvbnN0cnVjdG9yKHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERlY29yYXRlQ29uc3RydWN0b3IoZGVjb3JhdG9ycywgdGFyZ2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcImRlY29yYXRlXCIsIGRlY29yYXRlKTtcclxuICAgICAgICAvLyA0LjEuMiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI3JlZmxlY3QubWV0YWRhdGFcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGRlZmF1bHQgbWV0YWRhdGEgZGVjb3JhdG9yIGZhY3RvcnkgdGhhdCBjYW4gYmUgdXNlZCBvbiBhIGNsYXNzLCBjbGFzcyBtZW1iZXIsIG9yIHBhcmFtZXRlci5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgVGhlIGtleSBmb3IgdGhlIG1ldGFkYXRhIGVudHJ5LlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YVZhbHVlIFRoZSB2YWx1ZSBmb3IgdGhlIG1ldGFkYXRhIGVudHJ5LlxyXG4gICAgICAgICAqIEByZXR1cm5zIEEgZGVjb3JhdG9yIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEByZW1hcmtzXHJcbiAgICAgICAgICogSWYgYG1ldGFkYXRhS2V5YCBpcyBhbHJlYWR5IGRlZmluZWQgZm9yIHRoZSB0YXJnZXQgYW5kIHRhcmdldCBrZXksIHRoZVxyXG4gICAgICAgICAqIG1ldGFkYXRhVmFsdWUgZm9yIHRoYXQga2V5IHdpbGwgYmUgb3ZlcndyaXR0ZW4uXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBAUmVmbGVjdC5tZXRhZGF0YShrZXksIHZhbHVlKVxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvciwgVHlwZVNjcmlwdCBvbmx5KVxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIEBSZWZsZWN0Lm1ldGFkYXRhKGtleSwgdmFsdWUpXHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlLCBUeXBlU2NyaXB0IG9ubHkpXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgQFJlZmxlY3QubWV0YWRhdGEoa2V5LCB2YWx1ZSlcclxuICAgICAgICAgKiAgICAgICAgIHByb3BlcnR5O1xyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICBAUmVmbGVjdC5tZXRhZGF0YShrZXksIHZhbHVlKVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZCgpIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgQFJlZmxlY3QubWV0YWRhdGEoa2V5LCB2YWx1ZSlcclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZCgpIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBtZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWNvcmF0b3IodGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgICAgIGlmICghSXNVbmRlZmluZWQocHJvcGVydHlLZXkpICYmICFJc1Byb3BlcnR5S2V5KHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlLCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcIm1ldGFkYXRhXCIsIG1ldGFkYXRhKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZWZpbmUgYSB1bmlxdWUgbWV0YWRhdGEgZW50cnkgb24gdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgQSBrZXkgdXNlZCB0byBzdG9yZSBhbmQgcmV0cmlldmUgbWV0YWRhdGEuXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGFkYXRhVmFsdWUgQSB2YWx1ZSB0aGF0IGNvbnRhaW5zIGF0dGFjaGVkIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdG8gZGVmaW5lIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZSk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZS5wcm90b3R5cGUsIFwicHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIG9wdGlvbnMsIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGRlY29yYXRvciBmYWN0b3J5IGFzIG1ldGFkYXRhLXByb2R1Y2luZyBhbm5vdGF0aW9uLlxyXG4gICAgICAgICAqICAgICBmdW5jdGlvbiBNeUFubm90YXRpb24ob3B0aW9ucyk6IERlY29yYXRvciB7XHJcbiAgICAgICAgICogICAgICAgICByZXR1cm4gKHRhcmdldCwga2V5PykgPT4gUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIG9wdGlvbnMsIHRhcmdldCwga2V5KTtcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZGVmaW5lTWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUsIHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlLCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJkZWZpbmVNZXRhZGF0YVwiLCBkZWZpbmVNZXRhZGF0YSk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0cyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlciB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluIGhhcyB0aGUgcHJvdmlkZWQgbWV0YWRhdGEga2V5IGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGFkYXRhS2V5IEEga2V5IHVzZWQgdG8gc3RvcmUgYW5kIHJldHJpZXZlIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG1ldGFkYXRhIGtleSB3YXMgZGVmaW5lZCBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluOyBvdGhlcndpc2UsIGBmYWxzZWAuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZS5wcm90b3R5cGUsIFwicHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5oYXNNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gaGFzTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeUhhc01ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJoYXNNZXRhZGF0YVwiLCBoYXNNZXRhZGF0YSk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0cyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlciB0aGUgdGFyZ2V0IG9iamVjdCBoYXMgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIGtleSBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgYHRydWVgIGlmIHRoZSBtZXRhZGF0YSBrZXkgd2FzIGRlZmluZWQgb24gdGhlIHRhcmdldCBvYmplY3Q7IG90aGVyd2lzZSwgYGZhbHNlYC5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY1Byb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc093bk1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSwgXCJzdGF0aWNNZXRob2RcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLnByb3RvdHlwZSwgXCJtZXRob2RcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBoYXNPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIGlmICghSXNVbmRlZmluZWQocHJvcGVydHlLZXkpKVxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHlLZXkgPSBUb1Byb3BlcnR5S2V5KHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCwgcHJvcGVydHlLZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcImhhc093bk1ldGFkYXRhXCIsIGhhc093bk1ldGFkYXRhKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXRzIHRoZSBtZXRhZGF0YSB2YWx1ZSBmb3IgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIGtleSBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluLlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgbWV0YWRhdGEga2V5IGlmIGZvdW5kOyBvdGhlcndpc2UsIGB1bmRlZmluZWRgLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldE1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRNZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cG9ydGVyKFwiZ2V0TWV0YWRhdGFcIiwgZ2V0TWV0YWRhdGEpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldHMgdGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgcHJvdmlkZWQgbWV0YWRhdGEga2V5IG9uIHRoZSB0YXJnZXQgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgbWV0YWRhdGEga2V5IGlmIGZvdW5kOyBvdGhlcndpc2UsIGB1bmRlZmluZWRgLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0T3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldE93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cG9ydGVyKFwiZ2V0T3duTWV0YWRhdGFcIiwgZ2V0T3duTWV0YWRhdGEpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldHMgdGhlIG1ldGFkYXRhIGtleXMgZGVmaW5lZCBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiB1bmlxdWUgbWV0YWRhdGEga2V5cy5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0TWV0YWRhdGFLZXlzKEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YUtleXMoRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE1ldGFkYXRhS2V5cyhFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE1ldGFkYXRhS2V5cyhFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YUtleXMoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0TWV0YWRhdGFLZXlzKHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeU1ldGFkYXRhS2V5cyh0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJnZXRNZXRhZGF0YUtleXNcIiwgZ2V0TWV0YWRhdGFLZXlzKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXRzIHRoZSB1bmlxdWUgbWV0YWRhdGEga2V5cyBkZWZpbmVkIG9uIHRoZSB0YXJnZXQgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiB1bmlxdWUgbWV0YWRhdGEga2V5cy5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0T3duTWV0YWRhdGFLZXlzKEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YUtleXMoRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE93bk1ldGFkYXRhS2V5cyhFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE93bk1ldGFkYXRhS2V5cyhFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YUtleXMoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0T3duTWV0YWRhdGFLZXlzKHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeU93bk1ldGFkYXRhS2V5cyh0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJnZXRPd25NZXRhZGF0YUtleXNcIiwgZ2V0T3duTWV0YWRhdGFLZXlzKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZWxldGVzIHRoZSBtZXRhZGF0YSBlbnRyeSBmcm9tIHRoZSB0YXJnZXQgb2JqZWN0IHdpdGggdGhlIHByb3ZpZGVkIGtleS5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgQSBrZXkgdXNlZCB0byBzdG9yZSBhbmQgcmV0cmlldmUgbWV0YWRhdGEuXHJcbiAgICAgICAgICogQHBhcmFtIHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCBvbiB3aGljaCB0aGUgbWV0YWRhdGEgaXMgZGVmaW5lZC5cclxuICAgICAgICAgKiBAcGFyYW0gcHJvcGVydHlLZXkgKE9wdGlvbmFsKSBUaGUgcHJvcGVydHkga2V5IGZvciB0aGUgdGFyZ2V0LlxyXG4gICAgICAgICAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgbWV0YWRhdGEgZW50cnkgd2FzIGZvdW5kIGFuZCBkZWxldGVkOyBvdGhlcndpc2UsIGZhbHNlLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZGVsZXRlTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICB2YXIgbWV0YWRhdGFNYXAgPSBHZXRPckNyZWF0ZU1ldGFkYXRhTWFwKHRhcmdldCwgcHJvcGVydHlLZXksIC8qQ3JlYXRlKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICBpZiAoSXNVbmRlZmluZWQobWV0YWRhdGFNYXApKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoIW1ldGFkYXRhTWFwLmRlbGV0ZShtZXRhZGF0YUtleSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YU1hcC5zaXplID4gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YWRhdGEgPSBNZXRhZGF0YS5nZXQodGFyZ2V0KTtcclxuICAgICAgICAgICAgdGFyZ2V0TWV0YWRhdGEuZGVsZXRlKHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFkYXRhLnNpemUgPiAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIE1ldGFkYXRhLmRlbGV0ZSh0YXJnZXQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJkZWxldGVNZXRhZGF0YVwiLCBkZWxldGVNZXRhZGF0YSk7XHJcbiAgICAgICAgZnVuY3Rpb24gRGVjb3JhdGVDb25zdHJ1Y3RvcihkZWNvcmF0b3JzLCB0YXJnZXQpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWNvcmF0b3IgPSBkZWNvcmF0b3JzW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRlZCA9IGRlY29yYXRvcih0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChkZWNvcmF0ZWQpICYmICFJc051bGwoZGVjb3JhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNDb25zdHJ1Y3RvcihkZWNvcmF0ZWQpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZGVjb3JhdGVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIERlY29yYXRlUHJvcGVydHkoZGVjb3JhdG9ycywgdGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRvciA9IGRlY29yYXRvcnNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVjb3JhdGVkID0gZGVjb3JhdG9yKHRhcmdldCwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChkZWNvcmF0ZWQpICYmICFJc051bGwoZGVjb3JhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QoZGVjb3JhdGVkKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0b3IgPSBkZWNvcmF0ZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgQ3JlYXRlKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhZGF0YSA9IE1ldGFkYXRhLmdldChPKTtcclxuICAgICAgICAgICAgaWYgKElzVW5kZWZpbmVkKHRhcmdldE1ldGFkYXRhKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFDcmVhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRhcmdldE1ldGFkYXRhID0gbmV3IF9NYXAoKTtcclxuICAgICAgICAgICAgICAgIE1ldGFkYXRhLnNldChPLCB0YXJnZXRNZXRhZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhTWFwID0gdGFyZ2V0TWV0YWRhdGEuZ2V0KFApO1xyXG4gICAgICAgICAgICBpZiAoSXNVbmRlZmluZWQobWV0YWRhdGFNYXApKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUNyZWF0ZSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGFNYXAgPSBuZXcgX01hcCgpO1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0TWV0YWRhdGEuc2V0KFAsIG1ldGFkYXRhTWFwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFNYXA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDMuMS4xLjEgT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUClcclxuICAgICAgICAvLyBodHRwczovL3JidWNrdG9uLmdpdGh1Yi5pby9yZWZsZWN0LW1ldGFkYXRhLyNvcmRpbmFyeWhhc21ldGFkYXRhXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUCkge1xyXG4gICAgICAgICAgICB2YXIgaGFzT3duID0gT3JkaW5hcnlIYXNPd25NZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUCk7XHJcbiAgICAgICAgICAgIGlmIChoYXNPd24pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTyk7XHJcbiAgICAgICAgICAgIGlmICghSXNOdWxsKHBhcmVudCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgcGFyZW50LCBQKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzLjEuMi4xIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEoTWV0YWRhdGFLZXksIE8sIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9yYnVja3Rvbi5naXRodWIuaW8vcmVmbGVjdC1tZXRhZGF0YS8jb3JkaW5hcnloYXNvd25tZXRhZGF0YVxyXG4gICAgICAgIGZ1bmN0aW9uIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEoTWV0YWRhdGFLZXksIE8sIFApIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhTWFwID0gR2V0T3JDcmVhdGVNZXRhZGF0YU1hcChPLCBQLCAvKkNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgaWYgKElzVW5kZWZpbmVkKG1ldGFkYXRhTWFwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIFRvQm9vbGVhbihtZXRhZGF0YU1hcC5oYXMoTWV0YWRhdGFLZXkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjMuMSBPcmRpbmFyeUdldE1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5Z2V0bWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeUdldE1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBoYXNPd24gPSBPcmRpbmFyeUhhc093bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTtcclxuICAgICAgICAgICAgaWYgKGhhc093bilcclxuICAgICAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTyk7XHJcbiAgICAgICAgICAgIGlmICghSXNOdWxsKHBhcmVudCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRNZXRhZGF0YShNZXRhZGF0YUtleSwgcGFyZW50LCBQKTtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjQuMSBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5Z2V0b3dubWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChJc1VuZGVmaW5lZChtZXRhZGF0YU1hcCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFNYXAuZ2V0KE1ldGFkYXRhS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjUuMSBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlLCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5ZGVmaW5lb3dubWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlLCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyB0cnVlKTtcclxuICAgICAgICAgICAgbWV0YWRhdGFNYXAuc2V0KE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjYuMSBPcmRpbmFyeU1ldGFkYXRhS2V5cyhPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5bWV0YWRhdGFrZXlzXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlNZXRhZGF0YUtleXMoTywgUCkge1xyXG4gICAgICAgICAgICB2YXIgb3duS2V5cyA9IE9yZGluYXJ5T3duTWV0YWRhdGFLZXlzKE8sIFApO1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gT3JkaW5hcnlHZXRQcm90b3R5cGVPZihPKTtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBvd25LZXlzO1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50S2V5cyA9IE9yZGluYXJ5TWV0YWRhdGFLZXlzKHBhcmVudCwgUCk7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRLZXlzLmxlbmd0aCA8PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG93bktleXM7XHJcbiAgICAgICAgICAgIGlmIChvd25LZXlzLmxlbmd0aCA8PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudEtleXM7XHJcbiAgICAgICAgICAgIHZhciBzZXQgPSBuZXcgX1NldCgpO1xyXG4gICAgICAgICAgICB2YXIga2V5cyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG93bktleXNfMSA9IG93bktleXM7IF9pIDwgb3duS2V5c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IG93bktleXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzS2V5ID0gc2V0LmhhcyhrZXkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXNLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXQuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBwYXJlbnRLZXlzXzEgPSBwYXJlbnRLZXlzOyBfYSA8IHBhcmVudEtleXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBwYXJlbnRLZXlzXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhc0tleSA9IHNldC5oYXMoa2V5KTtcclxuICAgICAgICAgICAgICAgIGlmICghaGFzS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0LmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzLjEuNy4xIE9yZGluYXJ5T3duTWV0YWRhdGFLZXlzKE8sIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9yYnVja3Rvbi5naXRodWIuaW8vcmVmbGVjdC1tZXRhZGF0YS8jb3JkaW5hcnlvd25tZXRhZGF0YWtleXNcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeU93bk1ldGFkYXRhS2V5cyhPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChJc1VuZGVmaW5lZChtZXRhZGF0YU1hcCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5cztcclxuICAgICAgICAgICAgdmFyIGtleXNPYmogPSBtZXRhZGF0YU1hcC5rZXlzKCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVyYXRvciA9IEdldEl0ZXJhdG9yKGtleXNPYmopO1xyXG4gICAgICAgICAgICB2YXIgayA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IEl0ZXJhdG9yU3RlcChpdGVyYXRvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBrZXlzLmxlbmd0aCA9IGs7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5c1trXSA9IG5leHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgSXRlcmF0b3JDbG9zZShpdGVyYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGsrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA2IEVDTUFTY3JpcHQgRGF0YSBUeXAwZXMgYW5kIFZhbHVlc1xyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWVjbWFzY3JpcHQtZGF0YS10eXBlcy1hbmQtdmFsdWVzXHJcbiAgICAgICAgZnVuY3Rpb24gVHlwZSh4KSB7XHJcbiAgICAgICAgICAgIGlmICh4ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDEgLyogTnVsbCAqLztcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlb2YgeCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInVuZGVmaW5lZFwiOiByZXR1cm4gMCAvKiBVbmRlZmluZWQgKi87XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOiByZXR1cm4gMiAvKiBCb29sZWFuICovO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOiByZXR1cm4gMyAvKiBTdHJpbmcgKi87XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwic3ltYm9sXCI6IHJldHVybiA0IC8qIFN5bWJvbCAqLztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjogcmV0dXJuIDUgLyogTnVtYmVyICovO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIm9iamVjdFwiOiByZXR1cm4geCA9PT0gbnVsbCA/IDEgLyogTnVsbCAqLyA6IDYgLyogT2JqZWN0ICovO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIDYgLyogT2JqZWN0ICovO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS4xIFRoZSBVbmRlZmluZWQgVHlwZVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWVjbWFzY3JpcHQtbGFuZ3VhZ2UtdHlwZXMtdW5kZWZpbmVkLXR5cGVcclxuICAgICAgICBmdW5jdGlvbiBJc1VuZGVmaW5lZCh4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB4ID09PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS4yIFRoZSBOdWxsIFR5cGVcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzLW51bGwtdHlwZVxyXG4gICAgICAgIGZ1bmN0aW9uIElzTnVsbCh4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB4ID09PSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA2LjEuNSBUaGUgU3ltYm9sIFR5cGVcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzLXN5bWJvbC10eXBlXHJcbiAgICAgICAgZnVuY3Rpb24gSXNTeW1ib2woeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09IFwic3ltYm9sXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS43IFRoZSBPYmplY3QgVHlwZVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLW9iamVjdC10eXBlXHJcbiAgICAgICAgZnVuY3Rpb24gSXNPYmplY3QoeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09IFwib2JqZWN0XCIgPyB4ICE9PSBudWxsIDogdHlwZW9mIHggPT09IFwiZnVuY3Rpb25cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy4xIFR5cGUgQ29udmVyc2lvblxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXR5cGUtY29udmVyc2lvblxyXG4gICAgICAgIC8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXRvcHJpbWl0aXZlXHJcbiAgICAgICAgZnVuY3Rpb24gVG9QcmltaXRpdmUoaW5wdXQsIFByZWZlcnJlZFR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChUeXBlKGlucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwIC8qIFVuZGVmaW5lZCAqLzogcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxIC8qIE51bGwgKi86IHJldHVybiBpbnB1dDtcclxuICAgICAgICAgICAgICAgIGNhc2UgMiAvKiBCb29sZWFuICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDMgLyogU3RyaW5nICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQgLyogU3ltYm9sICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDUgLyogTnVtYmVyICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGhpbnQgPSBQcmVmZXJyZWRUeXBlID09PSAzIC8qIFN0cmluZyAqLyA/IFwic3RyaW5nXCIgOiBQcmVmZXJyZWRUeXBlID09PSA1IC8qIE51bWJlciAqLyA/IFwibnVtYmVyXCIgOiBcImRlZmF1bHRcIjtcclxuICAgICAgICAgICAgdmFyIGV4b3RpY1RvUHJpbSA9IEdldE1ldGhvZChpbnB1dCwgdG9QcmltaXRpdmVTeW1ib2wpO1xyXG4gICAgICAgICAgICBpZiAoZXhvdGljVG9QcmltICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleG90aWNUb1ByaW0uY2FsbChpbnB1dCwgaGludCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeVRvUHJpbWl0aXZlKGlucHV0LCBoaW50ID09PSBcImRlZmF1bHRcIiA/IFwibnVtYmVyXCIgOiBoaW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy4xLjEuMSBPcmRpbmFyeVRvUHJpbWl0aXZlKE8sIGhpbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3JkaW5hcnl0b3ByaW1pdGl2ZVxyXG4gICAgICAgIGZ1bmN0aW9uIE9yZGluYXJ5VG9QcmltaXRpdmUoTywgaGludCkge1xyXG4gICAgICAgICAgICBpZiAoaGludCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvU3RyaW5nXzEgPSBPLnRvU3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodG9TdHJpbmdfMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdG9TdHJpbmdfMS5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZU9mID0gTy52YWx1ZU9mO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodmFsdWVPZikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdmFsdWVPZi5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZU9mID0gTy52YWx1ZU9mO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodmFsdWVPZikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdmFsdWVPZi5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciB0b1N0cmluZ18yID0gTy50b1N0cmluZztcclxuICAgICAgICAgICAgICAgIGlmIChJc0NhbGxhYmxlKHRvU3RyaW5nXzIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRvU3RyaW5nXzIuY2FsbChPKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHJlc3VsdCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjEuMiBUb0Jvb2xlYW4oYXJndW1lbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLzIwMTYvI3NlYy10b2Jvb2xlYW5cclxuICAgICAgICBmdW5jdGlvbiBUb0Jvb2xlYW4oYXJndW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhYXJndW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMS4xMiBUb1N0cmluZyhhcmd1bWVudClcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy10b3N0cmluZ1xyXG4gICAgICAgIGZ1bmN0aW9uIFRvU3RyaW5nKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiICsgYXJndW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMS4xNCBUb1Byb3BlcnR5S2V5KGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXRvcHJvcGVydHlrZXlcclxuICAgICAgICBmdW5jdGlvbiBUb1Byb3BlcnR5S2V5KGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBUb1ByaW1pdGl2ZShhcmd1bWVudCwgMyAvKiBTdHJpbmcgKi8pO1xyXG4gICAgICAgICAgICBpZiAoSXNTeW1ib2woa2V5KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgICAgIHJldHVybiBUb1N0cmluZyhrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIgVGVzdGluZyBhbmQgQ29tcGFyaXNvbiBPcGVyYXRpb25zXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtdGVzdGluZy1hbmQtY29tcGFyaXNvbi1vcGVyYXRpb25zXHJcbiAgICAgICAgLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudClcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1pc2FycmF5XHJcbiAgICAgICAgZnVuY3Rpb24gSXNBcnJheShhcmd1bWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheVxyXG4gICAgICAgICAgICAgICAgPyBBcnJheS5pc0FycmF5KGFyZ3VtZW50KVxyXG4gICAgICAgICAgICAgICAgOiBhcmd1bWVudCBpbnN0YW5jZW9mIE9iamVjdFxyXG4gICAgICAgICAgICAgICAgICAgID8gYXJndW1lbnQgaW5zdGFuY2VvZiBBcnJheVxyXG4gICAgICAgICAgICAgICAgICAgIDogT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZ3VtZW50KSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIuMyBJc0NhbGxhYmxlKGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWlzY2FsbGFibGVcclxuICAgICAgICBmdW5jdGlvbiBJc0NhbGxhYmxlKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgYW4gYXBwcm94aW1hdGlvbiBhcyB3ZSBjYW5ub3QgY2hlY2sgZm9yIFtbQ2FsbF1dIGludGVybmFsIG1ldGhvZC5cclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmd1bWVudCA9PT0gXCJmdW5jdGlvblwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIuNCBJc0NvbnN0cnVjdG9yKGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWlzY29uc3RydWN0b3JcclxuICAgICAgICBmdW5jdGlvbiBJc0NvbnN0cnVjdG9yKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgYW4gYXBwcm94aW1hdGlvbiBhcyB3ZSBjYW5ub3QgY2hlY2sgZm9yIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kLlxyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3VtZW50ID09PSBcImZ1bmN0aW9uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMi43IElzUHJvcGVydHlLZXkoYXJndW1lbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtaXNwcm9wZXJ0eWtleVxyXG4gICAgICAgIGZ1bmN0aW9uIElzUHJvcGVydHlLZXkoYXJndW1lbnQpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChUeXBlKGFyZ3VtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzIC8qIFN0cmluZyAqLzogcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQgLyogU3ltYm9sICovOiByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjMgT3BlcmF0aW9ucyBvbiBPYmplY3RzXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3BlcmF0aW9ucy1vbi1vYmplY3RzXHJcbiAgICAgICAgLy8gNy4zLjkgR2V0TWV0aG9kKFYsIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtZ2V0bWV0aG9kXHJcbiAgICAgICAgZnVuY3Rpb24gR2V0TWV0aG9kKFYsIFApIHtcclxuICAgICAgICAgICAgdmFyIGZ1bmMgPSBWW1BdO1xyXG4gICAgICAgICAgICBpZiAoZnVuYyA9PT0gdW5kZWZpbmVkIHx8IGZ1bmMgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBpZiAoIUlzQ2FsbGFibGUoZnVuYykpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjQgT3BlcmF0aW9ucyBvbiBJdGVyYXRvciBPYmplY3RzXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3BlcmF0aW9ucy1vbi1pdGVyYXRvci1vYmplY3RzXHJcbiAgICAgICAgZnVuY3Rpb24gR2V0SXRlcmF0b3Iob2JqKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRob2QgPSBHZXRNZXRob2Qob2JqLCBpdGVyYXRvclN5bWJvbCk7XHJcbiAgICAgICAgICAgIGlmICghSXNDYWxsYWJsZShtZXRob2QpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOyAvLyBmcm9tIENhbGxcclxuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gbWV0aG9kLmNhbGwob2JqKTtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdChpdGVyYXRvcikpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVyYXRvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjQgSXRlcmF0b3JWYWx1ZShpdGVyUmVzdWx0KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8yMDE2LyNzZWMtaXRlcmF0b3J2YWx1ZVxyXG4gICAgICAgIGZ1bmN0aW9uIEl0ZXJhdG9yVmFsdWUoaXRlclJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlclJlc3VsdC52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjUgSXRlcmF0b3JTdGVwKGl0ZXJhdG9yKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWl0ZXJhdG9yc3RlcFxyXG4gICAgICAgIGZ1bmN0aW9uIEl0ZXJhdG9yU3RlcChpdGVyYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyBmYWxzZSA6IHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbilcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1pdGVyYXRvcmNsb3NlXHJcbiAgICAgICAgZnVuY3Rpb24gSXRlcmF0b3JDbG9zZShpdGVyYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGl0ZXJhdG9yW1wicmV0dXJuXCJdO1xyXG4gICAgICAgICAgICBpZiAoZilcclxuICAgICAgICAgICAgICAgIGYuY2FsbChpdGVyYXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDkuMSBPcmRpbmFyeSBPYmplY3QgSW50ZXJuYWwgTWV0aG9kcyBhbmQgSW50ZXJuYWwgU2xvdHNcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1vcmRpbmFyeS1vYmplY3QtaW50ZXJuYWwtbWV0aG9kcy1hbmQtaW50ZXJuYWwtc2xvdHNcclxuICAgICAgICAvLyA5LjEuMS4xIE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTylcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1vcmRpbmFyeWdldHByb3RvdHlwZW9mXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlHZXRQcm90b3R5cGVPZihPKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBPICE9PSBcImZ1bmN0aW9uXCIgfHwgTyA9PT0gZnVuY3Rpb25Qcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIFR5cGVTY3JpcHQgZG9lc24ndCBzZXQgX19wcm90b19fIGluIEVTNSwgYXMgaXQncyBub24tc3RhbmRhcmQuXHJcbiAgICAgICAgICAgIC8vIFRyeSB0byBkZXRlcm1pbmUgdGhlIHN1cGVyY2xhc3MgY29uc3RydWN0b3IuIENvbXBhdGlibGUgaW1wbGVtZW50YXRpb25zXHJcbiAgICAgICAgICAgIC8vIG11c3QgZWl0aGVyIHNldCBfX3Byb3RvX18gb24gYSBzdWJjbGFzcyBjb25zdHJ1Y3RvciB0byB0aGUgc3VwZXJjbGFzcyBjb25zdHJ1Y3RvcixcclxuICAgICAgICAgICAgLy8gb3IgZW5zdXJlIGVhY2ggY2xhc3MgaGFzIGEgdmFsaWQgYGNvbnN0cnVjdG9yYCBwcm9wZXJ0eSBvbiBpdHMgcHJvdG90eXBlIHRoYXRcclxuICAgICAgICAgICAgLy8gcG9pbnRzIGJhY2sgdG8gdGhlIGNvbnN0cnVjdG9yLlxyXG4gICAgICAgICAgICAvLyBJZiB0aGlzIGlzIG5vdCB0aGUgc2FtZSBhcyBGdW5jdGlvbi5bW1Byb3RvdHlwZV1dLCB0aGVuIHRoaXMgaXMgZGVmaW5hdGVseSBpbmhlcml0ZWQuXHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlbiBpbiBFUzYgb3Igd2hlbiB1c2luZyBfX3Byb3RvX18gaW4gYSBjb21wYXRpYmxlIGJyb3dzZXIuXHJcbiAgICAgICAgICAgIGlmIChwcm90byAhPT0gZnVuY3Rpb25Qcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBzdXBlciBwcm90b3R5cGUgaXMgT2JqZWN0LnByb3RvdHlwZSwgbnVsbCwgb3IgdW5kZWZpbmVkLCB0aGVuIHdlIGNhbm5vdCBkZXRlcm1pbmUgdGhlIGhlcml0YWdlLlxyXG4gICAgICAgICAgICB2YXIgcHJvdG90eXBlID0gTy5wcm90b3R5cGU7XHJcbiAgICAgICAgICAgIHZhciBwcm90b3R5cGVQcm90byA9IHByb3RvdHlwZSAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG90eXBlKTtcclxuICAgICAgICAgICAgaWYgKHByb3RvdHlwZVByb3RvID09IG51bGwgfHwgcHJvdG90eXBlUHJvdG8gPT09IE9iamVjdC5wcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBjb25zdHJ1Y3RvciB3YXMgbm90IGEgZnVuY3Rpb24sIHRoZW4gd2UgY2Fubm90IGRldGVybWluZSB0aGUgaGVyaXRhZ2UuXHJcbiAgICAgICAgICAgIHZhciBjb25zdHJ1Y3RvciA9IHByb3RvdHlwZVByb3RvLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnN0cnVjdG9yICE9PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgc29tZSBraW5kIG9mIHNlbGYtcmVmZXJlbmNlLCB0aGVuIHdlIGNhbm5vdCBkZXRlcm1pbmUgdGhlIGhlcml0YWdlLlxyXG4gICAgICAgICAgICBpZiAoY29uc3RydWN0b3IgPT09IE8pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgYSBwcmV0dHkgZ29vZCBndWVzcyBhdCB0aGUgaGVyaXRhZ2UuXHJcbiAgICAgICAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbmFpdmUgTWFwIHNoaW1cclxuICAgICAgICBmdW5jdGlvbiBDcmVhdGVNYXBQb2x5ZmlsbCgpIHtcclxuICAgICAgICAgICAgdmFyIGNhY2hlU2VudGluZWwgPSB7fTtcclxuICAgICAgICAgICAgdmFyIGFycmF5U2VudGluZWwgPSBbXTtcclxuICAgICAgICAgICAgdmFyIE1hcEl0ZXJhdG9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIE1hcEl0ZXJhdG9yKGtleXMsIHZhbHVlcywgc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGtleXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBNYXBJdGVyYXRvci5wcm90b3R5cGVbXCJAQGl0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfTtcclxuICAgICAgICAgICAgICAgIE1hcEl0ZXJhdG9yLnByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xyXG4gICAgICAgICAgICAgICAgTWFwSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5faW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLl9rZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fc2VsZWN0b3IodGhpcy5fa2V5c1tpbmRleF0sIHRoaXMuX3ZhbHVlc1tpbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggKyAxID49IHRoaXMuX2tleXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMgPSBhcnJheVNlbnRpbmVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogcmVzdWx0LCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgTWFwSXRlcmF0b3IucHJvdG90eXBlLnRocm93ID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2luZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5kZXggPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlcyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIE1hcEl0ZXJhdG9yLnByb3RvdHlwZS5yZXR1cm4gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gYXJyYXlTZW50aW5lbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gYXJyYXlTZW50aW5lbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBkb25lOiB0cnVlIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hcEl0ZXJhdG9yO1xyXG4gICAgICAgICAgICB9KCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIE1hcCgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVLZXkgPSBjYWNoZVNlbnRpbmVsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSAtMjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXAucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fa2V5cy5sZW5ndGg7IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoa2V5KSB7IHJldHVybiB0aGlzLl9maW5kKGtleSwgLyppbnNlcnQqLyBmYWxzZSkgPj0gMDsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmQoa2V5LCAvKmluc2VydCovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggPj0gMCA/IHRoaXMuX3ZhbHVlc1tpbmRleF0gOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmQoa2V5LCAvKmluc2VydCovIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9maW5kKGtleSwgLyppbnNlcnQqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSB0aGlzLl9rZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGluZGV4ICsgMTsgaSA8IHNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5c1tpIC0gMV0gPSB0aGlzLl9rZXlzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzW2kgLSAxXSA9IHRoaXMuX3ZhbHVlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzLmxlbmd0aC0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IHRoaXMuX2NhY2hlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlU2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUluZGV4ID0gLTI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleXMubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlU2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVJbmRleCA9IC0yO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldEtleSk7IH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLnZhbHVlcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldFZhbHVlKTsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldEVudHJ5KTsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGVbXCJAQGl0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5lbnRyaWVzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZW50cmllcygpOyB9O1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5fZmluZCA9IGZ1bmN0aW9uIChrZXksIGluc2VydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYWNoZUtleSAhPT0ga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSB0aGlzLl9rZXlzLmluZGV4T2YodGhpcy5fY2FjaGVLZXkgPSBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FjaGVJbmRleCA8IDAgJiYgaW5zZXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSB0aGlzLl9rZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cy5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXA7XHJcbiAgICAgICAgICAgIH0oKSk7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEtleShrZXksIF8pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsdWUoXywgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRFbnRyeShrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2tleSwgdmFsdWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG5haXZlIFNldCBzaGltXHJcbiAgICAgICAgZnVuY3Rpb24gQ3JlYXRlU2V0UG9seWZpbGwoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gU2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcCA9IG5ldyBfTWFwKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0LnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5zaXplOyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB0aGlzLl9tYXAuaGFzKHZhbHVlKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB0aGlzLl9tYXAuc2V0KHZhbHVlLCB2YWx1ZSksIHRoaXM7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdGhpcy5fbWFwLmRlbGV0ZSh2YWx1ZSk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9tYXAuY2xlYXIoKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5rZXlzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLnZhbHVlcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC52YWx1ZXMoKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5lbnRyaWVzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlW1wiQEBpdGVyYXRvclwiXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMua2V5cygpOyB9O1xyXG4gICAgICAgICAgICAgICAgU2V0LnByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmtleXMoKTsgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBTZXQ7XHJcbiAgICAgICAgICAgIH0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG5haXZlIFdlYWtNYXAgc2hpbVxyXG4gICAgICAgIGZ1bmN0aW9uIENyZWF0ZVdlYWtNYXBQb2x5ZmlsbCgpIHtcclxuICAgICAgICAgICAgdmFyIFVVSURfU0laRSA9IDE2O1xyXG4gICAgICAgICAgICB2YXIga2V5cyA9IEhhc2hNYXAuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZhciByb290S2V5ID0gQ3JlYXRlVW5pcXVlS2V5KCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gV2Vha01hcCgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXkgPSBDcmVhdGVVbmlxdWVLZXkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFdlYWtNYXAucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBHZXRPckNyZWF0ZVdlYWtNYXBUYWJsZSh0YXJnZXQsIC8qY3JlYXRlKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWJsZSAhPT0gdW5kZWZpbmVkID8gSGFzaE1hcC5oYXModGFibGUsIHRoaXMuX2tleSkgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBXZWFrTWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGUgIT09IHVuZGVmaW5lZCA/IEhhc2hNYXAuZ2V0KHRhYmxlLCB0aGlzLl9rZXkpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIFdlYWtNYXAucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlW3RoaXMuX2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBXZWFrTWFwLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGUgIT09IHVuZGVmaW5lZCA/IGRlbGV0ZSB0YWJsZVt0aGlzLl9rZXldIDogZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgV2Vha01hcC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogbm90IGEgcmVhbCBjbGVhciwganVzdCBtYWtlcyB0aGUgcHJldmlvdXMgZGF0YSB1bnJlYWNoYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleSA9IENyZWF0ZVVuaXF1ZUtleSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBXZWFrTWFwO1xyXG4gICAgICAgICAgICB9KCkpO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBDcmVhdGVVbmlxdWVLZXkoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5O1xyXG4gICAgICAgICAgICAgICAgZG9cclxuICAgICAgICAgICAgICAgICAgICBrZXkgPSBcIkBAV2Vha01hcEBAXCIgKyBDcmVhdGVVVUlEKCk7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoSGFzaE1hcC5oYXMoa2V5cywga2V5KSk7XHJcbiAgICAgICAgICAgICAgICBrZXlzW2tleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBHZXRPckNyZWF0ZVdlYWtNYXBUYWJsZSh0YXJnZXQsIGNyZWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXNPd24uY2FsbCh0YXJnZXQsIHJvb3RLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjcmVhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcm9vdEtleSwgeyB2YWx1ZTogSGFzaE1hcC5jcmVhdGUoKSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbcm9vdEtleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gRmlsbFJhbmRvbUJ5dGVzKGJ1ZmZlciwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpXHJcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyW2ldID0gTWF0aC5yYW5kb20oKSAqIDB4ZmYgfCAwO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBHZW5SYW5kb21CeXRlcyhzaXplKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY3J5cHRvICE9PSBcInVuZGVmaW5lZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShzaXplKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc0NyeXB0byAhPT0gXCJ1bmRlZmluZWRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShzaXplKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZpbGxSYW5kb21CeXRlcyhuZXcgVWludDhBcnJheShzaXplKSwgc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRmlsbFJhbmRvbUJ5dGVzKG5ldyBBcnJheShzaXplKSwgc2l6ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gQ3JlYXRlVVVJRCgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gR2VuUmFuZG9tQnl0ZXMoVVVJRF9TSVpFKTtcclxuICAgICAgICAgICAgICAgIC8vIG1hcmsgYXMgcmFuZG9tIC0gUkZDIDQxMjIgwqcgNC40XHJcbiAgICAgICAgICAgICAgICBkYXRhWzZdID0gZGF0YVs2XSAmIDB4NGYgfCAweDQwO1xyXG4gICAgICAgICAgICAgICAgZGF0YVs4XSA9IGRhdGFbOF0gJiAweGJmIHwgMHg4MDtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgVVVJRF9TSVpFOyArK29mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBieXRlID0gZGF0YVtvZmZzZXRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgPT09IDQgfHwgb2Zmc2V0ID09PSA2IHx8IG9mZnNldCA9PT0gOClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IFwiLVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChieXRlIDwgMTYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBcIjBcIjtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gYnl0ZS50b1N0cmluZygxNikudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdXNlcyBhIGhldXJpc3RpYyB1c2VkIGJ5IHY4IGFuZCBjaGFrcmEgdG8gZm9yY2UgYW4gb2JqZWN0IGludG8gZGljdGlvbmFyeSBtb2RlLlxyXG4gICAgICAgIGZ1bmN0aW9uIE1ha2VEaWN0aW9uYXJ5KG9iaikge1xyXG4gICAgICAgICAgICBvYmouX18gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBvYmouX187XHJcbiAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKFJlZmxlY3QgfHwgKFJlZmxlY3QgPSB7fSkpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWZsZWN0LmpzLm1hcFxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvcmVmbGVjdC1tZXRhZGF0YS9SZWZsZWN0LmpzXG4vLyBtb2R1bGUgaWQgPSAxOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog6L+Z5Liq5paH5Lu255qE5a2Y5Zyo5piv5Li65LqG5a+5546w5pyJanPlip/og73miZPooaXkuIHkv65idWfnrYlcclxuKi9cclxuLyoqIOS/ruWkjUFycmF5LmZpbmRJbmRleOS8muiiq+mBjeWOhuWIsOeahOmXrumimCAqL1xyXG5pZiAoQXJyYXkucHJvdG90eXBlLmhhc093blByb3BlcnR5KFwiZmluZEluZGV4XCIpKSB7XHJcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoQXJyYXkucHJvdG90eXBlLCBcImZpbmRJbmRleFwiKTtcclxuICAgIGlmIChkZXNjLmVudW1lcmFibGUpIHtcclxuICAgICAgICBkZXNjLmVudW1lcmFibGUgPSBmYWxzZTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCBcImZpbmRJbmRleFwiLCBkZXNjKTtcclxuICAgIH1cclxufVxyXG4vKiog5Li65p+Q5Lqb5LiN5pSv5oyBRXJyb3JFdmVudOeahOa1j+iniOWZqOa3u+WKoEVycm9yRXZlbnTmlK/mjIEgKi9cclxudHJ5IHtcclxuICAgIG5ldyBFcnJvckV2ZW50KFwiXCIpO1xyXG59XHJcbmNhdGNoIChlcnIpIHtcclxuICAgIHdpbmRvd1tcIkVycm9yRXZlbnRcIl0gPSBmdW5jdGlvbiBFcnJvckV2ZW50KHR5cGUsIGVycm9yRXZlbnRJbml0RGljdCkge1xyXG4gICAgICAgIGlmICghZXJyb3JFdmVudEluaXREaWN0KVxyXG4gICAgICAgICAgICBlcnJvckV2ZW50SW5pdERpY3QgPSB7fTtcclxuICAgICAgICBpZiAoRXZlbnQgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICBFdmVudC5jYWxsKHRoaXMsIHR5cGUsIGVycm9yRXZlbnRJbml0RGljdCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdEVycm9yRXZlbnQodHlwZSwgZXJyb3JFdmVudEluaXREaWN0LmJ1YmJsZXMsIGVycm9yRXZlbnRJbml0RGljdC5jYW5jZWxhYmxlLCBlcnJvckV2ZW50SW5pdERpY3QubWVzc2FnZSwgZXJyb3JFdmVudEluaXREaWN0LmZpbGVuYW1lLCBlcnJvckV2ZW50SW5pdERpY3QubGluZW5vKTtcclxuICAgICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yRXZlbnRJbml0RGljdC5lcnJvcjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFcnJvckV2ZW50XCIpO1xyXG4gICAgICAgICAgICBldnQuaW5pdEVycm9yRXZlbnQodHlwZSwgZXJyb3JFdmVudEluaXREaWN0LmJ1YmJsZXMsIGVycm9yRXZlbnRJbml0RGljdC5jYW5jZWxhYmxlLCBlcnJvckV2ZW50SW5pdERpY3QubWVzc2FnZSwgZXJyb3JFdmVudEluaXREaWN0LmZpbGVuYW1lLCBlcnJvckV2ZW50SW5pdERpY3QubGluZW5vKTtcclxuICAgICAgICAgICAgcmV0dXJuIGV2dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgd2luZG93W1wiRXJyb3JFdmVudFwiXS5wcm90b3R5cGUuaW5pdEVycm9yRXZlbnQgPSBmdW5jdGlvbiBpbml0RXJyb3JFdmVudCh0eXBlQXJnLCBjYW5CdWJibGVBcmcsIGNhbmNlbGFibGVBcmcsIG1lc3NhZ2VBcmcsIGZpbGVuYW1lQXJnLCBsaW5lbm9BcmcpIHtcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlQXJnO1xyXG4gICAgICAgIHRoaXMuYnViYmxlcyA9IGNhbkJ1YmJsZUFyZztcclxuICAgICAgICB0aGlzLmNhbmNlbGFibGUgPSBjYW5jZWxhYmxlQXJnO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VBcmc7XHJcbiAgICAgICAgdGhpcy5maWxlbmFtZSA9IGZpbGVuYW1lQXJnO1xyXG4gICAgICAgIHRoaXMubGluZW5vID0gbGluZW5vQXJnO1xyXG4gICAgfTtcclxufVxyXG4vKiog56+h5pS5UmVmbGVjdC5kZWNvcmF0ZeaWueazle+8jOeUqOS6juS4uuijhemlsOWZqOaWueazleaJk+S4qmZsYWfvvIzmoIforrDoo4XppbDlmajmmK/lkKbkuLrlj4LmlbDljJboo4XppbAgKi9cclxuZXhwb3J0IHZhciBkZWNvcmF0ZVRoaXMgPSB7fTtcclxuaWYgKFJlZmxlY3QgJiYgUmVmbGVjdC5kZWNvcmF0ZSkge1xyXG4gICAgdmFyIG9yaURlY29yYXRlID0gUmVmbGVjdC5kZWNvcmF0ZTtcclxuICAgIFJlZmxlY3QuZGVjb3JhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOevoeaUuWFyZ3NbMF1bMF3vvIjoo4XppbDlmajmlrnms5XlvJXnlKjvvInvvIzlnKjosIPnlKjml7bkuLrlhbbmj5DkvpvkuIDkuKp0aGlz5oyH5ZCR77yM5oyH5ZCRd2luZG93XHJcbiAgICAgICAgdmFyIG9yaVJlZiA9IGFyZ3NbMF1bMF07XHJcbiAgICAgICAgYXJnc1swXVswXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gb3JpUmVmLmFwcGx5KGRlY29yYXRlVGhpcywgYXJncyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDosIPnlKjljp/lp4vmlrnms5VcclxuICAgICAgICB2YXIgcmVzdWx0ID0gb3JpRGVjb3JhdGUuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgLy8g6L+Y5Y6f56+h5pS56aG5XHJcbiAgICAgICAgYXJnc1swXVswXSA9IG9yaVJlZjtcclxuICAgICAgICAvLyDov5Tlm57nu5PmnpxcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL2dsb2JhbC9QYXRjaC5qc1xuLy8gbW9kdWxlIGlkID0gMjBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZXh0ZW5kT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuZnVuY3Rpb24gd3JhcEV2YWxGdW5jKGV4cCkge1xyXG4gICAgLy8g6L+Z5Liq5pa55rOV55qE5Yqf6IO95Li76KaB5piv5bCG5aSa5Liqc2NvcGXlkIjlubbmiJDkuLrkuIDkuKpzY29wZVxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2NvcGVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgc2NvcGVzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzY29wZSA9IGV4dGVuZE9iamVjdC5hcHBseSh2b2lkIDAsIFt7fV0uY29uY2F0KHNjb3Blcy5yZXZlcnNlKCkpKTtcclxuICAgICAgICByZXR1cm4gZXhwLmNhbGwodGhpcywgc2NvcGUpO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICog5bCG6KGo6L6+5byP5YyF6KOF5oiQ5Li65pa55rOVXHJcbiAqXHJcbiAqIEBwYXJhbSB7KEV2YWxFeHApfSBleHAg6KGo6L6+5byP5oiW5pa55rOVXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBzY29wZUNvdW50IOWPguaVsOS4quaVsO+8jOS7heWcqGV4cOS4uuihqOi+vuW8j+aXtuacieaViFxyXG4gKiBAcmV0dXJucyB7RXZhbEZ1bmN9IOWMheijheaWueazlVxyXG4gKi9cclxuZnVuY3Rpb24gd3JhcEV2YWxGdW5jRXhwKGV4cCwgc2NvcGVDb3VudCkge1xyXG4gICAgaWYgKHR5cGVvZiBleHAgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICB2YXIgYXJnTGlzdCA9IFtdO1xyXG4gICAgICAgIHZhciBleHBTdHIgPSBleHA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY29wZUNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgYXJnTGlzdC5wdXNoKFwic1wiICsgaSk7XHJcbiAgICAgICAgICAgIGV4cFN0ciA9IFwid2l0aChzXCIgKyBpICsgXCJ8fHt9KXtcIiArIGV4cFN0ciArIFwifVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gRnVuY3Rpb24oYXJnTGlzdC5qb2luKFwiLFwiKSwgZXhwU3RyKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB3cmFwRXZhbEZ1bmMoZXhwKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5Yib5bu65LiA5Liq5omn6KGM5pa55rOV77yM55So5LqO5pyq5p2l5omn6KGMXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDooajovr7lvI/miJbmlrnms5VcclxuICogQHBhcmFtIHtudW1iZXJ9IFtzY29wZUNvdW50PTBdIOaJgOmcgOeahOWfn+eahOaVsOmHj1xyXG4gKiBAcmV0dXJucyB7RXZhbEZ1bmN9IOWIm+W7uueahOaWueazlVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJ1bkZ1bmMoZXhwLCBzY29wZUNvdW50KSB7XHJcbiAgICBpZiAoc2NvcGVDb3VudCA9PT0gdm9pZCAwKSB7IHNjb3BlQ291bnQgPSAwOyB9XHJcbiAgICBpZiAodHlwZW9mIGV4cCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIHZhciBmdW5jO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGZ1bmMgPSB3cmFwRXZhbEZ1bmNFeHAoZXhwLCBzY29wZUNvdW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAvLyDlj6/og73mmK/mn5DkupvniYjmnKznmoTop6Pph4rlmajkuI3orqTor4bmqKHmnb/lrZfnrKbkuLLvvIzlsIbmqKHmnb/lrZfnrKbkuLLlj5jmiJDmma7pgJrlrZfnrKbkuLJcclxuICAgICAgICAgICAgdmFyIHNlcFN0ciA9IChleHAuaW5kZXhPZignXCInKSA8IDAgPyAnXCInIDogXCInXCIpO1xyXG4gICAgICAgICAgICAvLyDlsIZleHDkuK3nmoTCt+abv+aNouS4uidcclxuICAgICAgICAgICAgdmFyIHJlZyA9IC8oW15cXFxcXT8pYC9nO1xyXG4gICAgICAgICAgICBleHAgPSBleHAucmVwbGFjZShyZWcsIFwiJDFcIiArIHNlcFN0cik7XHJcbiAgICAgICAgICAgIC8vIOWwhmV4cOS4rSR7Li4ufeabv+aNouS4ulwiICsgLi4uICsgXCLnmoTlvaLlvI9cclxuICAgICAgICAgICAgcmVnID0gL1xcJFxceyguKj8pXFx9L2c7XHJcbiAgICAgICAgICAgIGV4cCA9IGV4cC5yZXBsYWNlKHJlZywgc2VwU3RyICsgXCIrKCQxKStcIiArIHNlcFN0cik7XHJcbiAgICAgICAgICAgIC8vIOmHjeaWsOeUn+aIkOaWueazleW5tui/lOWbnlxyXG4gICAgICAgICAgICBmdW5jID0gd3JhcEV2YWxGdW5jRXhwKGV4cCwgc2NvcGVDb3VudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmdW5jO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBFdmFsRnVuYyhleHApO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDnm7TmjqXmiafooYzooajovr7lvI/vvIzkuI3msYLlgLzjgILor6Xmlrnms5Xlj6/ku6XmiafooYzlpJrmnaHor63lj6VcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyhFdmFsRXhwKX0gZXhwIOihqOi+vuW8j+aIluaWueazlVxyXG4gKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAqIEBwYXJhbSB7Li4uYW55W119IHNjb3BlcyDooajovr7lvI/nmoTkvZznlKjln5/liJfooahcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBydW5FeHAoZXhwLCB0aGlzQXJnKSB7XHJcbiAgICB2YXIgc2NvcGVzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHNjb3Blc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGNyZWF0ZVJ1bkZ1bmMoZXhwLCBzY29wZXMubGVuZ3RoKS5hcHBseSh0aGlzQXJnLCBzY29wZXMpO1xyXG59XHJcbi8qKlxyXG4gKiDliJvlu7rkuIDkuKrooajovr7lvI/msYLlgLzmlrnms5XvvIznlKjkuo7mnKrmnaXmiafooYxcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyhFdmFsRXhwKX0gZXhwIOihqOi+vuW8j+aIluaWueazlVxyXG4gKiBAcGFyYW0ge251bWJlcn0gW3Njb3BlQ291bnQ9MF0g5omA6ZyA55qE5Z+f55qE5pWw6YePXHJcbiAqIEByZXR1cm5zIHtFdmFsRnVuY30g5Yib5bu655qE5pa55rOVXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXZhbEZ1bmMoZXhwLCBzY29wZUNvdW50KSB7XHJcbiAgICBpZiAoc2NvcGVDb3VudCA9PT0gdm9pZCAwKSB7IHNjb3BlQ291bnQgPSAwOyB9XHJcbiAgICBpZiAodHlwZW9mIGV4cCA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICByZXR1cm4gY3JlYXRlUnVuRnVuYyhcInJldHVybiBcIiArIGV4cCwgc2NvcGVDb3VudCk7XHJcbiAgICBlbHNlXHJcbiAgICAgICAgcmV0dXJuIHdyYXBFdmFsRnVuYyhleHApO1xyXG59XHJcbi8qKlxyXG4gKiDooajovr7lvI/msYLlgLzvvIzml6Dms5XmiafooYzlpJrmnaHor63lj6VcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyhFdmFsRXhwKX0gZXhwIOihqOi+vuW8j+aIluaWueazlVxyXG4gKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAqIEBwYXJhbSB7Li4uYW55W119IHNjb3BlcyDooajovr7lvI/nmoTkvZznlKjln5/liJfooahcclxuICogQHJldHVybnMgeyp9IOi/lOWbnuWAvFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV2YWxFeHAoZXhwLCB0aGlzQXJnKSB7XHJcbiAgICB2YXIgc2NvcGVzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHNjb3Blc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIHJldHVybiBjcmVhdGVFdmFsRnVuYyhleHAsIHNjb3Blcy5sZW5ndGgpLmFwcGx5KHRoaXNBcmcsIHNjb3Blcyk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvVXRpbHMuanNcbi8vIG1vZHVsZSBpZCA9IDIxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgbm9uZSBmcm9tIFwiLi9Ob25lUGFuZWxQb2xpY3lcIjtcclxuaW1wb3J0IFBhbmVsTWVzc2FnZSBmcm9tIFwiLi9QYW5lbE1lc3NhZ2VcIjtcclxuaW1wb3J0IHsgQnV0dG9uVHlwZSB9IGZyb20gXCIuL0lQcm9tcHRQYW5lbFwiO1xyXG5pbXBvcnQgeyBicmlkZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IG1hc2tNYW5hZ2VyIH0gZnJvbSBcIi4uL21hc2svTWFza01hbmFnZXJcIjtcclxuaW1wb3J0IERpY3Rpb25hcnkgZnJvbSBcIi4uLy4uL3V0aWxzL0RpY3Rpb25hcnlcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIOW8ueeql+euoeeQhuWZqO+8jOWMheWQq+W8ueWHuuW8ueeql+OAgeWFs+mXreW8ueeql+OAgeW8ueeql+euoeeQhuetieWKn+iDvVxyXG4qL1xyXG52YXIgUGFuZWxNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGFuZWxNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX3BhbmVscyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX3ByaW9yaXRpZXMgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKiDkuIvpnaLmmK/pgJrnlKjlvLnnqpfnmoTpgLvovpEgKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIHRoaXMuX3Byb21wdERpY3QgPSB7fTtcclxuICAgIH1cclxuICAgIFBhbmVsTWFuYWdlcl8xID0gUGFuZWxNYW5hZ2VyO1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blvZPliY3mmL7npLrnmoTlvLnnqpfmlbDnu4TvvIjlia/mnKzvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcn0gW2Nsc10g5by556qX57G75Z6L77yM5aaC5p6c5Lyg6YCS6K+l5Y+C5pWw5YiZ5Y+q6L+U5Zue6K+l57G75Z6L55qE5bey5omT5byA5by556qX77yM5ZCm5YiZ5bCG6L+U5Zue5omA5pyJ5bey5omT5byA55qE5by556qXXHJcbiAgICAgKiBAcmV0dXJucyB7SVBhbmVsW119IOW3suaJk+W8gOW8ueeql+aVsOe7hFxyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQYW5lbE1hbmFnZXIucHJvdG90eXBlLmdldE9wZW5lZCA9IGZ1bmN0aW9uIChjbHMpIHtcclxuICAgICAgICBpZiAoIWNscylcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhbmVscy5jb25jYXQoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYW5lbHMuZmlsdGVyKGZ1bmN0aW9uIChwYW5lbCkgeyByZXR1cm4gcGFuZWwuY29uc3RydWN0b3IgPT0gY2xzOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW8ueeql+aYr+WQpuW3suW8gOWQr1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVBhbmVsfSBwYW5lbCDlvLnnqpflr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKblt7Lnu4/lvIDlkK9cclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5pc09wZW5lZCA9IGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fcGFuZWxzLmluZGV4T2YocGFuZWwpID49IDApO1xyXG4gICAgfTtcclxuICAgIFBhbmVsTWFuYWdlci5wcm90b3R5cGUudXBkYXRlTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgLy8g6aaW5YWI5bCG5Lyg5YWl55qEcGFuZWznmoTmqKHmgIHpga7nvanljrvpmaRcclxuICAgICAgICBtYXNrTWFuYWdlci5oaWRlTW9kYWxNYXNrKHBhbmVsKTtcclxuICAgICAgICAvLyDnhLblkI7kuLrmnIDkuIrlsYLnmoTmqKHmgIHlvLnnqpfmt7vliqDpga7nvalcclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fcGFuZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIHBhbmVsID0gdGhpcy5fcGFuZWxzW2ldO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxEaWN0LmdldChwYW5lbCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOW3sue7j+aciemBrue9qeS6hu+8jOWFiOenu+mZpOS5i1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2tNYW5hZ2VyLmlzU2hvd2luZ01vZGFsTWFzayhwYW5lbCkpXHJcbiAgICAgICAgICAgICAgICAgICAgbWFza01hbmFnZXIuaGlkZU1vZGFsTWFzayhwYW5lbCk7XHJcbiAgICAgICAgICAgICAgICAvLyDmt7vliqDpga7nvalcclxuICAgICAgICAgICAgICAgIG1hc2tNYW5hZ2VyLnNob3dNb2RhbE1hc2socGFuZWwpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDkuIDkuKrlvLnnqpdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lQYW5lbH0gcGFuZWwg6KaB5omT5byA55qE5by556qXXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDmlbDmja5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzTW9kYWw9dHJ1ZV0g5piv5ZCm5qih5oCB5by55Ye6XHJcbiAgICAgKiBAcGFyYW0ge3t4Om51bWJlciwgeTpudW1iZXJ9fSBbZnJvbV0g5by55Ye66LW354K55L2N572uXHJcbiAgICAgKiBAcmV0dXJucyB7SVBhbmVsfSDov5Tlm57lvLnnqpflr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5wb3AgPSBmdW5jdGlvbiAocGFuZWwsIGRhdGEsIGlzTW9kYWwsIGZyb20pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChpc01vZGFsID09PSB2b2lkIDApIHsgaXNNb2RhbCA9IHRydWU7IH1cclxuICAgICAgICBpZiAodGhpcy5fcGFuZWxzLmluZGV4T2YocGFuZWwpIDwgMCkge1xyXG4gICAgICAgICAgICAvLyDmlbDmja7lhYjooYxcclxuICAgICAgICAgICAgdGhpcy5fcGFuZWxzLnB1c2gocGFuZWwpO1xyXG4gICAgICAgICAgICAvLyDlvLnnqpfmiYDlnKjnmoTooajnjrDlsYLlv4XpobvopoHmmL7npLpcclxuICAgICAgICAgICAgcGFuZWwuYnJpZGdlLmh0bWxXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xyXG4gICAgICAgICAgICAvLyDojrflj5bnrZbnlaVcclxuICAgICAgICAgICAgdmFyIHBvbGljeSA9IHBhbmVsLnBvbGljeSB8fCBwYW5lbC5icmlkZ2UuZGVmYXVsdFBhbmVsUG9saWN5IHx8IG5vbmU7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBwYW5lbC5vbkJlZm9yZVBvcChkYXRhLCBpc01vZGFsLCBmcm9tKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5raI5oGvXHJcbiAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goUGFuZWxNZXNzYWdlLlBBTkVMX0JFRk9SRV9QT1AsIHBhbmVsLCBpc01vZGFsLCBmcm9tKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5YeG5aSH5o6l5Y+jXHJcbiAgICAgICAgICAgIHBvbGljeS5wcmVwYXJlICYmIHBvbGljeS5wcmVwYXJlKHBhbmVsKTtcclxuICAgICAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgICAgIHZhciBicmlkZ2UgPSBwYW5lbC5icmlkZ2U7XHJcbiAgICAgICAgICAgIGJyaWRnZS5hZGRDaGlsZChwYW5lbC5icmlkZ2UucGFuZWxMYXllciwgcGFuZWwuc2tpbik7XHJcbiAgICAgICAgICAgIC8vIOagueaNruS8mOWFiOe6p+i/m+ihjOaOkuW6j1xyXG4gICAgICAgICAgICB0aGlzLl9wYW5lbHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHByaUEgPSBfdGhpcy5fcHJpb3JpdGllcy5nZXQoYSkgfHwgMDtcclxuICAgICAgICAgICAgICAgIHZhciBwcmlCID0gX3RoaXMuX3ByaW9yaXRpZXMuZ2V0KGIpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJpQSAtIHByaUI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyDmoLnmja7mjpLluo/lkI7nmoTpobrluo/osIPmlbTmmL7npLrpobrluo9cclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX3BhbmVsczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgdGVtcC5icmlkZ2UuYWRkQ2hpbGQodGVtcC5icmlkZ2UucGFuZWxMYXllciwgdGVtcC5za2luKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjnrZbnlaXmjqXlj6NcclxuICAgICAgICAgICAgcG9saWN5LnBvcChwYW5lbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBwYW5lbC5vbkFmdGVyUG9wKGRhdGEsIGlzTW9kYWwsIGZyb20pO1xyXG4gICAgICAgICAgICAgICAgLy8g5rS+5Y+R5raI5oGvXHJcbiAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKFBhbmVsTWVzc2FnZS5QQU5FTF9BRlRFUl9QT1AsIHBhbmVsLCBpc01vZGFsLCBmcm9tKTtcclxuICAgICAgICAgICAgfSwgZnJvbSk7XHJcbiAgICAgICAgICAgIC8vIOiusOW9leaooeaAgeaVsOaNrlxyXG4gICAgICAgICAgICB0aGlzLl9tb2RhbERpY3Quc2V0KHBhbmVsLCBpc01vZGFsKTtcclxuICAgICAgICAgICAgLy8g5pu05paw5qih5oCB6YGu572pXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kYWxNYXNrKHBhbmVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhbmVsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet5LiA5Liq5by556qXXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJUGFuZWx9IHBhbmVsIOimgeWFs+mXreeahOW8ueeql1xyXG4gICAgICogQHBhcmFtIHsqfSBbZGF0YV0g5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0ge3t4Om51bWJlciwgeTpudW1iZXJ9fSBbdG9dIOWFs+mXree7iOeCueS9jee9rlxyXG4gICAgICogQHJldHVybnMge0lQYW5lbH0g6L+U5Zue5by556qX5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWFuYWdlci5wcm90b3R5cGUuZHJvcCA9IGZ1bmN0aW9uIChwYW5lbCwgZGF0YSwgdG8pIHtcclxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9wYW5lbHMuaW5kZXhPZihwYW5lbCk7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgLy8g5pWw5o2u5YWI6KGMXHJcbiAgICAgICAgICAgIHRoaXMuX3BhbmVscy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAvLyDojrflj5bnrZbnlaVcclxuICAgICAgICAgICAgdmFyIHBvbGljeSA9IHBhbmVsLnBvbGljeSB8fCBwYW5lbC5icmlkZ2UuZGVmYXVsdFBhbmVsUG9saWN5IHx8IG5vbmU7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBwYW5lbC5vbkJlZm9yZURyb3AoZGF0YSwgdG8pO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChQYW5lbE1lc3NhZ2UuUEFORUxfQkVGT1JFX0RST1AsIHBhbmVsLCB0byk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOetlueVpeaOpeWPo1xyXG4gICAgICAgICAgICBwb2xpY3kuZHJvcChwYW5lbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBwYW5lbC5vbkFmdGVyRHJvcChkYXRhLCB0byk7XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goUGFuZWxNZXNzYWdlLlBBTkVMX0FGVEVSX0RST1AsIHBhbmVsLCB0byk7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTmmL7npLpcclxuICAgICAgICAgICAgICAgIHZhciBicmlkZ2UgPSBwYW5lbC5icmlkZ2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gYnJpZGdlLmdldFBhcmVudChwYW5lbC5za2luKTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJpZGdlLnJlbW92ZUNoaWxkKHBhcmVudCwgcGFuZWwuc2tpbik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjmjqXlj6NcclxuICAgICAgICAgICAgICAgIHBhbmVsLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgfSwgdG8pO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTkvJjlhYjnuqfmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fcHJpb3JpdGllcy5kZWxldGUocGFuZWwpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTmqKHmgIHmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxEaWN0LmRlbGV0ZShwYW5lbCk7XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOaooeaAgemBrue9qVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGFsTWFzayhwYW5lbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYW5lbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOmAmueUqOW8ueeql1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOmAmueUqOW8ueeql+imgeazqOWGjOWIsOeahOihqOeOsOWxguexu+Wei1xyXG4gICAgICogQHBhcmFtIHtJUHJvbXB0UGFuZWxDb25zdHJ1Y3Rvcn0gcHJvbXB0IOmAmueUqOW8ueeql+exu+Wei1xyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQYW5lbE1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyUHJvbXB0ID0gZnVuY3Rpb24gKHR5cGUsIHByb21wdCkge1xyXG4gICAgICAgIHRoaXMuX3Byb21wdERpY3RbdHlwZV0gPSBwcm9tcHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojms6jlhozpgJrnlKjlvLnnqpdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDopoHlj5bmtojms6jlhozpgJrnlKjlvLnnqpfnmoTooajnjrDlsYLnsbvlnotcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS51bnJlZ2lzdGVyUHJvbXB0ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcHJvbXB0RGljdFt0eXBlXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWFuYWdlci5wcm90b3R5cGUucHJvbXB0ID0gZnVuY3Rpb24gKG1zZ09yUGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgaGFuZGxlcnNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXJhbXM7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtc2dPclBhcmFtcyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgICAgIG1zZzogbXNnT3JQYXJhbXMsXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyczogaGFuZGxlcnNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IG1zZ09yUGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlj5bliLDlvZPliY3lnLrmma/nmoTnsbvlnotcclxuICAgICAgICB2YXIgY3VyQnJpZGdlID0gYnJpZGdlTWFuYWdlci5jdXJyZW50QnJpZGdlO1xyXG4gICAgICAgIHZhciB0eXBlID0gY3VyQnJpZGdlICYmIGN1ckJyaWRnZS50eXBlO1xyXG4gICAgICAgIC8vIOeUqOWcuuaZr+exu+Wei+WPluWIsOW8ueeql+WvueixoVxyXG4gICAgICAgIHZhciBwcm9tcHRDbHMgPSB0aGlzLl9wcm9tcHREaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChwcm9tcHRDbHMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDmsqHmnInmib7liLDlvZPliY3mqKHlnZfnsbvlnovlhbPogZTnmoTpgJrnlKjlvLnnqpfnsbvlnovvvIzmlLnnlKjns7vnu5/lvLnnqpflh5HlkIjkuIDkuItcclxuICAgICAgICAgICAgYWxlcnQocGFyYW1zLm1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5aKe5Yqg6buY6K6k5YC8XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBwYXJhbXMuaGFuZGxlcnMpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBwYXJhbXMuaGFuZGxlcnNbaV07XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLnRleHQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIudGV4dCA9IGhhbmRsZXIuZGF0YTtcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIuYnV0dG9uVHlwZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgaGFuZGxlci5idXR0b25UeXBlID0gQnV0dG9uVHlwZS5ub3JtYWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWunuS+i+WMllxyXG4gICAgICAgIHZhciBwcm9tcHQgPSBuZXcgcHJvbXB0Q2xzKCk7XHJcbiAgICAgICAgLy8g6K6+572u5LyY5YWI57qnXHJcbiAgICAgICAgdGhpcy5fcHJpb3JpdGllcy5zZXQocHJvbXB0LCBQYW5lbE1hbmFnZXJfMS5QUklPUklUWV9QUk9NUFQpO1xyXG4gICAgICAgIC8vIOaYvuekuuW8ueeql1xyXG4gICAgICAgIHByb21wdC5vcGVuKHBhcmFtcyk7XHJcbiAgICAgICAgLy8g5pu05paw5by556qXXHJcbiAgICAgICAgcHJvbXB0LnVwZGF0ZShwYXJhbXMpO1xyXG4gICAgICAgIC8vIOi/lOWbnuW8ueeql1xyXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrorablkYrnqpflj6PvvIjlj6rmnInkuIDkuKrnoa7lrprmjInpkq7vvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8SVByb21wdFBhcmFtcyl9IG1zZ09yUGFyYW1zIOimgeaYvuekuueahOaWh+acrO+8jOaIluiAheW8ueeql+aVsOaNrlxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gW29rSGFuZGxlcl0g56Gu5a6a5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcmV0dXJucyB7SVByb21wdFBhbmVsfSDov5Tlm57lvLnnqpflrp7kvZNcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5hbGVydCA9IGZ1bmN0aW9uIChtc2dPclBhcmFtcywgb2tIYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcztcclxuICAgICAgICBpZiAodHlwZW9mIG1zZ09yUGFyYW1zID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgcGFyYW1zID0geyBtc2c6IG1zZ09yUGFyYW1zIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMgPSBtc2dPclBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyYW1zLmhhbmRsZXJzID0gW1xyXG4gICAgICAgICAgICB7IGRhdGE6IFwi56Gu5a6aXCIsIGhhbmRsZXI6IG9rSGFuZGxlciwgYnV0dG9uVHlwZTogQnV0dG9uVHlwZS5pbXBvcnRhbnQgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbXB0KHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrnoa7orqTnqpflj6PvvIjmnInkuIDkuKrnoa7lrprmjInpkq7lkozkuIDkuKrlj5bmtojmjInpkq7vvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8SVByb21wdFBhcmFtcyl9IG1zZ09yUGFyYW1zIOimgeaYvuekuueahOaWh+acrO+8jOaIluiAheW8ueeql+aVsOaNrlxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gW29rSGFuZGxlcl0g56Gu5a6a5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcGFyYW0geygpPT52b2lkfSBbY2FuY2VsSGFuZGxlcl0g5Y+W5raI5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcmV0dXJucyB7SVByb21wdFBhbmVsfSDov5Tlm57lvLnnqpflrp7kvZNcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5jb25maXJtID0gZnVuY3Rpb24gKG1zZ09yUGFyYW1zLCBva0hhbmRsZXIsIGNhbmNlbEhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgcGFyYW1zO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbXNnT3JQYXJhbXMgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBwYXJhbXMgPSB7IG1zZzogbXNnT3JQYXJhbXMgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IG1zZ09yUGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJhbXMuaGFuZGxlcnMgPSBbXHJcbiAgICAgICAgICAgIHsgZGF0YTogXCLlj5bmtohcIiwgaGFuZGxlcjogY2FuY2VsSGFuZGxlciwgYnV0dG9uVHlwZTogQnV0dG9uVHlwZS5ub3JtYWwgfSxcclxuICAgICAgICAgICAgeyBkYXRhOiBcIuehruWumlwiLCBoYW5kbGVyOiBva0hhbmRsZXIsIGJ1dHRvblR5cGU6IEJ1dHRvblR5cGUuaW1wb3J0YW50IH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21wdChwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIFBhbmVsTWFuYWdlci5QUklPUklUWV9OT1JNQUwgPSAwO1xyXG4gICAgUGFuZWxNYW5hZ2VyLlBSSU9SSVRZX1BST01QVCA9IDE7XHJcbiAgICBQYW5lbE1hbmFnZXIgPSBQYW5lbE1hbmFnZXJfMSA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgUGFuZWxNYW5hZ2VyKTtcclxuICAgIHJldHVybiBQYW5lbE1hbmFnZXI7XHJcbiAgICB2YXIgUGFuZWxNYW5hZ2VyXzE7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFBhbmVsTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHBhbmVsTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KFBhbmVsTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDIyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyB0cmltVVJMLCB3cmFwQWJzb2x1dGVQYXRoIH0gZnJvbSBcIi4uLy4uL3V0aWxzL1VSTFV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTIxXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTIxXHJcbiAqXHJcbiAqIOeuoeeQhuaWh+S7tuWTiOW4jOeJiOacrOWPt1xyXG4qL1xyXG52YXIgVmVyc2lvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFZlcnNpb24oKSB7XHJcbiAgICAgICAgdGhpcy5faGFzaERpY3QgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW5ZOI5biM54mI5pys5bel5YW3XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gaGFuZGxlciDlm57osINcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbaG9zdF0gdmVyc2lvbi5jZmfmlofku7bliqDovb3ln5/lkI3vvIzkuI3kvKDliJnkvb/nlKjlvZPliY3ln5/lkI1cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbdmVyc2lvbl0g5Yqg6L29dmVyc2lvbi5jZmfmlofku7bnmoTniYjmnKzlj7fvvIzkuI3kvKDliJnkvb/nlKjpmo/mnLrml7bpl7TmiLPkvZzkuLrniYjmnKzlj7dcclxuICAgICAqIEBtZW1iZXJvZiBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFZlcnNpb24ucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoaGFuZGxlciwgaG9zdCwgdmVyc2lvbikge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAod2luZG93W1wiX19PbHltcHVzX1ZlcnNpb25faGFzaERpY3RfX1wiXSkge1xyXG4gICAgICAgICAgICAvLyDkuYvliY3lnKjlk6rliqDovb3ov4fvvIzml6DpnIDlho3mrKHliqDovb3vvIznm7TmjqXkvb/nlKhcclxuICAgICAgICAgICAgdGhpcy5faGFzaERpY3QgPSB3aW5kb3dbXCJfX09seW1wdXNfVmVyc2lvbl9oYXNoRGljdF9fXCJdO1xyXG4gICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDljrvliqDovb12ZXJzaW9uLmNmZ1xyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3dbXCJYRG9tYWluUmVxdWVzdFwiXSAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFIDEwLlwiKSA8IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvZGUgZm9yIElFNyAtIElFOVxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyB3aW5kb3dbXCJYRG9tYWluUmVxdWVzdFwiXSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHdpbmRvd1tcIlhNTEh0dHBSZXF1ZXN0XCJdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb2RlIGZvciBJRTEwLCBGaXJlZm94LCBDaHJvbWUsIE9wZXJhLCBTYWZhcmlcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3aW5kb3dbXCJBY3RpdmVYT2JqZWN0XCJdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb2RlIGZvciBJRTYsIElFNVxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5rOo5YaM5Zue6LCD5Ye95pWwXHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDor7TmmI7mmK/kuI3mlK/mjIFYTUxIdHRwUmVxdWVzdOeahOaDheWGte+8jOafpeeci+WFtnJlc3BvbnNlVGV4dOaYr+WQpuS4ulwiXCJcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdC5yZXNwb25zZVRleHQgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aSx6LSlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvcihuZXcgRXJyb3JFdmVudChcIlJlcXVlc3RFcnJvclwiLCB7IGZpbGVuYW1lOiB1cmwgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uTG9hZChldnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5Y2z5L2/5pivb25Mb2Fk5Lmf6KaB5Yik5pat5LiL54q25oCB56CBXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1c0hlYWQgPSBNYXRoLmZsb29yKHJlcXVlc3Quc3RhdHVzICogMC4wMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChzdGF0dXNIZWFkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMnh45ZKMM3h455qE54q25oCB56CB6K6k5Li65piv5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkxvYWQoZXZ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDR4eOWSjDV4eOeahOeKtuaAgeeggeiupOS4uuaYr+mUmeivr++8jOi9rOiwg+mUmeivr+Wbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yKG5ldyBFcnJvckV2ZW50KFwiUmVxdWVzdEVycm9yXCIsIHsgZmlsZW5hbWU6IHVybCwgbWVzc2FnZTogcmVxdWVzdC5zdGF0dXMgKyBcIiBcIiArIHJlcXVlc3Quc3RhdHVzVGV4dCB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciB1cmw7XHJcbiAgICAgICAgICAgIGlmICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5L2/55SoLXJf5pa55byP5Yqg6L295aSx6LSl5LqG77yM5YaN6K+V5LiA5qyh55SocXVlcnnlj4LmlbDliqDovb3niYjmnKzlj7dcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gd3JhcEFic29sdXRlUGF0aChcInZlcnNpb24uY2ZnP3Y9XCIgKyB2ZXJzaW9uLCBob3N0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmFib3J0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gaGFuZGxlcjtcclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LnNlbmQoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7ov57mjqXkv6Hmga9cclxuICAgICAgICAgICAgICAgIHVybCA9IHdyYXBBYnNvbHV0ZVBhdGgoXCJ2ZXJzaW9uLmNmZ1wiLCBob3N0KTtcclxuICAgICAgICAgICAgICAgIC8vIOa3u+WKoC1yX+aWueW8j+eJiOacrOWPt1xyXG4gICAgICAgICAgICAgICAgdXJsID0gdGhpcy5qb2luVmVyc2lvbih1cmwsIHZlcnNpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5rKh5pyJ54mI5pys5Y+377yM55u05o6l5L2/55So5b2T5YmN5pe26Ze05oiz5Yqg6L29XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBoYW5kbGVyO1xyXG4gICAgICAgICAgICAgICAgdXJsID0gd3JhcEFic29sdXRlUGF0aChcInZlcnNpb24uY2ZnP3Y9XCIgKyBEYXRlLm5vdygpLCBob3N0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcclxuICAgICAgICAgICAgLy8g5Y+R6YCB5pWw5o2u77yM5byA5aeL5ZKM5pyN5Yqh5Zmo6L+b6KGM5Lqk5LqSXHJcbiAgICAgICAgICAgIHJlcXVlc3Quc2VuZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkxvYWQoZXZ0KSB7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gZXZ0LnRhcmdldDtcclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlVGV4dCA9IHJlcXVlc3QucmVzcG9uc2VUZXh0O1xyXG4gICAgICAgICAgICB2YXIgbGluZXMgPSByZXNwb25zZVRleHQuc3BsaXQoXCJcXG5cIik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gbGluZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gbGluZXNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbGluZS5zcGxpdChcIiAgXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBhcnJbMV0uc3Vic3RyKDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFyclswXTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9oYXNoRGljdFtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5Zyod2luZG935LiK5oyC5LiA5Lu9XHJcbiAgICAgICAgICAgIHdpbmRvd1tcIl9fT2x5bXB1c19WZXJzaW9uX2hhc2hEaWN0X19cIl0gPSBzZWxmLl9oYXNoRGljdDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmlofku7blk4jluIzlgLzvvIzlpoLmnpzmsqHmnInmlofku7blk4jluIzlgLzliJnov5Tlm55udWxsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDmlofku7bnmoRVUkxcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOaWh+S7tueahOWTiOW4jOWAvO+8jOaIluiAhW51bGxcclxuICAgICAqIEBtZW1iZXJvZiBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEhhc2ggPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdXJsID0gdHJpbVVSTCh1cmwpO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIGZvciAodmFyIHBhdGggaW4gdGhpcy5faGFzaERpY3QpIHtcclxuICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKHBhdGgpID49IDApIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuX2hhc2hEaWN0W3BhdGhdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWwhnVybOi9rOaNouS4uuWTiOW4jOeJiOacrHVybFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg5Y6f5aeLdXJsXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDlk4jluIzniYjmnKx1cmxcclxuICAgICAqIEBtZW1iZXJvZiBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFZlcnNpb24ucHJvdG90eXBlLndyYXBIYXNoVXJsID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHZhciBoYXNoID0gdGhpcy5nZXRIYXNoKHVybCk7XHJcbiAgICAgICAgaWYgKGhhc2ggIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB1cmwgPSB0aGlzLmpvaW5WZXJzaW9uKHVybCwgaGFzaCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqAtcl9YWFjlvaLlvI/niYjmnKzlj7dcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvbiDniYjmnKzlj7fvvIzku6XmlbDlrZflkozlsI/lhpnlrZfmr43nu4TmiJBcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOWKoOeJiOacrOWPt+WQjueahHVybO+8jOWmguaenOayoeacieafpeWIsOeJiOacrOWPt+WImei/lOWbnuWOn+Wni3VybFxyXG4gICAgICogQG1lbWJlcm9mIFZlcnNpb25cclxuICAgICAqL1xyXG4gICAgVmVyc2lvbi5wcm90b3R5cGUuam9pblZlcnNpb24gPSBmdW5jdGlvbiAodXJsLCB2ZXJzaW9uKSB7XHJcbiAgICAgICAgaWYgKHZlcnNpb24gPT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuIHVybDtcclxuICAgICAgICAvLyDljrvmjol2ZXJzaW9u5Lit55qE6Z2e5rOV5a2X56ymXHJcbiAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24ucmVwbGFjZSgvW14wLTlhLXpdKy9pZywgXCJcIik7XHJcbiAgICAgICAgLy8g5o+S5YWl54mI5pys5Y+3XHJcbiAgICAgICAgdmFyIHJlZyA9IC8oKFthLXpBLVpdKzpcXC8rW15cXC9cXD8jXStcXC8pP1teXFw/I10rKVxcLihbXlxcP10rKShcXD8uKyk/LztcclxuICAgICAgICB2YXIgcmVzdWx0ID0gcmVnLmV4ZWModXJsKTtcclxuICAgICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdXJsID0gcmVzdWx0WzFdICsgXCItcl9cIiArIHZlcnNpb24gKyBcIi5cIiArIHJlc3VsdFszXSArIChyZXN1bHRbNF0gfHwgXCJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaQtcl9YWFjlvaLlvI/niYjmnKzlj7dcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHVybFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30g56e76Zmk54mI5pys5Y+35ZCO55qEdXJsXHJcbiAgICAgKiBAbWVtYmVyb2YgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBWZXJzaW9uLnByb3RvdHlwZS5yZW1vdmVWZXJzaW9uID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIC8vIOWOu+aOiS1yX1hYWOeJiOacrOWPt++8jOWmguaenOaciVxyXG4gICAgICAgIHVybCA9IHVybC5yZXBsYWNlKC9cXC1yX1thLXowLTldK1xcLi9pZywgXCIuXCIpO1xyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9O1xyXG4gICAgVmVyc2lvbiA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgVmVyc2lvbik7XHJcbiAgICByZXR1cm4gVmVyc2lvbjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgVmVyc2lvbjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHZlcnNpb24gPSBjb3JlLmdldEluamVjdChWZXJzaW9uKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3ZlcnNpb24vVmVyc2lvbi5qc1xuLy8gbW9kdWxlIGlkID0gMjNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE4LTAzLTA1XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE4LTAzLTA1XHJcbiAqXHJcbiAqIOS4reS7i+iAhea2iOaBr1xyXG4qL1xyXG52YXIgTWVkaWF0b3JNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVkaWF0b3JNZXNzYWdlKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDkuK3ku4vogIXlvIDlkK/lrozmr5Xkuovku7ZcclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfT1BFTkVEID0gXCJtZWRpYXRvck9wZW5lZFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDkuK3ku4vogIXlhbPpl63lrozmr5Xkuovku7ZcclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfQ0xPU0VEID0gXCJtZWRpYXRvckNsb3NlZFwiO1xyXG4gICAgcmV0dXJuIE1lZGlhdG9yTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTWVkaWF0b3JNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3JNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAyNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIOeUqOadpeiusOW9leeoi+W6j+i/kOihjOaXtumXtO+8jOW5tuS4lOaPkOS+m+W7tui/n+Wbnuiwg+aIlumikeeOh+Wbnuiwg+WKn+iDvVxyXG4qL1xyXG52YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU3lzdGVtKCkge1xyXG4gICAgICAgIC8vIOi/memHjOWwneivleS4gOS4i1RT55qEVHVwbGXnsbvlnovigJTigJRSYXlraWRcclxuICAgICAgICB0aGlzLl9uZXh0RnJhbWVMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5fdGltZXIgPSAwO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShvblJlcXVlc3RBbmltYXRpb25GcmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuI3mlK/mjIFyZXF1ZXN0QW5pbWF0aW9uRnJhbWXliJnmlLnnlKhzZXRUaW1lb3V06K6h5pe277yM5bu26L+f5pe26Ze0MTAwMC82MOavq+enklxyXG4gICAgICAgICAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1clRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LWL5YC8dGltZXJcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RpbWVyID0gY3VyVGltZSAtIHN0YXJ0VGltZTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqHRpY2vmlrnms5VcclxuICAgICAgICAgICAgICAgIHNlbGYudGljaygpO1xyXG4gICAgICAgICAgICB9LCAxMDAwIC8gNjApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvblJlcXVlc3RBbmltYXRpb25GcmFtZSh0aW1lcikge1xyXG4gICAgICAgICAgICAvLyDotYvlgLx0aW1lcu+8jOi/meS4quaWueazlemHjOaXoOazleiOt+WPlnRoaXPvvIzlm6DmraTpnIDopoHpgJrov4fms6jlhaXnmoTpnZnmgIHlsZ7mgKflj5bliLDoh6rouqvlrp7kvotcclxuICAgICAgICAgICAgc2VsZi5fdGltZXIgPSB0aW1lcjtcclxuICAgICAgICAgICAgLy8g6LCD55SodGlja+aWueazlVxyXG4gICAgICAgICAgICBzZWxmLnRpY2soKTtcclxuICAgICAgICAgICAgLy8g6K6h5YiS5LiL5LiA5qyh5omn6KGMXHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShvblJlcXVlc3RBbmltYXRpb25GcmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bku47nqIvluo/ov5DooYzliLDlvZPliY3miYDnu4/ov4fnmoTmr6vnp5LmlbBcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSDmr6vnp5LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5nZXRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdGltZXI7XHJcbiAgICB9O1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOiwg+eUqOS4i+S4gOW4p+Wbnuiwg1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9uZXh0RnJhbWVMaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fbmV4dEZyYW1lTGlzdC5zaGlmdCgpO1xyXG4gICAgICAgICAgICBkYXRhWzBdLmFwcGx5KGRhdGFbMV0sIGRhdGFbMl0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWcqOS4i+S4gOW4p+aJp+ihjOafkOS4quaWueazlVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5biM5pyb5Zyo5LiL5LiA5bin5omn6KGM55qE5p+Q5Liq5pa55rOVXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOaWueazleWPguaVsOWIl+ihqFxyXG4gICAgICogQHJldHVybnMge0lDYW5jZWxhYmxlfSDlj6/lj5bmtojnmoTlj6Xmn4RcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IFtoYW5kbGVyLCB0aGlzQXJnLCBhcmdzXTtcclxuICAgICAgICB0aGlzLl9uZXh0RnJhbWVMaXN0LnB1c2goZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBfdGhpcy5fbmV4dEZyYW1lTGlzdC5pbmRleE9mKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX25leHRGcmFtZUxpc3Quc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmr4/luKfmiafooYzmn5DkuKrmlrnms5XvvIznm7TliLDlj5bmtojkuLrmraJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOavj+W4p+aJp+ihjOeahOafkOS4quaWueazlVxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDmlrnms5Xlj4LmlbDliJfooahcclxuICAgICAqIEByZXR1cm5zIHtJQ2FuY2VsYWJsZX0g5Y+v5Y+W5raI55qE5Y+l5p+EXHJcbiAgICAgKiBAbWVtYmVyb2YgU3lzdGVtXHJcbiAgICAgKi9cclxuICAgIFN5c3RlbS5wcm90b3R5cGUuZW50ZXJGcmFtZSA9IGZ1bmN0aW9uIChoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNhbmNlbGFibGUgPSB0aGlzLm5leHRGcmFtZS5hcHBseSh0aGlzLCBbd3JhcEhhbmRsZXIsIHRoaXNBcmddLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxhYmxlLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmdW5jdGlvbiB3cmFwSGFuZGxlcigpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICAgICAgLy8g5omn6KGM5LiL5LiA5binXHJcbiAgICAgICAgICAgIGNhbmNlbGFibGUgPSBzZWxmLm5leHRGcmFtZS5hcHBseShzZWxmLCBbd3JhcEhhbmRsZXIsIHRoaXNdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5bu26L+f5Zue6LCDXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIOW7tui/n+avq+enkuWAvFxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg6KaB5Lyg6YCS55qE5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7SUNhbmNlbGFibGV9IOWPr+WPlua2iOeahOWPpeafhFxyXG4gICAgICogQG1lbWJlcm9mIFN5c3RlbVxyXG4gICAgICovXHJcbiAgICBTeXN0ZW0ucHJvdG90eXBlLnNldFRpbWVvdXQgPSBmdW5jdGlvbiAoZHVyYXRpb24sIGhhbmRsZXIsIHRoaXNBcmcpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdGFydFRpbWVyID0gdGhpcy5fdGltZXI7XHJcbiAgICAgICAgLy8g5ZCv5Yqo6K6h5pe25ZmoXHJcbiAgICAgICAgdmFyIG5leHRGcmFtZSA9IHRoaXMubmV4dEZyYW1lKHRpY2ssIHRoaXMpO1xyXG4gICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7XHJcbiAgICAgICAgICAgIHZhciBkZWx0YSA9IHRoaXMuX3RpbWVyIC0gc3RhcnRUaW1lcjtcclxuICAgICAgICAgICAgaWYgKGRlbHRhID49IGR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0RnJhbWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzQXJnLCBhcmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5leHRGcmFtZSA9IHRoaXMubmV4dEZyYW1lKHRpY2ssIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbmV4dEZyYW1lICYmIG5leHRGcmFtZS5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIG5leHRGcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5bu25pe26Ze06ZqUXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIOW7tui/n+avq+enkuWAvFxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg6KaB5Lyg6YCS55qE5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7SUNhbmNlbGFibGV9IOWPr+WPlua2iOeahOWPpeafhFxyXG4gICAgICogQG1lbWJlcm9mIFN5c3RlbVxyXG4gICAgICovXHJcbiAgICBTeXN0ZW0ucHJvdG90eXBlLnNldEludGVydmFsID0gZnVuY3Rpb24gKGR1cmF0aW9uLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGltZW91dCA9IHRoaXMuc2V0VGltZW91dChkdXJhdGlvbiwgb25UaW1lb3V0LCB0aGlzKTtcclxuICAgICAgICBmdW5jdGlvbiBvblRpbWVvdXQoKSB7XHJcbiAgICAgICAgICAgIC8vIOinpuWPkeWbnuiwg1xyXG4gICAgICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xyXG4gICAgICAgICAgICAvLyDnu6fnu63kuIvkuIDmrKFcclxuICAgICAgICAgICAgdGltZW91dCA9IHRoaXMuc2V0VGltZW91dChkdXJhdGlvbiwgb25UaW1lb3V0LCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ICYmIHRpbWVvdXQuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgU3lzdGVtID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlLFxyXG4gICAgICAgIHRzbGliXzEuX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxyXG4gICAgXSwgU3lzdGVtKTtcclxuICAgIHJldHVybiBTeXN0ZW07XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFN5c3RlbTtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHN5c3RlbSA9IGNvcmUuZ2V0SW5qZWN0KFN5c3RlbSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zeXN0ZW0vU3lzdGVtLmpzXG4vLyBtb2R1bGUgaWQgPSAyNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLy8gPGFtZC1tb2R1bGUgbmFtZT1cIkRPTUJyaWRnZVwiLz5cclxuLy8vIDxyZWZlcmVuY2UgdHlwZXM9XCJ0d2Vlbi5qc1wiLz5cclxuaW1wb3J0IHsgZ2V0T2JqZWN0SGFzaHMsIGV4dGVuZE9iamVjdCB9IGZyb20gXCJvbHltcHVzLXIvdXRpbHMvT2JqZWN0VXRpbFwiO1xyXG5pbXBvcnQgeyBhc3NldHNNYW5hZ2VyIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IHsgc3lzdGVtIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvc3lzdGVtL1N5c3RlbVwiO1xyXG5pbXBvcnQgTWFza0VudGl0eSBmcm9tIFwiLi9kb20vbWFzay9NYXNrRW50aXR5XCI7XHJcbmltcG9ydCB7IGNvcHlSZWYsIHdyYXBTa2luLCBpc0RPTVN0ciwgaXNET01QYXRoLCB0b0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vZG9tL3V0aWxzL1NraW5VdGlsXCI7XHJcbmltcG9ydCBCYWNrUGFuZWxQb2xpY3kgZnJvbSBcIi4vZG9tL3BhbmVsL0JhY2tQYW5lbFBvbGljeVwiO1xyXG5pbXBvcnQgRmFkZVNjZW5lUG9saWN5IGZyb20gXCIuL2RvbS9zY2VuZS9GYWRlU2NlbmVQb2xpY3lcIjtcclxuaW1wb3J0ICogYXMgVFdFRU4gZnJvbSBcIkB0d2VlbmpzL3R3ZWVuLmpzXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gKlxyXG4gKiDln7rkuo5ET03nmoTooajnjrDlsYLmoaXlrp7njrBcclxuKi9cclxudmFyIERPTUJyaWRnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERPTUJyaWRnZShwYXJhbXMpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpu5jorqTlvLnnqpfnrZbnlaVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJUGFuZWxQb2xpY3l9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFBhbmVsUG9saWN5ID0gbmV3IEJhY2tQYW5lbFBvbGljeSgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlum7mOiupOWcuuaZr+WIh+aNouetlueVpVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lTY2VuZVBvbGljeX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0U2NlbmVQb2xpY3kgPSBuZXcgRmFkZVNjZW5lUG9saWN5KCk7XHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5faW5pdFBhcmFtcyA9IHBhcmFtcztcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcInR5cGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluihqOeOsOWxguexu+Wei+WQjeensFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBET01CcmlkZ2UuVFlQRTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcImh0bWxXcmFwcGVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5booajnjrDlsYJIVE1M5YyF6KOF5Zmo77yM5Y+v5Lul5a+55YW25qC35byP6L+b6KGM6Ieq5a6a5LmJ6LCD5pW0XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJyb290XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmoLnmmL7npLroioLngrlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcInN0YWdlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5boiJ7lj7DlvJXnlKjvvIxET03nmoToiJ7lj7DmjIflkJHmoLnoioLngrlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcImJnTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluiDjOaZr+WuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JnTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJzY2VuZUxheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blnLrmma/lrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY2VuZUxheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTUJyaWRnZS5wcm90b3R5cGUsIFwiZnJhbWVMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5qGG5p625a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWVMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcInBhbmVsTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluW8ueeql+WuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhbmVsTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJtYXNrTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlumBrue9qeWuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hc2tMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcInRvcExheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpobbnuqflrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90b3BMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcInByb21wdENsYXNzXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpgJrnlKjmj5DnpLrmoYZcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJUHJvbXB0UGFuZWxDb25zdHJ1Y3Rvcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0UGFyYW1zLnByb21wdENsYXNzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTUJyaWRnZS5wcm90b3R5cGUsIFwibWFza0VudGl0eVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6YGu572p5a6e5L2TXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SU1hc2tFbnRpdHl9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE1hc2tFbnRpdHkodGhpcy5faW5pdFBhcmFtcy5tYXNrRGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmNyZWF0ZUxheWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOeUn+aIkOS4gOS4queItuWuueWZqO+8jOS4jeWTjeW6lOeCueWHu+S6i+S7tu+8jOS9huS8muaSkei1t+WFqOWxj+W5leiMg+WbtFxyXG4gICAgICAgIHZhciBsYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgbGF5ZXIuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XHJcbiAgICAgICAgbGF5ZXIuc3R5bGUudG9wID0gXCIwJVwiO1xyXG4gICAgICAgIGxheWVyLnN0eWxlLmxlZnQgPSBcIjAlXCI7XHJcbiAgICAgICAgbGF5ZXIuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICBsYXllci5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuICAgICAgICBsYXllci5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XHJcbiAgICAgICAgdGhpcy5yb290LmFwcGVuZENoaWxkKGxheWVyKTtcclxuICAgICAgICAvLyDnlJ/miJDkuIDkuKrlrZDlrrnlmajvvIzlrp7pmYXnlKjmnaXmlL7nva7lrZDlr7nosaHvvIznm67nmoTmmK/lk43lupTngrnlh7vkuovku7ZcclxuICAgICAgICB2YXIgc3ViTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHN1YkxheWVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImF1dG9cIjtcclxuICAgICAgICBsYXllci5hcHBlbmRDaGlsZChzdWJMYXllcik7XHJcbiAgICAgICAgLy8g6L+U5Zue5a2Q5a655ZmoXHJcbiAgICAgICAgcmV0dXJuIHN1YkxheWVyO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW6KGo546w5bGC5qGl77yM5Y+v5Lul5rKh5pyJ6K+l5pa55rOV77yM5rKh5pyJ6K+l5pa55rOV5YiZ6KGo56S66K+l6KGo546w5bGC5peg6ZyA5Yid5aeL5YyWXHJcbiAgICAgKiBAcGFyYW0geygpPT52b2lkfSBjb21wbGV0ZSDliJ3lp4vljJblrozmr5XlkI7nmoTlm57osINcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGNvbXBsZXRlKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5ZCN56ew77yM5YiZ6L2s5Y+Y5oiQ5byV55SoXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWmguaenOaYr+epuu+8jOWImeeUn+aIkOS4gOS4qlxyXG4gICAgICAgIGlmICghdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Yib5bu66IOM5pmv5pi+56S65bGCXHJcbiAgICAgICAgdGhpcy5fYmdMYXllciA9IHRoaXMuY3JlYXRlTGF5ZXIoKTtcclxuICAgICAgICAvLyDliJvlu7rlnLrmma/mmL7npLrlsYJcclxuICAgICAgICB0aGlzLl9zY2VuZUxheWVyID0gdGhpcy5jcmVhdGVMYXllcigpO1xyXG4gICAgICAgIC8vIOWIm+W7uuahhuaetuaYvuekuuWxglxyXG4gICAgICAgIHRoaXMuX2ZyYW1lTGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyKCk7XHJcbiAgICAgICAgLy8g5Yib5bu65by55Ye65bGCXHJcbiAgICAgICAgdGhpcy5fcGFuZWxMYXllciA9IHRoaXMuY3JlYXRlTGF5ZXIoKTtcclxuICAgICAgICAvLyDliJvlu7rpga7nvanlsYJcclxuICAgICAgICB0aGlzLl9tYXNrTGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyKCk7XHJcbiAgICAgICAgLy8g5Yib5bu66aG257qn5pi+56S65bGCXHJcbiAgICAgICAgdGhpcy5fdG9wTGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyKCk7XHJcbiAgICAgICAgLy8g5re75YqgVHdlZW4uanPpqbHliqhcclxuICAgICAgICBzeXN0ZW0uZW50ZXJGcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOavj+asoeS9v+eUqOacgOaWsOeahOW9k+WJjei/kOihjOavq+enkuaVsOabtOaWsFR3ZWVuLmpzXHJcbiAgICAgICAgICAgIFRXRUVOLnVwZGF0ZShzeXN0ZW0uZ2V0VGltZXIoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgY29tcGxldGUodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3nmq7ogqTmmK/lkKbmmK9ET03mmL7npLroioLngrlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fHN0cmluZ3xzdHJpbmdbXX0gc2tpbiDnmq7ogqTlr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKbmmK9ET03mmL7npLroioLngrlcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5pc015U2tpbiA9IGZ1bmN0aW9uIChza2luKSB7XHJcbiAgICAgICAgaWYgKHNraW4gaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBza2luID09PSBcInN0cmluZ1wiICYmIChpc0RPTVBhdGgoc2tpbikgfHwgaXNET01TdHIoc2tpbikpKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAoc2tpbiBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIC8vIOaVsOe7hOmHjOavj+S4gOS4quWFg+e0oOmDveW/hemhu+aYr+earuiCpFxyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBza2luXzEgPSBza2luOyBfaSA8IHNraW5fMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gc2tpbl8xW19pXTtcclxuICAgICAgICAgICAgICAgIGlmICghKHR5cGVvZiB0ZW1wID09PSBcInN0cmluZ1wiICYmIChpc0RPTVBhdGgodGVtcCkgfHwgaXNET01TdHIodGVtcCkpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWMheijhUhUTUxFbGVtZW506IqC54K5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxzdHJpbmd8c3RyaW5nW119IHNraW4g5Y6f5aeLSFRNTEVsZW1lbnToioLngrlcclxuICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0g5YyF6KOF5ZCO55qESFRNTEVsZW1lbnToioLngrlcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS53cmFwU2tpbiA9IGZ1bmN0aW9uIChtZWRpYXRvciwgc2tpbikge1xyXG4gICAgICAgIHJldHVybiB3cmFwU2tpbihtZWRpYXRvciwgc2tpbik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmm7/mjaLnmq7ogqTvvIznlKjkuo7nu4Tku7blj5jouqvml7bkuI3lkIzooajnjrDlsYLmoaXnmoTlpITnkIZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnQg5b2T5YmN55qu6IKkXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fHN0cmluZ3xzdHJpbmdbXX0gdGFyZ2V0IOimgeabv+aNoueahOearuiCpFxyXG4gICAgICogQHJldHVybnMgeyp9IOabv+aNouWujOavleeahOearuiCpFxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLnJlcGxhY2VTa2luID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjdXJyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICB0YXJnZXQgPSB0b0hUTUxFbGVtZW50KHRhcmdldCk7XHJcbiAgICAgICAgLy8g5aaC5p6c5pyJ54i26IqC54K577yM5YiZ55So55uu5qCH6IqC54K55pu/5o2i5b2T5YmN6IqC54K55L2N572uXHJcbiAgICAgICAgdmFyIHBhcmVudCA9IGN1cnJlbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUodGFyZ2V0LCBjdXJyZW50KTtcclxuICAgICAgICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKGN1cnJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDph43mlrDljIXoo4XoioLngrlcclxuICAgICAgICB0aGlzLndyYXBTa2luKG1lZGlhdG9yLCB0YXJnZXQpO1xyXG4gICAgICAgIC8vIOi/lOWbnuearuiCpFxyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlkIzmraXnmq7ogqTvvIznlKjkuo7nu4Tku7blj5jouqvlkI7nmoTph43mlrDlrprkvY1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBjdXJyZW50IOW9k+WJjeearuiCpFxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IOabv+aNoueahOearuiCpFxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLnN5bmNTa2luID0gZnVuY3Rpb24gKGN1cnJlbnQsIHRhcmdldCkge1xyXG4gICAgICAgIGlmICghY3VycmVudCB8fCAhdGFyZ2V0KVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gRE9N5peg6ZyA54m55oSP5ZCM5q2l77yM5Zug5Li65YW25qC35byP6YO95Y+v5Lul5LulY3Nz5qC35byP5pa55byP5Zyo5aSW6YOo6KGo56S677yM6ICM5LuF5pyJ5b2T5YmN6IqC54K555qEc3R5bGXlsZ7mgKfmmK/pnIDopoHlkIzmraXnmoRcclxuICAgICAgICBleHRlbmRPYmplY3QodGFyZ2V0LnN0eWxlLCBjdXJyZW50LnN0eWxlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIm+W7uuS4gOS4quepuueahOaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH1cclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5jcmVhdGVFbXB0eURpc3BsYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDopoHmt7vliqDliLDnmoTniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IOiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g6L+U5Zue6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50LmFwcGVuZENoaWxkKHRhcmdldCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjInntKLlvJXmt7vliqDmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDopoHmt7vliqDliLDnmoTniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IOiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOimgea3u+WKoOWIsOeahOeItue6p+e0ouW8lVxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g6L+U5Zue6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuYWRkQ2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIHRhcmdldCwgaW5kZXgpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50Lmluc2VydEJlZm9yZSh0YXJnZXQsIHRoaXMuZ2V0Q2hpbGRBdChwYXJlbnQsIGluZGV4KSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IOiiq+enu+mZpOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g6L+U5Zue6KKr56e76Zmk55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBpZiAocGFyZW50ICYmIHRhcmdldCAmJiB0YXJnZXQucGFyZW50RWxlbWVudCA9PT0gcGFyZW50KVxyXG4gICAgICAgICAgICByZXR1cm4gcGFyZW50LnJlbW92ZUNoaWxkKHRhcmdldCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5oyJ57Si5byV56e76Zmk5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXgg57Si5byVXHJcbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSDov5Tlm57ooqvnp7vpmaTnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5yZW1vdmVDaGlsZEF0ID0gZnVuY3Rpb24gKHBhcmVudCwgaW5kZXgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVDaGlsZChwYXJlbnQsIHRoaXMuZ2V0Q2hpbGRBdChwYXJlbnQsIGluZGV4KSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTmiYDmnInmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5yZW1vdmVDaGlsZHJlbiA9IGZ1bmN0aW9uIChwYXJlbnQpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGFyZW50LmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQuY2hpbGRyZW4uaXRlbShpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W54i25a655ZmoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQg55uu5qCH5a+56LGhXHJcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0g54i25a655ZmoXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuZ2V0UGFyZW50ID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQucGFyZW50RWxlbWVudDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaMh+Wumue0ouW8leWkhOeahOaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOaMh+WumueItue6p+e0ouW8lVxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g57Si5byV5aSE55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5jaGlsZHJlbi5pdGVtKGluZGV4KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaYvuekuue0ouW8lVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQg5a2Q5pi+56S65a+56LGhXHJcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IHRhcmdldOWcqHBhcmVudOS4reeahOe0ouW8lVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmdldENoaWxkSW5kZXggPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGFyZW50LmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHBhcmVudC5jaGlsZHJlbi5pdGVtKGkpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmAmui/h+WQjeensOiOt+WPluaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg5a+56LGh5ZCN56ewXHJcbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSDmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5nZXRDaGlsZEJ5TmFtZSA9IGZ1bmN0aW9uIChwYXJlbnQsIG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50LmNoaWxkcmVuLm5hbWVkSXRlbShuYW1lKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWtkOaYvuekuuWvueixoeaVsOmHj1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHJldHVybiB7bnVtYmVyfSDlrZDmmL7npLrlr7nosaHmlbDph49cclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5nZXRDaGlsZENvdW50ID0gZnVuY3Rpb24gKHBhcmVudCkge1xyXG4gICAgICAgIHJldHVybiBwYXJlbnQuY2hpbGRFbGVtZW50Q291bnQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3otYTmupBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBhc3NldHMg6LWE5rqQ5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig6LWE5rqQ5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0geyhlcnI/OkVycm9yKT0+dm9pZH0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5sb2FkQXNzZXRzID0gZnVuY3Rpb24gKGFzc2V0cywgbWVkaWF0b3IsIGhhbmRsZXIpIHtcclxuICAgICAgICAvLyDlvIDlp4vliqDovb3nmq7ogqTliJfooahcclxuICAgICAgICBpZiAoYXNzZXRzKVxyXG4gICAgICAgICAgICBhc3NldHMgPSBhc3NldHMuY29uY2F0KCk7XHJcbiAgICAgICAgbG9hZE5leHQoKTtcclxuICAgICAgICBmdW5jdGlvbiBsb2FkTmV4dCgpIHtcclxuICAgICAgICAgICAgaWYgKCFhc3NldHMgfHwgYXNzZXRzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBza2luID0gYXNzZXRzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBhc3NldHNNYW5hZ2VyLmxvYWRBc3NldHMoc2tpbiwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBFcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZE5leHQoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog55uR5ZCs5LqL5Lu277yM5LuO6L+Z5Liq5pa55rOV55uR5ZCs55qE5LqL5Lu25Lya5Zyo5Lit5LuL6ICF6ZSA5q+B5pe26KKr6Ieq5Yqo56e76Zmk55uR5ZCsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFdmVudFRhcmdldH0gdGFyZ2V0IOS6i+S7tuebruagh+WvueixoVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5LqL5Lu257G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhldnQ6RXZlbnQpPT52b2lkfSBoYW5kbGVyIOS6i+S7tuWkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkeWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLm1hcExpc3RlbmVyID0gZnVuY3Rpb24gKHRhcmdldCwgdHlwZSwgaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBrZXkgPSBnZXRPYmplY3RIYXNocyh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpO1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuW3sue7j+WtmOWcqOivpeebkeWQrO+8jOWmguaenOWtmOWcqOWImeS4jeWGjeebkeWQrFxyXG4gICAgICAgIGlmICh0aGlzLl9saXN0ZW5lckRpY3Rba2V5XSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOebkeWQrFxyXG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzQXJnIHx8IHRoaXMsIGV2dCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgLy8g6K6w5b2V55uR5ZCsXHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJEaWN0W2tleV0gPSBsaXN0ZW5lcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOebkeWQrOS6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RXZlbnRUYXJnZXR9IHRhcmdldCDkuovku7bnm67moIflr7nosaFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOS6i+S7tuexu+Wei1xyXG4gICAgICogQHBhcmFtIHsoZXZ0OkV2ZW50KT0+dm9pZH0gaGFuZGxlciDkuovku7blpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJHlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS51bm1hcExpc3RlbmVyID0gZnVuY3Rpb24gKHRhcmdldCwgdHlwZSwgaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBrZXkgPSBnZXRPYmplY3RIYXNocyh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpO1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuW3sue7j+WtmOWcqOivpeebkeWQrO+8jOWmguaenOWtmOWcqOWImeenu+mZpOebkeWQrFxyXG4gICAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMuX2xpc3RlbmVyRGljdFtrZXldO1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOiusOW9lVxyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fbGlzdGVuZXJEaWN0W2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Li657uR5a6a55qE5YiX6KGo5pi+56S65a+56LGh5YyF6KOF5LiA5Liq5riy5p+T5Zmo5Yib5bu65Zue6LCDXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IEJpbmRGb3LmjIfku6TmjIflkJHnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7KGtleT86YW55LCB2YWx1ZT86YW55LCByZW5kZXJlcj86SFRNTEVsZW1lbnQpPT52b2lkfSBoYW5kbGVyIOa4suafk+WZqOWIm+W7uuWbnuiwg1xyXG4gICAgICogQHJldHVybnMgeyp9IOi/lOWbnuS4gOS4quWkh+W/mOW9leWvueixoe+8jOS8muWcqOi1i+WAvOaXtuaPkOS+m1xyXG4gICAgICogQG1lbWJlcm9mIElCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS53cmFwQmluZEZvciA9IGZ1bmN0aW9uICh0YXJnZXQsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgcGFyZW50ID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgLy8g55Sf5oiQ5LiA5LiqZnJvbeiKgueCueWSjOS4gOS4qnRv6IqC54K577yM55So5p2l5Y2g5L2NXHJcbiAgICAgICAgdmFyIGZyb20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHZhciB0byA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgcGFyZW50ICYmIHBhcmVudC5pbnNlcnRCZWZvcmUoZnJvbSwgdGFyZ2V0KTtcclxuICAgICAgICBwYXJlbnQgJiYgcGFyZW50Lmluc2VydEJlZm9yZSh0bywgdGFyZ2V0KTtcclxuICAgICAgICAvLyDnp7vpmaTmmL7npLpcclxuICAgICAgICBwYXJlbnQgJiYgcGFyZW50LnJlbW92ZUNoaWxkKHRhcmdldCk7XHJcbiAgICAgICAgLy8g6L+U5Zue5aSH5b+Y5b2VXHJcbiAgICAgICAgcmV0dXJuIHsgcGFyZW50OiBwYXJlbnQsIGZyb206IGZyb20sIHRvOiB0bywgaGFuZGxlcjogaGFuZGxlciB9O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Li65YiX6KGo5pi+56S65a+56LGh6LWL5YC8XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0IEJpbmRGb3LmjIfku6TmjIflkJHnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gZGF0YXMg5pWw5o2u6ZuG5ZCIXHJcbiAgICAgKiBAcGFyYW0geyp9IG1lbWVudG8gd3JhcEJpbmRGb3Lov5Tlm57nmoTlpIflv5jlvZXlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBJQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUudmFsdWF0ZUJpbmRGb3IgPSBmdW5jdGlvbiAodGFyZ2V0LCBkYXRhcywgbWVtZW50bykge1xyXG4gICAgICAgIC8vIOenu+mZpOW3suacieeahOWIl+ihqOmhueaYvuekulxyXG4gICAgICAgIHZhciBwYXJlbnQgPSBtZW1lbnRvLnBhcmVudDtcclxuICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBmcm9tSW5kZXggPSB0aGlzLmdldENoaWxkSW5kZXgocGFyZW50LCBtZW1lbnRvLmZyb20pO1xyXG4gICAgICAgICAgICB2YXIgdG9JbmRleCA9IHRoaXMuZ2V0Q2hpbGRJbmRleChwYXJlbnQsIG1lbWVudG8udG8pO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gZnJvbUluZGV4ICsgMTsgaSA8IHRvSW5kZXg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlsZEF0KHBhcmVudCwgZnJvbUluZGV4ICsgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5re75Yqg5paw55qE5riy5p+T5ZmoXHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGFzKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdFbGVtZW50ID0gdGFyZ2V0LmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgLy8g5ou36LSd5a2Q5a2Z5a+56LGh5byV55SoXHJcbiAgICAgICAgICAgIGNvcHlSZWYobmV3RWxlbWVudCwgbmV3RWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgICAgICBwYXJlbnQgJiYgcGFyZW50Lmluc2VydEJlZm9yZShuZXdFbGVtZW50LCBtZW1lbnRvLnRvKTtcclxuICAgICAgICAgICAgLy8g5L2/55SoY2xvbmVOb2Rl5pa55rOV5aSN5Yi25riy5p+T5ZmoXHJcbiAgICAgICAgICAgIG1lbWVudG8uaGFuZGxlcihrZXksIGRhdGFzW2tleV0sIG5ld0VsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog5o+Q5L6b6Z2Z5oCB57G75Z6L5bi46YePICovXHJcbiAgICBET01CcmlkZ2UuVFlQRSA9IFwiRE9NXCI7XHJcbiAgICByZXR1cm4gRE9NQnJpZGdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBET01CcmlkZ2U7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9ET01CcmlkZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDI2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogVHdlZW4uanMgLSBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS90d2VlbmpzL3R3ZWVuLmpzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS90d2VlbmpzL3R3ZWVuLmpzL2dyYXBocy9jb250cmlidXRvcnMgZm9yIHRoZSBmdWxsIGxpc3Qgb2YgY29udHJpYnV0b3JzLlxuICogVGhhbmsgeW91IGFsbCwgeW91J3JlIGF3ZXNvbWUhXG4gKi9cblxuXG52YXIgX0dyb3VwID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLl90d2VlbnMgPSB7fTtcblx0dGhpcy5fdHdlZW5zQWRkZWREdXJpbmdVcGRhdGUgPSB7fTtcbn07XG5cbl9Hcm91cC5wcm90b3R5cGUgPSB7XG5cdGdldEFsbDogZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX3R3ZWVucykubWFwKGZ1bmN0aW9uICh0d2VlbklkKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdHdlZW5zW3R3ZWVuSWRdO1xuXHRcdH0uYmluZCh0aGlzKSk7XG5cblx0fSxcblxuXHRyZW1vdmVBbGw6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHRoaXMuX3R3ZWVucyA9IHt9O1xuXG5cdH0sXG5cblx0YWRkOiBmdW5jdGlvbiAodHdlZW4pIHtcblxuXHRcdHRoaXMuX3R3ZWVuc1t0d2Vlbi5nZXRJZCgpXSA9IHR3ZWVuO1xuXHRcdHRoaXMuX3R3ZWVuc0FkZGVkRHVyaW5nVXBkYXRlW3R3ZWVuLmdldElkKCldID0gdHdlZW47XG5cblx0fSxcblxuXHRyZW1vdmU6IGZ1bmN0aW9uICh0d2Vlbikge1xuXG5cdFx0ZGVsZXRlIHRoaXMuX3R3ZWVuc1t0d2Vlbi5nZXRJZCgpXTtcblx0XHRkZWxldGUgdGhpcy5fdHdlZW5zQWRkZWREdXJpbmdVcGRhdGVbdHdlZW4uZ2V0SWQoKV07XG5cblx0fSxcblxuXHR1cGRhdGU6IGZ1bmN0aW9uICh0aW1lLCBwcmVzZXJ2ZSkge1xuXG5cdFx0dmFyIHR3ZWVuSWRzID0gT2JqZWN0LmtleXModGhpcy5fdHdlZW5zKTtcblxuXHRcdGlmICh0d2Vlbklkcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR0aW1lID0gdGltZSAhPT0gdW5kZWZpbmVkID8gdGltZSA6IFRXRUVOLm5vdygpO1xuXG5cdFx0Ly8gVHdlZW5zIGFyZSB1cGRhdGVkIGluIFwiYmF0Y2hlc1wiLiBJZiB5b3UgYWRkIGEgbmV3IHR3ZWVuIGR1cmluZyBhbiB1cGRhdGUsIHRoZW4gdGhlXG5cdFx0Ly8gbmV3IHR3ZWVuIHdpbGwgYmUgdXBkYXRlZCBpbiB0aGUgbmV4dCBiYXRjaC5cblx0XHQvLyBJZiB5b3UgcmVtb3ZlIGEgdHdlZW4gZHVyaW5nIGFuIHVwZGF0ZSwgaXQgbWF5IG9yIG1heSBub3QgYmUgdXBkYXRlZC4gSG93ZXZlcixcblx0XHQvLyBpZiB0aGUgcmVtb3ZlZCB0d2VlbiB3YXMgYWRkZWQgZHVyaW5nIHRoZSBjdXJyZW50IGJhdGNoLCB0aGVuIGl0IHdpbGwgbm90IGJlIHVwZGF0ZWQuXG5cdFx0d2hpbGUgKHR3ZWVuSWRzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMuX3R3ZWVuc0FkZGVkRHVyaW5nVXBkYXRlID0ge307XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdHdlZW5JZHMubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0XHR2YXIgdHdlZW4gPSB0aGlzLl90d2VlbnNbdHdlZW5JZHNbaV1dO1xuXG5cdFx0XHRcdGlmICh0d2VlbiAmJiB0d2Vlbi51cGRhdGUodGltZSkgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0dHdlZW4uX2lzUGxheWluZyA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0aWYgKCFwcmVzZXJ2ZSkge1xuXHRcdFx0XHRcdFx0ZGVsZXRlIHRoaXMuX3R3ZWVuc1t0d2Vlbklkc1tpXV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHR3ZWVuSWRzID0gT2JqZWN0LmtleXModGhpcy5fdHdlZW5zQWRkZWREdXJpbmdVcGRhdGUpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXG5cdH1cbn07XG5cbnZhciBUV0VFTiA9IG5ldyBfR3JvdXAoKTtcblxuVFdFRU4uR3JvdXAgPSBfR3JvdXA7XG5UV0VFTi5fbmV4dElkID0gMDtcblRXRUVOLm5leHRJZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIFRXRUVOLl9uZXh0SWQrKztcbn07XG5cblxuLy8gSW5jbHVkZSBhIHBlcmZvcm1hbmNlLm5vdyBwb2x5ZmlsbC5cbi8vIEluIG5vZGUuanMsIHVzZSBwcm9jZXNzLmhydGltZS5cbmlmICh0eXBlb2YgKHdpbmRvdykgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiAocHJvY2VzcykgIT09ICd1bmRlZmluZWQnKSB7XG5cdFRXRUVOLm5vdyA9IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgdGltZSA9IHByb2Nlc3MuaHJ0aW1lKCk7XG5cblx0XHQvLyBDb252ZXJ0IFtzZWNvbmRzLCBuYW5vc2Vjb25kc10gdG8gbWlsbGlzZWNvbmRzLlxuXHRcdHJldHVybiB0aW1lWzBdICogMTAwMCArIHRpbWVbMV0gLyAxMDAwMDAwO1xuXHR9O1xufVxuLy8gSW4gYSBicm93c2VyLCB1c2Ugd2luZG93LnBlcmZvcm1hbmNlLm5vdyBpZiBpdCBpcyBhdmFpbGFibGUuXG5lbHNlIGlmICh0eXBlb2YgKHdpbmRvdykgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICB3aW5kb3cucGVyZm9ybWFuY2UgIT09IHVuZGVmaW5lZCAmJlxuXHRcdCB3aW5kb3cucGVyZm9ybWFuY2Uubm93ICE9PSB1bmRlZmluZWQpIHtcblx0Ly8gVGhpcyBtdXN0IGJlIGJvdW5kLCBiZWNhdXNlIGRpcmVjdGx5IGFzc2lnbmluZyB0aGlzIGZ1bmN0aW9uXG5cdC8vIGxlYWRzIHRvIGFuIGludm9jYXRpb24gZXhjZXB0aW9uIGluIENocm9tZS5cblx0VFdFRU4ubm93ID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHdpbmRvdy5wZXJmb3JtYW5jZSk7XG59XG4vLyBVc2UgRGF0ZS5ub3cgaWYgaXQgaXMgYXZhaWxhYmxlLlxuZWxzZSBpZiAoRGF0ZS5ub3cgIT09IHVuZGVmaW5lZCkge1xuXHRUV0VFTi5ub3cgPSBEYXRlLm5vdztcbn1cbi8vIE90aGVyd2lzZSwgdXNlICduZXcgRGF0ZSgpLmdldFRpbWUoKScuXG5lbHNlIHtcblx0VFdFRU4ubm93ID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblx0fTtcbn1cblxuXG5UV0VFTi5Ud2VlbiA9IGZ1bmN0aW9uIChvYmplY3QsIGdyb3VwKSB7XG5cdHRoaXMuX29iamVjdCA9IG9iamVjdDtcblx0dGhpcy5fdmFsdWVzU3RhcnQgPSB7fTtcblx0dGhpcy5fdmFsdWVzRW5kID0ge307XG5cdHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0ID0ge307XG5cdHRoaXMuX2R1cmF0aW9uID0gMTAwMDtcblx0dGhpcy5fcmVwZWF0ID0gMDtcblx0dGhpcy5fcmVwZWF0RGVsYXlUaW1lID0gdW5kZWZpbmVkO1xuXHR0aGlzLl95b3lvID0gZmFsc2U7XG5cdHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuXHR0aGlzLl9yZXZlcnNlZCA9IGZhbHNlO1xuXHR0aGlzLl9kZWxheVRpbWUgPSAwO1xuXHR0aGlzLl9zdGFydFRpbWUgPSBudWxsO1xuXHR0aGlzLl9lYXNpbmdGdW5jdGlvbiA9IFRXRUVOLkVhc2luZy5MaW5lYXIuTm9uZTtcblx0dGhpcy5faW50ZXJwb2xhdGlvbkZ1bmN0aW9uID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5MaW5lYXI7XG5cdHRoaXMuX2NoYWluZWRUd2VlbnMgPSBbXTtcblx0dGhpcy5fb25TdGFydENhbGxiYWNrID0gbnVsbDtcblx0dGhpcy5fb25TdGFydENhbGxiYWNrRmlyZWQgPSBmYWxzZTtcblx0dGhpcy5fb25VcGRhdGVDYWxsYmFjayA9IG51bGw7XG5cdHRoaXMuX29uQ29tcGxldGVDYWxsYmFjayA9IG51bGw7XG5cdHRoaXMuX29uU3RvcENhbGxiYWNrID0gbnVsbDtcblx0dGhpcy5fZ3JvdXAgPSBncm91cCB8fCBUV0VFTjtcblx0dGhpcy5faWQgPSBUV0VFTi5uZXh0SWQoKTtcblxufTtcblxuVFdFRU4uVHdlZW4ucHJvdG90eXBlID0ge1xuXHRnZXRJZDogZnVuY3Rpb24gZ2V0SWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2lkO1xuXHR9LFxuXG5cdGlzUGxheWluZzogZnVuY3Rpb24gaXNQbGF5aW5nKCkge1xuXHRcdHJldHVybiB0aGlzLl9pc1BsYXlpbmc7XG5cdH0sXG5cblx0dG86IGZ1bmN0aW9uIHRvKHByb3BlcnRpZXMsIGR1cmF0aW9uKSB7XG5cblx0XHR0aGlzLl92YWx1ZXNFbmQgPSBwcm9wZXJ0aWVzO1xuXG5cdFx0aWYgKGR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb247XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRzdGFydDogZnVuY3Rpb24gc3RhcnQodGltZSkge1xuXG5cdFx0dGhpcy5fZ3JvdXAuYWRkKHRoaXMpO1xuXG5cdFx0dGhpcy5faXNQbGF5aW5nID0gdHJ1ZTtcblxuXHRcdHRoaXMuX29uU3RhcnRDYWxsYmFja0ZpcmVkID0gZmFsc2U7XG5cblx0XHR0aGlzLl9zdGFydFRpbWUgPSB0aW1lICE9PSB1bmRlZmluZWQgPyB0eXBlb2YgdGltZSA9PT0gJ3N0cmluZycgPyBUV0VFTi5ub3coKSArIHBhcnNlRmxvYXQodGltZSkgOiB0aW1lIDogVFdFRU4ubm93KCk7XG5cdFx0dGhpcy5fc3RhcnRUaW1lICs9IHRoaXMuX2RlbGF5VGltZTtcblxuXHRcdGZvciAodmFyIHByb3BlcnR5IGluIHRoaXMuX3ZhbHVlc0VuZCkge1xuXG5cdFx0XHQvLyBDaGVjayBpZiBhbiBBcnJheSB3YXMgcHJvdmlkZWQgYXMgcHJvcGVydHkgdmFsdWVcblx0XHRcdGlmICh0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldIGluc3RhbmNlb2YgQXJyYXkpIHtcblxuXHRcdFx0XHRpZiAodGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XS5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENyZWF0ZSBhIGxvY2FsIGNvcHkgb2YgdGhlIEFycmF5IHdpdGggdGhlIHN0YXJ0IHZhbHVlIGF0IHRoZSBmcm9udFxuXHRcdFx0XHR0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldID0gW3RoaXMuX29iamVjdFtwcm9wZXJ0eV1dLmNvbmNhdCh0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBJZiBgdG8oKWAgc3BlY2lmaWVzIGEgcHJvcGVydHkgdGhhdCBkb2Vzbid0IGV4aXN0IGluIHRoZSBzb3VyY2Ugb2JqZWN0LFxuXHRcdFx0Ly8gd2Ugc2hvdWxkIG5vdCBzZXQgdGhhdCBwcm9wZXJ0eSBpbiB0aGUgb2JqZWN0XG5cdFx0XHRpZiAodGhpcy5fb2JqZWN0W3Byb3BlcnR5XSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTYXZlIHRoZSBzdGFydGluZyB2YWx1ZS5cblx0XHRcdHRoaXMuX3ZhbHVlc1N0YXJ0W3Byb3BlcnR5XSA9IHRoaXMuX29iamVjdFtwcm9wZXJ0eV07XG5cblx0XHRcdGlmICgodGhpcy5fdmFsdWVzU3RhcnRbcHJvcGVydHldIGluc3RhbmNlb2YgQXJyYXkpID09PSBmYWxzZSkge1xuXHRcdFx0XHR0aGlzLl92YWx1ZXNTdGFydFtwcm9wZXJ0eV0gKj0gMS4wOyAvLyBFbnN1cmVzIHdlJ3JlIHVzaW5nIG51bWJlcnMsIG5vdCBzdHJpbmdzXG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XSA9IHRoaXMuX3ZhbHVlc1N0YXJ0W3Byb3BlcnR5XSB8fCAwO1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuXG5cdFx0aWYgKCF0aGlzLl9pc1BsYXlpbmcpIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdHRoaXMuX2dyb3VwLnJlbW92ZSh0aGlzKTtcblx0XHR0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcblxuXHRcdGlmICh0aGlzLl9vblN0b3BDYWxsYmFjayAhPT0gbnVsbCkge1xuXHRcdFx0dGhpcy5fb25TdG9wQ2FsbGJhY2sodGhpcy5fb2JqZWN0KTtcblx0XHR9XG5cblx0XHR0aGlzLnN0b3BDaGFpbmVkVHdlZW5zKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRlbmQ6IGZ1bmN0aW9uIGVuZCgpIHtcblxuXHRcdHRoaXMudXBkYXRlKHRoaXMuX3N0YXJ0VGltZSArIHRoaXMuX2R1cmF0aW9uKTtcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdHN0b3BDaGFpbmVkVHdlZW5zOiBmdW5jdGlvbiBzdG9wQ2hhaW5lZFR3ZWVucygpIHtcblxuXHRcdGZvciAodmFyIGkgPSAwLCBudW1DaGFpbmVkVHdlZW5zID0gdGhpcy5fY2hhaW5lZFR3ZWVucy5sZW5ndGg7IGkgPCBudW1DaGFpbmVkVHdlZW5zOyBpKyspIHtcblx0XHRcdHRoaXMuX2NoYWluZWRUd2VlbnNbaV0uc3RvcCgpO1xuXHRcdH1cblxuXHR9LFxuXG5cdGdyb3VwOiBmdW5jdGlvbiBncm91cChncm91cCkge1xuXHRcdHRoaXMuX2dyb3VwID0gZ3JvdXA7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0ZGVsYXk6IGZ1bmN0aW9uIGRlbGF5KGFtb3VudCkge1xuXG5cdFx0dGhpcy5fZGVsYXlUaW1lID0gYW1vdW50O1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0cmVwZWF0OiBmdW5jdGlvbiByZXBlYXQodGltZXMpIHtcblxuXHRcdHRoaXMuX3JlcGVhdCA9IHRpbWVzO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0cmVwZWF0RGVsYXk6IGZ1bmN0aW9uIHJlcGVhdERlbGF5KGFtb3VudCkge1xuXG5cdFx0dGhpcy5fcmVwZWF0RGVsYXlUaW1lID0gYW1vdW50O1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0eW95bzogZnVuY3Rpb24geW95byh5eSkge1xuXG5cdFx0dGhpcy5feW95byA9IHl5O1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0ZWFzaW5nOiBmdW5jdGlvbiBlYXNpbmcoZWFzKSB7XG5cblx0XHR0aGlzLl9lYXNpbmdGdW5jdGlvbiA9IGVhcztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdGludGVycG9sYXRpb246IGZ1bmN0aW9uIGludGVycG9sYXRpb24oaW50ZXIpIHtcblxuXHRcdHRoaXMuX2ludGVycG9sYXRpb25GdW5jdGlvbiA9IGludGVyO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0Y2hhaW46IGZ1bmN0aW9uIGNoYWluKCkge1xuXG5cdFx0dGhpcy5fY2hhaW5lZFR3ZWVucyA9IGFyZ3VtZW50cztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdG9uU3RhcnQ6IGZ1bmN0aW9uIG9uU3RhcnQoY2FsbGJhY2spIHtcblxuXHRcdHRoaXMuX29uU3RhcnRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0b25VcGRhdGU6IGZ1bmN0aW9uIG9uVXBkYXRlKGNhbGxiYWNrKSB7XG5cblx0XHR0aGlzLl9vblVwZGF0ZUNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRvbkNvbXBsZXRlOiBmdW5jdGlvbiBvbkNvbXBsZXRlKGNhbGxiYWNrKSB7XG5cblx0XHR0aGlzLl9vbkNvbXBsZXRlQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdG9uU3RvcDogZnVuY3Rpb24gb25TdG9wKGNhbGxiYWNrKSB7XG5cblx0XHR0aGlzLl9vblN0b3BDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0dXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUodGltZSkge1xuXG5cdFx0dmFyIHByb3BlcnR5O1xuXHRcdHZhciBlbGFwc2VkO1xuXHRcdHZhciB2YWx1ZTtcblxuXHRcdGlmICh0aW1lIDwgdGhpcy5fc3RhcnRUaW1lKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fb25TdGFydENhbGxiYWNrRmlyZWQgPT09IGZhbHNlKSB7XG5cblx0XHRcdGlmICh0aGlzLl9vblN0YXJ0Q2FsbGJhY2sgIT09IG51bGwpIHtcblx0XHRcdFx0dGhpcy5fb25TdGFydENhbGxiYWNrKHRoaXMuX29iamVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX29uU3RhcnRDYWxsYmFja0ZpcmVkID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRlbGFwc2VkID0gKHRpbWUgLSB0aGlzLl9zdGFydFRpbWUpIC8gdGhpcy5fZHVyYXRpb247XG5cdFx0ZWxhcHNlZCA9ICh0aGlzLl9kdXJhdGlvbiA9PT0gMCB8fCBlbGFwc2VkID4gMSkgPyAxIDogZWxhcHNlZDtcblxuXHRcdHZhbHVlID0gdGhpcy5fZWFzaW5nRnVuY3Rpb24oZWxhcHNlZCk7XG5cblx0XHRmb3IgKHByb3BlcnR5IGluIHRoaXMuX3ZhbHVlc0VuZCkge1xuXG5cdFx0XHQvLyBEb24ndCB1cGRhdGUgcHJvcGVydGllcyB0aGF0IGRvIG5vdCBleGlzdCBpbiB0aGUgc291cmNlIG9iamVjdFxuXHRcdFx0aWYgKHRoaXMuX3ZhbHVlc1N0YXJ0W3Byb3BlcnR5XSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgc3RhcnQgPSB0aGlzLl92YWx1ZXNTdGFydFtwcm9wZXJ0eV0gfHwgMDtcblx0XHRcdHZhciBlbmQgPSB0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldO1xuXG5cdFx0XHRpZiAoZW5kIGluc3RhbmNlb2YgQXJyYXkpIHtcblxuXHRcdFx0XHR0aGlzLl9vYmplY3RbcHJvcGVydHldID0gdGhpcy5faW50ZXJwb2xhdGlvbkZ1bmN0aW9uKGVuZCwgdmFsdWUpO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIFBhcnNlcyByZWxhdGl2ZSBlbmQgdmFsdWVzIHdpdGggc3RhcnQgYXMgYmFzZSAoZS5nLjogKzEwLCAtMylcblx0XHRcdFx0aWYgKHR5cGVvZiAoZW5kKSA9PT0gJ3N0cmluZycpIHtcblxuXHRcdFx0XHRcdGlmIChlbmQuY2hhckF0KDApID09PSAnKycgfHwgZW5kLmNoYXJBdCgwKSA9PT0gJy0nKSB7XG5cdFx0XHRcdFx0XHRlbmQgPSBzdGFydCArIHBhcnNlRmxvYXQoZW5kKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZW5kID0gcGFyc2VGbG9hdChlbmQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFByb3RlY3QgYWdhaW5zdCBub24gbnVtZXJpYyBwcm9wZXJ0aWVzLlxuXHRcdFx0XHRpZiAodHlwZW9mIChlbmQpID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRcdHRoaXMuX29iamVjdFtwcm9wZXJ0eV0gPSBzdGFydCArIChlbmQgLSBzdGFydCkgKiB2YWx1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRpZiAodGhpcy5fb25VcGRhdGVDYWxsYmFjayAhPT0gbnVsbCkge1xuXHRcdFx0dGhpcy5fb25VcGRhdGVDYWxsYmFjayh0aGlzLl9vYmplY3QpO1xuXHRcdH1cblxuXHRcdGlmIChlbGFwc2VkID09PSAxKSB7XG5cblx0XHRcdGlmICh0aGlzLl9yZXBlYXQgPiAwKSB7XG5cblx0XHRcdFx0aWYgKGlzRmluaXRlKHRoaXMuX3JlcGVhdCkpIHtcblx0XHRcdFx0XHR0aGlzLl9yZXBlYXQtLTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlYXNzaWduIHN0YXJ0aW5nIHZhbHVlcywgcmVzdGFydCBieSBtYWtpbmcgc3RhcnRUaW1lID0gbm93XG5cdFx0XHRcdGZvciAocHJvcGVydHkgaW4gdGhpcy5fdmFsdWVzU3RhcnRSZXBlYXQpIHtcblxuXHRcdFx0XHRcdGlmICh0eXBlb2YgKHRoaXMuX3ZhbHVlc0VuZFtwcm9wZXJ0eV0pID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0dGhpcy5fdmFsdWVzU3RhcnRSZXBlYXRbcHJvcGVydHldID0gdGhpcy5fdmFsdWVzU3RhcnRSZXBlYXRbcHJvcGVydHldICsgcGFyc2VGbG9hdCh0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAodGhpcy5feW95bykge1xuXHRcdFx0XHRcdFx0dmFyIHRtcCA9IHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XTtcblxuXHRcdFx0XHRcdFx0dGhpcy5fdmFsdWVzU3RhcnRSZXBlYXRbcHJvcGVydHldID0gdGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XTtcblx0XHRcdFx0XHRcdHRoaXMuX3ZhbHVlc0VuZFtwcm9wZXJ0eV0gPSB0bXA7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dGhpcy5fdmFsdWVzU3RhcnRbcHJvcGVydHldID0gdGhpcy5fdmFsdWVzU3RhcnRSZXBlYXRbcHJvcGVydHldO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGhpcy5feW95bykge1xuXHRcdFx0XHRcdHRoaXMuX3JldmVyc2VkID0gIXRoaXMuX3JldmVyc2VkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHRoaXMuX3JlcGVhdERlbGF5VGltZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3RhcnRUaW1lID0gdGltZSArIHRoaXMuX3JlcGVhdERlbGF5VGltZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLl9zdGFydFRpbWUgPSB0aW1lICsgdGhpcy5fZGVsYXlUaW1lO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0aWYgKHRoaXMuX29uQ29tcGxldGVDYWxsYmFjayAhPT0gbnVsbCkge1xuXG5cdFx0XHRcdFx0dGhpcy5fb25Db21wbGV0ZUNhbGxiYWNrKHRoaXMuX29iamVjdCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbnVtQ2hhaW5lZFR3ZWVucyA9IHRoaXMuX2NoYWluZWRUd2VlbnMubGVuZ3RoOyBpIDwgbnVtQ2hhaW5lZFR3ZWVuczsgaSsrKSB7XG5cdFx0XHRcdFx0Ly8gTWFrZSB0aGUgY2hhaW5lZCB0d2VlbnMgc3RhcnQgZXhhY3RseSBhdCB0aGUgdGltZSB0aGV5IHNob3VsZCxcblx0XHRcdFx0XHQvLyBldmVuIGlmIHRoZSBgdXBkYXRlKClgIG1ldGhvZCB3YXMgY2FsbGVkIHdheSBwYXN0IHRoZSBkdXJhdGlvbiBvZiB0aGUgdHdlZW5cblx0XHRcdFx0XHR0aGlzLl9jaGFpbmVkVHdlZW5zW2ldLnN0YXJ0KHRoaXMuX3N0YXJ0VGltZSArIHRoaXMuX2R1cmF0aW9uKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fVxufTtcblxuXG5UV0VFTi5FYXNpbmcgPSB7XG5cblx0TGluZWFyOiB7XG5cblx0XHROb25lOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gaztcblxuXHRcdH1cblxuXHR9LFxuXG5cdFF1YWRyYXRpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrICogaztcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrICogKDIgLSBrKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogayAqIGs7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAtIDAuNSAqICgtLWsgKiAoayAtIDIpIC0gMSk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRDdWJpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrICogayAqIGs7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gLS1rICogayAqIGsgKyAxO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoKGsgKj0gMikgPCAxKSB7XG5cdFx0XHRcdHJldHVybiAwLjUgKiBrICogayAqIGs7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAwLjUgKiAoKGsgLT0gMikgKiBrICogayArIDIpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0UXVhcnRpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrICogayAqIGsgKiBrO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIDEgLSAoLS1rICogayAqIGsgKiBrKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogayAqIGsgKiBrICogaztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIC0gMC41ICogKChrIC09IDIpICogayAqIGsgKiBrIC0gMik7XG5cblx0XHR9XG5cblx0fSxcblxuXHRRdWludGljOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIGsgKiBrICogayAqIGsgKiBrO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIC0tayAqIGsgKiBrICogayAqIGsgKyAxO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoKGsgKj0gMikgPCAxKSB7XG5cdFx0XHRcdHJldHVybiAwLjUgKiBrICogayAqIGsgKiBrICogaztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIDAuNSAqICgoayAtPSAyKSAqIGsgKiBrICogayAqIGsgKyAyKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdFNpbnVzb2lkYWw6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gMSAtIE1hdGguY29zKGsgKiBNYXRoLlBJIC8gMik7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gTWF0aC5zaW4oayAqIE1hdGguUEkgLyAyKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIDAuNSAqICgxIC0gTWF0aC5jb3MoTWF0aC5QSSAqIGspKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdEV4cG9uZW50aWFsOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIGsgPT09IDAgPyAwIDogTWF0aC5wb3coMTAyNCwgayAtIDEpO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIGsgPT09IDEgPyAxIDogMSAtIE1hdGgucG93KDIsIC0gMTAgKiBrKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKGsgPT09IDApIHtcblx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChrID09PSAxKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoKGsgKj0gMikgPCAxKSB7XG5cdFx0XHRcdHJldHVybiAwLjUgKiBNYXRoLnBvdygxMDI0LCBrIC0gMSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAwLjUgKiAoLSBNYXRoLnBvdygyLCAtIDEwICogKGsgLSAxKSkgKyAyKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdENpcmN1bGFyOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIDEgLSBNYXRoLnNxcnQoMSAtIGsgKiBrKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBNYXRoLnNxcnQoMSAtICgtLWsgKiBrKSk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmICgoayAqPSAyKSA8IDEpIHtcblx0XHRcdFx0cmV0dXJuIC0gMC41ICogKE1hdGguc3FydCgxIC0gayAqIGspIC0gMSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAwLjUgKiAoTWF0aC5zcXJ0KDEgLSAoayAtPSAyKSAqIGspICsgMSk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRFbGFzdGljOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKGsgPT09IDApIHtcblx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChrID09PSAxKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gLU1hdGgucG93KDIsIDEwICogKGsgLSAxKSkgKiBNYXRoLnNpbigoayAtIDEuMSkgKiA1ICogTWF0aC5QSSk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoayA9PT0gMCkge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGsgPT09IDEpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBNYXRoLnBvdygyLCAtMTAgKiBrKSAqIE1hdGguc2luKChrIC0gMC4xKSAqIDUgKiBNYXRoLlBJKSArIDE7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmIChrID09PSAwKSB7XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoayA9PT0gMSkge1xuXHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdH1cblxuXHRcdFx0ayAqPSAyO1xuXG5cdFx0XHRpZiAoayA8IDEpIHtcblx0XHRcdFx0cmV0dXJuIC0wLjUgKiBNYXRoLnBvdygyLCAxMCAqIChrIC0gMSkpICogTWF0aC5zaW4oKGsgLSAxLjEpICogNSAqIE1hdGguUEkpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gMC41ICogTWF0aC5wb3coMiwgLTEwICogKGsgLSAxKSkgKiBNYXRoLnNpbigoayAtIDEuMSkgKiA1ICogTWF0aC5QSSkgKyAxO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0QmFjazoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHZhciBzID0gMS43MDE1ODtcblxuXHRcdFx0cmV0dXJuIGsgKiBrICogKChzICsgMSkgKiBrIC0gcyk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHR2YXIgcyA9IDEuNzAxNTg7XG5cblx0XHRcdHJldHVybiAtLWsgKiBrICogKChzICsgMSkgKiBrICsgcykgKyAxO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHR2YXIgcyA9IDEuNzAxNTggKiAxLjUyNTtcblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogKGsgKiBrICogKChzICsgMSkgKiBrIC0gcykpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gMC41ICogKChrIC09IDIpICogayAqICgocyArIDEpICogayArIHMpICsgMik7XG5cblx0XHR9XG5cblx0fSxcblxuXHRCb3VuY2U6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gMSAtIFRXRUVOLkVhc2luZy5Cb3VuY2UuT3V0KDEgLSBrKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmIChrIDwgKDEgLyAyLjc1KSkge1xuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogayAqIGs7XG5cdFx0XHR9IGVsc2UgaWYgKGsgPCAoMiAvIDIuNzUpKSB7XG5cdFx0XHRcdHJldHVybiA3LjU2MjUgKiAoayAtPSAoMS41IC8gMi43NSkpICogayArIDAuNzU7XG5cdFx0XHR9IGVsc2UgaWYgKGsgPCAoMi41IC8gMi43NSkpIHtcblx0XHRcdFx0cmV0dXJuIDcuNTYyNSAqIChrIC09ICgyLjI1IC8gMi43NSkpICogayArIDAuOTM3NTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiA3LjU2MjUgKiAoayAtPSAoMi42MjUgLyAyLjc1KSkgKiBrICsgMC45ODQzNzU7XG5cdFx0XHR9XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmIChrIDwgMC41KSB7XG5cdFx0XHRcdHJldHVybiBUV0VFTi5FYXNpbmcuQm91bmNlLkluKGsgKiAyKSAqIDAuNTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIFRXRUVOLkVhc2luZy5Cb3VuY2UuT3V0KGsgKiAyIC0gMSkgKiAwLjUgKyAwLjU7XG5cblx0XHR9XG5cblx0fVxuXG59O1xuXG5UV0VFTi5JbnRlcnBvbGF0aW9uID0ge1xuXG5cdExpbmVhcjogZnVuY3Rpb24gKHYsIGspIHtcblxuXHRcdHZhciBtID0gdi5sZW5ndGggLSAxO1xuXHRcdHZhciBmID0gbSAqIGs7XG5cdFx0dmFyIGkgPSBNYXRoLmZsb29yKGYpO1xuXHRcdHZhciBmbiA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuTGluZWFyO1xuXG5cdFx0aWYgKGsgPCAwKSB7XG5cdFx0XHRyZXR1cm4gZm4odlswXSwgdlsxXSwgZik7XG5cdFx0fVxuXG5cdFx0aWYgKGsgPiAxKSB7XG5cdFx0XHRyZXR1cm4gZm4odlttXSwgdlttIC0gMV0sIG0gLSBmKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZm4odltpXSwgdltpICsgMSA+IG0gPyBtIDogaSArIDFdLCBmIC0gaSk7XG5cblx0fSxcblxuXHRCZXppZXI6IGZ1bmN0aW9uICh2LCBrKSB7XG5cblx0XHR2YXIgYiA9IDA7XG5cdFx0dmFyIG4gPSB2Lmxlbmd0aCAtIDE7XG5cdFx0dmFyIHB3ID0gTWF0aC5wb3c7XG5cdFx0dmFyIGJuID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5VdGlscy5CZXJuc3RlaW47XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8PSBuOyBpKyspIHtcblx0XHRcdGIgKz0gcHcoMSAtIGssIG4gLSBpKSAqIHB3KGssIGkpICogdltpXSAqIGJuKG4sIGkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBiO1xuXG5cdH0sXG5cblx0Q2F0bXVsbFJvbTogZnVuY3Rpb24gKHYsIGspIHtcblxuXHRcdHZhciBtID0gdi5sZW5ndGggLSAxO1xuXHRcdHZhciBmID0gbSAqIGs7XG5cdFx0dmFyIGkgPSBNYXRoLmZsb29yKGYpO1xuXHRcdHZhciBmbiA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuQ2F0bXVsbFJvbTtcblxuXHRcdGlmICh2WzBdID09PSB2W21dKSB7XG5cblx0XHRcdGlmIChrIDwgMCkge1xuXHRcdFx0XHRpID0gTWF0aC5mbG9vcihmID0gbSAqICgxICsgaykpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZm4odlsoaSAtIDEgKyBtKSAlIG1dLCB2W2ldLCB2WyhpICsgMSkgJSBtXSwgdlsoaSArIDIpICUgbV0sIGYgLSBpKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmIChrIDwgMCkge1xuXHRcdFx0XHRyZXR1cm4gdlswXSAtIChmbih2WzBdLCB2WzBdLCB2WzFdLCB2WzFdLCAtZikgLSB2WzBdKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGsgPiAxKSB7XG5cdFx0XHRcdHJldHVybiB2W21dIC0gKGZuKHZbbV0sIHZbbV0sIHZbbSAtIDFdLCB2W20gLSAxXSwgZiAtIG0pIC0gdlttXSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmbih2W2kgPyBpIC0gMSA6IDBdLCB2W2ldLCB2W20gPCBpICsgMSA/IG0gOiBpICsgMV0sIHZbbSA8IGkgKyAyID8gbSA6IGkgKyAyXSwgZiAtIGkpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0VXRpbHM6IHtcblxuXHRcdExpbmVhcjogZnVuY3Rpb24gKHAwLCBwMSwgdCkge1xuXG5cdFx0XHRyZXR1cm4gKHAxIC0gcDApICogdCArIHAwO1xuXG5cdFx0fSxcblxuXHRcdEJlcm5zdGVpbjogZnVuY3Rpb24gKG4sIGkpIHtcblxuXHRcdFx0dmFyIGZjID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5VdGlscy5GYWN0b3JpYWw7XG5cblx0XHRcdHJldHVybiBmYyhuKSAvIGZjKGkpIC8gZmMobiAtIGkpO1xuXG5cdFx0fSxcblxuXHRcdEZhY3RvcmlhbDogKGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0dmFyIGEgPSBbMV07XG5cblx0XHRcdHJldHVybiBmdW5jdGlvbiAobikge1xuXG5cdFx0XHRcdHZhciBzID0gMTtcblxuXHRcdFx0XHRpZiAoYVtuXSkge1xuXHRcdFx0XHRcdHJldHVybiBhW25dO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IG47IGkgPiAxOyBpLS0pIHtcblx0XHRcdFx0XHRzICo9IGk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhW25dID0gcztcblx0XHRcdFx0cmV0dXJuIHM7XG5cblx0XHRcdH07XG5cblx0XHR9KSgpLFxuXG5cdFx0Q2F0bXVsbFJvbTogZnVuY3Rpb24gKHAwLCBwMSwgcDIsIHAzLCB0KSB7XG5cblx0XHRcdHZhciB2MCA9IChwMiAtIHAwKSAqIDAuNTtcblx0XHRcdHZhciB2MSA9IChwMyAtIHAxKSAqIDAuNTtcblx0XHRcdHZhciB0MiA9IHQgKiB0O1xuXHRcdFx0dmFyIHQzID0gdCAqIHQyO1xuXG5cdFx0XHRyZXR1cm4gKDIgKiBwMSAtIDIgKiBwMiArIHYwICsgdjEpICogdDMgKyAoLSAzICogcDEgKyAzICogcDIgLSAyICogdjAgLSB2MSkgKiB0MiArIHYwICogdCArIHAxO1xuXG5cdFx0fVxuXG5cdH1cblxufTtcblxuLy8gVU1EIChVbml2ZXJzYWwgTW9kdWxlIERlZmluaXRpb24pXG4oZnVuY3Rpb24gKHJvb3QpIHtcblxuXHRpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG5cblx0XHQvLyBBTURcblx0XHRkZWZpbmUoW10sIGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiBUV0VFTjtcblx0XHR9KTtcblxuXHR9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuXG5cdFx0Ly8gTm9kZS5qc1xuXHRcdG1vZHVsZS5leHBvcnRzID0gVFdFRU47XG5cblx0fSBlbHNlIGlmIChyb290ICE9PSB1bmRlZmluZWQpIHtcblxuXHRcdC8vIEdsb2JhbCB2YXJpYWJsZVxuXHRcdHJvb3QuVFdFRU4gPSBUV0VFTjtcblxuXHR9XG5cbn0pKHRoaXMpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9AdHdlZW5qcy90d2Vlbi5qcy9zcmMvVHdlZW4uanNcbi8vIG1vZHVsZSBpZCA9IDI3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vLyA8YW1kLW1vZHVsZSBuYW1lPVwiRWdyZXRCcmlkZ2VcIi8+XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwib2x5bXB1cy1yL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgTW9kdWxlTWVzc2FnZSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWVzc2FnZVwiO1xyXG5pbXBvcnQgU2NlbmVNZXNzYWdlIGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgeyB3cmFwQWJzb2x1dGVQYXRoIH0gZnJvbSBcIm9seW1wdXMtci91dGlscy9VUkxVdGlsXCI7XHJcbmltcG9ydCBSZW5kZXJNb2RlIGZyb20gXCIuL2VncmV0L1JlbmRlck1vZGVcIjtcclxuaW1wb3J0IEFzc2V0c0xvYWRlciBmcm9tIFwiLi9lZ3JldC9Bc3NldHNMb2FkZXJcIjtcclxuaW1wb3J0IEJhY2tQYW5lbFBvbGljeSBmcm9tIFwiLi9lZ3JldC9wYW5lbC9CYWNrUGFuZWxQb2xpY3lcIjtcclxuaW1wb3J0IEZhZGVTY2VuZVBvbGljeSBmcm9tIFwiLi9lZ3JldC9zY2VuZS9GYWRlU2NlbmVQb2xpY3lcIjtcclxuaW1wb3J0IE1hc2tFbnRpdHkgZnJvbSBcIi4vZWdyZXQvbWFzay9NYXNrRW50aXR5XCI7XHJcbmltcG9ydCB7IHdyYXBFVUlMaXN0IH0gZnJvbSBcIi4vZWdyZXQvdXRpbHMvVUlVdGlsXCI7XHJcbmltcG9ydCBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZCBmcm9tIFwiLi9lZ3JldC9jb21tYW5kL1VwZGF0ZVNjcmVlblNpemVDb21tYW5kXCI7XHJcbmltcG9ydCB7IHdyYXBTa2luIH0gZnJvbSBcIi4vZWdyZXQvdXRpbHMvU2tpblV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqXHJcbiAqIEVncmV055qE6KGo546w5bGC5qGl5a6e546w77yM5b2T5YmNRWdyZXTniYjmnKzvvJo1LjAuN1xyXG4qL1xyXG52YXIgRWdyZXRCcmlkZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFZ3JldEJyaWRnZShwYXJhbXMpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDpu5jorqTlvLnnqpfnrZbnlaVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJUGFuZWxQb2xpY3l9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0UGFuZWxQb2xpY3kgPSBuZXcgQmFja1BhbmVsUG9saWN5KCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6buY6K6k5Zy65pmv5YiH5o2i562W55WlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SVNjZW5lUG9saWN5fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFNjZW5lUG9saWN5ID0gbmV3IEZhZGVTY2VuZVBvbGljeSgpO1xyXG4gICAgICAgIHRoaXMuX2luaXRQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcInR5cGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluihqOeOsOWxguexu+Wei+WQjeensFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEVncmV0QnJpZGdlLlRZUEU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcImh0bWxXcmFwcGVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5booajnjrDlsYJIVE1M5YyF6KOF5Zmo77yM5Y+v5Lul5a+55YW25qC35byP6L+b6KGM6Ieq5a6a5LmJ6LCD5pW0XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwicm9vdFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5qC55pi+56S66IqC54K5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jvb3Q7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcInN0YWdlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5boiJ7lj7DlvJXnlKhcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtlZ3JldC5TdGFnZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YWdlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJiZ0xheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bog4zmma/lrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmdMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwic2NlbmVMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Zy65pmv5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NjZW5lTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcImZyYW1lTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluahhuaetuWuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9mcmFtZUxheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJwYW5lbExheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvLnnqpflrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFuZWxMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwibWFza0xheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpga7nvanlrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFza0xheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJ0b3BMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6aG257qn5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RvcExheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJwcm9tcHRDbGFzc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6YCa55So5o+Q56S65qGGXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SVByb21wdFBhbmVsQ29uc3RydWN0b3J9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0UGFyYW1zLnByb21wdENsYXNzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJtYXNrRW50aXR5XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpga7nvanlrp7kvZNcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJTWFza0VudGl0eX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBNYXNrRW50aXR5KHRoaXMuX2luaXRQYXJhbXMubWFza0RhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbooajnjrDlsYLmoaVcclxuICAgICAqIEBwYXJhbSB7KCk9PnZvaWR9IGNvbXBsZXRlIOWIneWni+WMluWujOavleWQjueahOWbnuiwg1xyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGNvbXBsZXRlKSB7XHJcbiAgICAgICAgLy8g55Sf5oiQaHRtbOWSjGJvZHnnmoTmoLflvI/oioLngrlcclxuICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcbiAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBcIlxcbiAgICAgICAgICAgIGh0bWwsIGJvZHkge1xcbiAgICAgICAgICAgICAgICAtbXMtdG91Y2gtYWN0aW9uOiBub25lO1xcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBcIiArIGVncmV0LnRvQ29sb3JTdHJpbmcodGhpcy5faW5pdFBhcmFtcy5iYWNrZ3JvdW5kQ29sb3IgfHwgMCkgKyBcIjtcXG4gICAgICAgICAgICAgICAgcGFkZGluZzogMDtcXG4gICAgICAgICAgICAgICAgYm9yZGVyOiAwO1xcbiAgICAgICAgICAgICAgICBtYXJnaW46IDA7XFxuICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICBcIjtcclxuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcclxuICAgICAgICAvLyDnu5/kuIDlrrnlmahcclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29udGFpbmVyID0gdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXI7XHJcbiAgICAgICAgLy8g5p6E5bu65a655Zmo5Y+C5pWwXHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1hcmdpbiA9IFwiYXV0b1wiO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuICAgICAgICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IFwiMCVcIjtcclxuICAgICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IFwiMCVcIjtcclxuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJlZ3JldC1wbGF5ZXJcIjtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1lbnRyeS1jbGFzc1wiLCBcIl9fRWdyZXRSb290X19cIik7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtb3JpZW50YXRpb25cIiwgXCJhdXRvXCIpO1xyXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNjYWxlLW1vZGVcIiwgdGhpcy5faW5pdFBhcmFtcy5zY2FsZU1vZGUgfHwgZWdyZXQuU3RhZ2VTY2FsZU1vZGUuRklYRURfTkFSUk9XKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1mcmFtZS1yYXRlXCIsICh0aGlzLl9pbml0UGFyYW1zLmZyYW1lUmF0ZSB8fCA2MCkgKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1jb250ZW50LXdpZHRoXCIsIHRoaXMuX2luaXRQYXJhbXMud2lkdGggKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1jb250ZW50LWhlaWdodFwiLCB0aGlzLl9pbml0UGFyYW1zLmhlaWdodCArIFwiXCIpO1xyXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNob3ctcGFpbnQtcmVjdFwiLCAodGhpcy5faW5pdFBhcmFtcy5zaG93UGFpbnRSZWN0IHx8IGZhbHNlKSArIFwiXCIpO1xyXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLW11bHRpLWZpbmdlcmVkXCIsICh0aGlzLl9pbml0UGFyYW1zLm11bHRpRmluZ2VyZWQgfHwgMikgKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zaG93LWZwc1wiLCAodGhpcy5faW5pdFBhcmFtcy5zaG93RlBTIHx8IGZhbHNlKSArIFwiXCIpO1xyXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNob3ctZnBzLXN0eWxlXCIsIHRoaXMuX2luaXRQYXJhbXMuc2hvd0ZQU1N0eWxlIHx8IFwieDowLHk6MCxzaXplOjEyLHRleHRDb2xvcjoweGZmZmZmZixiZ0FscGhhOjAuOVwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zaG93LWxvZ1wiLCAodGhpcy5faW5pdFBhcmFtcy5zaG93TG9nIHx8IGZhbHNlKSArIFwiXCIpO1xyXG4gICAgICAgIC8vIOaehOW7ul9fRWdyZXRSb290X1/nsbvvvIzkvb/lvpdFZ3JldOW8leaTjuWPr+S7pemAmui/h3dpbmRvd+Wvu+WdgOeahOaWueW8j+aJvuWIsOivpeexu++8jOWQjOaXtuWPiOWPr+S7peiuqeWFtuWwhuaOp+WItuadg+i9rOS6pOe7mUFwcGxpY2F0aW9uXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHdpbmRvd1tcIl9fRWdyZXRSb290X19cIl0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV1aS5VSUxheWVyLmNhbGwodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB3aW5kb3dbXCJfX0VncmV0Um9vdF9fXCJdLnByb3RvdHlwZSA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgIHdpbmRvd1tcIl9fRWdyZXRSb290X19cIl0ucHJvdG90eXBlLiRvbkFkZFRvU3RhZ2UgPSBmdW5jdGlvbiAoc3RhZ2UsIG5lc3RMZXZlbCkge1xyXG4gICAgICAgICAgICAvLyDosIPnlKjniLbnsbvmlrnms5VcclxuICAgICAgICAgICAgZXVpLlVJTGF5ZXIucHJvdG90eXBlLiRvbkFkZFRvU3RhZ2UuY2FsbCh0aGlzLCBzdGFnZSwgbmVzdExldmVsKTtcclxuICAgICAgICAgICAgLy8g56e76Zmk5byV55SoXHJcbiAgICAgICAgICAgIGRlbGV0ZSB3aW5kb3dbXCJfX0VncmV0Um9vdF9fXCJdO1xyXG4gICAgICAgICAgICAvLyDlsIbmjqfliLbmnYPnp7vkuqTnu5lBcHBsaWNhdGlvbuWvueixoVxyXG4gICAgICAgICAgICBvblJvb3RJbml0aWFsaXplZCh0aGlzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOagueaNrua4suafk+aooeW8j+WIneWni+WMlkVncmV05byV5pOOXHJcbiAgICAgICAgc3dpdGNoICh0aGlzLl9pbml0UGFyYW1zLnJlbmRlck1vZGUpIHtcclxuICAgICAgICAgICAgY2FzZSBSZW5kZXJNb2RlLldFQkdMOlxyXG4gICAgICAgICAgICAgICAgaW5pdEVncmV0KFwid2ViZ2xcIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBSZW5kZXJNb2RlLkNBTlZBUzpcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGluaXRFZ3JldChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBpbml0RWdyZXQocmVuZGVyTW9kZSkge1xyXG4gICAgICAgICAgICBpZiAod2luZG93W1wiZXVpXCJdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDnr6HmlLlldWkuRGF0YUdyb3VwLmNvbW1pdFByb3BlcnRpZXPlkoxnZXRWaXJ0dWFsRWxlbWVudEF05pa55rOV77yM5Li6cmVuZGVyZXLmt7vliqDkuIDkuKrmoIfnrb7ku6Xkv67lpI3liJfooajpppbpobnmuLLmn5PlpJrmrKHnmoRidWdcclxuICAgICAgICAgICAgICAgIHZhciBvcmlDb21taXRQcm9wZXJ0aWVzID0gZXVpLkRhdGFHcm91cC5wcm90b3R5cGVbXCJjb21taXRQcm9wZXJ0aWVzXCJdO1xyXG4gICAgICAgICAgICAgICAgZXVpLkRhdGFHcm91cC5wcm90b3R5cGVbXCJjb21taXRQcm9wZXJ0aWVzXCJdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX19lZ3JldF9kYXRhZ3JvdXBfc3RhdGVfXyA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG9yaUNvbW1pdFByb3BlcnRpZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBvcmlHZXRWaXJ0dWFsRWxlbWVudEF0ID0gZXVpLkRhdGFHcm91cC5wcm90b3R5cGVbXCJnZXRWaXJ0dWFsRWxlbWVudEF0XCJdO1xyXG4gICAgICAgICAgICAgICAgZXVpLkRhdGFHcm91cC5wcm90b3R5cGVbXCJnZXRWaXJ0dWFsRWxlbWVudEF0XCJdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX19lZ3JldF9kYXRhZ3JvdXBfc3RhdGVfXyA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG9yaUdldFZpcnR1YWxFbGVtZW50QXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIOevoeaUuWV1aS5yZWdpc3RlckJpbmRhYmxl5pa55rOV77yM5oqKX19iaW5kYWJsZXNfX+i1i+WAvOWPmOS4uuS4jeWPr+mBjeWOhueahOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgdmFyIG9yaVJlZ2lzdGVyQmluZGFibGUgPSBldWkucmVnaXN0ZXJCaW5kYWJsZTtcclxuICAgICAgICAgICAgICAgIGV1aS5yZWdpc3RlckJpbmRhYmxlID0gZnVuY3Rpb24gKGluc3RhbmNlLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlSZWdpc3RlckJpbmRhYmxlLmNhbGwodGhpcywgaW5zdGFuY2UsIHByb3BlcnR5KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmlLnlj5jlj6/pgY3ljobmgKdcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaW5zdGFuY2UsIFwiX19iaW5kYWJsZXNfX1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzYyAmJiBkZXNjLmVudW1lcmFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzYy5lbnVtZXJhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpbnN0YW5jZSwgXCJfX2JpbmRhYmxlc19fXCIsIGRlc2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDov5Tlm57nu5PmnpxcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIOevoeaUuVdhdGNoZXIuY2hlY2tCaW5kYWJsZeaWueazle+8jOaKil9fbGlzdGVuZXJzX1/otYvlgLzlj5jkuLrkuI3lj6/pgY3ljoZcclxuICAgICAgICAgICAgICAgIHZhciBvcmlDaGVja0JpbmRhYmxlID0gZXVpLldhdGNoZXJbXCJjaGVja0JpbmRhYmxlXCJdO1xyXG4gICAgICAgICAgICAgICAgZXVpLldhdGNoZXJbXCJjaGVja0JpbmRhYmxlXCJdID0gZnVuY3Rpb24gKGhvc3QsIHByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG9yaUNoZWNrQmluZGFibGUuY2FsbCh0aGlzLCBob3N0LCBwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5pS55Y+Y5Y+v6YGN5Y6G5oCnXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGhvc3QsIFwiX19saXN0ZW5lcnNfX1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzYyAmJiBkZXNjLmVudW1lcmFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzYy5lbnVtZXJhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShob3N0LCBcIl9fbGlzdGVuZXJzX19cIiwgZGVzYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlkK/liqhFZ3JldOW8leaTjlxyXG4gICAgICAgICAgICBlZ3JldC5ydW5FZ3JldCh7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJNb2RlOiByZW5kZXJNb2RlLFxyXG4gICAgICAgICAgICAgICAgYXVkaW9UeXBlOiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvblJvb3RJbml0aWFsaXplZChyb290KSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3Jvb3QgPSByb290O1xyXG4gICAgICAgICAgICBzZWxmLl9zdGFnZSA9IHJvb3Quc3RhZ2U7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uuiDjOaZr+aYvuekuuWxglxyXG4gICAgICAgICAgICBzZWxmLl9iZ0xheWVyID0gbmV3IGV1aS5VSUxheWVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX2JnTGF5ZXIudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQoc2VsZi5fYmdMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uuWcuuaZr+aYvuekuuWxglxyXG4gICAgICAgICAgICBzZWxmLl9zY2VuZUxheWVyID0gbmV3IGV1aS5VSUxheWVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NjZW5lTGF5ZXIudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQoc2VsZi5fc2NlbmVMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uuahhuaetuaYvuekuuWxglxyXG4gICAgICAgICAgICBzZWxmLl9mcmFtZUxheWVyID0gbmV3IGV1aS5VSUxheWVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX2ZyYW1lTGF5ZXIudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQoc2VsZi5fZnJhbWVMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uuW8ueWHuuWxglxyXG4gICAgICAgICAgICBzZWxmLl9wYW5lbExheWVyID0gbmV3IGV1aS5VSUxheWVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3BhbmVsTGF5ZXIudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQoc2VsZi5fcGFuZWxMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uumBrue9qeWxglxyXG4gICAgICAgICAgICBzZWxmLl9tYXNrTGF5ZXIgPSBuZXcgZXVpLlVJTGF5ZXIoKTtcclxuICAgICAgICAgICAgc2VsZi5fbWFza0xheWVyLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByb290LmFkZENoaWxkKHNlbGYuX21hc2tMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOWIm+W7uumhtue6p+aYvuekuuWxglxyXG4gICAgICAgICAgICBzZWxmLl90b3BMYXllciA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgICAgICBzZWxmLl90b3BMYXllci50b3VjaEVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcm9vdC5hZGRDaGlsZChzZWxmLl90b3BMYXllcik7XHJcbiAgICAgICAgICAgIC8vIOaPkuWFpeabtOaWsOWxj+W5leWRveS7pFxyXG4gICAgICAgICAgICBjb3JlLm1hcENvbW1hbmQoU2NlbmVNZXNzYWdlLlNDRU5FX0JFRk9SRV9DSEFOR0UsIFVwZGF0ZVNjcmVlblNpemVDb21tYW5kKTtcclxuICAgICAgICAgICAgLy8g6K6+572u6LWE5rqQ5ZKM5Li76aKY6YCC6YWN5ZmoXHJcbiAgICAgICAgICAgIGVncmV0LnJlZ2lzdGVySW1wbGVtZW50YXRpb24oXCJldWkuSUFzc2V0QWRhcHRlclwiLCBuZXcgQXNzZXRBZGFwdGVyKCkpO1xyXG4gICAgICAgICAgICBlZ3JldC5yZWdpc3RlckltcGxlbWVudGF0aW9uKFwiZXVpLklUaGVtZUFkYXB0ZXJcIiwgbmV3IFRoZW1lQWRhcHRlcihzZWxmLl9pbml0UGFyYW1zKSk7XHJcbiAgICAgICAgICAgIC8vIOWKoOi9vei1hOa6kOmFjee9rlxyXG4gICAgICAgICAgICBSRVMuYWRkRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5DT05GSUdfQ09NUExFVEUsIG9uQ29uZmlnQ29tcGxldGUsIHNlbGYpO1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gd3JhcEFic29sdXRlUGF0aChzZWxmLl9pbml0UGFyYW1zLnBhdGhQcmVmaXggKyBcInJlc291cmNlL2RlZmF1bHQucmVzLmpzb25cIiwgZW52aXJvbm1lbnQuY3VyQ0ROSG9zdCk7XHJcbiAgICAgICAgICAgIFJFUy5sb2FkQ29uZmlnKHVybCwgc2VsZi5faW5pdFBhcmFtcy5wYXRoUHJlZml4ICsgXCJyZXNvdXJjZS9cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uQ29uZmlnQ29tcGxldGUoZXZ0KSB7XHJcbiAgICAgICAgICAgIFJFUy5yZW1vdmVFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkNPTkZJR19DT01QTEVURSwgb25Db25maWdDb21wbGV0ZSwgc2VsZik7XHJcbiAgICAgICAgICAgIC8vIOWKoOi9veS4u+mimOmFjee9rlxyXG4gICAgICAgICAgICB2YXIgdXJsID0gd3JhcEFic29sdXRlUGF0aCh0aGlzLl9pbml0UGFyYW1zLnBhdGhQcmVmaXggKyBcInJlc291cmNlL2RlZmF1bHQudGhtLmpzb25cIiwgZW52aXJvbm1lbnQuY3VyQ0ROSG9zdCk7XHJcbiAgICAgICAgICAgIHZhciB0aGVtZSA9IG5ldyBldWkuVGhlbWUodXJsLCBzZWxmLl9yb290LnN0YWdlKTtcclxuICAgICAgICAgICAgdGhlbWUuYWRkRXZlbnRMaXN0ZW5lcihldWkuVUlFdmVudC5DT01QTEVURSwgb25UaGVtZUxvYWRDb21wbGV0ZSwgc2VsZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uVGhlbWVMb2FkQ29tcGxldGUoZXZ0KSB7XHJcbiAgICAgICAgICAgIGV2dC50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldWkuVUlFdmVudC5DT01QTEVURSwgb25UaGVtZUxvYWRDb21wbGV0ZSwgc2VsZik7XHJcbiAgICAgICAgICAgIC8vIOWKoOi9vemihOWKoOi9vei1hOa6kOe7hFxyXG4gICAgICAgICAgICB2YXIgcHJlbG9hZEdyb3VwcyA9IHRoaXMuX2luaXRQYXJhbXMucHJlbG9hZEdyb3VwcztcclxuICAgICAgICAgICAgc2VsZi5sb2FkQXNzZXRzKHByZWxvYWRHcm91cHMsIG51bGwsIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIGNvbXBsZXRlKHNlbGYpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3nmq7ogqTmmK/lkKbmmK9FZ3JldOaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Kn0gc2tpbiDnmq7ogqTlr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKbmmK9FZ3JldOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5pc015U2tpbiA9IGZ1bmN0aW9uIChza2luKSB7XHJcbiAgICAgICAgaWYgKHNraW4gaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0KVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAoc2tpbiBpbnN0YW5jZW9mIEZ1bmN0aW9uKVxyXG4gICAgICAgICAgICByZXR1cm4gKHNraW4ucHJvdG90eXBlIGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBza2luID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gKGVncmV0LmdldERlZmluaXRpb25CeU5hbWUoc2tpbikgIT0gbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDljIXoo4VIVE1MRWxlbWVudOiKgueCuVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7Kn0gc2tpbiDljp/lp4vnmq7ogqRcclxuICAgICAqIEByZXR1cm5zIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDljIXoo4XlkI7nmoTnmq7ogqRcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUud3JhcFNraW4gPSBmdW5jdGlvbiAobWVkaWF0b3IsIHNraW4pIHtcclxuICAgICAgICByZXR1cm4gd3JhcFNraW4obWVkaWF0b3IsIHNraW4pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pu/5o2i55qu6IKk77yM55So5LqO57uE5Lu25Y+Y6Lqr5pe25LiN5ZCM6KGo546w5bGC5qGl55qE5aSE55CGXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50IOW9k+WJjeearuiCpFxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg6KaB5pu/5o2i55qE55qu6IKkXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0g5pu/5o2i5a6M5q+V55qE55qu6IKkXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLnJlcGxhY2VTa2luID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjdXJyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICAvLyBFZ3JldOearuiCpOmcgOimgeWIpOaWreexu+Wei++8jOi/m+ihjOS4jeWQjOWkhOeQhlxyXG4gICAgICAgIGlmIChjdXJyZW50IGluc3RhbmNlb2YgZXVpLkNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgZXVpLkNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5Lik6L656YO95pivZXVp57uE5Lu277yM55u05o6l5bCG5Y+z5omL55qu6IKk6LWL5YC857uZ5bem5omLXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50LnNraW5OYW1lID0gdGFyZ2V0LnNraW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0IGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+z5omL5piv5pmu6YCa5pi+56S65a+56LGh77yM56e76Zmk5bem5omL55qu6IKk77yM5re75Yqg5Y+z5omL5pi+56S65Yiw5YW25LitXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50LnNraW5OYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQuYWRkQ2hpbGQodGFyZ2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWFtuS7luaDheWGtemDveiupOS4uuWPs+aJi+aYr+earuiCpOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgY3VycmVudC5za2luTmFtZSA9IHRhcmdldDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDov5Tlm57lt6bmiYtcclxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0KSkge1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+z5omL5LiN5piv5pi+56S65a+56LGh77yM6K6k5Li65piv55qu6IKk5pWw5o2u77yM55Sf5oiQ5LiA5LiqZXVpLkNvbXBvbmVudOWMheijueWug1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBuZXcgZXVpLkNvbXBvbmVudCgpO1xyXG4gICAgICAgICAgICAgICAgdGVtcC5za2luTmFtZSA9IHRhcmdldDtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRlbXA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5Y+z5omL5pu/5o2i5bem5omL5L2N572uXHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBjdXJyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgcGFyZW50LmFkZENoaWxkQXQodGFyZ2V0LCBwYXJlbnQuZ2V0Q2hpbGRJbmRleChjdXJyZW50KSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChjdXJyZW50KTtcclxuICAgICAgICAgICAgLy8g6L+U5Zue5Y+z5omLXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5ZCM5q2l55qu6IKk77yM55So5LqO57uE5Lu25Y+Y6Lqr5ZCO55qE6YeN5paw5a6a5L2NXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSBjdXJyZW50IOW9k+WJjeearuiCpFxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSB0YXJnZXQg5pu/5o2i55qE55qu6IKkXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLnN5bmNTa2luID0gZnVuY3Rpb24gKGN1cnJlbnQsIHRhcmdldCkge1xyXG4gICAgICAgIGlmICghY3VycmVudCB8fCAhdGFyZ2V0KVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g6K6+572u5bGe5oCnXHJcbiAgICAgICAgLy8g5LiL6Z2i5pivZWdyZXTnuqfliKvlsZ7mgKdcclxuICAgICAgICB2YXIgcHJvcHMgPSBbXHJcbiAgICAgICAgICAgIFwibWF0cml4XCIsIFwiYW5jaG9yT2Zmc2V0WFwiLCBcImFuY2hvck9mZnNldFlcIiwgXCJhbHBoYVwiLCBcInZpc2libGVcIlxyXG4gICAgICAgIF07XHJcbiAgICAgICAgLy8g5aaC5p6c5b2T5YmN5a696auY5LiN5Li6MOWImeWQjOagt+iuvue9ruWuvemrmFxyXG4gICAgICAgIGlmIChjdXJyZW50LndpZHRoID4gMClcclxuICAgICAgICAgICAgcHJvcHMucHVzaChcIndpZHRoXCIpO1xyXG4gICAgICAgIGlmIChjdXJyZW50LmhlaWdodCA+IDApXHJcbiAgICAgICAgICAgIHByb3BzLnB1c2goXCJoZWlnaHRcIik7XHJcbiAgICAgICAgLy8g5LiL6Z2i5pivZXVp57qn5Yir5bGe5oCnXHJcbiAgICAgICAgaWYgKGN1cnJlbnQgaW5zdGFuY2VvZiBldWkuQ29tcG9uZW50ICYmIHRhcmdldCBpbnN0YW5jZW9mIGV1aS5Db21wb25lbnQpIHtcclxuICAgICAgICAgICAgcHJvcHMucHVzaC5hcHBseShwcm9wcywgW1xyXG4gICAgICAgICAgICAgICAgXCJob3Jpem9udGFsQ2VudGVyXCIsIFwidmVydGljYWxDZW50ZXJcIiwgXCJsZWZ0XCIsIFwicmlnaHRcIiwgXCJ0b3BcIiwgXCJib3R0b21cIlxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5YWo6YOo6LWL5YC8XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcm9wc18xID0gcHJvcHM7IF9pIDwgcHJvcHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHByb3AgPSBwcm9wc18xW19pXTtcclxuICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gY3VycmVudFtwcm9wXTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJvlu7rkuIDkuKrnqbrnmoTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7ZWdyZXQuU3ByaXRlfVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5jcmVhdGVFbXB0eURpc3BsYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBlZ3JldC5TcHJpdGUoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOaYvuekulxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOimgea3u+WKoOWIsOeahOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSB0YXJnZXQg6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDov5Tlm57ooqvmt7vliqDnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBpZiAocGFyZW50ICYmIHRhcmdldClcclxuICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5hZGRDaGlsZCh0YXJnZXQpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaMiee0ouW8lea3u+WKoOaYvuekulxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOimgea3u+WKoOWIsOeahOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSB0YXJnZXQg6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXgg6KaB5re75Yqg5Yiw55qE54i257qn57Si5byVXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDov5Tlm57ooqvmt7vliqDnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuYWRkQ2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIHRhcmdldCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAocGFyZW50ICYmIHRhcmdldClcclxuICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5hZGRDaGlsZEF0KHRhcmdldCwgaW5kZXgpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSB0YXJnZXQg6KKr56e76Zmk55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDov5Tlm57ooqvnp7vpmaTnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBpZiAocGFyZW50ICYmIHRhcmdldCAmJiB0YXJnZXQucGFyZW50ID09PSBwYXJlbnQpXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQucmVtb3ZlQ2hpbGQodGFyZ2V0KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjInntKLlvJXnp7vpmaTmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDntKLlvJVcclxuICAgICAqIEByZXR1cm4ge2VncmV0LkRpc3BsYXlPYmplY3R9IOi/lOWbnuiiq+enu+mZpOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5yZW1vdmVDaGlsZEF0ID0gZnVuY3Rpb24gKHBhcmVudCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAocGFyZW50ICYmIGluZGV4ID49IDApXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQucmVtb3ZlQ2hpbGRBdChpbmRleCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOaJgOacieaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5yZW1vdmVDaGlsZHJlbiA9IGZ1bmN0aW9uIChwYXJlbnQpIHtcclxuICAgICAgICBpZiAocGFyZW50KVxyXG4gICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGRyZW4oKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlueItuWuueWZqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gdGFyZ2V0IOebruagh+WvueixoVxyXG4gICAgICogQHJldHVybnMge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IOeItuWuueWZqFxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5nZXRQYXJlbnQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldC5wYXJlbnQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmjIflrprntKLlvJXlpITnmoTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDmjIflrprniLbnuqfntKLlvJVcclxuICAgICAqIEByZXR1cm4ge2VncmV0LkRpc3BsYXlPYmplY3R9IOe0ouW8leWkhOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5nZXRDaGlsZEF0ID0gZnVuY3Rpb24gKHBhcmVudCwgaW5kZXgpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50LmdldENoaWxkQXQoaW5kZXgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5pi+56S657Si5byVXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3R9IHRhcmdldCDlrZDmmL7npLrlr7nosaFcclxuICAgICAqIEByZXR1cm4ge251bWJlcn0gdGFyZ2V05ZyocGFyZW505Lit55qE57Si5byVXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmdldENoaWxkSW5kZXggPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50LmdldENoaWxkSW5kZXgodGFyZ2V0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmAmui/h+WQjeensOiOt+WPluaYvuekuuWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg5a+56LGh5ZCN56ewXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRCeU5hbWUgPSBmdW5jdGlvbiAocGFyZW50LCBuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5nZXRDaGlsZEJ5TmFtZShuYW1lKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWtkOaYvuekuuWvueixoeaVsOmHj1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHJldHVybiB7bnVtYmVyfSDlrZDmmL7npLrlr7nosaHmlbDph49cclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uIChwYXJlbnQpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50Lm51bUNoaWxkcmVuO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L296LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gYXNzZXRzIOi1hOa6kOaVsOe7hFxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOi1hOa6kOWIl+ihqFxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Zue6LCD5Ye95pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmxvYWRBc3NldHMgPSBmdW5jdGlvbiAoYXNzZXRzLCBtZWRpYXRvciwgaGFuZGxlcikge1xyXG4gICAgICAgIHZhciBsb2FkZXIgPSBuZXcgQXNzZXRzTG9hZGVyKHtcclxuICAgICAgICAgICAgb25lRXJyb3I6IGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcihuZXcgRXJyb3IoXCLotYTmupDliqDovb3lpLHotKVcIikpO1xyXG4gICAgICAgICAgICAgICAgLy8g5rS+5Y+R5Yqg6L296ZSZ6K+v5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKE1vZHVsZU1lc3NhZ2UuTU9EVUxFX0xPQURfQVNTRVRTX0VSUk9SLCBldnQpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKGRpY3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbG9hZGVyLmxvYWRHcm91cHMoYXNzZXRzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOebkeWQrOS6i+S7tu+8jOS7jui/meS4quaWueazleebkeWQrOeahOS6i+S7tuS8muWcqOS4reS7i+iAhemUgOavgeaXtuiiq+iHquWKqOenu+mZpOebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRXZlbnREaXNwYXRjaGVyfSB0YXJnZXQg5LqL5Lu255uu5qCH5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5LqL5Lu25aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCR5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLm1hcExpc3RlbmVyID0gZnVuY3Rpb24gKHRhcmdldCwgdHlwZSwgaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA55uR5ZCs5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5FdmVudERpc3BhdGNoZXJ9IHRhcmdldCDkuovku7bnm67moIflr7nosaFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOS6i+S7tuexu+Wei1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDkuovku7blpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJHlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUudW5tYXBMaXN0ZW5lciA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpIHtcclxuICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOS4uue7keWumueahOWIl+ihqOaYvuekuuWvueixoeWMheijheS4gOS4qua4suafk+WZqOWIm+W7uuWbnuiwg1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZXVpLkRhdGFHcm91cH0gdGFyZ2V0IEJpbmRGb3LmjIfku6TmjIflkJHnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7KGtleT86YW55LCB2YWx1ZT86YW55LCByZW5kZXJlcj86ZXVpLklJdGVtUmVuZGVyZXIpPT52b2lkfSByZW5kZXJlckhhbmRsZXIg5riy5p+T5Zmo5Yib5bu65Zue6LCDXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0g6L+U5Zue5LiA5Liq5aSH5b+Y5b2V5a+56LGh77yM5Lya5Zyo6LWL5YC85pe25o+Q5L6bXHJcbiAgICAgKiBAbWVtYmVyb2YgSUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUud3JhcEJpbmRGb3IgPSBmdW5jdGlvbiAodGFyZ2V0LCByZW5kZXJlckhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgbWVtZW50byA9IHt9O1xyXG4gICAgICAgIHdyYXBFVUlMaXN0KHRhcmdldCwgZnVuY3Rpb24gKGRhdGEsIHJlbmRlcmVyKSB7XHJcbiAgICAgICAgICAgIC8vIOWPluWHumtleVxyXG4gICAgICAgICAgICB2YXIga2V5O1xyXG4gICAgICAgICAgICB2YXIgZGF0YXMgPSBtZW1lbnRvLmRhdGFzO1xyXG4gICAgICAgICAgICAvLyDpgY3ljoZtZW1lbnRv55qEZGF0YXPlsZ7mgKfvvIjlnKh2YWx1YXRlQmluZEZvcuaXtuiiq+i1i+WAvO+8iVxyXG4gICAgICAgICAgICBpZiAoZGF0YXMgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAga2V5ID0gcmVuZGVyZXIuaXRlbUluZGV4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhc1tpXSA9PT0gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDov5nlsLHmmK/miJHku6zopoHmib7nmoRrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBpZiAoa2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtZW1lbnRvLnN5bmNEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtZW1lbnRvLnN5bmNEaWN0W2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldFtcIl9fZWdyZXRfZGF0YWdyb3VwX3N0YXRlX19cIl0gPT09IDEgfHwgdGFyZ2V0W1wiX19lZ3JldF9kYXRhZ3JvdXBfc3RhdGVfX1wiXSA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtZW50by5zeW5jRGljdFtrZXldID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVySGFuZGxlcihrZXksIGRhdGEsIHJlbmRlcmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcmVySGFuZGxlcihrZXksIGRhdGEsIHJlbmRlcmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBtZW1lbnRvO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Li65YiX6KGo5pi+56S65a+56LGh6LWL5YC8XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtldWkuRGF0YUdyb3VwfSB0YXJnZXQgQmluZEZvcuaMh+S7pOaMh+WQkeeahOaYvuekuuWvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSBkYXRhcyDmlbDmja7pm4blkIhcclxuICAgICAqIEBwYXJhbSB7Kn0gbWVtZW50byB3cmFwQmluZEZvcui/lOWbnueahOWkh+W/mOW9leWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIElCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLnZhbHVhdGVCaW5kRm9yID0gZnVuY3Rpb24gKHRhcmdldCwgZGF0YXMsIG1lbWVudG8pIHtcclxuICAgICAgICB2YXIgcHJvdmlkZXI7XHJcbiAgICAgICAgLy8g5Yid5aeL5YyW5YiX6KGo54q25oCBXHJcbiAgICAgICAgdGFyZ2V0W1wiX19lZ3JldF9kYXRhZ3JvdXBfc3RhdGVfX1wiXSA9IDA7XHJcbiAgICAgICAgLy8g6K6+572ubWVtZW50b1xyXG4gICAgICAgIG1lbWVudG8uZGF0YXMgPSBkYXRhcztcclxuICAgICAgICBtZW1lbnRvLnN5bmNEaWN0ID0ge307XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOS4gOasoea4suafk+WQjuino+mUgVxyXG4gICAgICAgICAgICBkZWxldGUgbWVtZW50by5zeW5jRGljdDtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICAvLyDlpI3liLZkYXRhc1xyXG4gICAgICAgIGlmIChkYXRhcyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIHByb3ZpZGVyID0gbmV3IGV1aS5BcnJheUNvbGxlY3Rpb24oZGF0YXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5piv5a2X5YW477yM5bCG5YW25Y+Y5Li65pWw57uEXHJcbiAgICAgICAgICAgIHZhciBsaXN0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhcykge1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGRhdGFzW2tleV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByb3ZpZGVyID0gbmV3IGV1aS5BcnJheUNvbGxlY3Rpb24obGlzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi1i+WAvFxyXG4gICAgICAgIHRhcmdldC5kYXRhUHJvdmlkZXIgPSBwcm92aWRlcjtcclxuICAgIH07XHJcbiAgICAvKiog5o+Q5L6b6Z2Z5oCB57G75Z6L5bi46YePICovXHJcbiAgICBFZ3JldEJyaWRnZS5UWVBFID0gXCJFZ3JldFwiO1xyXG4gICAgcmV0dXJuIEVncmV0QnJpZGdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBFZ3JldEJyaWRnZTtcclxudmFyIEFzc2V0QWRhcHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFzc2V0QWRhcHRlcigpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGxhbmd1YWdlIHpoX0NOXHJcbiAgICAgKiDop6PmnpDntKDmnZBcclxuICAgICAqIEBwYXJhbSBzb3VyY2Ug5b6F6Kej5p6Q55qE5paw57Sg5p2Q5qCH6K+G56ymXHJcbiAgICAgKiBAcGFyYW0gY29tcEZ1bmMg6Kej5p6Q5a6M5oiQ5Zue6LCD5Ye95pWw77yM56S65L6L77yaY2FsbEJhY2soY29udGVudDphbnksc291cmNlOnN0cmluZyk6dm9pZDtcclxuICAgICAqIEBwYXJhbSB0aGlzT2JqZWN0IGNhbGxCYWNr55qEIHRoaXMg5byV55SoXHJcbiAgICAgKi9cclxuICAgIEFzc2V0QWRhcHRlci5wcm90b3R5cGUuZ2V0QXNzZXQgPSBmdW5jdGlvbiAoc291cmNlLCBjb21wRnVuYywgdGhpc09iamVjdCkge1xyXG4gICAgICAgIGlmIChSRVMuaGFzUmVzKHNvdXJjZSkpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBSRVMuZ2V0UmVzKHNvdXJjZSk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhKVxyXG4gICAgICAgICAgICAgICAgb25HZXRSZXMoZGF0YSk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIFJFUy5nZXRSZXNBc3luYyhzb3VyY2UsIG9uR2V0UmVzLCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIFJFUy5nZXRSZXNCeVVybChzb3VyY2UsIG9uR2V0UmVzLCB0aGlzLCBSRVMuUmVzb3VyY2VJdGVtLlRZUEVfSU1BR0UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkdldFJlcyhkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbXBGdW5jLmNhbGwodGhpc09iamVjdCwgZGF0YSwgc291cmNlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFzc2V0QWRhcHRlcjtcclxufSgpKTtcclxudmFyIFRoZW1lQWRhcHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRoZW1lQWRhcHRlcihpbml0UGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5faW5pdFBhcmFtcyA9IGluaXRQYXJhbXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOino+aekOS4u+mimFxyXG4gICAgICogQHBhcmFtIHVybCDlvoXop6PmnpDnmoTkuLvpoph1cmxcclxuICAgICAqIEBwYXJhbSBjb21wRnVuYyDop6PmnpDlrozmiJDlm57osIPlh73mlbDvvIznpLrkvovvvJpjb21wRnVuYyhlOmVncmV0LkV2ZW50KTp2b2lkO1xyXG4gICAgICogQHBhcmFtIGVycm9yRnVuYyDop6PmnpDlpLHotKXlm57osIPlh73mlbDvvIznpLrkvovvvJplcnJvckZ1bmMoKTp2b2lkO1xyXG4gICAgICogQHBhcmFtIHRoaXNPYmplY3Qg5Zue6LCD55qEdGhpc+W8leeUqFxyXG4gICAgICovXHJcbiAgICBUaGVtZUFkYXB0ZXIucHJvdG90eXBlLmdldFRoZW1lID0gZnVuY3Rpb24gKHVybCwgY29tcEZ1bmMsIGVycm9yRnVuYywgdGhpc09iamVjdCkge1xyXG4gICAgICAgIFJFUy5hZGRFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LklURU1fTE9BRF9FUlJPUiwgb25FcnJvciwgbnVsbCk7XHJcbiAgICAgICAgUkVTLmdldFJlc0J5VXJsKHVybCwgb25HZXRSZXMsIHRoaXMsIFJFUy5SZXNvdXJjZUl0ZW0uVFlQRV9URVhUKTtcclxuICAgICAgICBmdW5jdGlvbiBvbkdldFJlcyhlKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpnIDopoHkuLrmiYDmnInkuLvpopjotYTmupDmt7vliqDot6/lvoTliY3nvIBcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShlKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhLnNraW5zKVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc2tpbnNba2V5XSA9IHRoaXMuX2luaXRQYXJhbXMucGF0aFByZWZpeCArIGRhdGEuc2tpbnNba2V5XTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhLmV4bWxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5Y+q5pivVVJM5YiZ55u05o6l5re75Yqg5YmN57yA77yM5ZCm5YiZ5piv5YaF5a656ZuG5oiQ5pa55byP77yM6ZyA6KaB5Y2V54us5L+u5pS5cGF0aOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBleG1sID0gZGF0YS5leG1sc1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXhtbCA9PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmV4bWxzW2tleV0gPSB0aGlzLl9pbml0UGFyYW1zLnBhdGhQcmVmaXggKyBleG1sO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhtbC5wYXRoID0gdGhpcy5faW5pdFBhcmFtcy5wYXRoUHJlZml4ICsgZXhtbC5wYXRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHsgfVxyXG4gICAgICAgICAgICBjb21wRnVuYy5jYWxsKHRoaXNPYmplY3QsIGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkVycm9yKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUucmVzSXRlbS51cmwgPT0gdXJsKSB7XHJcbiAgICAgICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5JVEVNX0xPQURfRVJST1IsIG9uRXJyb3IsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgZXJyb3JGdW5jLmNhbGwodGhpc09iamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRoZW1lQWRhcHRlcjtcclxufSgpKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvRWdyZXRCcmlkZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBDb21tb25NZXNzYWdlIGZyb20gXCIuLi9tZXNzYWdlL0NvbW1vbk1lc3NhZ2VcIjtcclxuaW1wb3J0IENvcmVNZXNzYWdlIGZyb20gXCIuLi9tZXNzYWdlL0NvcmVNZXNzYWdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0zMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0zMVxyXG4gKlxyXG4gKiDlj6/op4Llr5/mjqXlj6PnmoTpu5jorqTlrp7njrDlr7nosaHvvIzkvJrlsIbmlLbliLDnmoTmtojmga/pgJrnn6Xnu5nms6jlhoznmoTlm57osINcclxuKi9cclxudmFyIE9ic2VydmFibGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKHBhcmVudCkge1xyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2NvbW1hbmREaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fZGlzcG9zZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQub2JzZXJ2YWJsZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYnNlcnZhYmxlLnByb3RvdHlwZSwgXCJvYnNlcnZhYmxlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bliLBJT2JzZXJ2YWJsZeWunuS9k++8jOiLpeacrOi6q+WwseaYr0lPYnNlcnZhYmxl5a6e5L2T5YiZ6L+U5Zue5pys6LqrXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE9ic2VydmFibGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5oYW5kbGVNZXNzYWdlcyA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzMSA9IHRoaXMuX2xpc3RlbmVyRGljdFttc2cuX190eXBlXTtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzMiA9IHRoaXMuX2xpc3RlbmVyRGljdFttc2cuY29uc3RydWN0b3IudG9TdHJpbmcoKV07XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IChsaXN0ZW5lcnMxICYmIGxpc3RlbmVyczIgPyBsaXN0ZW5lcnMxLmNvbmNhdChsaXN0ZW5lcnMyKSA6IGxpc3RlbmVyczEgfHwgbGlzdGVuZXJzMik7XHJcbiAgICAgICAgaWYgKGxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lcnMgPSBsaXN0ZW5lcnMuY29uY2F0KCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgbGlzdGVuZXJzXzEgPSBsaXN0ZW5lcnM7IF9pIDwgbGlzdGVuZXJzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGxpc3RlbmVyc18xW19pXTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWkhOeQhuWHveaVsFxyXG4gICAgICAgICAgICAgICAgaWYgKG1zZyBpbnN0YW5jZW9mIENvbW1vbk1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv6YCa55So5raI5oGv77yM5YiZ5bCG5Y+C5pWw57uT5p6E5ZCO6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgKF9hID0gdGVtcC5oYW5kbGVyKS5jYWxsLmFwcGx5KF9hLCBbdGVtcC50aGlzQXJnXS5jb25jYXQobXNnLnBhcmFtcykpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOaYr+WFtuS7lua2iOaBr++8jOWImeebtOaOpeWwhua2iOaBr+S9k+S8oOe7meWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXAuaGFuZGxlci5jYWxsKHRlbXAudGhpc0FyZywgbXNnKTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOaYr+S4gOasoeaAp+ebkeWQrOWImeenu+mZpOS5i1xyXG4gICAgICAgICAgICAgICAgaWYgKHRlbXAub25jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5saXN0ZW4obXNnLl9fdHlwZSwgdGVtcC5oYW5kbGVyLCB0ZW1wLnRoaXNBcmcsIHRlbXAub25jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxpc3Rlbihtc2cuY29uc3RydWN0b3IudG9TdHJpbmcoKSwgdGVtcC5oYW5kbGVyLCB0ZW1wLnRoaXNBcmcsIHRlbXAub25jZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmRvRGlzcGF0Y2ggPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgLy8g6K6w5b2V5rWB6L2s5YaF5qC4XHJcbiAgICAgICAgbXNnLl9fb2JzZXJ2YWJsZXMucHVzaCh0aGlzKTtcclxuICAgICAgICAvLyDop6blj5Hlkb3ku6RcclxuICAgICAgICB0aGlzLmhhbmRsZUNvbW1hbmRzKG1zZyk7XHJcbiAgICAgICAgLy8g6Kem5Y+R55SobGlzdGVu5b2i5byP55uR5ZCs55qE5raI5oGvXHJcbiAgICAgICAgdGhpcy5oYW5kbGVNZXNzYWdlcyhtc2cpO1xyXG4gICAgfTtcclxuICAgIC8qKiBkaXNwYXRjaOaWueazleWunueOsCAqL1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAodHlwZU9yTXNnKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6ZSA5q+B5Yik5patXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g57uf5LiA5raI5oGv5a+56LGhXHJcbiAgICAgICAgdmFyIG1zZyA9IHR5cGVPck1zZztcclxuICAgICAgICBpZiAodHlwZW9mIHR5cGVPck1zZyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG1zZyA9IG5ldyBDb21tb25NZXNzYWdlKHR5cGVPck1zZyk7XHJcbiAgICAgICAgICAgIG1zZy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgIHRoaXMuZG9EaXNwYXRjaChtc2cpO1xyXG4gICAgICAgIC8vIOmineWklua0vuWPkeS4gOS4qumAmueUqOS6i+S7tlxyXG4gICAgICAgIHRoaXMuZG9EaXNwYXRjaChuZXcgQ29tbW9uTWVzc2FnZShDb3JlTWVzc2FnZS5NRVNTQUdFX0RJU1BBVENIRUQsIG1zZykpO1xyXG4gICAgICAgIC8vIOWwhuS6i+S7tui9rOWPkeWIsOS4iuS4gOWxglxyXG4gICAgICAgIHRoaXMucGFyZW50ICYmIHRoaXMucGFyZW50LmRpc3BhdGNoKG1zZyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzlhoXmoLjmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbkuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBPYnNlcnZhYmxlXHJcbiAgICAgKi9cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICAvLyDplIDmr4HliKTmlq1cclxuICAgICAgICBpZiAodGhpcy5fZGlzcG9zZWQpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0eXBlID0gKHR5cGVvZiB0eXBlID09IFwic3RyaW5nXCIgPyB0eXBlIDogdHlwZS50b1N0cmluZygpKTtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJEaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmICghbGlzdGVuZXJzKVxyXG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5lckRpY3RbdHlwZV0gPSBsaXN0ZW5lcnMgPSBbXTtcclxuICAgICAgICAvLyDmo4Dmn6XlrZjlnKjmgKdcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gbGlzdGVuZXJzW2ldO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzlt7Lnu4/lrZjlnKjnm5HlkKzliJnnm7TmjqXov5Tlm55cclxuICAgICAgICAgICAgaWYgKHRlbXAuaGFuZGxlciA9PSBoYW5kbGVyICYmIHRlbXAudGhpc0FyZyA9PSB0aGlzQXJnKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmt7vliqDnm5HlkKxcclxuICAgICAgICBsaXN0ZW5lcnMucHVzaCh7IGhhbmRsZXI6IGhhbmRsZXIsIHRoaXNBcmc6IHRoaXNBcmcsIG9uY2U6IG9uY2UgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTlhoXmoLjmtojmga/nm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbkuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBPYnNlcnZhYmxlXHJcbiAgICAgKi9cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIC8vIOmUgOavgeWIpOaWrVxyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHR5cGUgPSAodHlwZW9mIHR5cGUgPT0gXCJzdHJpbmdcIiA/IHR5cGUgOiB0eXBlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lckRpY3RbdHlwZV07XHJcbiAgICAgICAgLy8g5qOA5p+l5a2Y5Zyo5oCnXHJcbiAgICAgICAgaWYgKGxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGxpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOW3sue7j+WtmOWcqOebkeWQrOWImeebtOaOpei/lOWbnlxyXG4gICAgICAgICAgICAgICAgaWYgKHRlbXAuaGFuZGxlciA9PSBoYW5kbGVyICYmIHRlbXAudGhpc0FyZyA9PSB0aGlzQXJnICYmIHRlbXAub25jZSA9PSBvbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5oYW5kbGVDb21tYW5kcyA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICB2YXIgY29tbWFuZHMgPSB0aGlzLl9jb21tYW5kRGljdFttc2cuX190eXBlXTtcclxuICAgICAgICBpZiAoY29tbWFuZHMpIHtcclxuICAgICAgICAgICAgY29tbWFuZHMgPSBjb21tYW5kcy5jb25jYXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjb21tYW5kc18xID0gY29tbWFuZHM7IF9pIDwgY29tbWFuZHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbHMgPSBjb21tYW5kc18xW19pXTtcclxuICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWRveS7pFxyXG4gICAgICAgICAgICAgICAgbmV3IGNscyhtc2cpLmV4ZWMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOWRveS7pOWIsOeJueWumua2iOaBr+exu+Wei+S4iu+8jOW9k+i/meS4quexu+Wei+eahOa2iOaBr+a0vuWPkeWIsOahhuaetuWGheaguOaXtuS8muinpuWPkUNvbW1hbmTov5DooYxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDopoHms6jlhoznmoTmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7KElDb21tYW5kQ29uc3RydWN0b3IpfSBjbWQg5ZG95Luk5aSE55CG5Zmo77yM5Y+v5Lul5piv5pa55rOV5b2i5byP77yM5Lmf5Y+v5Lul5L2/57G75b2i5byPXHJcbiAgICAgKiBAbWVtYmVyb2YgT2JzZXJ2YWJsZVxyXG4gICAgICovXHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIC8vIOmUgOavgeWIpOaWrVxyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHZhciBjb21tYW5kcyA9IHRoaXMuX2NvbW1hbmREaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmICghY29tbWFuZHMpXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbW1hbmREaWN0W3R5cGVdID0gY29tbWFuZHMgPSBbXTtcclxuICAgICAgICBpZiAoY29tbWFuZHMuaW5kZXhPZihjbWQpIDwgMClcclxuICAgICAgICAgICAgY29tbWFuZHMucHVzaChjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA5ZG95LukXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo6ZSA55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqFxyXG4gICAgICogQHJldHVybnMge3ZvaWR9XHJcbiAgICAgKiBAbWVtYmVyb2YgT2JzZXJ2YWJsZVxyXG4gICAgICovXHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS51bm1hcENvbW1hbmQgPSBmdW5jdGlvbiAodHlwZSwgY21kKSB7XHJcbiAgICAgICAgLy8g6ZSA5q+B5Yik5patXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdmFyIGNvbW1hbmRzID0gdGhpcy5fY29tbWFuZERpY3RbdHlwZV07XHJcbiAgICAgICAgaWYgKCFjb21tYW5kcylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHZhciBpbmRleCA9IGNvbW1hbmRzLmluZGV4T2YoY21kKTtcclxuICAgICAgICBpZiAoaW5kZXggPCAwKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgY29tbWFuZHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JzZXJ2YWJsZS5wcm90b3R5cGUsIFwiZGlzcG9zZWRcIiwge1xyXG4gICAgICAgIC8qKiDmmK/lkKblt7Lnu4/ooqvplIDmr4EgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2VkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqIOmUgOavgSAqL1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyDplIDmr4HliKTmlq1cclxuICAgICAgICBpZiAodGhpcy5fZGlzcG9zZWQpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyDnp7vpmaTkuIrkuIDlsYLop4Llr5/ogIXlvJXnlKhcclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgLy8g5riF56m65omA5pyJ5raI5oGv55uR5ZCsXHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJEaWN0ID0gbnVsbDtcclxuICAgICAgICAvLyDmuIXnqbrmiYDmnInlkb3ku6RcclxuICAgICAgICB0aGlzLl9jb21tYW5kRGljdCA9IG51bGw7XHJcbiAgICAgICAgLy8g5qCH6K6w6ZSA5q+BXHJcbiAgICAgICAgdGhpcy5fZGlzcG9zZWQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPYnNlcnZhYmxlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBPYnNlcnZhYmxlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL29ic2VydmFibGUvT2JzZXJ2YWJsZS5qc1xuLy8gbW9kdWxlIGlkID0gMjlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAqXHJcbiAqIOa2iOaBr+Wfuuexu1xyXG4qL1xyXG52YXIgTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lc3NhZ2UodHlwZSkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+a0vuWPkeWGheaguOWIl+ihqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZXNzYWdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fX29ic2VydmFibGVzID0gW107XHJcbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVzc2FnZS5wcm90b3R5cGUsIFwiX190eXBlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmtojmga/nsbvlnovlrZfnrKbkuLJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lc3NhZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVzc2FnZS5wcm90b3R5cGUsIFwiX19vYnNlcnZhYmxlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmtojmga/lvZPliY3miYDlsZ7lhoXmoLhcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJT2JzZXJ2YWJsZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVzc2FnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX29ic2VydmFibGVzWzBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lc3NhZ2UucHJvdG90eXBlLCBcIl9fb3JpT2JzZXJ2YWJsZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5raI5oGv5omA5bGe55qE5Y6f5aeL5YaF5qC477yI56ys5LiA5Liq5rS+5Y+R5Yiw55qE5YaF5qC477yJXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lc3NhZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19vYnNlcnZhYmxlc1t0aGlzLl9fb2JzZXJ2YWJsZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWGjeasoeWPkemAgea2iOaBr++8jOS8muS9v+eUqOmmluS4quWGheaguOmHjeaWsOWPkemAgeivpea2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIE1lc3NhZ2UucHJvdG90eXBlLnJlZGlzcGF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fX29yaU9ic2VydmFibGUuZGlzcGF0Y2godGhpcyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lc3NhZ2U7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1lc3NhZ2U7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvbWVzc2FnZS9NZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAzMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTNcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTNcclxuICpcclxuICog5qC45b+D5LqL5Lu257G75Z6LXHJcbiovXHJcbnZhciBDb3JlTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENvcmVNZXNzYWdlKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDku7vkvZXmtojmga/mtL7lj5HliLDmoYbmnrblkI7pg73kvJrmtL7lj5Hov5nkuKrmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIENvcmVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIENvcmVNZXNzYWdlLk1FU1NBR0VfRElTUEFUQ0hFRCA9IFwibWVzc2FnZURpc3BhdGNoZWRcIjtcclxuICAgIHJldHVybiBDb3JlTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQ29yZU1lc3NhZ2U7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvbWVzc2FnZS9Db3JlTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gMzFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gMzJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgY3JlYXRlRXZhbEZ1bmMgfSBmcm9tIFwiLi9VdGlsc1wiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTEtMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTEtMDZcclxuICpcclxuICog5pWw5o2u5pu05paw6K6i6ZiF6ICF77yM5b2T5L6d6LWW55qE5pWw5o2u5pyJ5pu05paw5pe25Lya6Kem5Y+RY2FsbGJhY2vpgJrnn6XlpJbpnaJcclxuKi9cclxudmFyIFdhdGNoZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXYXRjaGVyKGJpbmQsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBzY29wZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDY7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBzY29wZXNbX2kgLSA2XSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VkID0gZmFsc2U7XHJcbiAgICAgICAgLy8g6K6w5b2VQmluZOWunuS+i1xyXG4gICAgICAgIHRoaXMuX2JpbmQgPSBiaW5kO1xyXG4gICAgICAgIC8vIOiusOW9leS9nOeUqOebruagh+OAgeihqOi+vuW8j+WSjOS9nOeUqOWfn1xyXG4gICAgICAgIHRoaXMuX2N1cnJlbnRUYXJnZXQgPSBjdXJyZW50VGFyZ2V0O1xyXG4gICAgICAgIHRoaXMuX3RhcmdldCA9IHRhcmdldDtcclxuICAgICAgICB0aGlzLl9leHAgPSBleHA7XHJcbiAgICAgICAgdGhpcy5fdGhpc0FyZyA9IHRoaXNBcmc7XHJcbiAgICAgICAgdGhpcy5fc2NvcGVzID0gc2NvcGVzO1xyXG4gICAgICAgIC8vIOWwhuihqOi+vuW8j+WSjOS9nOeUqOWfn+ino+aekOS4uuS4gOS4qkZ1bmN0aW9uXHJcbiAgICAgICAgdGhpcy5fZXhwRnVuYyA9IGNyZWF0ZUV2YWxGdW5jKGV4cCwgMSArIHNjb3Blcy5sZW5ndGgpO1xyXG4gICAgICAgIC8vIOiusOW9leWbnuiwg+WHveaVsFxyXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgICAgICAgLy8g6L+b6KGM6aaW5qyh5pu05pawXHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXYXRjaGVyLnByb3RvdHlwZSwgXCJkaXNwb3NlZFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6K+l6KeC5a+f6ICF5piv5ZCm5bey57uP6KKr6ZSA5q+BXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgV2F0Y2hlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWIsOihqOi+vuW8j+W9k+WJjeacgOaWsOWAvFxyXG4gICAgICogQHJldHVybnMge2FueX0g5pyA5paw5YC8XHJcbiAgICAgKi9cclxuICAgIFdhdGNoZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIHZhbHVlO1xyXG4gICAgICAgIC8vIOiusOW9leiHqui6q1xyXG4gICAgICAgIFdhdGNoZXIudXBkYXRpbmcgPSB0aGlzO1xyXG4gICAgICAgIC8vIOiuvue9rumAmueUqOWxnuaAp1xyXG4gICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgJHRoaXM6IHRoaXMuX2JpbmQubWVkaWF0b3IsXHJcbiAgICAgICAgICAgICRkYXRhOiB0aGlzLl9iaW5kLm1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgJGJyaWRnZTogdGhpcy5fYmluZC5tZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICRjdXJyZW50VGFyZ2V0OiB0aGlzLl9jdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAkdGFyZ2V0OiB0aGlzLl90YXJnZXRcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOihqOi+vuW8j+axguWAvFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gKF9hID0gdGhpcy5fZXhwRnVuYykuY2FsbC5hcHBseShfYSwgW3RoaXMuX3RoaXNBcmddLmNvbmNhdCh0aGlzLl9zY29wZXMsIFtjb21tb25TY29wZV0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAvLyDovpPlh7rplJnor6/ml6Xlv5dcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwi6KGo6L6+5byP5rGC5YC86ZSZ6K+vXFxuZXJyOiBcIiArIGVyci50b1N0cmluZygpICsgXCJcXG5leHDvvJpcIiArIHRoaXMuX2V4cCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOenu+mZpOiHqui6q+iusOW9lVxyXG4gICAgICAgIFdhdGNoZXIudXBkYXRpbmcgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPkvp3otZbnmoTmlbDmja7mnInmm7TmlrDml7bosIPnlKjor6Xmlrnms5VcclxuICAgICAqIEBwYXJhbSBleHRyYSDlj6/og73nmoTpop3lpJbmlbDmja5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGV4dHJhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xyXG4gICAgICAgIGlmICghV2F0Y2hlci5pc0VxdWFsKHZhbHVlLCB0aGlzLl92YWx1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgJiYgdGhpcy5fY2FsbGJhY2sodmFsdWUsIHRoaXMuX3ZhbHVlLCBleHRyYSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gV2F0Y2hlci5kZWVwQ29weSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDplIDmr4HorqLpmIXogIUgKi9cclxuICAgIFdhdGNoZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3RhcmdldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fZXhwID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zY29wZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2V4cEZ1bmMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmK/lkKbnm7jnrYnvvIzljIXmi6zln7rnoYDnsbvlnovlkozlr7nosaEv5pWw57uE55qE5a+55q+UXHJcbiAgICAgKi9cclxuICAgIFdhdGNoZXIuaXNFcXVhbCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIChhID09IGIgfHwgKFdhdGNoZXIuaXNPYmplY3QoYSkgJiYgV2F0Y2hlci5pc09iamVjdChiKVxyXG4gICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGEpID09IEpTT04uc3RyaW5naWZ5KGIpXHJcbiAgICAgICAgICAgIDogZmFsc2UpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuS4uuWvueixoSjljIXmi6zmlbDnu4TjgIHmraPliJnnrYkpXHJcbiAgICAgKi9cclxuICAgIFdhdGNoZXIuaXNPYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIChvYmogJiYgdHlwZW9mIG9iaiA9PSBcIm9iamVjdFwiKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWkjeWItuWvueixoe+8jOiLpeS4uuWvueixoeWImea3seW6puWkjeWItlxyXG4gICAgICovXHJcbiAgICBXYXRjaGVyLmRlZXBDb3B5ID0gZnVuY3Rpb24gKGZyb20pIHtcclxuICAgICAgICBpZiAoV2F0Y2hlci5pc09iamVjdChmcm9tKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8g5aSN5p2C57G75Z6L5a+56LGh77yM5YWI5a2X56ym5Liy5YyW77yM5YaN5a+56LGh5YyWXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShmcm9tKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikgeyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWfuuacrOexu+Wei+WvueixoeWSjOaXoOazleWkjeWItueahOWvueixoe+8jOebtOaOpei/lOWbnuS5i1xyXG4gICAgICAgIHJldHVybiBmcm9tO1xyXG4gICAgfTtcclxuICAgIC8qKiDorrDlvZXlvZPliY3mraPlnKjmiafooYx1cGRhdGXmlrnms5XnmoRXYXRjaGVy5byV55SoICovXHJcbiAgICBXYXRjaGVyLnVwZGF0aW5nID0gbnVsbDtcclxuICAgIFdhdGNoZXIuX3VpZCA9IDA7XHJcbiAgICByZXR1cm4gV2F0Y2hlcjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgV2F0Y2hlcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvV2F0Y2hlci5qc1xuLy8gbW9kdWxlIGlkID0gMzNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuLi8uLi91dGlscy9EaWN0aW9uYXJ5XCI7XHJcbmltcG9ydCBCaW5kIGZyb20gXCIuL0JpbmRcIjtcclxuaW1wb3J0IHsgZXZhbEV4cCwgY3JlYXRlUnVuRnVuYyB9IGZyb20gXCIuL1V0aWxzXCI7XHJcbmltcG9ydCB7IG5ldE1hbmFnZXIgfSBmcm9tIFwiLi4vbmV0L05ldE1hbmFnZXJcIjtcclxuaW1wb3J0IHsgZ2V0T2JqZWN0SGFzaHMsIGV4dGVuZE9iamVjdCB9IGZyb20gXCIuLi8uLi91dGlscy9PYmplY3RVdGlsXCI7XHJcbmltcG9ydCB7IHJlcGxhY2VEaXNwbGF5IH0gZnJvbSBcIi4uLy4uL3V0aWxzL0Rpc3BsYXlVdGlsXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMS0wNlxyXG4gKlxyXG4gKiDnu5HlrprnrqHnkIblmajvvIzlj6/ku6XlsIbmlbDmja7lkozmmL7npLrlr7nosaHnu5HlrprliLDkuIDotbfvvIxNVlZN5Lmm5YaZ55WM6Z2iXHJcbiovXHJcbnZhciBCaW5kTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJpbmRNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX2JpbmREaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICB0aGlzLl9yZWdFeHAgPSAvXlxccyooXFx3KylcXHMrKChpbil8KG9mKSlcXHMrKC4rPylcXHMqJC87XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumuaVsOaNruWIsFVJ5LiKXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHJldHVybnMge0JpbmR9IOi/lOWbnue7keWumuWunuS+i1xyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICBpZiAoIWJpbmREYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2JpbmREaWN0LnNldChtZWRpYXRvciwgYmluZERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBiaW5kOiBuZXcgQmluZChtZWRpYXRvciksXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFja3M6IFtdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDph43mlrDnu5HlrprmiYDmnIlcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gYmluZERhdGEuY2FsbGJhY2tzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/lOWbnkJpbmTlr7nosaFcclxuICAgICAgICByZXR1cm4gYmluZERhdGEuYmluZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOe7keWumlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvclxyXG4gICAgICogQHJldHVybnMge0JpbmR9XHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIHZhciBiaW5kRGF0YSA9IHRoaXMuX2JpbmREaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICAgICAgaWYgKGJpbmREYXRhKSB7XHJcbiAgICAgICAgICAgIGJpbmREYXRhLmJpbmQuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9iaW5kRGljdC5kZWxldGUobWVkaWF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYmluZERhdGEgJiYgYmluZERhdGEuYmluZDtcclxuICAgIH07XHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYWRkQmluZEhhbmRsZXIgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOWIpOaWreaVsOaNruaYr+WQpuWQiOazlVxyXG4gICAgICAgICAgICBpZiAoIW1lZGlhdG9yLnZpZXdNb2RlbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgLy8g5byA5aeL57uR5a6aXHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDmt7vliqDnu5HlrprmlbDmja5cclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIGlmIChiaW5kRGF0YS5jYWxsYmFja3MuaW5kZXhPZihoYW5kbGVyKSA8IDApXHJcbiAgICAgICAgICAgIGJpbmREYXRhLmNhbGxiYWNrcy5wdXNoKGhhbmRsZXIpO1xyXG4gICAgICAgIC8vIOeri+WNs+iwg+eUqOS4gOasoVxyXG4gICAgICAgIGhhbmRsZXIoKTtcclxuICAgIH07XHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuZ2V0TmVhcmVzdEFuY2VzdG9yID0gZnVuY3Rpb24gKGJyaWRnZSwgdGFyZ2V0LCBwcm9wTmFtZSkge1xyXG4gICAgICAgIGlmICghdGFyZ2V0IHx8IHRhcmdldFtwcm9wTmFtZV0pXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXROZWFyZXN0QW5jZXN0b3IoYnJpZGdlLCBicmlkZ2UuZ2V0UGFyZW50KHRhcmdldCksIHByb3BOYW1lKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumuWxnuaAp+WAvFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7Kn0gY3VycmVudFRhcmdldCDnu5HlrprliLDnmoR0YXJnZXTlrp7kvZPlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOe7keWumuWRveS7pOacrOadpeaJgOWcqOeahOWvueixoVxyXG4gICAgICogQHBhcmFtIHthbnlbXX0gZW52TW9kZWxzIOeOr+Wig+WPmOmHj+aVsOe7hFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg57uR5a6a55qE5bGe5oCn5ZCNXHJcbiAgICAgKiBAcGFyYW0geyhFdmFsRXhwKX0gZXhwIOe7keWumueahOihqOi+vuW8j+aIluaWueazlVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kVmFsdWUgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lLCBleHApIHtcclxuICAgICAgICB2YXIgd2F0Y2hlcjtcclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIHRoaXMuYWRkQmluZEhhbmRsZXIobWVkaWF0b3IsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5LmL5YmN57uR5a6a6L+H77yM5YiZ6KaB5YWI6ZSA5q+B5LmLXHJcbiAgICAgICAgICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgICAgICAgICAgd2F0Y2hlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIC8vIOe7keWumuaWsOeahOiuoumYheiAhVxyXG4gICAgICAgICAgICB3YXRjaGVyID0gKF9hID0gYmluZERhdGEuYmluZCkuY3JlYXRlV2F0Y2hlci5hcHBseShfYSwgW2N1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0W25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9LCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChlbnZNb2RlbHMsIFttZWRpYXRvci52aWV3TW9kZWxdKSk7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumuS4gOS4quihqOi+vuW8j++8jOS4jmJpbmRWYWx1Zeexu+S8vO+8jOS9huS4jeS8mue7meWxnuaAp+i1i+WAvFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7Kn0gY3VycmVudFRhcmdldCDnu5HlrprliLDnmoR0YXJnZXTlrp7kvZPlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOe7keWumuWRveS7pOacrOadpeaJgOWcqOeahOWvueixoVxyXG4gICAgICogQHBhcmFtIHthbnlbXX0gZW52TW9kZWxzIOeOr+Wig+WPmOmHj+aVsOe7hFxyXG4gICAgICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDnu5HlrprnmoTooajovr7lvI/miJbmlrnms5VcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZEV4cCA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCkge1xyXG4gICAgICAgIHZhciB3YXRjaGVyO1xyXG4gICAgICAgIHZhciBiaW5kRGF0YSA9IHRoaXMuX2JpbmREaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICAgICAgdGhpcy5hZGRCaW5kSGFuZGxlcihtZWRpYXRvciwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuYvliY3nu5Hlrprov4fvvIzliJnopoHlhYjplIDmr4HkuYtcclxuICAgICAgICAgICAgaWYgKHdhdGNoZXIpXHJcbiAgICAgICAgICAgICAgICB3YXRjaGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgLy8g57uR5a6a5paw55qE6K6i6ZiF6ICFXHJcbiAgICAgICAgICAgIHdhdGNoZXIgPSAoX2EgPSBiaW5kRGF0YS5iaW5kKS5jcmVhdGVXYXRjaGVyLmFwcGx5KF9hLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBleHAsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS4jeW5suS7u+S9leS6i+aDhVxyXG4gICAgICAgICAgICAgICAgfSwgbWVkaWF0b3Iudmlld01vZGVsXS5jb25jYXQoZW52TW9kZWxzLCBbbWVkaWF0b3Iudmlld01vZGVsXSkpO1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5Hlrprmlrnms5XmiafooYxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumueahOaWueazleWQjVxyXG4gICAgICogQHBhcmFtIHsuLi4oRXZhbEV4cClbXX0gYXJnRXhwcyDmiafooYzmlrnms5XnmoTlj4LmlbDooajovr7lvI/miJbmlrnms5XliJfooahcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZEZ1bmMgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgYXJnRXhwcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gNTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ0V4cHNbX2kgLSA1XSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB3YXRjaGVycyA9IFtdO1xyXG4gICAgICAgIHZhciBiaW5kRGF0YSA9IHRoaXMuX2JpbmREaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICAgICAgdGhpcy5hZGRCaW5kSGFuZGxlcihtZWRpYXRvciwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDliKTmlq3lj4LmlbDmlbDph4/vvIzml6Dlj4LmlbDmlrnms5XkuIDmrKHmgKfmiafooYzljbPlj6/vvIzml6DpnIDnu5HlrprvvIzmnInlj4LmlbDnmoTmlrnms5XliJnpnIDopoHmr4/mrKHlj4LmlbDmlLnlj5jlsLHmiafooYzkuIDmrKFcclxuICAgICAgICAgICAgaWYgKGFyZ0V4cHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5bCG6KGo6L6+5byP5Lit5omA5pyJdW5kZWZpbmVk5ZKMbnVsbOWPmOS4uuWGhemDqOWAvFxyXG4gICAgICAgICAgICAgICAgdmFyIHVuZGVmaW5lZFZhbHVlID0gRGF0ZS5ub3coKSAqIE1hdGgucmFuZG9tKCkgKyBcIl91bmRlZmluZWRcIjtcclxuICAgICAgICAgICAgICAgIHZhciBudWxsVmFsdWUgPSBEYXRlLm5vdygpICogTWF0aC5yYW5kb20oKSArIFwiX251bGxcIjtcclxuICAgICAgICAgICAgICAgIGFyZ0V4cHMgPSBhcmdFeHBzLm1hcChmdW5jdGlvbiAoZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cCA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyB1bmRlZmluZWRWYWx1ZSArIFwiJ1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4cCA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiJ1wiICsgbnVsbFZhbHVlICsgXCInXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDnu5Hlrprooajovr7lvI/lj4LmlbDmlbDnu4RcclxuICAgICAgICAgICAgICAgIHZhciBpbml0VmFsdWUgPSB7fTtcclxuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJnc0luaXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bCGdmFsdWXkuK3nmoR1bmRlZmluZWTlkoxudWxs5oGi5aSN5Zue5Y67XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWRWYWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gbnVsbFZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Y+C5pWw5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tpbmRleF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3lj4LmlbDmmK/lkKbpvZDlhahcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWFyZ3NJbml0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhcmdzXzEgPSBhcmdzOyBfaSA8IGFyZ3NfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmcgPSBhcmdzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5YiX6KGo6YeM5a2Y5Zyo5Yid5aeL5YC877yM6KGo56S65rKh5pyJ6LWL5YC85a6M5q+V77yM55u05o6l6L+U5ZueXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJnID09PSBpbml0VmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruWIneWni+WMluWujOavleeKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzSW5pdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LWL5YC85bey57uP5a6M5q+V5LqG77yM6LCD55So5pa55rOV77yMdGhpc+aMh+WQkXVp5pys6LqrXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldFtuYW1lXS5hcHBseShjdXJyZW50VGFyZ2V0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDmuIXnkIbml6fnmoTorqLpmIXogIVcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB3YXRjaGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhdGNoZXJzLnNoaWZ0KCkuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5b6q546v57uR5a6a6KGo6L6+5byP5YiwaGFuZGxlclxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyZ0V4cHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXkuIDkuKrliJ3lp4vlgLzvvIznlKjkuo7liKTmlq3lj4LmlbDliJfooajmmK/lkKblt7LotYvlgLzlrozmr5VcclxuICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goaW5pdFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcmdFeHBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g57uR5a6a6KGo6L6+5byPXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdhdGNoZXIgPSAoX2EgPSBiaW5kRGF0YS5iaW5kKS5jcmVhdGVXYXRjaGVyLmFwcGx5KF9hLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBhcmdFeHBzW2ldLCBoYW5kbGVyLmJpbmQoX3RoaXMsIGkpLCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChlbnZNb2RlbHMsIFttZWRpYXRvci52aWV3TW9kZWxdKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V6K6i6ZiF6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgd2F0Y2hlcnMucHVzaCh3YXRjaGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaXoOWPguaVsOaJp+ihjO+8jOaXoOmcgOe7keWumu+8jOS4gOasoeaAp+aJp+ihjOWNs+WPr1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6a5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOe7keWumuWIsOeahHRhcmdldOWunuS9k+WvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBlbnZNb2RlbHMg546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDnu5HlrprnmoTkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7RXZhbEV4cH0gZXhwIOe7keWumueahOS6i+S7tuWbnuiwg+ihqOi+vuW8j+aIluaWueazlVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kT24gPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBleHApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYWRkQmluZEhhbmRsZXIobWVkaWF0b3IsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNvbW1vblNjb3BlID0ge1xyXG4gICAgICAgICAgICAgICAgJHRoaXM6IG1lZGlhdG9yLFxyXG4gICAgICAgICAgICAgICAgJGRhdGE6IG1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgICAgICRicmlkZ2U6IG1lZGlhdG9yLmJyaWRnZSxcclxuICAgICAgICAgICAgICAgICRjdXJyZW50VGFyZ2V0OiBjdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgJHRhcmdldDogdGFyZ2V0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIOiuoeeul+S6i+S7tmhhc2hcclxuICAgICAgICAgICAgdmFyIG9uSGFzaCA9IGdldE9iamVjdEhhc2hzKGN1cnJlbnRUYXJnZXQsIHR5cGUsIGV4cCk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOS5i+WJjea3u+WKoOi/h+ebkeWQrO+8jOWImeWFiOenu+mZpOS5i1xyXG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IGN1cnJlbnRUYXJnZXRbb25IYXNoXTtcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLmJyaWRnZS51bm1hcExpc3RlbmVyKGN1cnJlbnRUYXJnZXQsIHR5cGUsIGhhbmRsZXIsIG1lZGlhdG9yLnZpZXdNb2RlbCk7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlhYjlsJ3or5XnlKhleHDlvZPlgZrmlrnms5XlkI3ljrt2aWV3TW9kZWzph4zlr7vmib7vvIzlpoLmnpzmib7kuI3liLDliJnmiopleHDlvZPlgZrkuIDkuKrmiafooYzooajovr7lvI/lpITnkIbvvIzlpJbpnaLljIXkuIDlsYLmlrnms5VcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBleHAgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gbWVkaWF0b3Iudmlld01vZGVsW2V4cF07XHJcbiAgICAgICAgICAgIGlmICghKGhhbmRsZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmdW5jID0gY3JlYXRlUnVuRnVuYyhleHAsIDMgKyBlbnZNb2RlbHMubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIC8vIOi/memHjOimgei9rOS4gOaJi++8jOiusOWIsOmXreWMhemHjOS4gOS4quWJr+acrO+8jOWQpuWImeWboOS4umJpbmRPbuaYr+W7tui/n+aTjeS9nO+8jOWIsOaXtmVudk1vZGVs5Y+v6IO95bey6KKr5L+u5pS5XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5jYWxsLmFwcGx5KGZ1bmMsIFt0aGlzLCBjb21tb25TY29wZV0uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbCwgeyAkZXZlbnQ6IGV2ZW50IH1dKSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLmJyaWRnZS5tYXBMaXN0ZW5lcihjdXJyZW50VGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCBtZWRpYXRvci52aWV3TW9kZWwpO1xyXG4gICAgICAgICAgICAvLyDlsIbkuovku7blm57osIPorrDlvZXliLDmmL7npLrlr7nosaHkuIpcclxuICAgICAgICAgICAgY3VycmVudFRhcmdldFtvbkhhc2hdID0gaGFuZGxlcjtcclxuICAgICAgICAgICAgLy8g5aaC5p6cX19iaW5kX3N1Yl9ldmVudHNfX+WIl+ihqOWtmOWcqO+8jOWImeWwhuS6i+S7tuiusOW9leWIsOWFtuS4ilxyXG4gICAgICAgICAgICB2YXIgbmVhcmVzdEFuY2VzdG9yID0gX3RoaXMuZ2V0TmVhcmVzdEFuY2VzdG9yKG1lZGlhdG9yLmJyaWRnZSwgdGFyZ2V0LCBcIl9fYmluZF9zdWJfZXZlbnRzX19cIik7XHJcbiAgICAgICAgICAgIHZhciBldmVudHMgPSAobmVhcmVzdEFuY2VzdG9yIHx8IHRhcmdldCkuX19iaW5kX3N1Yl9ldmVudHNfXztcclxuICAgICAgICAgICAgaWYgKGV2ZW50cykge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogY3VycmVudFRhcmdldCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXI6IGhhbmRsZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc0FyZzogbWVkaWF0b3Iudmlld01vZGVsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6a5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOe7keWumuWIsOeahHRhcmdldOWunuS9k+WvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBlbnZNb2RlbHMg546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge0V2YWxFeHB9IGV4cCDnu5Hlrprooajovr7lvI/miJbmlrnms5VcclxuICAgICAqIEBwYXJhbSB7KHZhbHVlOmJvb2xlYW4pPT52b2lkfSBbY2FsbGJhY2tdIOWIpOaWreadoeS7tuaUueWPmOaXtuS8muinpuWPkei/meS4quWbnuiwg1xyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kSWYgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBleHAsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHdhdGNoZXI7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB2YXIgcmVwbGFjZXIgPSBtZWRpYXRvci5icmlkZ2UuY3JlYXRlRW1wdHlEaXNwbGF5KCk7XHJcbiAgICAgICAgdGhpcy5hZGRCaW5kSGFuZGxlcihtZWRpYXRvciwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuYvliY3nu5Hlrprov4fvvIzliJnopoHlhYjplIDmr4HkuYtcclxuICAgICAgICAgICAgaWYgKHdhdGNoZXIpXHJcbiAgICAgICAgICAgICAgICB3YXRjaGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgLy8g57uR5a6a6KGo6L6+5byPXHJcbiAgICAgICAgICAgIHdhdGNoZXIgPSAoX2EgPSBiaW5kRGF0YS5iaW5kKS5jcmVhdGVXYXRjaGVyLmFwcGx5KF9hLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBleHAsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOihqOi+vuW8j+S4unRydWXliJnmmL7npLp1ae+8jOWQpuWImeenu+mZpHVpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlRGlzcGxheShtZWRpYXRvci5icmlkZ2UsIHJlcGxhY2VyLCBjdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VEaXNwbGF5KG1lZGlhdG9yLmJyaWRnZSwgY3VycmVudFRhcmdldCwgcmVwbGFjZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOinpuWPkeWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0sIG1lZGlhdG9yLnZpZXdNb2RlbF0uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbF0pKTtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6a5b6q546vXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOe7keWumuWIsOeahHRhcmdldOWunuS9k+WvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBlbnZNb2RlbHMg546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwIOW+queOr+ihqOi+vuW8j++8jOW9ouWmgu+8mlwiYSBpbiBiXCLvvIjooajnpLph6YGN5Y6GYuS4reeahGtlee+8ieaIllwiYSBvZiBiXCLvvIjooajnpLph6YGN5Y6GYuS4reeahOWAvO+8ieOAgmLlj6/ku6XmmK/kuKrooajovr7lvI9cclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yQ29uc3RydWN0b3J9IFttZWRpYXRvckNsc10g5o+Q5L6b6K+l5Y+C5pWw5bCG5L2/55So5o+Q5L6b55qE5Lit5LuL6ICF5YyF6KOF5q+P5LiA5Liq5riy5p+T5ZmoXHJcbiAgICAgKiBAcGFyYW0geyhkYXRhOmFueSwgcmVuZGVyZXI6YW55LCBlbnZNb2RlbHM6YW55W10pPT52b2lkfSBbY2FsbGJhY2tdIOavj+asoeeUn+aIkOaWsOeahHJlbmRlcmVy5a6e5L6L5pe26LCD55So6L+Z5Liq5Zue6LCDXHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmJpbmRGb3IgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBleHAsIG1lZGlhdG9yQ2xzLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHdhdGNoZXI7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB2YXIgcmVwbGFjZXIgPSBtZWRpYXRvci5icmlkZ2UuY3JlYXRlRW1wdHlEaXNwbGF5KCk7XHJcbiAgICAgICAgdmFyIHN1Yk1lZGlhdG9yQ2FjaGUgPSBbXTtcclxuICAgICAgICB0aGlzLmFkZEJpbmRIYW5kbGVyKG1lZGlhdG9yLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOino+aekOihqOi+vuW8j1xyXG4gICAgICAgICAgICB2YXIgcmVzID0gX3RoaXMuX3JlZ0V4cC5leGVjKGV4cCk7XHJcbiAgICAgICAgICAgIGlmICghcmVzKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAvLyDljIXoo4XmuLLmn5PlmajliJvlu7rlm57osINcclxuICAgICAgICAgICAgdmFyIG1lbWVudG8gPSBtZWRpYXRvci5icmlkZ2Uud3JhcEJpbmRGb3IoY3VycmVudFRhcmdldCwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIHJlbmRlcmVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7njq/looPlj5jph49cclxuICAgICAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAka2V5OiBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgJHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAkcGFyZW50OiBlbnZNb2RlbHNbMF0gfHwgbWVkaWF0b3Iudmlld01vZGVsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy8g5aGr5YWl55So5oi35aOw5piO55qE5bGe5oCnXHJcbiAgICAgICAgICAgICAgICBjb21tb25TY29wZVtyZXNbMV1dID0gKHJlc1syXSA9PSBcImluXCIgPyBrZXkgOiB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDnlJ/miJDkuIDkuKrnjq/looPlj5jph4/nmoTlia/mnKxcclxuICAgICAgICAgICAgICAgIHZhciBzdWJFbnZNb2RlbHMgPSBlbnZNb2RlbHMuY29uY2F0KCk7XHJcbiAgICAgICAgICAgICAgICAvLyDmj5LlhaXnjq/looPlj5jph49cclxuICAgICAgICAgICAgICAgIHN1YkVudk1vZGVscy51bnNoaWZ0KGNvbW1vblNjb3BlKTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenHJlbmRlcmVy5bey57uP5pyJ5LqL5Lu25YiX6KGo5LqG77yM6K+05piOcmVuZGVyZXLmmK/ooqvph43nlKjnmoTvvIzliKDpmaTmiYDmnInkuovku7ZcclxuICAgICAgICAgICAgICAgIHZhciBldmVudHMgPSByZW5kZXJlci5fX2JpbmRfc3ViX2V2ZW50c19fO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBldmVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGV2ZW50cy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5icmlkZ2UudW5tYXBMaXN0ZW5lcihkYXRhLnRhcmdldCwgZGF0YS50eXBlLCBkYXRhLmhhbmRsZXIsIGRhdGEudGhpc0FyZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDkuLpyZW5kZXJlcuiuvue9ruWtkOWvueixoeS6i+S7tuWIl+ihqFxyXG4gICAgICAgICAgICAgICAgaWYgKCFldmVudHMpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuX19iaW5kX3N1Yl9ldmVudHNfXyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy8g5Li6cmVuZGVyZXLlpZfkuIDkuKpNZWRpYXRvcuWkluWjs1xyXG4gICAgICAgICAgICAgICAgaWYgKG1lZGlhdG9yQ2xzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yk1lZGlhdG9yID0gbmV3IG1lZGlhdG9yQ2xzKHJlbmRlcmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmm7TmlrDmuLLmn5PlmahcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViTWVkaWF0b3Iuc2tpbiAmJiBzdWJNZWRpYXRvci5icmlkZ2UgPT09IG1lZGlhdG9yLmJyaWRnZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIgPSBzdWJNZWRpYXRvci5za2luO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaJmOeuoeWtkOS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yLmRlbGVnYXRlTWVkaWF0b3Ioc3ViTWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS9v+eUqOW9k+WJjeaJgOacieeahOaVsOaNruW8gOWQr+ivpeS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgIHN1Yk1lZGlhdG9yLm9wZW4oZXh0ZW5kT2JqZWN0LmFwcGx5KHZvaWQgMCwgW3t9XS5jb25jYXQoc3ViRW52TW9kZWxzLCBbdmFsdWVdKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOe8k+WtmOWtkOS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgIHN1Yk1lZGlhdG9yQ2FjaGUucHVzaChzdWJNZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDop6blj5Hlm57osIPvvIzov5vooYzlhoXpg6jnvJbor5FcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKHZhbHVlLCByZW5kZXJlciwgc3ViRW52TW9kZWxzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOS5i+WJjee7keWumui/h++8jOWImeimgeWFiOmUgOavgeS5i1xyXG4gICAgICAgICAgICBpZiAod2F0Y2hlcilcclxuICAgICAgICAgICAgICAgIHdhdGNoZXIuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICAvLyDojrflvpfopoHpgY3ljobnmoTmlbDmja7pm4blkIhcclxuICAgICAgICAgICAgd2F0Y2hlciA9IChfYSA9IGJpbmREYXRhLmJpbmQpLmNyZWF0ZVdhdGNoZXIuYXBwbHkoX2EsIFtjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIHJlc1s1XSwgZnVuY3Rpb24gKGRhdGFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c6YGN5Y6G55qE5a+56LGh5piv5Liq5pWw5a2X77yM5YiZ5Lyq6YCg5LiA5Liq5Li05pe25pWw57uE5L6b5L2/55SoXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhcyA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcEFyciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBBcnIucHVzaChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhcyA9IHRlbXBBcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa4heepuuW3suacieeahOWtkOS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzdWJNZWRpYXRvckNhY2hlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJNZWRpYXRvciA9IHN1Yk1lZGlhdG9yQ2FjaGUuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3IudW5kZWxlZ2F0ZU1lZGlhdG9yKHN1Yk1lZGlhdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViTWVkaWF0b3IuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDotYvlgLxcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5icmlkZ2UudmFsdWF0ZUJpbmRGb3IoY3VycmVudFRhcmdldCwgZGF0YXMsIG1lbWVudG8pO1xyXG4gICAgICAgICAgICAgICAgfSwgbWVkaWF0b3Iudmlld01vZGVsXS5jb25jYXQoZW52TW9kZWxzLCBbbWVkaWF0b3Iudmlld01vZGVsXSkpO1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5HlrppNZXNzYWdlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOe7keWumuWIsOeahHRhcmdldOWunuS9k+WvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBlbnZNb2RlbHMg546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge0lDb25zdHJ1Y3RvcnxzdHJpbmd9IHR5cGUg57uR5a6a55qE5raI5oGv57G75Z6L5a2X56ym5LiyXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSDnu5HlrprnmoTlsZ7mgKflkI1cclxuICAgICAqIEBwYXJhbSB7RXZhbEV4cH0gZXhwIOe7keWumueahOihqOi+vuW8j+aIluaWueazlVxyXG4gICAgICogQHBhcmFtIHtJT2JzZXJ2YWJsZX0gW29ic2VydmFibGVdIOe7keWumueahOa2iOaBr+WGheaguO+8jOm7mOiupOaYr2NvcmVcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZE1lc3NhZ2UgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpIHtcclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobWVkaWF0b3IuZGlzcG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIG1lZGlhdG9y5bey6ZSA5q+B77yM5Y+W5raI55uR5ZCsXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLnVubGlzdGVuKHR5cGUsIGhhbmRsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1zZztcclxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxICYmIHR5cGVvZiBhcmdzWzBdID09IFwib2JqZWN0XCIgJiYgYXJnc1swXS50eXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIG1zZyA9IGFyZ3NbMF07XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgbXNnID0geyAkYXJndW1lbnRzOiBhcmdzIH07XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7pgJrnlKjlsZ7mgKdcclxuICAgICAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpczogbWVkaWF0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgJGRhdGE6IG1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgICAgICAgICAkYnJpZGdlOiBtZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgJHRhcmdldDogdGFyZ2V0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldFtuYW1lXSA9IGV2YWxFeHAuYXBwbHkodm9pZCAwLCBbZXhwLCBtZWRpYXRvci52aWV3TW9kZWwsIG1zZ10uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbCwgY29tbW9uU2NvcGVdKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOa3u+WKoOebkeWQrFxyXG4gICAgICAgIG9ic2VydmFibGUubGlzdGVuKHR5cGUsIGhhbmRsZXIpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6aUmVzcG9uc2VcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7SVJlc3BvbnNlRGF0YUNvbnN0cnVjdG9yfHN0cmluZ30gdHlwZSDnu5HlrprnmoTpgJrorq/mtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumueahOWxnuaAp+WQjVxyXG4gICAgICogQHBhcmFtIHtFdmFsRXhwfSBleHAg57uR5a6a55qE6KGo6L6+5byP5oiW5pa55rOVXHJcbiAgICAgKiBAcGFyYW0ge0lPYnNlcnZhYmxlfSBbb2JzZXJ2YWJsZV0g57uR5a6a55qE5raI5oGv5YaF5qC477yM6buY6K6k5pivY29yZVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kUmVzcG9uc2UgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpIHtcclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICBpZiAobWVkaWF0b3IuZGlzcG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIG1lZGlhdG9y5bey6ZSA5q+B77yM5Y+W5raI55uR5ZCsXHJcbiAgICAgICAgICAgICAgICBuZXRNYW5hZ2VyLnVubGlzdGVuUmVzcG9uc2UodHlwZSwgaGFuZGxlciwgbnVsbCwgbnVsbCwgb2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7pgJrnlKjlsZ7mgKdcclxuICAgICAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpczogbWVkaWF0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgJGRhdGE6IG1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgICAgICAgICAkYnJpZGdlOiBtZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgJHRhcmdldDogdGFyZ2V0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldFtuYW1lXSA9IGV2YWxFeHAuYXBwbHkodm9pZCAwLCBbZXhwLCBtZWRpYXRvci52aWV3TW9kZWwsIHJlc3BvbnNlXS5jb25jYXQoZW52TW9kZWxzLCBbbWVkaWF0b3Iudmlld01vZGVsLCBjb21tb25TY29wZV0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5re75Yqg55uR5ZCsXHJcbiAgICAgICAgbmV0TWFuYWdlci5saXN0ZW5SZXNwb25zZSh0eXBlLCBoYW5kbGVyLCBudWxsLCBudWxsLCBvYnNlcnZhYmxlKTtcclxuICAgICAgICAvLyDlpoLmnpxtZWRpYXRvcuaJgOS+nei1lueahOaooeWdl+acieWIneWni+WMlua2iOaBr++8jOWImeimgemineWkluinpuWPkeWIneWni+WMlua2iOaBr+eahOe7keWumlxyXG4gICAgICAgIGlmIChtZWRpYXRvcltcImRlcGVuZE1vZHVsZUluc3RhbmNlXCJdKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBtZWRpYXRvcltcImRlcGVuZE1vZHVsZUluc3RhbmNlXCJdLnJlc3BvbnNlczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJpbmRNYW5hZ2VyID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBCaW5kTWFuYWdlcik7XHJcbiAgICByZXR1cm4gQmluZE1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEJpbmRNYW5hZ2VyO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgYmluZE1hbmFnZXIgPSBjb3JlLmdldEluamVjdChCaW5kTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0JpbmRNYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgUmVxdWVzdERhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZXF1ZXN0RGF0YSgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnlKjmiLflj4LmlbDvvIzlj6/ku6Xkv53lrZjku7vmhI/lj4LmlbDliLBNZXNzYWdl5Lit77yM6K+l5Y+C5pWw5Lit55qE5pWw5o2u5LiN5Lya6KKr5Y+R6YCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Kn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgUmVxdWVzdERhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9fdXNlckRhdGEgPSB7fTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmK/lkKblnKjmjqXliLDov5Tlm57liY3kvb/nlKhsb2FkaW5n57G75Z6L6YGu572p6KaG55uW5YWo5bGP77yM6Ziy5q2i55So5oi35pON5L2c77yM6buY6K6k5pivdHJ1ZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFJlcXVlc3REYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fX3VzZU1hc2sgPSB0cnVlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+a0vuWPkeWGheaguOWIl+ihqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX19vYnNlcnZhYmxlcyA9IFtdO1xyXG4gICAgICAgIC8vIOemgeaOiemDqOWIhuacrOWcsOWPmOmHj+eahOWPr+mBjeWOhuaAp1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcclxuICAgICAgICAgICAgX191c2VyRGF0YToge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9fdXNlckRhdGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX19vYnNlcnZhYmxlczoge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9fb2JzZXJ2YWJsZXNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlcXVlc3REYXRhLnByb3RvdHlwZSwgXCJfX29ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+W9k+WJjeaJgOWxnuWGheaguFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX29ic2VydmFibGVzWzBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlcXVlc3REYXRhLnByb3RvdHlwZSwgXCJfX29yaU9ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+aJgOWxnueahOWOn+Wni+WGheaguO+8iOesrOS4gOS4qua0vuWPkeWIsOeahOWGheaguO+8iVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX29ic2VydmFibGVzW3RoaXMuX19vYnNlcnZhYmxlcy5sZW5ndGggLSAxXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXF1ZXN0RGF0YS5wcm90b3R5cGUsIFwiX190eXBlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bor7fmsYLmtojmga/nsbvlnovlrZfnrKbkuLJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFJlcXVlc3REYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9fcGFyYW1zLnR5cGU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWGjeasoeWPkemAgea2iOaBr++8jOS8muS9v+eUqOmmluS4quWGheaguOmHjeaWsOWPkemAgeivpea2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICovXHJcbiAgICBSZXF1ZXN0RGF0YS5wcm90b3R5cGUucmVkaXNwYXRjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9fb3JpT2JzZXJ2YWJsZS5kaXNwYXRjaCh0aGlzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVxdWVzdERhdGE7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFJlcXVlc3REYXRhO1xyXG4vKiog5a+85Ye65YWs5YWx5raI5oGv5Y+C5pWw5a+56LGhICovXHJcbmV4cG9ydCB2YXIgY29tbW9uRGF0YSA9IHt9O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L1JlcXVlc3REYXRhLmpzXG4vLyBtb2R1bGUgaWQgPSAzNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog6KGo546w5bGC5raI5oGvXHJcbiovXHJcbnZhciBCcmlkZ2VNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQnJpZGdlTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW6KGo546w5bGC5a6e5L6L5YmN55qE5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBWaWV3TWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBCcmlkZ2VNZXNzYWdlLkJSSURHRV9CRUZPUkVfSU5JVCA9IFwiYnJpZGdlQmVmb3JlSW5pdFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbooajnjrDlsYLlrp7kvovlkI7nmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFZpZXdNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FGVEVSX0lOSVQgPSBcImJyaWRnZUFmdGVySW5pdFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiYDmnInooajnjrDlsYLlrp7kvovpg73liJ3lp4vljJblrozmr5XnmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFZpZXdNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FMTF9JTklUID0gXCJicmlkZ2VBbGxJbml0XCI7XHJcbiAgICByZXR1cm4gQnJpZGdlTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQnJpZGdlTWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IG5vbmUgZnJvbSBcIi4vTm9uZVNjZW5lUG9saWN5XCI7XHJcbmltcG9ydCBTY2VuZU1lc3NhZ2UgZnJvbSBcIi4vU2NlbmVNZXNzYWdlXCI7XHJcbmltcG9ydCB7IHdhaXQsIG5vdGlmeSB9IGZyb20gXCIuLi8uLi91dGlscy9TeW5jVXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDhcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDhcclxuICpcclxuICog5by556qX566h55CG5Zmo77yM5YyF5ZCr5YiH5o2i5Zy65pmv44CBcHVzaOWcuuaZr+OAgXBvcOWcuuaZr+WKn+iDvVxyXG4qL1xyXG52YXIgU1lOQ19OQU1FID0gXCJTY2VuZU1hbmFnZXJfc3luY1wiO1xyXG52YXIgQ2hhbmdlVHlwZTtcclxuKGZ1bmN0aW9uIChDaGFuZ2VUeXBlKSB7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJTd2l0Y2hcIl0gPSAwXSA9IFwiU3dpdGNoXCI7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJQdXNoXCJdID0gMV0gPSBcIlB1c2hcIjtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIlBvcFwiXSA9IDJdID0gXCJQb3BcIjtcclxufSkoQ2hhbmdlVHlwZSB8fCAoQ2hhbmdlVHlwZSA9IHt9KSk7XHJcbnZhciBTY2VuZU1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTY2VuZU1hbmFnZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fc2NlbmVTdGFjayA9IFtdO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjZW5lTWFuYWdlci5wcm90b3R5cGUsIFwiY3VycmVudFNjZW5lXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3lnLrmma9cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJU2NlbmV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFNjZW5lTWFuYWdlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2NlbmVTdGFja1swXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY2VuZU1hbmFnZXIucHJvdG90eXBlLCBcImFjdGl2ZUNvdW50XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmtLvliqjlnLrmma/kuKrmlbBcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFNjZW5lTWFuYWdlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2NlbmVTdGFjay5sZW5ndGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWcuuaZr+aYr+WQpuW3sue7j+W8gOWQr1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVNjZW5lfSBzY2VuZSDlnLrmma/lr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKblt7Lnu4/lvIDlkK9cclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5pc09wZW5lZCA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fc2NlbmVTdGFjay5pbmRleE9mKHNjZW5lKSA+PSAwKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouWcuuaZr++8jOabv+aNouW9k+WJjeWcuuaZr++8jOW9k+WJjeWcuuaZr+S8muiiq+mUgOavgVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVNjZW5lfSBzY2VuZSDopoHliIfmjaLliLDnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOimgeaQuuW4pue7meS4i+S4gOS4quWcuuaZr+eahOaVsOaNrlxyXG4gICAgICogQHJldHVybnMge0lTY2VuZX0g5Zy65pmv5pys5L2TXHJcbiAgICAgKiBAbWVtYmVyb2YgU2NlbmVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWFuYWdlci5wcm90b3R5cGUuc3dpdGNoID0gZnVuY3Rpb24gKHNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDpnZ7nqbrliKTmlq1cclxuICAgICAgICBpZiAoc2NlbmUgPT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOWmguaenOWIh+WFpeeahOaYr+esrOS4gOS4quWcuuaZr++8jOWImeaUueeUqHB1c2jmk43kvZxcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVDb3VudCA9PSAwKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wdXNoKHNjZW5lLCBkYXRhKTtcclxuICAgICAgICAvLyDlkIzmraXmiafooYxcclxuICAgICAgICB3YWl0KFNZTkNfTkFNRSwgdGhpcy5kb0NoYW5nZSwgdGhpcywgdGhpcy5jdXJyZW50U2NlbmUsIHNjZW5lLCBkYXRhLCBzY2VuZS5wb2xpY3kgfHwgc2NlbmUuYnJpZGdlLmRlZmF1bHRTY2VuZVBvbGljeSB8fCBub25lLCBDaGFuZ2VUeXBlLlN3aXRjaCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbGFzdFNjZW5lID0gX3RoaXMuX3NjZW5lU3RhY2tbMF07XHJcbiAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICBfdGhpcy5fc2NlbmVTdGFja1swXSA9IHNjZW5lO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfU1RBQ0tfQ0hBTkdFKTtcclxuICAgICAgICAgICAgLy8g6ZSA5q+BXHJcbiAgICAgICAgICAgIGxhc3RTY2VuZSAmJiBsYXN0U2NlbmUuZGlzcG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzY2VuZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaOqOWFpeWcuuaZr++8jOW9k+WJjeWcuuaZr+S4jeS8mumUgOavge+8jOiAjOaYr+i/m+WFpeWcuuaZr+agiOS/neWtmO+8jOS7peWQjuWPr+S7pemAmui/h3BvcFNjZW5l6YeN5paw5bGV546wXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJU2NlbmV9IHNjZW5lIOimgeaOqOWFpeeahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIHsqfSBbZGF0YV0g6KaB5pC65bim57uZ5LiL5LiA5Liq5Zy65pmv55qE5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB7SVNjZW5lfSDlnLrmma/mnKzkvZNcclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKHNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDpnZ7nqbrliKTmlq1cclxuICAgICAgICBpZiAoc2NlbmUgPT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuIHNjZW5lO1xyXG4gICAgICAgIC8vIOWQjOatpeaJp+ihjFxyXG4gICAgICAgIHdhaXQoU1lOQ19OQU1FLCB0aGlzLmRvQ2hhbmdlLCB0aGlzLCB0aGlzLmN1cnJlbnRTY2VuZSwgc2NlbmUsIGRhdGEsIHNjZW5lLnBvbGljeSB8fCBzY2VuZS5icmlkZ2UuZGVmYXVsdFNjZW5lUG9saWN5IHx8IG5vbmUsIENoYW5nZVR5cGUuUHVzaCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDmlbDmja7lhYjooYxcclxuICAgICAgICAgICAgX3RoaXMuX3NjZW5lU3RhY2sudW5zaGlmdChzY2VuZSk7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKFNjZW5lTWVzc2FnZS5TQ0VORV9TVEFDS19DSEFOR0UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzY2VuZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW8ueWHuuWcuuaZr++8jOW9k+WJjeWcuuaZr+S8muiiq+mUgOavge+8jOW9k+WJjeS9jeS6juagiOmhtueahOWcuuaZr+S8mumHjeaWsOaYvuekulxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVNjZW5lfSBzY2VuZSDopoHliIfmjaLlh7rnmoTlnLrmma/vvIzlpoLmnpzkvKDlhaXnmoTlnLrmma/kuI3mmK/lvZPliY3lnLrmma/liJnku4Xnp7vpmaTmjIflrprlnLrmma/vvIzkuI3kvJrov5vooYzliIfmjaLmk43kvZxcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOimgeaQuuW4pue7meS4i+S4gOS4quWcuuaZr+eahOaVsOaNrlxyXG4gICAgICogQHJldHVybnMge0lTY2VuZX0g5Zy65pmv5pys5L2TXHJcbiAgICAgKiBAbWVtYmVyb2YgU2NlbmVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWFuYWdlci5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKHNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g6Z2e56m65Yik5patXHJcbiAgICAgICAgaWYgKHNjZW5lID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBzY2VuZTtcclxuICAgICAgICAvLyDlkIzmraXmiafooYxcclxuICAgICAgICB3YWl0KFNZTkNfTkFNRSwgdGhpcy5kb1BvcCwgdGhpcywgc2NlbmUsIGRhdGEpO1xyXG4gICAgICAgIHJldHVybiBzY2VuZTtcclxuICAgIH07XHJcbiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLmRvUG9wID0gZnVuY3Rpb24gKHNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDlpoLmnpzmsqHmnInotrPlpJ/nmoTlnLrmma/lgqjlpIfliJnku4DkuYjpg73kuI3lgZpcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVDb3VudCA8PSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5Zy65pmv5qCI5Lit55qE5Zy65pmv5pWw6YeP5LiN6Laz77yM5peg5rOV5omn6KGMcG9w5pON5L2cXCIpO1xyXG4gICAgICAgICAgICAvLyDlrozmiJDmraXpqqRcclxuICAgICAgICAgICAgbm90aWZ5KFNZTkNfTkFNRSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6aqM6K+B5piv5ZCm5piv5b2T5YmN5Zy65pmv77yM5LiN5piv5YiZ55u05o6l56e76Zmk77yM5LiN5L2/55SoUG9saWN5XHJcbiAgICAgICAgdmFyIHRvID0gdGhpcy5fc2NlbmVTdGFja1sxXTtcclxuICAgICAgICB2YXIgcG9saWN5ID0gc2NlbmUucG9saWN5IHx8IHNjZW5lLmJyaWRnZS5kZWZhdWx0U2NlbmVQb2xpY3kgfHwgbm9uZTtcclxuICAgICAgICBpZiAodGhpcy5fc2NlbmVTdGFjay5pbmRleE9mKHNjZW5lKSAhPSAwKSB7XHJcbiAgICAgICAgICAgIHRvID0gbnVsbDtcclxuICAgICAgICAgICAgcG9saWN5ID0gbm9uZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5omn6KGM5YiH5o2iXHJcbiAgICAgICAgdGhpcy5kb0NoYW5nZShzY2VuZSwgdG8sIGRhdGEsIHBvbGljeSwgQ2hhbmdlVHlwZS5Qb3AsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g5pWw5o2u5YWI6KGMXHJcbiAgICAgICAgICAgIF90aGlzLl9zY2VuZVN0YWNrLnNwbGljZShfdGhpcy5fc2NlbmVTdGFjay5pbmRleE9mKHNjZW5lKSwgMSk7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKFNjZW5lTWVzc2FnZS5TQ0VORV9TVEFDS19DSEFOR0UpO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g6ZSA5q+BXHJcbiAgICAgICAgICAgIHNjZW5lLmRpc3Bvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLmRvQ2hhbmdlID0gZnVuY3Rpb24gKGZyb20sIHRvLCBkYXRhLCBwb2xpY3ksIHR5cGUsIGJlZ2luLCBjb21wbGV0ZSkge1xyXG4gICAgICAgIC8vIOWmguaenGZyb23lkox0b+acieS4gOS4quS4um51bGzliJlwb2xpY3nkuLpub25lXHJcbiAgICAgICAgaWYgKCFmcm9tIHx8ICF0bylcclxuICAgICAgICAgICAgcG9saWN5ID0gbm9uZTtcclxuICAgICAgICAvLyB0b+aMh+WumueahOWcuuaZr+W/hemhu+imgeaYvuekulxyXG4gICAgICAgIGlmICh0bylcclxuICAgICAgICAgICAgdG8uYnJpZGdlLmh0bWxXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xyXG4gICAgICAgIC8vIOWmguaenOimgeS6pOabv+eahOS4pOS4quWcuuaZr+S4jeaYr+WQjOS4gOS4quexu+Wei+eahOWcuuaZr++8jOWImeWIh+aNokhUTUxXcmFwcGVy5pi+56S677yM5LiUUG9saWN55Lmf6YeH55So5peg5YiH5o2i562W55WlXHJcbiAgICAgICAgaWYgKGZyb20gJiYgdG8gJiYgdG8uYnJpZGdlLnR5cGUgIT0gZnJvbS5icmlkZ2UudHlwZSkge1xyXG4gICAgICAgICAgICBmcm9tLmJyaWRnZS5odG1sV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIHBvbGljeSA9IG5vbmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIGJlZ2luICYmIGJlZ2luKCk7XHJcbiAgICAgICAgLy8g6I635Y+W5o6l5Y+j5byV55SoXHJcbiAgICAgICAgdmFyIHByZXBhcmVGdW5jO1xyXG4gICAgICAgIHZhciBkb0Z1bmM7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5Td2l0Y2g6XHJcbiAgICAgICAgICAgICAgICBwcmVwYXJlRnVuYyA9IHBvbGljeS5wcmVwYXJlU3dpdGNoO1xyXG4gICAgICAgICAgICAgICAgZG9GdW5jID0gcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUHVzaDpcclxuICAgICAgICAgICAgICAgIHByZXBhcmVGdW5jID0gcG9saWN5LnByZXBhcmVQdXNoIHx8IHBvbGljeS5wcmVwYXJlU3dpdGNoO1xyXG4gICAgICAgICAgICAgICAgZG9GdW5jID0gcG9saWN5LnB1c2ggfHwgcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUG9wOlxyXG4gICAgICAgICAgICAgICAgcHJlcGFyZUZ1bmMgPSBwb2xpY3kucHJlcGFyZVBvcCB8fCBwb2xpY3kucHJlcGFyZVN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGRvRnVuYyA9IHBvbGljeS5wb3AgfHwgcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliY3nva7lpITnkIZcclxuICAgICAgICB0byAmJiBmcm9tICYmIGZyb20ub25CZWZvcmVPdXQodG8sIGRhdGEpO1xyXG4gICAgICAgIHRvICYmIHRvLm9uQmVmb3JlSW4oZnJvbSwgZGF0YSk7XHJcbiAgICAgICAgLy8g5rS+5Y+R5LqL5Lu2XHJcbiAgICAgICAgdG8gJiYgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfQkVGT1JFX0NIQU5HRSwgdG8sIGZyb20pO1xyXG4gICAgICAgIC8vIOiwg+eUqOWHhuWkh+aOpeWPo1xyXG4gICAgICAgIHByZXBhcmVGdW5jICYmIHByZXBhcmVGdW5jLmNhbGwocG9saWN5LCBmcm9tLCB0byk7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgdG8gJiYgdG8uYnJpZGdlLmFkZENoaWxkKHRvLmJyaWRnZS5zY2VuZUxheWVyLCB0by5za2luKTtcclxuICAgICAgICAvLyDosIPnlKjliIfmjaLmjqXlj6NcclxuICAgICAgICBkb0Z1bmMuY2FsbChwb2xpY3ksIGZyb20sIHRvLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOaYvuekulxyXG4gICAgICAgICAgICB0byAmJiBmcm9tICYmIGZyb20uYnJpZGdlLnJlbW92ZUNoaWxkKGZyb20uYnJpZGdlLnNjZW5lTGF5ZXIsIGZyb20uc2tpbik7XHJcbiAgICAgICAgICAgIC8vIOWQjue9ruWkhOeQhlxyXG4gICAgICAgICAgICB0byAmJiBmcm9tICYmIGZyb20ub25BZnRlck91dCh0bywgZGF0YSk7XHJcbiAgICAgICAgICAgIHRvICYmIHRvLm9uQWZ0ZXJJbihmcm9tLCBkYXRhKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5LqL5Lu2XHJcbiAgICAgICAgICAgIHRvICYmIGNvcmUuZGlzcGF0Y2goU2NlbmVNZXNzYWdlLlNDRU5FX0FGVEVSX0NIQU5HRSwgdG8sIGZyb20pO1xyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgY29tcGxldGUgJiYgY29tcGxldGUoKTtcclxuICAgICAgICAgICAgLy8g5a6M5oiQ5q2l6aqkXHJcbiAgICAgICAgICAgIG5vdGlmeShTWU5DX05BTUUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNjZW5lTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgU2NlbmVNYW5hZ2VyKTtcclxuICAgIHJldHVybiBTY2VuZU1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFNjZW5lTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHNjZW5lTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KFNjZW5lTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDM3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDlnLrmma/nm7jlhbPnmoTmtojmga9cclxuKi9cclxudmFyIFNjZW5lTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNjZW5lTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv5YmN55qE5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZXNzYWdlLlNDRU5FX0JFRk9SRV9DSEFOR0UgPSBcInNjZW5lQmVmb3JlQ2hhbmdlXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouWcuuaZr+WQjueahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgU2NlbmVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWVzc2FnZS5TQ0VORV9BRlRFUl9DSEFOR0UgPSBcInNjZW5lQWZ0ZXJDaGFuZ2VcIjtcclxuICAgIC8qKlxyXG4gICAgICog5Zy65pmv5qCI5pWw5o2u5Y+Y5YyW5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZXNzYWdlLlNDRU5FX1NUQUNLX0NIQU5HRSA9IFwic2NlbmVTdGFja0NoYW5nZVwiO1xyXG4gICAgcmV0dXJuIFNjZW5lTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgU2NlbmVNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvU2NlbmVNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSAzOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTgtMDEtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTgtMDEtMzBcclxuICpcclxuICog6K+l5o6l5Y+j6KeE5a6a5LqG5Lit5LuL6ICF5YW35pyJ55qE5qih5Z2X6YOo5YiG5Yqf6IO9XHJcbiovXHJcbmV4cG9ydCB2YXIgTW9kdWxlT3BlblN0YXR1cztcclxuKGZ1bmN0aW9uIChNb2R1bGVPcGVuU3RhdHVzKSB7XHJcbiAgICBNb2R1bGVPcGVuU3RhdHVzW01vZHVsZU9wZW5TdGF0dXNbXCJTdG9wXCJdID0gMF0gPSBcIlN0b3BcIjtcclxuICAgIE1vZHVsZU9wZW5TdGF0dXNbTW9kdWxlT3BlblN0YXR1c1tcIkJlZm9yZU9wZW5cIl0gPSAxXSA9IFwiQmVmb3JlT3BlblwiO1xyXG4gICAgTW9kdWxlT3BlblN0YXR1c1tNb2R1bGVPcGVuU3RhdHVzW1wiQWZ0ZXJPcGVuXCJdID0gMl0gPSBcIkFmdGVyT3BlblwiO1xyXG59KShNb2R1bGVPcGVuU3RhdHVzIHx8IChNb2R1bGVPcGVuU3RhdHVzID0ge30pKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL0lNZWRpYXRvck1vZHVsZVBhcnQuanNcbi8vIG1vZHVsZSBpZCA9IDM5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxOC0wMy0yMlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxOC0wMy0yMlxyXG4gKlxyXG4gKiDmmL7npLrlt6XlhbdcclxuKi9cclxuLyoqXHJcbiAqIOabv+aNouaYvuekulxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUJyaWRnZX0gYnJpZGdlIOimgeS9v+eUqOeahOahpVxyXG4gKiBAcGFyYW0geyp9IGN1cnJlbnQg6KKr5pu/5o2i55qE5pi+56S6XHJcbiAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOabv+aNouaIkOS4uueahOaYvuekulxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VEaXNwbGF5KGJyaWRnZSwgY3VycmVudCwgdGFyZ2V0KSB7XHJcbiAgICAvLyDkuKTkuKrnmq7ogqTlv4Xpobvpg73mmK/pmrblsZ7moaXnmoTnmq7ogqRcclxuICAgIGlmIChicmlkZ2UuaXNNeVNraW4odGFyZ2V0KSAmJiBicmlkZ2UuaXNNeVNraW4oY3VycmVudCkpIHtcclxuICAgICAgICB2YXIgcGFyZW50ID0gYnJpZGdlLmdldFBhcmVudChjdXJyZW50KTtcclxuICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGJyaWRnZS5nZXRDaGlsZEluZGV4KHBhcmVudCwgY3VycmVudCk7XHJcbiAgICAgICAgICAgIGJyaWRnZS5hZGRDaGlsZEF0KHBhcmVudCwgdGFyZ2V0LCBpbmRleCk7XHJcbiAgICAgICAgICAgIGJyaWRnZS5yZW1vdmVDaGlsZChwYXJlbnQsIGN1cnJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci91dGlscy9EaXNwbGF5VXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vZW5naW5lL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgeyB2YWxpZGF0ZVByb3RvY29sLCBqb2luUXVlcnlQYXJhbXMsIHRyaW1VUkwgfSBmcm9tIFwiLi9VUkxVdGlsXCI7XHJcbmltcG9ydCB7IGNsb25lT2JqZWN0IH0gZnJvbSBcIi4vT2JqZWN0VXRpbFwiO1xyXG4vKipcclxuICog5Y+R6YCB5LiA5Liq5oiW5aSa5LiqSFRUUOivt+axglxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUhUVFBSZXF1ZXN0UGFyYW1zfSBwYXJhbXMg6K+35rGC5Y+C5pWwXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbG9hZChwYXJhbXMpIHtcclxuICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgaWYgKCFwYXJhbXMudXJsKSB7XHJcbiAgICAgICAgLy8g5oiQ5Yqf5Zue6LCDXHJcbiAgICAgICAgcGFyYW1zLm9uUmVzcG9uc2UgJiYgcGFyYW1zLm9uUmVzcG9uc2UoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyDmlbDnu4TliKTmlq1cclxuICAgIGlmIChwYXJhbXMudXJsIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAvLyDkuIDmrKHor7fmsYLlpJrkuKrlnLDlnYDvvIzpnIDopoHlgZrkuIDkuKrpmJ/liJfliqDovb3vvIznhLblkI7kuIDmrKHmgKflm57osINcclxuICAgICAgICB2YXIgdXJscyA9IHBhcmFtcy51cmw7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICB2YXIgbmV3UGFyYW1zID0gY2xvbmVPYmplY3QocGFyYW1zKTtcclxuICAgICAgICBuZXdQYXJhbXMub25SZXNwb25zZSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIGxvYWROZXh0KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbG9hZE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh1cmxzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmiJDlip/lm57osINcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5vblJlc3BvbnNlICYmIHBhcmFtcy5vblJlc3BvbnNlKHJlc3VsdHMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5ld1BhcmFtcy51cmwgPSB1cmxzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIGxvYWQobmV3UGFyYW1zKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxvYWROZXh0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy8g5LiA5qyh6K+35rGC5LiA5Liq5Zyw5Z2AXHJcbiAgICB2YXIgcmV0cnlUaW1lcyA9IHBhcmFtcy5yZXRyeVRpbWVzIHx8IDI7XHJcbiAgICB2YXIgdGltZW91dCA9IHBhcmFtcy50aW1lb3V0IHx8IDEwMDAwO1xyXG4gICAgdmFyIG1ldGhvZCA9IHBhcmFtcy5tZXRob2QgfHwgXCJHRVRcIjtcclxuICAgIHZhciB0aW1lb3V0SWQgPSAwO1xyXG4gICAgdmFyIGRhdGEgPSBwYXJhbXMuZGF0YSB8fCB7fTtcclxuICAgIC8vIOWPluWIsHVybFxyXG4gICAgdmFyIHVybCA9IHBhcmFtcy51cmw7XHJcbiAgICBpZiAocGFyYW1zLnVzZUNETikge1xyXG4gICAgICAgIC8vIOWmguaenOS9v+eUqENETuWImeaUueeUqGNkbuWfn+WQjVxyXG4gICAgICAgIHVybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g5ZCI5rOV5YyWcHJvdG9jb2xcclxuICAgICAgICB1cmwgPSB2YWxpZGF0ZVByb3RvY29sKHVybCwgcGFyYW1zLmZvcmNlSFRUUFMgPyBcImh0dHBzOlwiIDogbnVsbCk7XHJcbiAgICAgICAgLy8g6KeE5pW05LiA5LiLdXJsXHJcbiAgICAgICAgdXJsID0gdHJpbVVSTCh1cmwpO1xyXG4gICAgfVxyXG4gICAgLy8g55Sf5oiQeGhyXHJcbiAgICB2YXIgeGhyID0gKHdpbmRvd1tcIlhEb21haW5SZXF1ZXN0XCJdICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUUgMTAuXCIpIDwgMCA/IG5ldyB3aW5kb3dbXCJYRG9tYWluUmVxdWVzdFwiXSgpIDogd2luZG93W1wiWE1MSHR0cFJlcXVlc3RcIl0gPyBuZXcgWE1MSHR0cFJlcXVlc3QoKSA6IG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIikpO1xyXG4gICAgLy8g5Y+R6YCBXHJcbiAgICBzZW5kKCk7XHJcbiAgICBmdW5jdGlvbiBzZW5kKCkge1xyXG4gICAgICAgIHZhciBzZW5kRGF0YSA9IG51bGw7XHJcbiAgICAgICAgLy8g5qC55o2u5Y+R6YCB5pa55byP57uE57uH5pWw5o2u5qC85byPXHJcbiAgICAgICAgc3dpdGNoIChtZXRob2QpIHtcclxuICAgICAgICAgICAgY2FzZSBcIlBPU1RcIjpcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyYW1zLmhlYWRlckRpY3QgJiYgcGFyYW1zLmhlYWRlckRpY3RbXCJDb250ZW50LVR5cGVcIl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREYXRhID0gdG9Gb3JtUGFyYW1zKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kRGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiR0VUXCI6XHJcbiAgICAgICAgICAgICAgICAvLyDlsIbmlbDmja7mt7vliqDliLB1cmzkuIpcclxuICAgICAgICAgICAgICAgIHVybCA9IGpvaW5RdWVyeVBhcmFtcyh1cmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLmmoLkuI3mlK/mjIHnmoRIVFRQIE1ldGhvZO+8mlwiICsgbWV0aG9kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5omT5byAWEhSXHJcbiAgICAgICAgeGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xyXG4gICAgICAgIC8vIOWIneWni+WMlu+8jHJlc3BvbnNlVHlwZeW/hemhu+WcqG9wZW7kuYvlkI7orr7nva7vvIzlkKbliJlJRTEw5ZKMSUUxMeS8muaKpemUmVxyXG4gICAgICAgIGlmIChwYXJhbXMucmVzcG9uc2VUeXBlKVxyXG4gICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gcGFyYW1zLnJlc3BvbnNlVHlwZTtcclxuICAgICAgICAvLyDlpoLmnpzpnIDopoF3aXRoQ3JlZGVudGlhbHPvvIzliJnorr7nva7kuYtcclxuICAgICAgICBpZiAocGFyYW1zLndpdGhDcmVkZW50aWFscylcclxuICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XHJcbiAgICAgICAgeGhyLm9ubG9hZCA9IG9uTG9hZDtcclxuICAgICAgICB4aHIub25lcnJvciA9IG9uRXJyb3I7XHJcbiAgICAgICAgLy8g5re75Yqg6Ieq5a6a5LmJ6K+35rGC5aS077yM5aaC5p6c5Y+v5Lul55qE6K+dXHJcbiAgICAgICAgaWYgKHhoci5zZXRSZXF1ZXN0SGVhZGVyKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwYXJhbXMuaGVhZGVyRGljdCkge1xyXG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBwYXJhbXMuaGVhZGVyRGljdFtrZXldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlvIDlp4vlj5HpgIFcclxuICAgICAgICB4aHIuc2VuZChzZW5kRGF0YSk7XHJcbiAgICAgICAgLy8g5byA5aeL6K6h5pe2XHJcbiAgICAgICAgdGltZW91dElkID0gd2luZG93LnNldFRpbWVvdXQoYWJvcnRBbmRSZXRyeSwgdGltZW91dCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBvbkxvYWQoZXZ0KSB7XHJcbiAgICAgICAgLy8g5Y2z5L2/5pivb25Mb2Fk5Lmf6KaB5Yik5pat5LiL54q25oCB56CB77yM5L2G5aaC5p6c5rKh5pyJ54q25oCB56CB77yM5q+U5aaC6K+0WERvbWFpblJlcXVlc3TlsLHnm7TmjqXorqTkuLrmiJDlip/kuoZcclxuICAgICAgICB2YXIgc3RhdHVzSGVhZCA9IHhoci5zdGF0dXMgPyBNYXRoLmZsb29yKHhoci5zdGF0dXMgKiAwLjAxKSA6IDI7XHJcbiAgICAgICAgc3dpdGNoIChzdGF0dXNIZWFkKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgLy8gMnh45ZKMM3h455qE54q25oCB56CB6K6k5Li65piv5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0SWQgJiYgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSAwO1xyXG4gICAgICAgICAgICAgICAgLy8g5oiQ5Yqf5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBwYXJhbXMub25SZXNwb25zZSAmJiBwYXJhbXMub25SZXNwb25zZSh4aHIucmVzcG9uc2UgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAvLyA0eHjlkow1eHjnmoTnirbmgIHnoIHorqTkuLrmmK/plJnor6/vvIzovazosIPplJnor6/lm57osINcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uRXJyb3IoKSB7XHJcbiAgICAgICAgLy8g5YGc5q2i6K6h5pe2XHJcbiAgICAgICAgdGltZW91dElkICYmIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgIHRpbWVvdXRJZCA9IDA7XHJcbiAgICAgICAgLy8g5aSx6LSl6YeN6K+VXHJcbiAgICAgICAgaWYgKHJldHJ5VGltZXMgPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIOayoeaciei2hei/h+mHjeivleS4iumZkOWImemHjeivlVxyXG4gICAgICAgICAgICBhYm9ydEFuZFJldHJ5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlh7rplJnvvIzlpoLmnpzkvb/nlKhDRE7lip/og73liJnlsJ3or5XliIfmjaJcclxuICAgICAgICAgICAgaWYgKHBhcmFtcy51c2VDRE4gJiYgIWVudmlyb25tZW50Lm5leHRDRE4oKSkge1xyXG4gICAgICAgICAgICAgICAgLy8g6L+Y5rKh5YiH5o2i5a6M77yM6YeN5paw5Yqg6L29XHJcbiAgICAgICAgICAgICAgICBsb2FkKHBhcmFtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDliIfmjaLlrozkuobov5jlpLHotKXvvIzliJnmsYfmiqXplJnor69cclxuICAgICAgICAgICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoeGhyLnN0YXR1cyA/IHhoci5zdGF0dXMgKyBcIiBcIiArIHhoci5zdGF0dXNUZXh0IDogXCLor7fmsYLplJnor6/vvIzkuJTml6Dms5Xojrflj5bplJnor6/kv6Hmga9cIik7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMub25FcnJvciAmJiBwYXJhbXMub25FcnJvcihlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYWJvcnRBbmRSZXRyeSgpIHtcclxuICAgICAgICAvLyDph43or5XmrKHmlbDpgJLlh49cclxuICAgICAgICByZXRyeVRpbWVzLS07XHJcbiAgICAgICAgLy8g5Lit5q2ieGhyXHJcbiAgICAgICAgeGhyLmFib3J0KCk7XHJcbiAgICAgICAgLy8g5re75Yqg5pe26Ze05oiz5L2c5Li66ZqP5py654mI5pys5Y+3XHJcbiAgICAgICAgdXJsID0gam9pblF1ZXJ5UGFyYW1zKHVybCwgeyBfcjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICAvLyDph43mlrDlj5HpgIFcclxuICAgICAgICBzZW5kKCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOWwhuaVsOaNrui9rOaNouS4umZvcm3lvaLlvI9cclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyp9IGRhdGEg6KaB6L2s5o2i55qE5pWw5o2uXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IOi9rOaNoue7k+aenOWtl+espuS4slxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRvRm9ybVBhcmFtcyhkYXRhKSB7XHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpO1xyXG4gICAgdmFyIHBhcmFtcyA9IGtleXMubWFwKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChkYXRhW2tleV0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcGFyYW1zLmpvaW4oXCImXCIpO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0hUVFBVdGlsLmpzXG4vLyBtb2R1bGUgaWQgPSA0MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi9EaWN0aW9uYXJ5XCI7XHJcbi8qKlxyXG4gKiDnroDljZXmlbDnu4TkubHluo9cclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAdGVtcGxhdGUgVFxyXG4gKiBAcGFyYW0ge1R9IGFcclxuICogQHJldHVybnMge1R9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2h1ZmZsZShhKSB7XHJcbiAgICB2YXIgbGVuID0gYS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGVuZCA9IGxlbiAtIGk7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gKE1hdGgucmFuZG9tKCkgKiAoZW5kICsgMSkpID4+IDA7XHJcbiAgICAgICAgdmFyIHQgPSBhW2VuZF07XHJcbiAgICAgICAgYVtlbmRdID0gYVtpbmRleF07XHJcbiAgICAgICAgYVtpbmRleF0gPSB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGE7XHJcbn1cclxuLyoqXHJcbiAqIOS7juaVsOe7hOaMh+WumuiMg+WbtOWGhemaj+acuuWPluWHuuaMh+WumuaVsOmHj+eahOS4jemHjeWkjeWFg+e0oFxyXG4gKiBBcnJheVV0aWxzLnJhbmRvbWl6ZShbMCwxLDIsMyw0LDUsNiw3LDgsOV0sIDMsIDIsIDcpO1xyXG4gKiAvL+i/lOWbnls2LDIsM11cclxuICpcclxuICogQHBhcmFtIGFyciBcdFx05Y6f5aeL5pWw57uEXHJcbiAqIEBwYXJhbSBjb3VudFx0ICAgIOaVsOmHj++8jOm7mOiupOS4uuiMg+WbtOWGheWFqOmDqOWFg+e0oFxyXG4gKiBAcGFyYW0gYmVnaW4gXHTotbflp4vkvY3nva7vvIzpu5jorqTkuLowXHJcbiAqIEBwYXJhbSBlbmRcdFx057uT5p2f5L2N572u77yM6buY6K6k5Li65pWw57uE6ZW/5bqmXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9taXplKGFyciwgY291bnQsIGJlZ2luLCBlbmQpIHtcclxuICAgIGlmICghYXJyIHx8IGJlZ2luIDwgMClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIGFyZ3VtZW50XCIpO1xyXG4gICAgYXJyID0gYXJyLmNvbmNhdCgpO1xyXG4gICAgdmFyIGxlbiA9IGFyci5sZW5ndGg7XHJcbiAgICBlbmQgPSBlbmQgPj4gMDtcclxuICAgIGlmICghKGVuZCA+PSAwICYmIGVuZCA8PSBsZW4pKSB7XHJcbiAgICAgICAgZW5kID0gbGVuO1xyXG4gICAgfVxyXG4gICAgYmVnaW4gPSBiZWdpbiA+PiAwO1xyXG4gICAgaWYgKCEoYmVnaW4gPiAwKSkge1xyXG4gICAgICAgIGJlZ2luID0gMDtcclxuICAgIH1cclxuICAgIGNvdW50ID0gY291bnQgPj4gMDtcclxuICAgIGlmICghKGNvdW50ID49IDAgJiYgY291bnQgPCBlbmQgLSBiZWdpbikpIHtcclxuICAgICAgICBjb3VudCA9IGVuZCAtIGJlZ2luO1xyXG4gICAgfVxyXG4gICAgdmFyIGFycjIgPSBbXTtcclxuICAgIHZhciBlbmQyID0gYmVnaW4gKyBjb3VudDtcclxuICAgIGZvciAodmFyIGkgPSBiZWdpbjsgaSA8IGVuZDI7IGkrKykge1xyXG4gICAgICAgIHZhciBpbmRleCA9IChNYXRoLnJhbmRvbSgpICogKGVuZCAtIGkpICsgaSkgPj4gMDtcclxuICAgICAgICBhcnIyW2kgLSBiZWdpbl0gPSBhcnJbaW5kZXhdO1xyXG4gICAgICAgIGFycltpbmRleF0gPSBhcnJbaV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXJyMjtcclxufVxyXG4vKipcclxuICog6L+b6KGM5p2D6YeN6ZqP5py6XHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHRlbXBsYXRlIFRcclxuICogQHBhcmFtIHtUW119IGFyciDljp/lp4vmlbDnu4RcclxuICogQHBhcmFtIHtudW1iZXJbXX0gd2VpZ2h0IOadg+mHjeaVsOe7hO+8jOW6lOS/neivgeadg+mHjeaVsOe7hOeahOWFg+e0oOaVsOmHj+S4jeWwj+S6juWOn+Wni+aVsOe7hOeahOWFg+e0oOaVsOmHj1xyXG4gKiBAcmV0dXJucyB7VH0g6YCJ5Y+W55qE57uT5p6cXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9taXplV2VpZ2h0KGFyciwgd2VpZ2h0KSB7XHJcbiAgICBpZiAoIWFyciB8fCAhd2VpZ2h0KVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgYXJndW1lbnRcIik7XHJcbiAgICBpZiAod2VpZ2h0Lmxlbmd0aCA8IGFyci5sZW5ndGgpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi5p2D6YeN5pWw57uE55qE5YWD57Sg5pWw6YeP5LiN5bqU5bCP5LqO5Y6f5aeL5pWw57uE55qE5YWD57Sg5pWw6YePXCIpO1xyXG4gICAgLy8g5qC55o2u5p2D6YeN5pWw57uE5bu656uL5LiA5Liq5Yy66Ze05pWw57uEXHJcbiAgICB2YXIgcmVnaW9ucyA9IFtdO1xyXG4gICAgdmFyIHN1bSA9IDA7XHJcbiAgICBmb3IgKHZhciBpIGluIGFycikge1xyXG4gICAgICAgIHN1bSArPSB3ZWlnaHRbaV07XHJcbiAgICAgICAgcmVnaW9ucy5wdXNoKHN1bSk7XHJcbiAgICB9XHJcbiAgICAvLyDpmo/mnLrkuIDkuKrkvY3nva5cclxuICAgIHZhciByYW4gPSBNYXRoLnJhbmRvbSgpICogc3VtO1xyXG4gICAgLy8g5pCc57Si6K+l5L2N572u5omA5bGe5Yy66Ze057Si5byVXHJcbiAgICB2YXIgaW5kZXg7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcmVnaW9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIGlmIChyYW4gPCByZWdpb25zW2ldKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gaTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g6L+U5Zue57Si5byV5aSE55qE5Y6f5aeL5pWw57uE5YWD57SgXHJcbiAgICByZXR1cm4gYXJyW2luZGV4XTtcclxufVxyXG4vKipcclxuICog5pWw57uE5Y676YeN77yM5LiN5Lya5L+u5pS55Y6f5pWw57uEXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHthbnlbXX0gbGlzdFxyXG4gKiBAcmV0dXJucyB7YW55W119XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5pcXVlKGxpc3QpIHtcclxuICAgIGlmICghbGlzdClcclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIC8vIOWIneWni+WMllxyXG4gICAgdmFyIGhhc2ggPSBuZXcgRGljdGlvbmFyeSgpLCByZXN1bHQgPSBbXTtcclxuICAgIC8vIOmBjeWOhuW9k+WJjeaVsOe7hFxyXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAvLyDlpoLmnpxoYXNo6KGo5Lit5rKh5pyJ5b2T5YmN6aG5XHJcbiAgICAgICAgaWYgKCFoYXNoLmdldChsaXN0W2ldKSkge1xyXG4gICAgICAgICAgICAvLyDlrZjlhaVoYXNo6KGoXHJcbiAgICAgICAgICAgIGhhc2guc2V0KGxpc3RbaV0sIHRydWUpO1xyXG4gICAgICAgICAgICAvLyDmiorlvZPliY3mlbDnu4TnmoTlvZPliY3poblwdXNo5Yiw5Li05pe25pWw57uE6YeM6Z2iXHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxpc3RbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvQXJyYXlVdGlsLmpzXG4vLyBtb2R1bGUgaWQgPSA0MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgRGF0YVR5cGUgZnJvbSBcIi4vRGF0YVR5cGVcIjtcclxudmFyIFJlc3BvbnNlRGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFJlc3BvbnNlRGF0YSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlc3BvbnNlRGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUmVzcG9uc2VEYXRhO1xyXG59KERhdGFUeXBlKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFJlc3BvbnNlRGF0YTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9SZXNwb25zZURhdGEuanNcbi8vIG1vZHVsZSBpZCA9IDQzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xMVxyXG4gKlxyXG4gKiDor7fmsYLmiJbov5Tlm57mlbDmja7nu5PmnoTkvZNcclxuKi9cclxudmFyIERhdGFUeXBlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGF0YVR5cGUoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOino+aekOWQjuerr+i/lOWbnueahEpTT07lr7nosaHvvIznlJ/miJDnu5PmnoTkvZNcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2FueX0gZGF0YSDlkI7nq6/ov5Tlm57nmoRKU09O5a+56LGhXHJcbiAgICAgKiBAcmV0dXJucyB7RGF0YVR5cGV9IOe7k+aehOS9k+WvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERhdGFUeXBlXHJcbiAgICAgKi9cclxuICAgIERhdGFUeXBlLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5fX3Jhd0RhdGEgPSB0aGlzLmRvUGFyc2UoZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERhdGFUeXBlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBEYXRhVHlwZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9EYXRhVHlwZS5qc1xuLy8gbW9kdWxlIGlkID0gNDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgYmluZE1hbmFnZXIgfSBmcm9tIFwiLi4vYmluZC9CaW5kTWFuYWdlclwiO1xyXG5mdW5jdGlvbiBnZXRCaW5kUGFyYW1zKGN1cnJlbnRUYXJnZXQpIHtcclxuICAgIHZhciBiaW5kUGFyYW1zID0gY3VycmVudFRhcmdldC5fX2JpbmRfY29tbWFuZHNfXztcclxuICAgIGlmICghYmluZFBhcmFtcykge1xyXG4gICAgICAgIGJpbmRQYXJhbXMgPSBbXTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3VycmVudFRhcmdldCwgXCJfX2JpbmRfY29tbWFuZHNfX1wiLCB7XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICB2YWx1ZTogYmluZFBhcmFtc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJpbmRQYXJhbXM7XHJcbn1cclxuLyoqXHJcbiAqIOa3u+WKoOe8luivkeWRveS7pOWIsOaYvuekuuWvueixoeS4iu+8iOato+WQke+8iVxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUNvbXBpbGVUYXJnZXR9IGN1cnJlbnRUYXJnZXQg5pi+56S65a+56LGhXHJcbiAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOe8luivkeWRveS7pOacrOadpeaJgOWcqOeahOWvueixoVxyXG4gKiBAcGFyYW0ge0lCaW5kQ29tbWFuZH0gY21kIOWRveS7pOWHveaVsFxyXG4gKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOWRveS7pOWPguaVsOWIl+ihqFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGNtZCkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgZ2V0QmluZFBhcmFtcyhjdXJyZW50VGFyZ2V0KS5wdXNoKHsgY21kOiBjbWQsIHRhcmdldDogdGFyZ2V0LCBhcmdzOiBhcmdzIH0pO1xyXG59XHJcbi8qKlxyXG4gKiDmt7vliqDnvJbor5Hlkb3ku6TliLDmmL7npLrlr7nosaHkuIrvvIjlj43lkJHvvIlcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lDb21waWxlVGFyZ2V0fSBjdXJyZW50VGFyZ2V0IOaYvuekuuWvueixoVxyXG4gKiBAcGFyYW0geyp9IHRhcmdldCDnvJbor5Hlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICogQHBhcmFtIHtJQmluZENvbW1hbmR9IGNtZCDlkb3ku6Tlh73mlbBcclxuICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDlkb3ku6Tlj4LmlbDliJfooahcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1bnNoaWZ0Q29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBjbWQpIHtcclxuICAgIHZhciBhcmdzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBnZXRCaW5kUGFyYW1zKGN1cnJlbnRUYXJnZXQpLnVuc2hpZnQoeyBjbWQ6IGNtZCwgdGFyZ2V0OiB0YXJnZXQsIGFyZ3M6IGFyZ3MgfSk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkeaYvuekuuWvueixoe+8jOS8muWFiOe8luivkeiHqui6q++8jOeEtuWQjuWGjemAkuW9kue8luivkeWtkOWvueixoVxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDmmL7npLrlr7nosaHmiYDlsZ7nmoTkuK3ku4vogIVcclxuICogQHBhcmFtIHtJQ29tcGlsZVRhcmdldH0gY3VycmVudFRhcmdldCDmmL7npLrlr7nosaFcclxuICogQHBhcmFtIHthbnlbXX0gW2Vudk1vZGVsc10g546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZShtZWRpYXRvciwgY3VycmVudFRhcmdldCwgZW52TW9kZWxzKSB7XHJcbiAgICAvLyDlj5bliLDnvJbor5Hlj4LmlbDliJfooahcclxuICAgIHZhciBiaW5kUGFyYW1zID0gY3VycmVudFRhcmdldC5fX2JpbmRfY29tbWFuZHNfXztcclxuICAgIC8vIOe8luivkWN1cnJlbnRUYXJnZXToh6rouqtcclxuICAgIGlmIChiaW5kUGFyYW1zKSB7XHJcbiAgICAgICAgLy8g6L+Z6YeM5rKh5pyJ5o+Q5YmN6K+75Y+W5Ye6bGVuZ3Ro5bGe5oCn77yM5Zug5Li66ZyA6KaB5Yqo5oCB5Yik5pat5pWw57uE6ZW/5bqmXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaW5kUGFyYW1zLmxlbmd0aDspIHtcclxuICAgICAgICAgICAgLy8g5L2/55Soc2hpZnTmjInpobrluo/lj5blh7rnvJbor5Hlkb3ku6RcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGJpbmRQYXJhbXMuc2hpZnQoKTtcclxuICAgICAgICAgICAgLy8g6LCD55So57yW6K+R5ZG95Luk77yM5bm25LiU5pu05paw5Lit5q2i54q25oCBXHJcbiAgICAgICAgICAgIHBhcmFtcy5jbWQuYXBwbHkocGFyYW1zLCBbbWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHBhcmFtcy50YXJnZXQsIGVudk1vZGVscyB8fCBbXV0uY29uY2F0KHBhcmFtcy5hcmdzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDnvJbor5FiaW5kVmFsdWXlkb3ku6TvvIzkuI3kvJrkuK3mraLnvJbor5FcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlVmFsdWUobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lLCBleHApIHtcclxuICAgIGJpbmRNYW5hZ2VyLmJpbmRWYWx1ZShtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIG5hbWUsIGV4cCk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRFeHDlkb3ku6TvvIzkuI3kvJrkuK3mraLnvJbor5FcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlRXhwKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgZXhwKSB7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kRXhwKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgZXhwKTtcclxufVxyXG4vKipcclxuICog57yW6K+RYmluZEZ1bmPlkb3ku6TvvIzkuI3kvJrkuK3mraLnvJbor5FcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlRnVuYyhtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIG5hbWUpIHtcclxuICAgIHZhciBhcmdFeHBzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDU7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ0V4cHNbX2kgLSA1XSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kRnVuYy5hcHBseShiaW5kTWFuYWdlciwgW21lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgbmFtZV0uY29uY2F0KGFyZ0V4cHMpKTtcclxufVxyXG4vKipcclxuICog57yW6K+RYmluZE9u5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZU9uKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgZXhwKSB7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kT24obWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBleHApO1xyXG59XHJcbmZ1bmN0aW9uIGlzUG9zdGVyaXR5KG1lZGlhdG9yLCB0YXJnZXQsIHBhcmVudCkge1xyXG4gICAgdmFyIHRlbXBQYXJlbnQgPSBtZWRpYXRvci5icmlkZ2UuZ2V0UGFyZW50KHRhcmdldCk7XHJcbiAgICBpZiAoIXRlbXBQYXJlbnQpXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgZWxzZSBpZiAodGVtcFBhcmVudCA9PT0gcGFyZW50KVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIHJldHVybiBpc1Bvc3Rlcml0eShtZWRpYXRvciwgdGVtcFBhcmVudCwgcGFyZW50KTtcclxufVxyXG5mdW5jdGlvbiBnZXRBbGxTdWJUYXJnZXRzKG1lZGlhdG9yLCB0YXJnZXQpIHtcclxuICAgIHZhciBiaW5kVGFyZ2V0cyA9IG1lZGlhdG9yLmJpbmRUYXJnZXRzO1xyXG4gICAgdmFyIHN1YlRhcmdldHMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgYmluZFRhcmdldHNfMSA9IGJpbmRUYXJnZXRzOyBfaSA8IGJpbmRUYXJnZXRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGJpbmRUYXJnZXQgPSBiaW5kVGFyZ2V0c18xW19pXTtcclxuICAgICAgICBiaW5kVGFyZ2V0ICYmIGJpbmRUYXJnZXQuZm9yRWFjaChmdW5jdGlvbiAodGVtcFRhcmdldCkge1xyXG4gICAgICAgICAgICBpZiAoaXNQb3N0ZXJpdHkobWVkaWF0b3IsIHRlbXBUYXJnZXQsIHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICBzdWJUYXJnZXRzLnB1c2godGVtcFRhcmdldCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3ViVGFyZ2V0cztcclxufVxyXG4vKipcclxuICog57yW6K+RYmluZElm5ZG95Luk77yM5Lya5Lit5q2i57yW6K+R77yM55u05Yiw5Yik5pat5p2h5Lu25Li6dHJ1ZeaXtuaJjeS8muWQr+WKqOS7pee7p+e7ree8luivkVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVJZihtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCkge1xyXG4gICAgLy8g5bCG5ZCO6Z2i55qE57yW6K+R5ZG95Luk57yT5a2Y6LW35p2lXHJcbiAgICB2YXIgYmluZFBhcmFtcyA9IGN1cnJlbnRUYXJnZXQuX19iaW5kX2NvbW1hbmRzX187XHJcbiAgICB2YXIgY2FjaGVzID0gW3sgdGFyZ2V0OiBjdXJyZW50VGFyZ2V0LCBwYXJhbXM6IGJpbmRQYXJhbXMuc3BsaWNlKDAsIGJpbmRQYXJhbXMubGVuZ3RoKSB9XTtcclxuICAgIC8vIOWQjuS7o+iKgueCueeahOS5n+imgee8k+WtmOS9j1xyXG4gICAgdmFyIHN1YlRhcmdldHMgPSBnZXRBbGxTdWJUYXJnZXRzKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0KTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgc3ViVGFyZ2V0c18xID0gc3ViVGFyZ2V0czsgX2kgPCBzdWJUYXJnZXRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIHN1YlRhcmdldCA9IHN1YlRhcmdldHNfMVtfaV07XHJcbiAgICAgICAgdmFyIHN1YkJpbmRQYXJhbXMgPSBzdWJUYXJnZXQuX19iaW5kX2NvbW1hbmRzX187XHJcbiAgICAgICAgY2FjaGVzLnB1c2goeyB0YXJnZXQ6IHN1YlRhcmdldCwgcGFyYW1zOiBzdWJCaW5kUGFyYW1zLnNwbGljZSgwLCBzdWJCaW5kUGFyYW1zLmxlbmd0aCkgfSk7XHJcbiAgICB9XHJcbiAgICAvLyDnu5HlrpppZuWRveS7pFxyXG4gICAgdmFyIHRlcm1pbmF0ZWQgPSBmYWxzZTtcclxuICAgIGJpbmRNYW5hZ2VyLmJpbmRJZihtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCwgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5p2h5Lu25Li6dHJ1Ze+8jOWImeWQr+WKqOe7p+e7ree8luivke+8jOS9huWPque8luivkeS4gOasoe+8jOe8luivkei/h+WwseS4jemcgOimgeWGjee8luivkeS6hlxyXG4gICAgICAgIGlmICghdGVybWluYXRlZCAmJiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAvLyDmgaLlpI3lkI7pnaLnmoTlkb3ku6RcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjYWNoZXNfMSA9IGNhY2hlczsgX2kgPCBjYWNoZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjYWNoZSA9IGNhY2hlc18xW19pXTtcclxuICAgICAgICAgICAgICAgIGNhY2hlLnRhcmdldC5fX2JpbmRfY29tbWFuZHNfXyA9IGNhY2hlLnBhcmFtcztcclxuICAgICAgICAgICAgICAgIC8vIOe7p+e7ree8luivkVxyXG4gICAgICAgICAgICAgICAgY29tcGlsZShtZWRpYXRvciwgY2FjaGUudGFyZ2V0LCBlbnZNb2RlbHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruW3sue7iOe7k+agh+ivhlxyXG4gICAgICAgICAgICB0ZXJtaW5hdGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICog57yW6K+RYmluZEZvcuWRveS7pO+8jOS8muS4reatoue8luivke+8jOebtOWIsOeUn+aIkOaWsOeahHJlbmRlcmVy5a6e5L6L5pe25omN5Lya57un57ut57yW6K+R5paw5a6e5L6LXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZUZvcihtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCwgbWVkaWF0b3JDbHMpIHtcclxuICAgIC8vIOWwhuWQjumdoueahOe8luivkeWRveS7pOe8k+WtmOi1t+adpVxyXG4gICAgdmFyIGxlZnRIYW5kbGVycyA9IHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fO1xyXG4gICAgLy8g57uR5a6aZm9y5ZG95LukXHJcbiAgICBiaW5kTWFuYWdlci5iaW5kRm9yKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgZXhwLCBtZWRpYXRvckNscywgZnVuY3Rpb24gKGRhdGEsIHJlbmRlcmVyLCBzdWJFbnZNb2RlbHMpIHtcclxuICAgICAgICB2YXIgc3ViTGVmdEhhbmRsZXJzID0gbGVmdEhhbmRsZXJzLmNvbmNhdCgpO1xyXG4gICAgICAgIHZhciBiaW5kVGFyZ2V0cyA9IFtdO1xyXG4gICAgICAgIC8vIOmSiOWvueavj+S4gOS4qnJlbmRlcmVy6LWL5YC85ZCO57ut57yW6K+R5oyH5LukXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBzdWJMZWZ0SGFuZGxlcnNfMSA9IHN1YkxlZnRIYW5kbGVyczsgX2kgPCBzdWJMZWZ0SGFuZGxlcnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGxlZnRIYW5kbGVyID0gc3ViTGVmdEhhbmRsZXJzXzFbX2ldO1xyXG4gICAgICAgICAgICBsZWZ0SGFuZGxlcihyZW5kZXJlciwgYmluZFRhcmdldHMsIHN1YkxlZnRIYW5kbGVycyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOe8luivkXJlbmRlcmVy5a6e5L6LXHJcbiAgICAgICAgZm9yICh2YXIgZGVwdGggaW4gYmluZFRhcmdldHMpIHtcclxuICAgICAgICAgICAgdmFyIGRpY3QgPSBiaW5kVGFyZ2V0c1tkZXB0aF07XHJcbiAgICAgICAgICAgIGRpY3QuZm9yRWFjaChmdW5jdGlvbiAoY3VycmVudFRhcmdldCkgeyByZXR1cm4gY29tcGlsZShtZWRpYXRvciwgY3VycmVudFRhcmdldCwgc3ViRW52TW9kZWxzKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRNZXNzYWdl5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZU1lc3NhZ2UobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpIHtcclxuICAgIGJpbmRNYW5hZ2VyLmJpbmRNZXNzYWdlKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgbmFtZSwgZXhwLCBvYnNlcnZhYmxlKTtcclxufVxyXG4vKipcclxuICog57yW6K+RYmluZFJlc3BvbnNl5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVJlc3BvbnNlKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgbmFtZSwgZXhwLCBvYnNlcnZhYmxlKSB7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kUmVzcG9uc2UobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpO1xyXG59XHJcbi8qKlxyXG4gKiDmkJzntKJVSe+8jOWPluWIsOebruagh+iKgueCue+8jOaJp+ihjOWbnuiwg1xyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7Kn0gdmFsdWVzIOWAvOe7k+aehOWtl+WFuFxyXG4gKiBAcGFyYW0geyp9IHVpIHVp5a6e5L2TXHJcbiAqIEBwYXJhbSB7KHVpOmFueSwga2V5OnN0cmluZywgdmFsdWU6YW55LCBkZXB0aD86bnVtYmVyKT0+dm9pZH0gY2FsbGJhY2sg5Zue6LCDXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBbZGVwdGg9MF0g6YGN5Y6G5rex5bqm77yM5pa55rOV5Lya57un57ut5aKe5Yqg6L+Z5Liq5rex5bqmXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2VhcmNoVUkodmFsdWVzLCB1aSwgY2FsbGJhY2ssIGRlcHRoKSB7XHJcbiAgICBpZiAoZGVwdGggPT09IHZvaWQgMCkgeyBkZXB0aCA9IDA7IH1cclxuICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZXMpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSB2YWx1ZXNba2V5XTtcclxuICAgICAgICB2YXIgaW5kZXggPSBrZXkuaW5kZXhPZihcIi5cIik7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgLy8g5piv6KGo6L6+5byP5a+75Z2A77yM6YCS5b2S5a+75Z2AXHJcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHt9O1xyXG4gICAgICAgICAgICBuZXdWYWx1ZVtrZXkuc3Vic3RyKGluZGV4ICsgMSldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIHNlYXJjaFVJKG5ld1ZhbHVlLCB1aVtrZXkuc3Vic3RyaW5nKDAsIGluZGV4KV0sIGNhbGxiYWNrLCBkZXB0aCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIiAmJiAhKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpKSB7XHJcbiAgICAgICAgICAgIC8vIOaYr+WtkOWvueixoeWvu+WdgO+8jOmAkuW9kuWvu+WdgFxyXG4gICAgICAgICAgICBzZWFyY2hVSSh2YWx1ZSwgdWlba2V5XSwgY2FsbGJhY2ssIGRlcHRoICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDmmK/ooajovr7lvI/vvIzosIPnlKjlm57osIPvvIzlsIbosIPnlKjlsYLnuqfkuZ/kvKDpgJLlm57ljrtcclxuICAgICAgICAgICAgY2FsbGJhY2sodWksIGtleSwgdmFsdWUsIGRlcHRoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0JpbmRVdGlsLmpzXG4vLyBtb2R1bGUgaWQgPSA0NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgQXVkaW9NZXNzYWdlIGZyb20gXCIuL0F1ZGlvTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCIuLi9lbnYvRW52aXJvbm1lbnRcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTMwXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTMwXHJcbiAqXHJcbiAqIOS9v+eUqEF1ZGlv5qCH562+5a6e546wSUF1ZGlv5o6l5Y+j55qE5a6e546w57G7XHJcbiovXHJcbnZhciBBdWRpb1RhZ0ltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdWRpb1RhZ0ltcGwoKSB7XHJcbiAgICAgICAgdGhpcy5fbXV0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3BsYXlpbmdEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fYXVkaW9DYWNoZSA9IHt9O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUsIFwibXV0ZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Z2Z6Z+z54q25oCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fbXV0ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvLyDpnZnpn7PvvIzmmoLlgZzmiYDmnInlo7Dpn7NcclxuICAgICAgICAgICAgZm9yICh2YXIgdXJsIGluIHRoaXMuX3BsYXlpbmdEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZnpn7PvvIzlgZzmraLpn7PpopHvvIzkuI3lj6/osIPnlKhzdG9w5pa55rOV77yM5Zug5Li66KaB5L+d5oyB5pKt5pS+5Lit55qE6Z+z6aKR54q25oCBXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9TdG9wKHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZ7pnZnpn7PvvIzmkq3mlL7pn7PpopFcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5fcGxheWluZ0RpY3RbdXJsXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3pn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikeWcsOWdgFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvVGFnSW1wbFxyXG4gICAgICovXHJcbiAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgLy8g5bCd6K+V6I635Y+W57yT5a2Y5pWw5o2uXHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICAvLyDlpoLmnpzmsqHmnInnvJPlrZjmiY3ljrvliqDovb1cclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgICAgLy8g5L2/55SoQXVkaW/moIfnrb7liqDovb1cclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIik7XHJcbiAgICAgICAgICAgIC8vIOi/memHjOW8uuWItuS9v+eUqGF1dG9wbGF577yM5Zug5Li65ZyoSU9T55qEc2FmYXJp5LiK5aaC5p6c5rKh6L+Z5Liq5Y+C5pWw77yM5YiZ5qC55pys5LiN5Lya6Kem5Y+Rb25sb2FkZWRkYXRh5LqL5Lu2XHJcbiAgICAgICAgICAgIG5vZGUuYXV0b3BsYXkgPSB0cnVlO1xyXG4gICAgICAgICAgICBub2RlLnNyYyA9IHRvVXJsO1xyXG4gICAgICAgICAgICAvLyDkv53lrZjmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fYXVkaW9DYWNoZVt0b1VybF0gPSBkYXRhID0geyBub2RlOiBub2RlLCBzdGF0dXM6IEF1ZGlvU3RhdHVzLkxPQURJTkcsIHBsYXlQYXJhbXM6IG51bGwgfTtcclxuICAgICAgICAgICAgLy8g55uR5ZCs5Yqg6L29XHJcbiAgICAgICAgICAgIG5vZGUub25sb2FkZWRkYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6K6w5b2V5Yqg6L295a6M5q+VXHJcbiAgICAgICAgICAgICAgICBkYXRhLnN0YXR1cyA9IEF1ZGlvU3RhdHVzLlBBVVNFRDtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOS4jeiHquWKqOaSreaUvuWImeaaguWBnFxyXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhLnBsYXlQYXJhbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXVzZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBub2RlLm9uZW5kZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmkq3mlL7lrozmr5Xkuovku7ZcclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfRU5ERUQsIHVybCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pKt5pS+6Z+z6aKR77yM5aaC5p6c6Z+z6aKR5rKh5pyJ5Yqg6L295YiZ5YWI5Yqg6L295YaN5pKt5pS+XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBdWRpb1BsYXlQYXJhbXN9IHBhcmFtcyDpn7PpopHmkq3mlL7lj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvVGFnSW1wbFxyXG4gICAgICovXHJcbiAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHBhcmFtcy51cmwpO1xyXG4gICAgICAgIC8vIOWwneivleiOt+WPlue8k+WtmOaVsOaNrlxyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIOayoeacieWKoOi9vei/h++8jOW8gOWni+WKoOi9vemfs+mikVxyXG4gICAgICAgICAgICB0aGlzLmxvYWQocGFyYW1zLnVybCk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruaSreaUvuWPguaVsFxyXG4gICAgICAgICAgICB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXS5wbGF5UGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc3dpdGNoIChkYXRhLnN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBBdWRpb1N0YXR1cy5MT0FESU5HOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOato+WcqOWKoOi9veS4re+8jOabv+aNouiHquWKqOaSreaUvuWPguaVsFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucGxheVBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgQXVkaW9TdGF0dXMuUExBWUlORzpcclxuICAgICAgICAgICAgICAgICAgICAvLyDmraPlnKjmkq3mlL7vvIzlhbPpl63lkI7lho3mkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AocGFyYW1zLnVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5KHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEF1ZGlvU3RhdHVzLlBBVVNFRDpcclxuICAgICAgICAgICAgICAgICAgICAvLyDlt7Lnu4/liqDovb3lrozmr5XvvIzmmoLlgZzkuK3vvIznm7TmjqXmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLnN0b3BPdGhlcnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMubG9vcCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUubG9vcCA9IHBhcmFtcy5sb29wO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMudGltZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuY3VycmVudFRpbWUgPSBwYXJhbXMudGltZSAqIDAuMDAxO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOebkeWQrOaSreaUvui/m+W6plxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZS5vbnRpbWV1cGRhdGUgPSBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPquacieaSreaUvueKtuaAgeWPr+S7pea0vuWPkVBST0dSRVNT5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBBdWRpb1N0YXR1cy5QTEFZSU5HKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiJHku6zop4Tlrprkvb/nlKjmr6vnp5LlgLzkvZzkuLrljZXkvY1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJUaW1lID0gZGF0YS5ub2RlLmN1cnJlbnRUaW1lICogMTAwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFRpbWUgPSBkYXRhLm5vZGUuZHVyYXRpb24gKiAxMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5pKt5pS+6L+b5bqm5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1BST0dSRVNTLCBwYXJhbXMudXJsLCBjdXJUaW1lLCB0b3RhbFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlvIDlp4vmkq3mlL7vvIxzYWZhcmnkuI3mlK/mjIHnm7TmjqVwbGF5KFdURj8p5omA5Lul6KaB55SoYXV0b3BsYXnliqBsb2Fk6L+b6KGM5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLmF1dG9wbGF5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUubG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rueKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gQXVkaW9TdGF0dXMuUExBWUlORztcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXmkq3mlL7kuK1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF0gPSBwYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5pKt5pS+5byA5aeL5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9TVEFSVEVELCBwYXJhbXMudXJsKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLl9kb1N0b3AgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICBkYXRhLm5vZGUuYXV0b3BsYXkgPSBmYWxzZTtcclxuICAgICAgICAgICAgZGF0YS5ub2RlLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWBnOatouaXtumXtFxyXG4gICAgICAgICAgICBpZiAodGltZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgZGF0YS5ub2RlLmN1cnJlbnRUaW1lID0gdGltZSAqIDAuMDAxO1xyXG4gICAgICAgICAgICAvLyDorr7nva7nirbmgIFcclxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuWBnOatouS6i+S7tlxyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1NUT1BQRUQsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pqC5YGc6Z+z6aKR77yI5LiN5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9kb1N0b3AodXJsKTtcclxuICAgICAgICAvLyDnp7vpmaTmkq3mlL7kuK1cclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcGxheWluZ0RpY3RbdG9VcmxdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i6Z+z6aKR77yI5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2RvU3RvcCh1cmwsIDApO1xyXG4gICAgICAgIC8vIOenu+mZpOaSreaUvuS4rVxyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraLmiYDmnInpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUuc3RvcEFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciB1cmwgaW4gdGhpcy5fYXVkaW9DYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AodXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7Povazpn7PpopHov5vluqZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUg6KaB6Lez6L2s5Yiw55qE6Z+z6aKR5L2N572u77yM5q+r56eS5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uICh1cmwsIHRpbWUpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdXJsXTtcclxuICAgICAgICBpZiAoZGF0YSlcclxuICAgICAgICAgICAgZGF0YS5ub2RlLmN1cnJlbnRUaW1lID0gdGltZSAqIDAuMDAxO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBdWRpb1RhZ0ltcGw7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEF1ZGlvVGFnSW1wbDtcclxudmFyIEF1ZGlvU3RhdHVzO1xyXG4oZnVuY3Rpb24gKEF1ZGlvU3RhdHVzKSB7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veS4rVxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIkxPQURJTkdcIl0gPSAwXSA9IFwiTE9BRElOR1wiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlt7LmmoLlgZxcclxuICAgICAqL1xyXG4gICAgQXVkaW9TdGF0dXNbQXVkaW9TdGF0dXNbXCJQQVVTRURcIl0gPSAxXSA9IFwiUEFVU0VEXCI7XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvuS4rVxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIlBMQVlJTkdcIl0gPSAyXSA9IFwiUExBWUlOR1wiO1xyXG59KShBdWRpb1N0YXR1cyB8fCAoQXVkaW9TdGF0dXMgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9UYWdJbXBsLmpzXG4vLyBtb2R1bGUgaWQgPSA0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzBcclxuICpcclxuICog6Z+z6aKR5raI5oGvXHJcbiovXHJcbnZhciBBdWRpb01lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdWRpb01lc3NhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmfs+mikeaSreaUvuW8gOWni+S6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1NUQVJURUQgPSBcImF1ZGlvUGxheVN0YXJ0ZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog6Z+z6aKR5pKt5pS+5YGc5q2i5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfU1RPUFBFRCA9IFwiYXVkaW9QbGF5U3RvcHBlZFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpn7PpopHmkq3mlL7lrozmr5Xkuovku7ZcclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9FTkRFRCA9IFwiYXVkaW9QbGF5RW5kZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog6Z+z6aKR5pKt5pS+6L+b5bqm5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfUFJPR1JFU1MgPSBcImF1ZGlvUGxheVByb2dyZXNzXCI7XHJcbiAgICByZXR1cm4gQXVkaW9NZXNzYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBdWRpb01lc3NhZ2U7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hdWRpby9BdWRpb01lc3NhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDQ3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxOC0wMS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxOC0wMS0wOFxyXG4gKlxyXG4gKiDlvJXmk47mtojmga/nsbvlnotcclxuKi9cclxudmFyIEVuZ2luZU1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFbmdpbmVNZXNzYWdlKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlvJXmk47liJ3lp4vljJblrozmr5Xmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIEVuZ2luZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgRW5naW5lTWVzc2FnZS5JTklUSUFMSVpFRCA9IFwiaW5pdGlhbGl6ZWRcIjtcclxuICAgIHJldHVybiBFbmdpbmVNZXNzYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBFbmdpbmVNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWVzc2FnZS9FbmdpbmVNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA0OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcclxufTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwib2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL2Vudi9IYXNoXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIEluamVjdG9yXzEsIEhhc2hfMSwgSW5qZWN0b3JfMikge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICB2YXIgSUZ1Y2tNb2RlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmdW5jdGlvbiBJRnVja01vZGVsKCkge1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSUZ1Y2tNb2RlbC5wcm90b3R5cGUsIFwiZnVja1wiLCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBJRnVja01vZGVsO1xyXG4gICAgfSgpKTtcclxuICAgIGV4cG9ydHMuSUZ1Y2tNb2RlbCA9IElGdWNrTW9kZWw7XHJcbiAgICB2YXIgRnVja01vZGVsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIEZ1Y2tNb2RlbCgpIHtcclxuICAgICAgICAgICAgdGhpcy5fZnVjayA9IFwiRnVja1wiO1xyXG4gICAgICAgICAgICB0aGlzLnNoaXQgPSBcIlNoaXRcIjtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGdWNrIE1vZGVsIENvbnN0cnVjdGVkIVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZ1Y2tNb2RlbC5wcm90b3R5cGUsIFwiZnVja1wiLCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Z1Y2s7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mdWNrID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIEZ1Y2tNb2RlbC5wcm90b3R5cGUuZnVja1lvdSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiT3llIVwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuSW5qZWN0LFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSGFzaF8xLmRlZmF1bHQpXHJcbiAgICAgICAgXSwgRnVja01vZGVsLnByb3RvdHlwZSwgXCJoYXNoXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgRnVja01vZGVsID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuTW9kZWxDbGFzcygxLCBJRnVja01vZGVsKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxyXG4gICAgICAgIF0sIEZ1Y2tNb2RlbCk7XHJcbiAgICAgICAgcmV0dXJuIEZ1Y2tNb2RlbDtcclxuICAgIH0oKSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBGdWNrTW9kZWw7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lSblZqYTAxdlpHVnNMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVJuVmphMDF2WkdWc0xuUnpJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSTdPenM3T3pzN096czdPenRKUVVsQk8xRkJRVUU3VVVGTlFTeERRVUZETzFGQlNrY3NjMEpCUVZjc05FSkJRVWs3YVVKQlFXWTdaMEpCUlVrc1RVRkJUU3hEUVVGRExFbEJRVWtzUTBGQlF6dFpRVU5vUWl4RFFVRkRPenM3VjBGQlFUdFJRVU5NTEdsQ1FVRkRPMGxCUVVRc1EwRkJReXhCUVU1RUxFbEJUVU03U1VGT1dTeG5RMEZCVlR0SlFWTjJRanRSUVdsQ1NUdFpRVnBSTEZWQlFVc3NSMEZCVlN4TlFVRk5MRU5CUVVNN1dVRlZka0lzVTBGQlNTeEhRVUZWTEUxQlFVMHNRMEZCUXp0WlFVbDRRaXhQUVVGUExFTkJRVU1zUjBGQlJ5eERRVUZETEhsQ1FVRjVRaXhEUVVGRExFTkJRVU03VVVGRE0wTXNRMEZCUXp0UlFXUkVMSE5DUVVGWExESkNRVUZKTzJsQ1FVRm1PMmRDUVVWSkxFMUJRVTBzUTBGQlF5eEpRVUZKTEVOQlFVTXNTMEZCU3l4RFFVRkRPMWxCUTNSQ0xFTkJRVU03YVVKQlEwUXNWVUZCWjBJc1MwRkJXVHRuUWtGRmVFSXNTVUZCU1N4RFFVRkRMRXRCUVVzc1IwRkJSeXhMUVVGTExFTkJRVU03V1VGRGRrSXNRMEZCUXpzN08xZEJTa0U3VVVGaFRTd3lRa0ZCVHl4SFFVRmtPMWxCUlVrc1RVRkJUU3hEUVVGRExFMUJRVTBzUTBGQlF6dFJRVU5zUWl4RFFVRkRPMUZCZEVKRU8xbEJSRU1zYVVKQlFVMDdjME5CUTAwc1kwRkJTVHNyUTBGQlF6dFJRVWhFTEZOQlFWTTdXVUZFTjBJc2NVSkJRVlVzUTBGQlF5eERRVUZETEVWQlFVVXNWVUZCVlN4RFFVRkRPenRYUVVOTUxGTkJRVk1zUTBFd1FqZENPMUZCUVVRc1owSkJRVU03UzBGQlFTeEJRVEZDUkN4SlFUQkNRenR6UWtFeFFtOUNMRk5CUVZNaWZRPT1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kZWxzL0Z1Y2tNb2RlbC50c1xuLy8gbW9kdWxlIGlkID0gNDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiBIYXNo57G75piv5Zyw5Z2A6Lev55Sx77yI572R6aG15ZOI5biM77yJ566h55CG5Zmo77yM6KeE5a6a5ZOI5biM5qC85byP5Li677yaI1vmqKHlnZflkI1dP1vlj4LmlbDlkI1dPVvlj4LmlbDlgLxdJlvlj4LmlbDlkI1dPVvlj4LmlbDlgLxdJi4uLlxyXG4qL1xyXG52YXIgSGFzaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhhc2goKSB7XHJcbiAgICAgICAgdGhpcy5fa2VlcEhhc2ggPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9oYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7XHJcbiAgICAgICAgdGhpcy5fbW9kdWxlRGF0YURpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9tb2R1bGVEYXRhcyA9IFtdO1xyXG4gICAgICAgIHZhciByZWcgPSAvIyhbXlxcPyYjXSspPyhcXD8oW15cXD8mPSNdKz1bXlxcPyY9I10rKSgmKFteXFw/Jj0jXSs9W15cXD8mPSNdKykpKik/L2c7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICB3aGlsZSAocmVzdWx0ID0gcmVnLmV4ZWModGhpcy5faGFzaCkpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiByZXN1bHRbMV0sXHJcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHt9LFxyXG4gICAgICAgICAgICAgICAgZGlyZWN0OiBmYWxzZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDop6PmnpDmqKHlnZflj4LmlbBcclxuICAgICAgICAgICAgdmFyIHBhcmFtc1N0ciA9IHJlc3VsdFsyXTtcclxuICAgICAgICAgICAgaWYgKHBhcmFtc1N0ciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNTdHIgPSBwYXJhbXNTdHIuc3Vic3RyKDEpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHBhcmFtc1N0ci5zcGxpdChcIiZcIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGFyYW1zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaXIgPSBwYXJhbXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhaXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBhaXIuc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDplK7lkozlgLzpg73opoHlgZrkuIDmrKFVUkzop6PnoIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGRlY29kZVVSSUNvbXBvbmVudCh0ZW1wWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGVjb2RlVVJJQ29tcG9uZW50KHRlbXBbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnBhcmFtc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOWkhOeQhmRpcmVjdOWPguaVsFxyXG4gICAgICAgICAgICBkYXRhLmRpcmVjdCA9IChkYXRhLnBhcmFtcy5kaXJlY3QgPT0gXCJ0cnVlXCIpO1xyXG4gICAgICAgICAgICBkZWxldGUgZGF0YS5wYXJhbXMuZGlyZWN0O1xyXG4gICAgICAgICAgICAvLyDlpITnkIZrZWVwSGFzaOWPguaVsFxyXG4gICAgICAgICAgICB0aGlzLl9rZWVwSGFzaCA9IHRoaXMuX2tlZXBIYXNoIHx8IChkYXRhLnBhcmFtcy5rZWVwSGFzaCA9PSBcInRydWVcIik7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhLnBhcmFtcy5rZWVwSGFzaDtcclxuICAgICAgICAgICAgLy8g6K6w5b2V5qih5Z2X6Lez6L2s5pWw5o2uXHJcbiAgICAgICAgICAgIHRoaXMuX21vZHVsZURhdGFEaWN0W2RhdGEubmFtZV0gPSBkYXRhO1xyXG4gICAgICAgICAgICB0aGlzLl9tb2R1bGVEYXRhcy5wdXNoKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpxrZWVwSGFzaOS4jeaYr3RydWXvvIzliJnnp7vpmaTlk4jluIzlgLxcclxuICAgICAgICBpZiAoIXRoaXMuX2tlZXBIYXNoKSB7XHJcbiAgICAgICAgICAgIC8vIOimgeS9v+eUqHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNl5pa55rOV77yM5LiN6IO955u05o6l6K6+572uaGFzaOWxnuaAp++8jOWQpuWImeS8muS6p+eUn+WOhuWPsuiusOW9lVxyXG4gICAgICAgICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHVybC5pbmRleE9mKFwiI1wiKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID49IDApXHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh1cmwuc3Vic3RyKDAsIGluZGV4ICsgMSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIYXNoLnByb3RvdHlwZSwgXCJoYXNoXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bljp/lp4vnmoTlk4jluIzlrZfnrKbkuLJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEhhc2hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hhc2g7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSGFzaC5wcm90b3R5cGUsIFwibW9kdWxlRGF0YXNcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaooeWdl+i3s+i9rOaVsOaNruaVsOe7hFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lIYXNoTW9kdWxlRGF0YVtdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBIYXNoXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGVEYXRhcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIYXNoLnByb3RvdHlwZSwgXCJmaXJzdE1vZHVsZVBhcmFtc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Lyg6YCS57uZ6aaW5qih5Z2X55qE5Y+C5pWw77yM6aaW5qih5Z2X5pWw5o2u55qE5Lyg6YCS5pa55byP5Li65L2N5LqO56ys5LiA5LiqI+WQjuS4lOS4jeWhq+WGmeaooeWdl+WQjVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUgeyp9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEhhc2hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9tb2R1bGVEYXRhc1swXTtcclxuICAgICAgICAgICAgaWYgKCFkYXRhKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5Lyg6YCS55qE56ys5LiA5Liq5qih5Z2X5pyJ5ZCN5a2X77yM5YiZ5LiN6K6k5Li65piv5Lyg6YCS57uZ6aaW5qih5Z2X55qEXHJcbiAgICAgICAgICAgIHJldHVybiAoZGF0YS5uYW1lID8gdW5kZWZpbmVkIDogZGF0YS5wYXJhbXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEhhc2gucHJvdG90eXBlLCBcImtlZXBIYXNoXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmmK/lkKbkv53mjIHlk4jluIzlgLxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBIYXNoXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9rZWVwSGFzaDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5oyH5a6a5ZOI5biM5Y+C5pWwXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSDlj4LmlbDlkI1cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbW9kdWxlTmFtZV0g5Y+C5pWw5omA5bGe5qih5Z2X5ZCN77yM5LiN5Lyg5YiZ6I635Y+W56ys5LiA5Liq5qih5Z2X55qE5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDlj4LmlbDlgLxcclxuICAgICAqIEBtZW1iZXJvZiBIYXNoXHJcbiAgICAgKi9cclxuICAgIEhhc2gucHJvdG90eXBlLmdldFBhcmFtID0gZnVuY3Rpb24gKGtleSwgbW9kdWxlTmFtZSkge1xyXG4gICAgICAgIHZhciBkYXRhID0gKG1vZHVsZU5hbWUgPyB0aGlzLl9tb2R1bGVEYXRhRGljdFttb2R1bGVOYW1lXSA6IHRoaXMuX21vZHVsZURhdGFzWzBdKTtcclxuICAgICAgICByZXR1cm4gKGRhdGEgJiYgZGF0YS5wYXJhbXNba2V5XSk7XHJcbiAgICB9O1xyXG4gICAgSGFzaCA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZSxcclxuICAgICAgICB0c2xpYl8xLl9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcclxuICAgIF0sIEhhc2gpO1xyXG4gICAgcmV0dXJuIEhhc2g7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEhhc2g7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBoYXNoID0gY29yZS5nZXRJbmplY3QoSGFzaCk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvSGFzaC5qc1xuLy8gbW9kdWxlIGlkID0gNTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIi4uL3R5cGUvVGVzdFwiLCBcIm9seW1wdXMtci9lbmdpbmUvbmV0L1Jlc3BvbnNlRGF0YVwiLCBcIm9seW1wdXMtci9lbmdpbmUvbmV0L05ldE1hbmFnZXJcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBUZXN0XzEsIFJlc3BvbnNlRGF0YV8xLCBOZXRNYW5hZ2VyXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAYXV0aG9yIFRlbXBsYXRlR2VuZXJhdG9yXHJcbiAgICAgKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gICAgICogQG1vZGlmeSBkYXRlIDEwLzkvMjAxN1xyXG4gICAgICpcclxuICAgICAqIOa1i+ivlVxyXG4gICAgKi9cclxuICAgIHZhciBUZXN0UmVzcG9uc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3RSZXNwb25zZSwgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBUZXN0UmVzcG9uc2UoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRlc3RSZXNwb25zZS5wcm90b3R5cGUsIFwiX19wYXJhbXNcIiwge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJUZXN0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6IFwiaHR0cFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIlxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgO1xyXG4gICAgICAgIFRlc3RSZXNwb25zZS5wcm90b3R5cGUuZG9QYXJzZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMuX19wYXJhbXMuc3VjY2VzcyA9IGRhdGEuc3VjY2VzcztcclxuICAgICAgICAgICAgdGhpcy50ZXN0ID0gbmV3IFRlc3RfMS5kZWZhdWx0KCkucGFyc2UoZGF0YS50ZXN0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRlc3RSZXNwb25zZS5wcm90b3R5cGUucGFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRlc3Q6IHRoaXMudGVzdC5wYWNrKClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRlc3RSZXNwb25zZS50eXBlID0gXCJUZXN0XCI7XHJcbiAgICAgICAgcmV0dXJuIFRlc3RSZXNwb25zZTtcclxuICAgIH0oUmVzcG9uc2VEYXRhXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdFJlc3BvbnNlO1xyXG4gICAgLyoqIOazqOWGjOi/lOWbnuS9kyAqL1xyXG4gICAgTmV0TWFuYWdlcl8xLm5ldE1hbmFnZXIucmVnaXN0ZXJSZXNwb25zZShUZXN0UmVzcG9uc2UpO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVkdWemRGSmxjM0J2Ym5ObExtcHpJaXdpYzI5MWNtTmxVbTl2ZENJNklpSXNJbk52ZFhKalpYTWlPbHNpVkdWemRGSmxjM0J2Ym5ObExuUnpJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSTdPenM3T3pzN096czdPenM3U1VGSlFUczdPenM3TzAxQlRVVTdTVUZEUmp0UlFVRXdReXhuUTBGQldUdFJRVUYwUkRzN1VVRnJRMEVzUTBGQlF6dFJRWGhDUnl4elFrRkJWeXhyUTBGQlVUdHBRa0ZCYmtJN1owSkJSVWtzVFVGQlRTeERRVUZETzI5Q1FVTklMRWxCUVVrc1JVRkJSU3hOUVVGTk8yOUNRVU5hTEZGQlFWRXNSVUZCUlN4TlFVRk5PMjlDUVVOb1FpeE5RVUZOTEVWQlFVVXNTMEZCU3p0cFFrRkRhRUlzUTBGQlF6dFpRVU5PTEVOQlFVTTdPenRYUVVGQk8xRkJRVUVzUTBGQlF6dFJRVWxSTERoQ1FVRlBMRWRCUVdwQ0xGVkJRV3RDTEVsQlFWRTdXVUZGZEVJc1JVRkJSU3hEUVVGQkxFTkJRVU1zU1VGQlNTeEpRVUZKTEVsQlFVa3NRMEZCUXp0blFrRkJReXhOUVVGTkxFTkJRVU03V1VGRGVFSXNTVUZCU1N4RFFVRkRMRkZCUVZFc1EwRkJReXhQUVVGUExFZEJRVWNzU1VGQlNTeERRVUZETEU5QlFVOHNRMEZCUXp0WlFVTnlReXhKUVVGSkxFTkJRVU1zU1VGQlNTeEhRVUZUTEVsQlFVa3NZMEZCU1N4RlFVRkZMRU5CUVVNc1MwRkJTeXhEUVVGRExFbEJRVWtzUTBGQlF5eEpRVUZKTEVOQlFVTXNRMEZCUXp0UlFVTnNSQ3hEUVVGRE8xRkJSVTBzTWtKQlFVa3NSMEZCV0R0WlFVVkpMRTFCUVUwc1EwRkJRenRuUWtGRFNDeEpRVUZKTEVWQlFVVXNTVUZCU1N4RFFVRkRMRWxCUVVrc1EwRkJReXhKUVVGSkxFVkJRVVU3WVVGRGVrSXNRMEZCUXp0UlFVTk9MRU5CUVVNN1VVRmtZU3hwUWtGQlNTeEhRVUZWTEUxQlFVMHNRMEZCUXp0UlFXVjJReXh0UWtGQlF6dExRVUZCTEVGQmJFTkVMRU5CUVRCRExITkNRVUZaTEVkQmEwTnlSRHR6UWtGc1EyOUNMRmxCUVZrN1NVRnZRMnBETEZsQlFWazdTVUZEV2l4MVFrRkJWU3hEUVVGRExHZENRVUZuUWl4RFFVRkRMRmxCUVZrc1EwRkJReXhEUVVGREluMD1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbmV0L3Jlc3BvbnNlL1Rlc3RSZXNwb25zZS50c1xuLy8gbW9kdWxlIGlkID0gNTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xyXG59O1xyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJvbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yLWVncmV0L2VncmV0L2luamVjdG9yL0luamVjdG9yXCIsIFwiLi9UZXN0Q29tcFwiLCBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1hbmFnZXJcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBTY2VuZU1lZGlhdG9yXzEsIEluamVjdG9yXzEsIEluamVjdG9yXzIsIFRlc3RDb21wXzEsIE1vZHVsZU1hbmFnZXJfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBhdXRob3IgUmF5a2lkXHJcbiAgICAgKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gICAgICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMThcclxuICAgICAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAgICAgKlxyXG4gICAgICog5rWL6K+V56ys5LqM5Liq5qih5Z2XXHJcbiAgICAqL1xyXG4gICAgdmFyIFNlY29uZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoU2Vjb25kLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFNlY29uZCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBTZWNvbmQucHJvdG90eXBlLmxpc3RBc3NldHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXCJwcmVsb2FkXCJdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU2Vjb25kLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMubWFwTGlzdGVuZXIodGhpcy5idG4sIGVncmV0LlRvdWNoRXZlbnQuVE9VQ0hfVEFQLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtb2R1bGVNYW5hZ2VyLmNsb3NlKFNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaChcIkZ1Y2tNc2dcIiwgXCJTaGl0ISEhXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBvbk1zZzogZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOihqOi+vuW8j+mHjOS9v+eUqOWHveaVsOWPr+S7peWcqOWHveaVsOmHjOaJp+ihjOWkjeadgumAu+i+ke+8jOW5tuS4lOWFt+acieS7o+eggeaPkOekulxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kdWxlTWFuYWdlcl8xLm1vZHVsZU1hbmFnZXIuY2xvc2UoX3RoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtc2cgKyBcIiAtIDFcIjtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdWNrOiBcInlvdVwiLFxyXG4gICAgICAgICAgICAgICAgZnVja0xpc3Q6IFtcImZ1Y2tcIiwgXCJzaGl0XCIsIFwieW91XCIsIFwiISEhXCJdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIOa1i+ivlea2iOaBr1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoKFwiZnVja1wiLCAxMjMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU2Vjb25kLnByb3RvdHlwZS5vbkZ1Y2sgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1lc3NhZ2UgYXQgU2Vjb25kOiBcIiArIGEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU2Vjb25kLnByb3RvdHlwZS5vblRlc3RDb21wTXNnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRlc3RDb21wTXNnIFJlY2VpdmVkXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgU2Vjb25kLnByb3RvdHlwZS5vblRlc3RDb21wTXNnR2xvYmFsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRlc3RDb21wTXNnIFJlY2VpdmVkIEdsb2JhbFwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFNlY29uZC5tb2R1bGVOYW1lID0gXCJTZWNvbmRcIjtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5TdWJNZWRpYXRvcixcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFRlc3RDb21wXzEuZGVmYXVsdClcclxuICAgICAgICBdLCBTZWNvbmQucHJvdG90eXBlLCBcIl90ZXN0Q29tcFwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRNZXNzYWdlKFwiRnVja01zZ1wiLCB7IGxhYmVsOiBcIm9uTXNnKCRhcmd1bWVudHNbMF0pXCIgfSksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuQmluZEZ1bmMoXCJnZXRDdXJyZW50U3RhdGVcIiwgW1wiZnVja1wiLCBcIm9uTXNnXCIsIHVuZGVmaW5lZF0pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgZXVpLkJ1dHRvbilcclxuICAgICAgICBdLCBTZWNvbmQucHJvdG90eXBlLCBcImJ0blwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRGb3IoXCJpIG9mIGZ1Y2tMaXN0LmNvbmNhdChmdWNrTGlzdCkuY29uY2F0KGZ1Y2tMaXN0KS5jb25jYXQoZnVja0xpc3QpXCIpLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRWYWx1ZShcInR4dC50ZXh0XCIsIGZ1bmN0aW9uIChzY29wZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLmk7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRGb3IoXCJsc3RcIiwgXCJqIG9mIGZ1Y2tMaXN0XCIpLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRWYWx1ZSh7XHJcbiAgICAgICAgICAgICAgICB0eHQ6IHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIidpPScgKyBpICsgJyAmICcgKyAnaj0nICsgalwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgZXVpLkRhdGFHcm91cClcclxuICAgICAgICBdLCBTZWNvbmQucHJvdG90eXBlLCBcImxzdFwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLk1lc3NhZ2VIYW5kbGVyKFwiZnVja1wiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5HbG9iYWxNZXNzYWdlSGFuZGxlcihcImZ1Y2tcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJvbkZ1Y2tcIiwgbnVsbCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuTWVzc2FnZUhhbmRsZXIoXCJUZXN0Q29tcE1zZ1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcclxuICAgICAgICBdLCBTZWNvbmQucHJvdG90eXBlLCBcIm9uVGVzdENvbXBNc2dcIiwgbnVsbCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuR2xvYmFsTWVzc2FnZUhhbmRsZXIoXCJUZXN0Q29tcE1zZ1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcclxuICAgICAgICBdLCBTZWNvbmQucHJvdG90eXBlLCBcIm9uVGVzdENvbXBNc2dHbG9iYWxcIiwgbnVsbCk7XHJcbiAgICAgICAgU2Vjb25kID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuRWdyZXRNZWRpYXRvckNsYXNzKFwiU2Vjb25kXCIsIFwiRnVjazJTa2luXCIpXHJcbiAgICAgICAgXSwgU2Vjb25kKTtcclxuICAgICAgICByZXR1cm4gU2Vjb25kO1xyXG4gICAgfShTY2VuZU1lZGlhdG9yXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gU2Vjb25kO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVTJWamIyNWtMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVUyVmpiMjVrTG5SeklsMHNJbTVoYldWeklqcGJYU3dpYldGd2NHbHVaM01pT2lJN096czdPenM3T3pzN096czdPenM3T3pzN096czdTVUZOUVRzN096czdPenROUVU5Rk8wbEJSMFk3VVVGQmIwTXNNRUpCUVdFN1VVRkJha1E3TzFGQmEwVkJMRU5CUVVNN1VVRTFRMVVzTWtKQlFWVXNSMEZCYWtJN1dVRkZTU3hOUVVGTkxFTkJRVU1zUTBGQlF5eFRRVUZUTEVOQlFVTXNRMEZCUXp0UlFVTjJRaXhEUVVGRE8xRkJSVTBzZFVKQlFVMHNSMEZCWWp0WlFVRkJMR2xDUVcxQ1F6dFpRV3BDUnl4SlFVRkpMRU5CUVVNc1YwRkJWeXhEUVVGRExFbEJRVWtzUTBGQlF5eEhRVUZITEVWQlFVVXNTMEZCU3l4RFFVRkRMRlZCUVZVc1EwRkJReXhUUVVGVExFVkJRVVU3WjBKQlEyNUVMQ3RDUVVFclFqdG5Ra0ZGTDBJc1MwRkJTU3hEUVVGRExGRkJRVkVzUTBGQlF5eFRRVUZUTEVWQlFVVXNVMEZCVXl4RFFVRkRMRU5CUVVNN1dVRkRlRU1zUTBGQlF5eERRVUZETEVOQlFVTTdXVUZEU0N4SlFVRkpMRU5CUVVNc1UwRkJVeXhIUVVGSE8yZENRVU5pTEV0QlFVc3NSVUZCUlN4VlFVRkJMRWRCUVVjN2IwSkJRMDRzWjBOQlFXZERPMjlDUVVOb1F5eFBRVUZQTEVOQlFVTXNSMEZCUnl4RFFVRkRMRWRCUVVjc1EwRkJReXhEUVVGRE8yOUNRVU5xUWl3MlFrRkJZU3hEUVVGRExFdEJRVXNzUTBGQlF5eExRVUZKTEVOQlFVTXNRMEZCUXp0dlFrRkRNVUlzVFVGQlRTeERRVUZETEVkQlFVY3NSMEZCUnl4TlFVRk5MRU5CUVVNN1owSkJRM2hDTEVOQlFVTTdaMEpCUTBRc1NVRkJTU3hGUVVGRkxFdEJRVXM3WjBKQlExZ3NVVUZCVVN4RlFVRkZMRU5CUVVNc1RVRkJUU3hGUVVGRkxFMUJRVTBzUlVGQlJTeExRVUZMTEVWQlFVVXNTMEZCU3l4RFFVRkRPMkZCUXpORExFTkJRVU03V1VGRFJpeFBRVUZQTzFsQlExQXNTVUZCU1N4RFFVRkRMRkZCUVZFc1EwRkJReXhOUVVGTkxFVkJRVVVzUjBGQlJ5eERRVUZETEVOQlFVTTdVVUZETDBJc1EwRkJRenRSUVVsUExIVkNRVUZOTEVkQlFXUXNWVUZCWlN4RFFVRkRPMWxCUlZvc1QwRkJUeXhEUVVGRExFZEJRVWNzUTBGQlF5eHhRa0ZCY1VJc1IwRkJSeXhEUVVGRExFTkJRVU1zUTBGQlF6dFJRVU16UXl4RFFVRkRPMUZCUjA4c09FSkJRV0VzUjBGQmNrSTdXVUZGU1N4UFFVRlBMRU5CUVVNc1IwRkJSeXhEUVVGRExITkNRVUZ6UWl4RFFVRkRMRU5CUVVNN1VVRkRlRU1zUTBGQlF6dFJRVWRQTEc5RFFVRnRRaXhIUVVFelFqdFpRVVZKTEU5QlFVOHNRMEZCUXl4SFFVRkhMRU5CUVVNc05rSkJRVFpDTEVOQlFVTXNRMEZCUXp0UlFVTXZReXhEUVVGRE8xRkJMMFJoTEdsQ1FVRlZMRWRCUVZVc1VVRkJVU3hEUVVGRE8xRkJSek5ETzFsQlJFTXNjMEpCUVZjN2MwTkJRMDBzYTBKQlFWRTdhVVJCUVVNN1VVRkpNMEk3V1VGR1F5eHpRa0ZCVnl4RFFVRkRMRk5CUVZNc1JVRkJSU3hGUVVGRExFdEJRVXNzUlVGQlJTeHpRa0ZCYzBJc1JVRkJReXhEUVVGRE8xbEJRM1pFTEcxQ1FVRlJMRU5CUVVNc2FVSkJRV2xDTEVWQlFVVXNRMEZCUXl4TlFVRk5MRVZCUVVVc1QwRkJUeXhGUVVGRkxGTkJRVk1zUTBGQlF5eERRVUZETzNORFFVTXZReXhIUVVGSExFTkJRVU1zVFVGQlRUc3lRMEZCUXp0UlFWZDBRanRaUVZaRExHdENRVUZQTEVOQlFVTXNhMFZCUVd0RkxFTkJRVU03V1VGRE0wVXNiMEpCUVZNc1EwRkJReXhWUVVGVkxFVkJRVVVzVlVGQlV5eExRVUZUTzJkQ1FVTnlReXhOUVVGTkxFTkJRVU1zUzBGQlN5eERRVUZETEVOQlFVTXNRMEZCUXp0WlFVTnVRaXhEUVVGRExFTkJRVU03V1VGRFJDeHJRa0ZCVHl4RFFVRkRMRXRCUVVzc1JVRkJSU3hsUVVGbExFTkJRVU03V1VGREwwSXNiMEpCUVZNc1EwRkJRenRuUWtGRFVDeEhRVUZITEVWQlFVVTdiMEpCUTBRc1NVRkJTU3hGUVVGRkxEWkNRVUUyUWp0cFFrRkRkRU03WVVGRFNpeERRVUZETzNORFFVTlRMRWRCUVVjc1EwRkJReXhUUVVGVE96SkRRVUZETzFGQk9FSjZRanRaUVVaRExIbENRVUZqTEVOQlFVTXNUVUZCVFN4RFFVRkRPMWxCUTNSQ0xDdENRVUZ2UWl4RFFVRkRMRTFCUVUwc1EwRkJRenM3T3pzMFEwRkpOVUk3VVVGSFJEdFpRVVJETEhsQ1FVRmpMRU5CUVVNc1lVRkJZU3hEUVVGRE96czdPMjFFUVVrM1FqdFJRVWRFTzFsQlJFTXNLMEpCUVc5Q0xFTkJRVU1zWVVGQllTeERRVUZET3pzN08zbEVRVWx1UXp0UlFXcEZaMElzVFVGQlRUdFpRVVF4UWl3MlFrRkJhMElzUTBGQlF5eFJRVUZSTEVWQlFVVXNWMEZCVnl4RFFVRkRPMWRCUTNKQ0xFMUJRVTBzUTBGclJURkNPMUZCUVVRc1lVRkJRenRMUVVGQkxFRkJiRVZFTEVOQlFXOURMSFZDUVVGaExFZEJhMFZvUkR0elFrRnNSVzlDTEUxQlFVMGlmUT09XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21vZHVsZXMvU2Vjb25kLnRzXG4vLyBtb2R1bGUgaWQgPSA1MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBsaXN0ZW5Db25zdHJ1Y3QgfSBmcm9tIFwib2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWxcIjtcclxuaW1wb3J0IHsgTWVkaWF0b3JDbGFzcyB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0wOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0wOVxyXG4gKlxyXG4gKiDotJ/otKPms6jlhaXnmoTmqKHlnZdcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEVncmV0U2tpbihza2luKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xyXG4gICAgICAgIC8vIOebkeWQrOexu+Wei+WunuS+i+WMlu+8jOi9rOaNouearuiCpOagvOW8j1xyXG4gICAgICAgIGxpc3RlbkNvbnN0cnVjdChjbHMsIGZ1bmN0aW9uIChtZWRpYXRvcikgeyByZXR1cm4gbWVkaWF0b3Iuc2tpbiA9IHNraW47IH0pO1xyXG4gICAgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gRWdyZXRNZWRpYXRvckNsYXNzKG1vZHVsZU5hbWUsIHNraW4pIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgLy8g6LCD55SoTWVkaWF0b3JDbGFzc+aWueazlVxyXG4gICAgICAgIGNscyA9IE1lZGlhdG9yQ2xhc3MobW9kdWxlTmFtZSkoY2xzKTtcclxuICAgICAgICAvLyDnm5HlkKznsbvlnovlrp7kvovljJbvvIzovazmjaLnmq7ogqTmoLzlvI9cclxuICAgICAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAobWVkaWF0b3IpIHsgcmV0dXJuIG1lZGlhdG9yLnNraW4gPSBza2luOyB9KTtcclxuICAgICAgICAvLyDov5Tlm57nu5PmnpznsbvlnotcclxuICAgICAgICByZXR1cm4gY2xzO1xyXG4gICAgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9pbmplY3Rvci9JbmplY3Rvci5qc1xuLy8gbW9kdWxlIGlkID0gNTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xyXG59O1xyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1lZGlhdG9yXCIsIFwib2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNYW5hZ2VyXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgSW5qZWN0b3JfMSwgUGFuZWxNZWRpYXRvcl8xLCBJbmplY3Rvcl8yLCBNb2R1bGVNYW5hZ2VyXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgdmFyIFRlc3RQYW5lbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoVGVzdFBhbmVsLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RQYW5lbCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBUZXN0UGFuZWxfMSA9IFRlc3RQYW5lbDtcclxuICAgICAgICBUZXN0UGFuZWwucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kdWxlTWFuYWdlcl8xLm1vZHVsZU1hbmFnZXIuY2xvc2UoVGVzdFBhbmVsXzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGVzdFBhbmVsLm1vZHVsZU5hbWUgPSBcIlRlc3RQYW5lbFwiO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRPbihcImNsaWNrXCIsIFwib25DbGlja1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIFRlc3RQYW5lbC5wcm90b3R5cGUsIFwic2tpblwiLCB2b2lkIDApO1xyXG4gICAgICAgIFRlc3RQYW5lbCA9IFRlc3RQYW5lbF8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuRE9NTWVkaWF0b3JDbGFzcyhcIlRlc3RQYW5lbFwiLCBcIlxcbiAgICA8ZGl2IHN0eWxlPVxcXCJiYWNrZ3JvdW5kOiNmZmZmZmY7IHdpZHRoOjQwMHB4OyBoZWlnaHQ6IDI1MHB4O1xcXCI+XFxuICAgICAgICBqbGsxMjRrbDFqMlxcbiAgICA8L2Rpdj5cXG5cIilcclxuICAgICAgICBdLCBUZXN0UGFuZWwpO1xyXG4gICAgICAgIHJldHVybiBUZXN0UGFuZWw7XHJcbiAgICAgICAgdmFyIFRlc3RQYW5lbF8xO1xyXG4gICAgfShQYW5lbE1lZGlhdG9yXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdFBhbmVsO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVkdWemRGQmhibVZzTG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lWR1Z6ZEZCaGJtVnNMblJ6SWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1NVRlZRVHRSUVVGMVF5dzJRa0ZCWVR0UlFVRndSRHM3VVVGbFFTeERRVUZETzNOQ1FXWnZRaXhUUVVGVE8xRkJUMjVDTERCQ1FVRk5MRWRCUVdJN1dVRkZTU3hKUVVGSkxFTkJRVU1zVTBGQlV5eEhRVUZITzJkQ1FVTmlMRTlCUVU4c1JVRkJSVHR2UWtGRFRDdzJRa0ZCWVN4RFFVRkRMRXRCUVVzc1EwRkJReXhYUVVGVExFTkJRVU1zUTBGQlF6dG5Ra0ZEYmtNc1EwRkJRenRoUVVOS0xFTkJRVU03VVVGRFRpeERRVUZETzFGQldtRXNiMEpCUVZVc1IwRkJWU3hYUVVGWExFTkJRVU03VVVGSE9VTTdXVUZFUXl4cFFrRkJUU3hEUVVGRExFOUJRVThzUlVGQlJTeFRRVUZUTEVOQlFVTTdjME5CUTJZc1YwRkJWenNyUTBGQlF6dFJRVXhRTEZOQlFWTTdXVUZNTjBJc01rSkJRV2RDTEVOQlFVTXNWMEZCVnl4RlFVRkZMREJIUVVrNVFpeERRVUZETzFkQlEyMUNMRk5CUVZNc1EwRmxOMEk3VVVGQlJDeG5Ra0ZCUXpzN1MwRkJRU3hCUVdaRUxFTkJRWFZETEhWQ1FVRmhMRWRCWlc1RU8zTkNRV1p2UWl4VFFVRlRJbjA9XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21vZHVsZXMvVGVzdFBhbmVsLnRzXG4vLyBtb2R1bGUgaWQgPSA1NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLy8gPHJlZmVyZW5jZSB0eXBlcz1cIm9seW1wdXMtclwiLz5cclxuLy8vIDxyZWZlcmVuY2UgdHlwZXM9XCJvbHltcHVzLXItZG9tXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSB0eXBlcz1cIm9seW1wdXMtci1lZ3JldFwiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4vZWdyZXQvbGlicy9tb2R1bGVzL2VncmV0L2VncmV0LmQudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2VncmV0L2xpYnMvbW9kdWxlcy9yZXMvcmVzLmQudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2VncmV0L2xpYnMvbW9kdWxlcy9ldWkvZXVpLmQudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2VncmV0L2xpYnMvbW9kdWxlcy90d2Vlbi90d2Vlbi5kLnRzXCIvPlxyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCIuL21vZHVsZXMvRmlyc3RcIiwgXCJvbHltcHVzLXIvT2x5bXB1c1wiLCBcIm9seW1wdXMtci9lbmdpbmUvZW52L0Vudmlyb25tZW50XCIsIFwib2x5bXB1cy1yLWRvbS9ET01CcmlkZ2VcIiwgXCJvbHltcHVzLXItZWdyZXQvRWdyZXRCcmlkZ2VcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBGaXJzdF8xLCBPbHltcHVzXzEsIEVudmlyb25tZW50XzEsIERPTUJyaWRnZV8xLCBFZ3JldEJyaWRnZV8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQGF1dGhvciBSYXlraWRcclxuICAgICAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAgICAgKiBAY3JlYXRlIGRhdGUgMjAxNy0wOC0zMVxyXG4gICAgICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDFcclxuICAgICAqXHJcbiAgICAgKiDmtYvor5Xpobnnm65cclxuICAgICovXHJcbiAgICBPbHltcHVzXzEuZGVmYXVsdC5zdGFydHVwKHtcclxuICAgICAgICBicmlkZ2VzOiBbXHJcbiAgICAgICAgICAgIG5ldyBET01CcmlkZ2VfMS5kZWZhdWx0KHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogXCIjcm9vdERPTVwiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBuZXcgRWdyZXRCcmlkZ2VfMS5kZWZhdWx0KHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiA3MjAsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEyODAsXHJcbiAgICAgICAgICAgICAgICBwYXRoUHJlZml4OiBcImVncmV0L1wiLFxyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBcIiNyb290RWdyZXRcIixcclxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogMCxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICBdLFxyXG4gICAgICAgIGZpcnN0TW9kdWxlOiBGaXJzdF8xLmRlZmF1bHQsXHJcbiAgICAgICAgbG9hZEVsZW1lbnQ6IFwiI2xvYWRpbmdcIixcclxuICAgICAgICBob3N0c0RpY3Q6IHtcclxuICAgICAgICAgICAgZGV2OiBbXCJodHRwOi8vd3d3LnRlc3QuMTd6dW95ZS5uZXQvXCJdLFxyXG4gICAgICAgICAgICB0ZXN0OiBbXCJodHRwczovL3d3dy50ZXN0LjE3enVveWUubmV0L1wiXSxcclxuICAgICAgICAgICAgc3RhZ2luZzogW1wiaHR0cHM6Ly93d3cuc3RhZ2luZy4xN3p1b3llLm5ldC9cIl0sXHJcbiAgICAgICAgICAgIHByb2Q6IFtcImh0dHBzOi8vd3d3LjE3enVveWUuY29tL1wiXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2Ruc0RpY3Q6IHtcclxuICAgICAgICAgICAgdGVzdDogW1wiaHR0cHM6Ly9jZG4tY25jLnRlc3QuMTd6dW95ZS5uZXQvXCJdLFxyXG4gICAgICAgICAgICBzdGFnaW5nOiBbXCJodHRwczovL2Nkbi1jbmMuc3RhZ2luZy4xN3p1b3llLm5ldC9cIl0sXHJcbiAgICAgICAgICAgIHByb2Q6IFtcImh0dHBzOi8vY2RuLWNuYy4xN3p1b3llLmNvbS9cIl1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHBhdGhEaWN0OiB7XHJcbiAgICAgICAgICAgIGE6IFwidGVzdDEuanNcIixcclxuICAgICAgICAgICAgYjogXCJ0ZXN0Mi5qc1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcmVsb2FkczogW1wiYVwiLCBcImJcIl0sXHJcbiAgICAgICAgb25Jbml0ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoXCJFZ3JldFwiKS5kZWZhdWx0U2NlbmVQb2xpY3kgPSBub25lO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhFbnZpcm9ubWVudF8xLmVudmlyb25tZW50LmVudiwgRW52aXJvbm1lbnRfMS5lbnZpcm9ubWVudC5nZXRIb3N0KCksIEVudmlyb25tZW50XzEuZW52aXJvbm1lbnQuY3VyQ0ROSG9zdCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkluaXRQcm9ncmVzczogZnVuY3Rpb24gKHByZywgc3RlcCkge1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBbcHJnLCBzdGVwXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pYldGcGJpNXFjeUlzSW5OdmRYSmpaVkp2YjNRaU9pSWlMQ0p6YjNWeVkyVnpJanBiSW0xaGFXNHVkSE1pWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJa0ZCUVVFc2EwTkJRV3RETzBGQlEyeERMSE5EUVVGelF6dEJRVU4wUXl4M1EwRkJkME03UVVGRGVFTXNOa1JCUVRaRU8wRkJRemRFTEhsRVFVRjVSRHRCUVVONlJDeDVSRUZCZVVRN1FVRkRla1FzTmtSQlFUWkVPenM3TzBsQlZ6ZEVPenM3T3pzN08wMUJUMFU3U1VGRFJpeHBRa0ZCVHl4RFFVRkRMRTlCUVU4c1EwRkJRenRSUVVOYUxFOUJRVThzUlVGQlJUdFpRVU5NTEVsQlFVa3NiVUpCUVZNc1EwRkJRenRuUWtGRFZpeFRRVUZUTEVWQlFVVXNWVUZCVlR0aFFVTjRRaXhEUVVGRE8xbEJRMFlzU1VGQlNTeHhRa0ZCVnl4RFFVRkRPMmRDUVVOYUxFdEJRVXNzUlVGQlJTeEhRVUZITzJkQ1FVTldMRTFCUVUwc1JVRkJSU3hKUVVGSk8yZENRVU5hTEZWQlFWVXNSVUZCUlN4UlFVRlJPMmRDUVVOd1FpeFRRVUZUTEVWQlFVVXNXVUZCV1R0blFrRkRka0lzWlVGQlpTeEZRVUZGTEVOQlFVTTdZVUZGY2tJc1EwRkJRenRUUVVOTU8xRkJRMFFzVjBGQlZ5eEZRVUZGTEdWQlFVczdVVUZEYkVJc1YwRkJWeXhGUVVGRkxGVkJRVlU3VVVGRGRrSXNVMEZCVXl4RlFVRkZPMWxCUTFBc1IwRkJSeXhGUVVGRkxFTkJRVU1zT0VKQlFUaENMRU5CUVVNN1dVRkRja01zU1VGQlNTeEZRVUZGTEVOQlFVTXNLMEpCUVN0Q0xFTkJRVU03V1VGRGRrTXNUMEZCVHl4RlFVRkZMRU5CUVVNc2EwTkJRV3RETEVOQlFVTTdXVUZETjBNc1NVRkJTU3hGUVVGRkxFTkJRVU1zTUVKQlFUQkNMRU5CUVVNN1UwRkRja003VVVGRFJDeFJRVUZSTEVWQlFVVTdXVUZEVGl4SlFVRkpMRVZCUVVVc1EwRkJReXh0UTBGQmJVTXNRMEZCUXp0WlFVTXpReXhQUVVGUExFVkJRVVVzUTBGQlF5eHpRMEZCYzBNc1EwRkJRenRaUVVOcVJDeEpRVUZKTEVWQlFVVXNRMEZCUXl3NFFrRkJPRUlzUTBGQlF6dFRRVU42UXp0UlFVTkVMRkZCUVZFc1JVRkJSVHRaUVVOT0xFTkJRVU1zUlVGQlJTeFZRVUZWTzFsQlEySXNRMEZCUXl4RlFVRkZMRlZCUVZVN1UwRkRhRUk3VVVGRFJDeFJRVUZSTEVWQlFVVXNRMEZCUXl4SFFVRkhMRVZCUVVVc1IwRkJSeXhEUVVGRE8xRkJRM0JDTEZGQlFWRXNSVUZCUlR0WlFVVk9MRGhFUVVFNFJEdFpRVU01UkN4UFFVRlBMRU5CUVVNc1IwRkJSeXhEUVVGRExIbENRVUZYTEVOQlFVTXNSMEZCUnl4RlFVRkZMSGxDUVVGWExFTkJRVU1zVDBGQlR5eEZRVUZGTEVWQlFVVXNlVUpCUVZjc1EwRkJReXhWUVVGVkxFTkJRVU1zUTBGQlF6dFJRVU5vUml4RFFVRkRPMUZCUTBRc1kwRkJZeXhGUVVGRkxGVkJRVU1zUjBGQlZTeEZRVUZGTEVsQlFXRTdXVUZCUlN4alFVRlBPMmxDUVVGUUxGVkJRVThzUlVGQlVDeHhRa0ZCVHl4RlFVRlFMRWxCUVU4N1owSkJRVkFzTmtKQlFVODdPMWxCUXk5RExFOUJRVThzUTBGQlF5eEhRVUZITEU5QlFWZ3NUMEZCVHl4SFFVRkxMRWRCUVVjc1JVRkJSU3hKUVVGSkxGTkJRVXNzU1VGQlNTeEhRVUZGTzFGQlEzQkRMRU5CUVVNN1MwRkRTaXhEUVVGRExFTkJRVU1pZlE9PVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9tYWluLnRzXG4vLyBtb2R1bGUgaWQgPSA1NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fbWV0YWRhdGEgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XHJcbn07XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci1kb20vZG9tL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL2F1ZGlvL0F1ZGlvTWFuYWdlclwiLCBcIm9seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNYW5hZ2VyXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWVzc2FnZVwiLCBcIm9seW1wdXMtci9lbmdpbmUvc2NlbmUvU2NlbmVNZWRpYXRvclwiLCBcIi4uL21vZGVscy9GdWNrTW9kZWxcIiwgXCIuLi9uZXQvcmVxdWVzdC9UZXN0UmVxdWVzdFwiLCBcIi4uL25ldC9yZXNwb25zZS9UZXN0UmVzcG9uc2VcIiwgXCIuL1NlY29uZFwiLCBcIi4vVGVzdEZvck1lZGlhdG9yXCIsIFwiLi9UaGlyZFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIEluamVjdG9yXzEsIEluamVjdG9yXzIsIEF1ZGlvTWFuYWdlcl8xLCBJbmplY3Rvcl8zLCBNb2R1bGVNYW5hZ2VyXzEsIE1vZHVsZU1lc3NhZ2VfMSwgU2NlbmVNZWRpYXRvcl8xLCBGdWNrTW9kZWxfMSwgVGVzdFJlcXVlc3RfMSwgVGVzdFJlc3BvbnNlXzEsIFNlY29uZF8xLCBUZXN0Rm9yTWVkaWF0b3JfMSwgVGhpcmRfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBhdXRob3IgUmF5a2lkXHJcbiAgICAgKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gICAgICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMThcclxuICAgICAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAgICAgKlxyXG4gICAgICog5rWL6K+V6aaW5Liq5qih5Z2XXHJcbiAgICAqL1xyXG4gICAgdmFyIEZpcnN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgICAgIF9fZXh0ZW5kcyhGaXJzdCwgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBGaXJzdCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBGaXJzdF8xID0gRmlyc3Q7XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLmxpc3RBc3NldHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXCIuL21vZHVsZXMvdGVzdC5odG1sXCJdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLmxpc3RKc0ZpbGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW1widGVzdDEuanNcIiwgXCIuL3Rlc3QyLmpzXCJdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgLy8gdGhpcy5tYXBMaXN0ZW5lcih0aGlzLmJ0biwgXCJjbGlja1wiLCBmdW5jdGlvbigpOnZvaWRcclxuICAgICAgICAgICAgLy8ge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy50eHQudGV4dENvbnRlbnQgPSBcIkZ1Y2sgeW91ISEhXCI7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLm1vZHVsZU1hbmFnZXIub3BlbihTZWNvbmQpO1xyXG4gICAgICAgICAgICAvLyB9LCB0aGlzKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5mdWNrTW9kZWwxLmZ1Y2ssIHRoaXMuZnVja01vZGVsMSA9PT0gdGhpcy5mdWNrTW9kZWwyLCB0aGlzLmZ1Y2tNb2RlbDEgPT09IHRoaXMuZnVja01vZGVsMyk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld01vZGVsID0ge1xyXG4gICAgICAgICAgICAgICAgZnVja0xpc3Q6IFsxLCAyLCBcInNoaXRcIiwgXCJ5b3VcIl0sXHJcbiAgICAgICAgICAgICAgICBmdWNrVGV4dDogXCJmdWNrIHlvdVwiLFxyXG4gICAgICAgICAgICAgICAgb25DbGlja0J0bjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnZpZXdNb2RlbC5mdWNrVGV4dCA9IFwiY2xpY2tlZFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMubW9kdWxlTWFuYWdlci5vcGVuKFNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFNlY29uZF8xLmRlZmF1bHQoKS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb25DbGlja0Z1Y2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2R1bGVNYW5hZ2VyLm9wZW4oVGhpcmRfMS5kZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdWNrTW9kZWw6IHRoaXMuZnVja01vZGVsMVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXJfMS5hdWRpb01hbmFnZXIucGxheU11c2ljKHtcclxuICAgICAgICAgICAgICAgIHVybDogXCIuL3Rlc3QubXAzXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMudmlld01vZGVsLmZ1Y2tUZXh0ID0gXCIxMjM0XCI7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnZpZXdNb2RlbC5mdWNrTGlzdCA9IFtcImhlbGxvXCIsIFwid29ybGRcIl07XHJcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3TW9kZWwuZnVja0xpc3QucHVzaChcImpma3NkamxmXCIpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZnVja01vZGVsMS5mdWNrID0gXCJZb3UhISFcIjtcclxuICAgICAgICAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2gobmV3IFRlc3RSZXF1ZXN0XzEuZGVmYXVsdCgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIEZpcnN0LnByb3RvdHlwZS5vbk1vZHVsZUNoYW5nZSA9IGZ1bmN0aW9uICh0bywgZnJvbSkge1xyXG4gICAgICAgICAgICBpZiAodG8gPT0gRmlyc3RfMSlcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlIHRvIGZpcnN0IG1vZHVsZSFcIik7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRvID09IFNlY29uZF8xLmRlZmF1bHQpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNoYW5nZSB0byBzZWNvbmQgbW9kdWxlIVwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIEZpcnN0LnByb3RvdHlwZS5vblJlc3BvbnNlID0gZnVuY3Rpb24gKHJlcywgcmVxKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwiMTIzXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLm9uRnVjayA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibWVzc2FnZSBhdCBGaXJzdE1vZHVsZTogXCIgKyBhKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIEZpcnN0Lm1vZHVsZU5hbWUgPSBcIkZpcnN0XCI7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuSW5qZWN0LFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTW9kdWxlTWFuYWdlcl8xLmRlZmF1bHQpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcIm1vZHVsZU1hbmFnZXJcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5JbmplY3QsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdWNrTW9kZWxfMS5kZWZhdWx0KVxyXG4gICAgICAgIF0sIEZpcnN0LnByb3RvdHlwZSwgXCJmdWNrTW9kZWwxXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuSW5qZWN0LFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVja01vZGVsXzEuSUZ1Y2tNb2RlbClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwiZnVja01vZGVsMlwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkluamVjdCgxKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1Y2tNb2RlbF8xLklGdWNrTW9kZWwpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcImZ1Y2tNb2RlbDNcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5CaW5kT24oeyBjbGljazogXCJvbkNsaWNrQnRuXCIgfSksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuQmluZElmKFwiZnVja1RleHQgPT0gJzEyMzQnXCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcImJ0blwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8zLkJpbmRGb3IoXCJmdWNrIG9mIGZ1Y2tMaXN0XCIsIFRlc3RGb3JNZWRpYXRvcl8xLmRlZmF1bHQpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcInR4dFwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8zLkJpbmRPbihcImNsaWNrXCIsIFwib25DbGlja0Z1Y2tcIiksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuQmluZFZhbHVlKFwidGV4dENvbnRlbnRcIiwgXCJmdWNrTW9kZWwuZnVja1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIEZpcnN0LnByb3RvdHlwZSwgXCJmdWNrXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuTWVzc2FnZUhhbmRsZXIoTW9kdWxlTWVzc2FnZV8xLmRlZmF1bHQuTU9EVUxFX0NIQU5HRSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0LCBPYmplY3RdKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwib25Nb2R1bGVDaGFuZ2VcIiwgbnVsbCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuUmVzcG9uc2VIYW5kbGVyLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1Rlc3RSZXNwb25zZV8xLmRlZmF1bHQsIFRlc3RSZXF1ZXN0XzEuZGVmYXVsdF0pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxyXG4gICAgICAgIF0sIEZpcnN0LnByb3RvdHlwZSwgXCJvblJlc3BvbnNlXCIsIG51bGwpO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8zLk1lc3NhZ2VIYW5kbGVyKFwiZnVja1wiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5HbG9iYWxNZXNzYWdlSGFuZGxlcihcImZ1Y2tcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcIm9uRnVja1wiLCBudWxsKTtcclxuICAgICAgICBGaXJzdCA9IEZpcnN0XzEgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5ET01NZWRpYXRvckNsYXNzKFwiRmlyc3RcIiwgXCIuL21vZHVsZXMvdGVzdC5odG1sXCIpXHJcbiAgICAgICAgXSwgRmlyc3QpO1xyXG4gICAgICAgIHJldHVybiBGaXJzdDtcclxuICAgICAgICB2YXIgRmlyc3RfMTtcclxuICAgIH0oU2NlbmVNZWRpYXRvcl8xLmRlZmF1bHQpKTtcclxuICAgIGV4cG9ydHMuZGVmYXVsdCA9IEZpcnN0O1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pUm1seWMzUXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lKR2FYSnpkQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wbEJZMEU3T3pzN096czdUVUZQUlR0SlFVZEdPMUZCUVcxRExIbENRVUZoTzFGQlFXaEVPenRSUVhkR1FTeERRVUZETzJ0Q1FYaEdiMElzUzBGQlN6dFJRWE5DWml3d1FrRkJWU3hIUVVGcVFqdFpRVVZKTEUxQlFVMHNRMEZCUXl4RFFVRkRMSEZDUVVGeFFpeERRVUZETEVOQlFVTTdVVUZEYmtNc1EwRkJRenRSUVVWTkxESkNRVUZYTEVkQlFXeENPMWxCUlVrc1RVRkJUU3hEUVVGRExFTkJRVU1zVlVGQlZTeEZRVUZGTEZsQlFWa3NRMEZCUXl4RFFVRkRPMUZCUTNSRExFTkJRVU03VVVGRlRTeHpRa0ZCVFN4SFFVRmlPMWxCUVVFc2FVSkJiVU5ETzFsQmFrTkhMSE5FUVVGelJEdFpRVU4wUkN4SlFVRkpPMWxCUTBvc05FTkJRVFJETzFsQlF6VkRMSFZEUVVGMVF6dFpRVU4yUXl4WlFVRlpPMWxCUTFvc1QwRkJUeXhEUVVGRExFZEJRVWNzUTBGQlF5eEpRVUZKTEVOQlFVTXNWVUZCVlN4RFFVRkRMRWxCUVVrc1JVRkJSU3hKUVVGSkxFTkJRVU1zVlVGQlZTeExRVUZMTEVsQlFVa3NRMEZCUXl4VlFVRlZMRVZCUVVVc1NVRkJTU3hEUVVGRExGVkJRVlVzUzBGQlN5eEpRVUZKTEVOQlFVTXNWVUZCVlN4RFFVRkRMRU5CUVVNN1dVRkZOVWNzU1VGQlNTeERRVUZETEZOQlFWTXNSMEZCUnp0blFrRkRZaXhSUVVGUkxFVkJRVVVzUTBGQlF5eERRVUZETEVWQlFVVXNRMEZCUXl4RlFVRkZMRTFCUVUwc1JVRkJSU3hMUVVGTExFTkJRVU03WjBKQlF5OUNMRkZCUVZFc1JVRkJSU3hWUVVGVk8yZENRVU53UWl4VlFVRlZMRVZCUVVVN2IwSkJRMUlzUzBGQlNTeERRVUZETEZOQlFWTXNRMEZCUXl4UlFVRlJMRWRCUVVjc1UwRkJVeXhEUVVGRE8yOUNRVU53UXl4dFEwRkJiVU03YjBKQlEyNURMRWxCUVVrc1owSkJRVTBzUlVGQlJTeERRVUZETEVsQlFVa3NSVUZCUlN4RFFVRkRPMmRDUVVONFFpeERRVUZETzJkQ1FVTkVMRmRCUVZjc1JVRkJSVHR2UWtGRFZDeExRVUZKTEVOQlFVTXNZVUZCWVN4RFFVRkRMRWxCUVVrc1EwRkJReXhsUVVGTExFTkJRVU1zUTBGQlF6dG5Ra0ZEYmtNc1EwRkJRenRuUWtGRFJDeFRRVUZUTEVWQlFVVXNTVUZCU1N4RFFVRkRMRlZCUVZVN1lVRkROMElzUTBGQlF6dFpRVVZHTERKQ1FVRlpMRU5CUVVNc1UwRkJVeXhEUVVGRE8yZENRVU51UWl4SFFVRkhMRVZCUVVVc1dVRkJXVHRoUVVOd1FpeERRVUZETEVOQlFVTTdXVUZGU0N4VlFVRlZMRU5CUVVNN1owSkJRMUFzUzBGQlNTeERRVUZETEZOQlFWTXNRMEZCUXl4UlFVRlJMRWRCUVVjc1RVRkJUU3hEUVVGRE8yZENRVU5xUXl4blJFRkJaMFE3WjBKQlEyaEVMRXRCUVVrc1EwRkJReXhUUVVGVExFTkJRVU1zVVVGQlVTeERRVUZETEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1EwRkJRenRuUWtGRGVrTXNTMEZCU1N4RFFVRkRMRlZCUVZVc1EwRkJReXhKUVVGSkxFZEJRVWNzVVVGQlVTeERRVUZETzFsQlEzQkRMRU5CUVVNc1JVRkJSU3hKUVVGSkxFTkJRVU1zUTBGQlF6dFpRVVZVTEVsQlFVa3NRMEZCUXl4UlFVRlJMRU5CUVVNc1NVRkJTU3h4UWtGQlZ5eEZRVUZGTEVOQlFVTXNRMEZCUXp0UlFVTnlReXhEUVVGRE8xRkJSMDhzT0VKQlFXTXNSMEZCZEVJc1ZVRkJkVUlzUlVGQlRTeEZRVUZGTEVsQlFWRTdXVUZGYmtNc1JVRkJSU3hEUVVGQkxFTkJRVU1zUlVGQlJTeEpRVUZKTEU5QlFVc3NRMEZCUXp0blFrRkJReXhQUVVGUExFTkJRVU1zUjBGQlJ5eERRVUZETEhsQ1FVRjVRaXhEUVVGRExFTkJRVU03V1VGRGRrUXNTVUZCU1N4RFFVRkRMRVZCUVVVc1EwRkJRU3hEUVVGRExFVkJRVVVzU1VGQlNTeG5Ra0ZCVFN4RFFVRkRPMmRDUVVGRExFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNNRUpCUVRCQ0xFTkJRVU1zUTBGQlF6dFJRVU5zUlN4RFFVRkRPMUZCUjA4c01FSkJRVlVzUjBGQmJFSXNWVUZCYlVJc1IwRkJaMElzUlVGQlJTeEhRVUZsTzFsQlJXaEVMRXRCUVVzc1EwRkJReXhMUVVGTExFTkJRVU1zUTBGQlF6dFJRVU5xUWl4RFFVRkRPMUZCU1U4c2MwSkJRVTBzUjBGQlpDeFZRVUZsTEVOQlFVTTdXVUZGV2l4UFFVRlBMRU5CUVVNc1IwRkJSeXhEUVVGRExEQkNRVUV3UWl4SFFVRkhMRU5CUVVNc1EwRkJReXhEUVVGRE8xRkJRMmhFTEVOQlFVTTdVVUZ5Um1Fc1owSkJRVlVzUjBGQlZTeFBRVUZQTEVOQlFVTTdVVUZITVVNN1dVRkVReXhwUWtGQlRUdHpRMEZEWlN4MVFrRkJZVHR2UkVGQlF6dFJRVVZ3UXp0WlFVUkRMR2xDUVVGTk8zTkRRVU5aTEcxQ1FVRlRPMmxFUVVGRE8xRkJSVGRDTzFsQlJFTXNhVUpCUVUwN2MwTkJRMWtzYzBKQlFWVTdhVVJCUVVNN1VVRkZPVUk3V1VGRVF5eHBRa0ZCVFN4RFFVRkRMRU5CUVVNc1EwRkJRenR6UTBGRFV5eHpRa0ZCVlR0cFJFRkJRenRSUVVrNVFqdFpRVVpETEdsQ1FVRk5MRU5CUVVNc1JVRkJReXhMUVVGTExFVkJRVVVzV1VGQldTeEZRVUZETEVOQlFVTTdXVUZETjBJc2FVSkJRVTBzUTBGQlF5eHZRa0ZCYjBJc1EwRkJRenR6UTBGRGJFSXNWMEZCVnpzd1EwRkJRVHRSUVVWMFFqdFpRVVJETEd0Q1FVRlBMRU5CUVVNc2EwSkJRV3RDTEVWQlFVVXNlVUpCUVdVc1EwRkJRenR6UTBGRGJFTXNWMEZCVnpzd1EwRkJRenRSUVVkMlFqdFpRVVpETEdsQ1FVRk5MRU5CUVVNc1QwRkJUeXhGUVVGRkxHRkJRV0VzUTBGQlF6dFpRVU01UWl4dlFrRkJVeXhEUVVGRExHRkJRV0VzUlVGQlJTeG5Ra0ZCWjBJc1EwRkJRenR6UTBGREwwSXNWMEZCVnpzeVEwRkJRenRSUVd0RWVFSTdXVUZFUXl4NVFrRkJZeXhEUVVGRExIVkNRVUZoTEVOQlFVTXNZVUZCWVN4RFFVRkRPenM3TzIxRVFVc3pRenRSUVVkRU8xbEJSRU1zTUVKQlFXVTdPelpEUVVOUExITkNRVUZaTEVWQlFVMHNjVUpCUVZjN095dERRVWR1UkR0UlFVbEVPMWxCUmtNc2VVSkJRV01zUTBGQlF5eE5RVUZOTEVOQlFVTTdXVUZEZEVJc0swSkJRVzlDTEVOQlFVTXNUVUZCVFN4RFFVRkRPenM3T3pKRFFVazFRanRSUVhaR1owSXNTMEZCU3p0WlFVUjZRaXd5UWtGQlowSXNRMEZCUXl4UFFVRlBMRVZCUVVVc2NVSkJRWEZDTEVOQlFVTTdWMEZETlVJc1MwRkJTeXhEUVhkR2VrSTdVVUZCUkN4WlFVRkRPenRMUVVGQkxFRkJlRVpFTEVOQlFXMURMSFZDUVVGaExFZEJkMFl2UXp0elFrRjRSbTlDTEV0QlFVc2lmUT09XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21vZHVsZXMvRmlyc3QudHNcbi8vIG1vZHVsZSBpZCA9IDU2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCBNZXNzYWdlIGZyb20gXCIuL01lc3NhZ2VcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTAxXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTAxXHJcbiAqXHJcbiAqIOahhuaetuWGheaguOmAmueUqOa2iOaBr1xyXG4qL1xyXG52YXIgQ29tbW9uTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENvbW1vbk1lc3NhZ2UsIF9zdXBlcik7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgTWVzc2FnZS5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOa2iOaBr+exu+Wei1xyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gcGFyYW1zIOWPr+iDveeahOa2iOaBr+WPguaVsOWIl+ihqFxyXG4gICAgICogQG1lbWJlcm9mIE1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gQ29tbW9uTWVzc2FnZSh0eXBlKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgdHlwZSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIENvbW1vbk1lc3NhZ2U7XHJcbn0oTWVzc2FnZSkpO1xyXG5leHBvcnQgZGVmYXVsdCBDb21tb25NZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvQ29tbW9uTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gNTdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGc7XHJcblxyXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxyXG5nID0gKGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiB0aGlzO1xyXG59KSgpO1xyXG5cclxudHJ5IHtcclxuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcclxuXHRnID0gZyB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCkgfHwgKDEsZXZhbCkoXCJ0aGlzXCIpO1xyXG59IGNhdGNoKGUpIHtcclxuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxyXG5cdGlmKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpXHJcblx0XHRnID0gd2luZG93O1xyXG59XHJcblxyXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXHJcbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXHJcbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZztcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzXG4vLyBtb2R1bGUgaWQgPSA1OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBnZXRPYmplY3RIYXNocyB9IGZyb20gXCIuLi8uLi91dGlscy9PYmplY3RVdGlsXCI7XHJcbmltcG9ydCBEZXAgZnJvbSBcIi4vRGVwXCI7XHJcbmltcG9ydCBXYXRjaGVyIGZyb20gXCIuL1dhdGNoZXJcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTExLTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTExLTA2XHJcbiAqXHJcbiAqIOWPmOW8guWZqO+8jOWwhlZpZXdNb2RlbOWPmOW8guS4uuWFt+acieS+nei1luWKn+iDveeahOW9ouW8j++8jOS5n+WPr+S7peiupOS4uuaYr+e8luivkei/h+eoi1xyXG4qL1xyXG4vLyDorrDlvZXmlbDnu4TkuK3kvJrpgKDmiJDmlbDmja7mm7TmlrDnmoTmiYDmnInmlrnms5XlkI1cclxudmFyIGFyck1ldGhvZHMgPSBbXHJcbiAgICBcInB1c2hcIixcclxuICAgIFwicG9wXCIsXHJcbiAgICBcInVuc2hpZnRcIixcclxuICAgIFwic2hpZnRcIixcclxuICAgIFwic3BsaWNlXCIsXHJcbiAgICBcInNvcnRcIixcclxuICAgIFwicmV2ZXJzZVwiXHJcbl07XHJcbi8qKlxyXG4gKiDlsIbnlKjmiLfkvKDov5vmnaXnmoTmlbDmja7igJzlj5jlvILigJ3miJDkuLrlhbfmnInmiKrojrfmlbDmja7lj5jmm7Tog73lipvnmoTmlbDmja5cclxuICogQHBhcmFtIGRhdGEg5Y6f5aeL5pWw5o2uXHJcbiAqIEByZXR1cm5zIHthbnl9IOWPmOW8guWQjueahOaVsOaNrlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG11dGF0ZShkYXRhKSB7XHJcbiAgICAvLyDlpoLmnpzmmK/nroDljZXnsbvlnovvvIzliJnllaXkuZ/kuI3lgZpcclxuICAgIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPSBcIm9iamVjdFwiKVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgLy8g6YCS5b2S5Y+Y5byC5omA5pyJ5YaF6YOo5Y+Y6YeP77yM5Y+K5YW2X19wcm90b19f5LiL55qE5bGe5oCn77yM5Zug5Li6Z2V0dGVyL3NldHRlcuS8muiiq+WumuS5ieWcqF9fcHJvdG9fX+S4iu+8jOiAjOS4jeaYr+W9k+WJjeWvueixoeS4ilxyXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkYXRhKS5jb25jYXQoT2JqZWN0LmtleXMoZGF0YS5fX3Byb3RvX18gfHwge30pKTtcclxuICAgIC8vIOWOu+mHjVxyXG4gICAgdmFyIHRlbXAgPSB7fTtcclxuICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XHJcbiAgICAgICAgaWYgKCF0ZW1wW2tleV0pIHtcclxuICAgICAgICAgICAgdGVtcFtrZXldID0ga2V5O1xyXG4gICAgICAgICAgICAvLyDpgJLlvZLlj5jlvIJcclxuICAgICAgICAgICAgbXV0YXRlT2JqZWN0KGRhdGEsIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbn1cclxuZnVuY3Rpb24gb25HZXQoZGVwLCByZXN1bHQsIG11dGF0ZVN1Yikge1xyXG4gICAgLy8g5aaC5p6cV2F0Y2hlci51cGRhdGluZ+S4jeaYr251bGzvvIzor7TmmI7lvZPliY3mraPlnKjmiafooYzooajovr7lvI/vvIzpgqPkuYjojrflj5bnmoTlj5jph4/oh6rnhLbmmK/lhbbpnIDopoHkvp3otZbnmoRcclxuICAgIHZhciB3YXRjaGVyID0gV2F0Y2hlci51cGRhdGluZztcclxuICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgIGRlcC53YXRjaCh3YXRjaGVyKTtcclxuICAgIC8vIOmmluasoeiOt+WPlumcgOimgeWPmOW8glxyXG4gICAgaWYgKG11dGF0ZVN1Yikge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+aVsOe7hOWwsei1sOS4k+mXqOeahOaVsOe7hOWPmOW8guaWueazle+8jOWQpuWImemAkuW9kuWPmOW8guWvueixoVxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdCkpXHJcbiAgICAgICAgICAgIG11dGF0ZUFycmF5KHJlc3VsdCwgZGVwKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIG11dGF0ZShyZXN1bHQpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG9uU2V0KGRlcCwgdmFsdWUpIHtcclxuICAgIC8vIOWmguaenOaYr+aVsOe7hOWwsei1sOS4k+mXqOeahOaVsOe7hOWPmOW8guaWueazle+8jOWQpuWImemAkuW9kuWPmOW8guWvueixoVxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKVxyXG4gICAgICAgIG11dGF0ZUFycmF5KHZhbHVlLCBkZXApO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIG11dGF0ZSh2YWx1ZSk7XHJcbiAgICAvLyDop6blj5HpgJrnn6VcclxuICAgIGRlcC5ub3RpZnkoKTtcclxufVxyXG5mdW5jdGlvbiBtdXRhdGVPYmplY3QoZGF0YSwga2V5KSB7XHJcbiAgICB2YXIgZGVwS2V5ID0gZ2V0T2JqZWN0SGFzaHMoZGF0YSwga2V5KTtcclxuICAgIC8vIOWvueavj+S4quWkjeadguexu+Wei+WvueixoemDveimgeacieS4gOS4quWvueW6lOeahOS+nei1luWIl+ihqFxyXG4gICAgdmFyIGRlcCA9IGRhdGFbZGVwS2V5XTtcclxuICAgIHZhciBtdXRhdGVTdWIgPSB0cnVlO1xyXG4gICAgaWYgKCFkZXApIHtcclxuICAgICAgICBkZXAgPSBuZXcgRGVwKCk7XHJcbiAgICAgICAgLy8g5Yik5pat5pys5p2l6L+Z5Liq5bGe5oCn5piv5YC85bGe5oCn6L+Y5pivZ2V0dGVyL3NldHRlcuWxnuaAp++8jOimgeacieS4jeWQjOeahOaTjeS9nOaWueW8j1xyXG4gICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihkYXRhLCBrZXkpIHx8IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZGF0YS5fX3Byb3RvX18gfHwge30sIGtleSk7XHJcbiAgICAgICAgaWYgKGRlc2MpIHtcclxuICAgICAgICAgICAgLy8g5byA5aeL5Y+Y5byC5b2T5YmN5bGe5oCnXHJcbiAgICAgICAgICAgIGlmIChkZXNjLmhhc093blByb3BlcnR5KFwidmFsdWVcIikpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWAvOWxnuaAp+eahOWPmOW8gui/h+eoi1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRhdGEsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDliKnnlKjpl63ljIXkv53lrZjljp/lp4vlgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGRlc2MudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkdldChkZXAsIHJlc3VsdCwgbXV0YXRlU3ViKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0ZVN1YiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDov5Tlm57lgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzYy53cml0YWJsZSB8fCB2YWx1ZSA9PT0gZGVzYy52YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzYy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmiafooYzlpITnkIZcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TZXQoZGVwLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXR0ZXIvc2V0dGVy5bGe5oCn55qE5Y+Y5byC6L+H56iLXHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRlc2MuZ2V0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDojrflj5ZnZXTmlrnms5Xnu5PmnpxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGRlc2MuZ2V0LmNhbGwoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkdldChkZXAsIHJlc3VsdCwgbXV0YXRlU3ViKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0ZVN1YiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDov5Tlm57lgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzYy5zZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjLnNldC5jYWxsKGRhdGEsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omn6KGM5aSE55CGXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU2V0KGRlcCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaJk+S4gOS4quagh+iusOihqOekuuW3sue7j+WPmOW8gui/h+S6hlxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkYXRhLCBkZXBLZXksIHtcclxuICAgICAgICAgICAgdmFsdWU6IGRlcCxcclxuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG11dGF0ZUFycmF5KGFyciwgZGVwKSB7XHJcbiAgICAvLyDlj5jlvILlvZPliY3mlbDnu4RcclxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihhcnIsIGRlZmluZVJlYWN0aXZlQXJyYXkoZGVwKSk7XHJcbiAgICAvLyDpgY3ljoblvZPliY3mlbDnu4TvvIzlsIblhoXlrrnlr7nosaHlhajpg6jlj5jlvIJcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBtdXRhdGUoYXJyW2ldKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBkZWZpbmVSZWFjdGl2ZUFycmF5KGRlcCkge1xyXG4gICAgdmFyIHByb3RvID0gQXJyYXkucHJvdG90eXBlO1xyXG4gICAgdmFyIHJlc3VsdCA9IE9iamVjdC5jcmVhdGUocHJvdG8pO1xyXG4gICAgLy8g6YGN5Y6G5omA5pyJ5pa55rOV77yM5LiA5Liq5LiA5Liq5Zyw5Y+Y5byCXHJcbiAgICBhcnJNZXRob2RzLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xyXG4gICAgICAgIC8vIOWIqeeUqOmXreWMheiusOW9leS4gOS4quWOn+Wni+aWueazlVxyXG4gICAgICAgIHZhciBvcmlNZXRob2QgPSBwcm90b1ttZXRob2RdO1xyXG4gICAgICAgIC8vIOW8gOWni+WPmOW8glxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXN1bHQsIG1ldGhvZCwge1xyXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g6aaW5YWI6LCD55So5Y6f5aeL5pa55rOV77yM6I635Y+W6L+U5Zue5YC8XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gb3JpTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgLy8g5pWw57uE5o+S5YWl6aG5XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5zZXJ0ZWQ7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG1ldGhvZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwdXNoXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVuc2hpZnRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWQgPSBhcmdzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3BsaWNlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydGVkID0gYXJncy5zbGljZSgyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDnm5Hop4bmlbDnu4Tmj5LlhaXpobnvvIzogIzkuI3mmK/ph43mlrDnm5Hop4bmlbTkuKrmlbDnu4RcclxuICAgICAgICAgICAgICAgIGlmIChpbnNlcnRlZCAmJiBpbnNlcnRlZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBtdXRhdGVBcnJheShpbnNlcnRlZCwgZGVwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOinpuWPkeabtOaWsFxyXG4gICAgICAgICAgICAgICAgZGVwLm5vdGlmeSh7IG1ldGhvZDogYXJncyB9KTtcclxuICAgICAgICAgICAgICAgIC8vIOi/lOWbnuWAvFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICAvLyDmj5Dkvpvmm7/mjaLmlbDnu4Torr7nva7nmoTmlrnms5XvvIzlm6DkuLrnm7TmjqXorr7nva7mlbDnu4TkuIvmoIfnmoTmlrnlvI/ml6Dms5Xlj5jlvIJcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXN1bHQsIFwiJHNldFwiLCB7XHJcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIChpbmRleCwgdmFsdWUpIHtcclxuICAgICAgICAgICAgLy8g6LaF5Ye65pWw57uE6ZW/5bqm6buY6K6k6L+95Yqg5Yiw5pyA5ZCOXHJcbiAgICAgICAgICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNwbGljZShpbmRleCwgMSwgdmFsdWUpWzBdO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8g5o+Q5L6b5pu/5o2i5pWw57uE56e76Zmk55qE5pa55rOV77yM5Zug5Li655u05o6l56e76Zmk55qE5pa55byP5peg5rOV5Y+Y5byCXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzdWx0LCBcIiRyZW1vdmVcIiwge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4T2YoaXRlbSk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL011dGF0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDU5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuLi8uLi91dGlscy9EaWN0aW9uYXJ5XCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMS0wNlxyXG4gKlxyXG4gKiDlrprkuYnkuIDkuKrkvp3otZbvvIzkuIDkuKrop4Llr5/ogIXlrp7njrBcclxuKi9cclxudmFyIERlcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlcCgpIHtcclxuICAgICAgICB0aGlzLl9tYXAgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDmlbDmja7lj5jmm7TorqLpmIXogIVcclxuICAgICAqIEBwYXJhbSB3YXRjaGVyIOaVsOaNruWPmOabtOiuoumYheiAhVxyXG4gICAgICovXHJcbiAgICBEZXAucHJvdG90eXBlLndhdGNoID0gZnVuY3Rpb24gKHdhdGNoZXIpIHtcclxuICAgICAgICB0aGlzLl9tYXAuc2V0KHdhdGNoZXIsIHdhdGNoZXIpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pWw5o2u5Y+Y5pu077yM6YCa55+l5omA5pyJ6K6i6ZiF6ICFXHJcbiAgICAgKiBAcGFyYW0gZXh0cmEg5Y+v6IO955qE6aKd5aSW5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIERlcC5wcm90b3R5cGUubm90aWZ5ID0gZnVuY3Rpb24gKGV4dHJhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9tYXAuZm9yRWFjaChmdW5jdGlvbiAod2F0Y2hlcikge1xyXG4gICAgICAgICAgICBpZiAod2F0Y2hlci5kaXNwb3NlZClcclxuICAgICAgICAgICAgICAgIC8vIOinguWvn+iAheW3sue7j+mUgOavge+8jOenu+mZpOebkeWQrFxyXG4gICAgICAgICAgICAgICAgX3RoaXMuX21hcC5kZWxldGUod2F0Y2hlcik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIC8vIOinguWvn+iAheS+neeEtueUn+aViO+8jOabtOaWsOS5i1xyXG4gICAgICAgICAgICAgICAgd2F0Y2hlci51cGRhdGUoZXh0cmEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEZXA7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IERlcDtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvRGVwLmpzXG4vLyBtb2R1bGUgaWQgPSA2MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBnZXRPYmplY3RIYXNocyB9IGZyb20gXCIuLi8uLi91dGlscy9PYmplY3RVdGlsXCI7XHJcbmltcG9ydCBXYXRjaGVyIGZyb20gXCIuL1dhdGNoZXJcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTExLTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTExLTA2XHJcbiAqXHJcbiAqIOS4gOS4que7keWumlxyXG4qL1xyXG52YXIgQmluZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJpbmQobWVkaWF0b3IpIHtcclxuICAgICAgICB0aGlzLl93YXRjaGVyRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX21lZGlhdG9yID0gbWVkaWF0b3I7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluZC5wcm90b3R5cGUsIFwibWVkaWF0b3JcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluW3sue7keWumueahOS4reS7i+iAheWunuS+i1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lNZWRpYXRvcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQmluZFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWF0b3I7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWIm+W7uuS4gOS4quinguWvn+iAhe+8jOWcqOaVsOWAvOWPmOabtOaXtuS8mumAmuefpeWbnuiwg+i/m+ihjOabtOaWsFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Kn0gY3VycmVudFRhcmdldCDkvZznlKjnm67moIfvvIzmjIfooajovr7lvI/miYDlnKjnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOe7keWumuihqOi+vuW8j+acrOadpeaJgOWcqOeahOWvueixoVxyXG4gICAgICogQHBhcmFtIHtFdmFsRXhwfSBleHAg6KGo6L6+5byP5oiW5pa55rOVXHJcbiAgICAgKiBAcGFyYW0ge1dhdGNoZXJDYWxsYmFja30gY2FsbGJhY2sg6K6i6ZiF5Zmo5Zue6LCDXHJcbiAgICAgKiBAcGFyYW0geyp9IHRoaXNBcmcgdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gc2NvcGVzIOS9nOeUqOWfn+WIl+ihqO+8jOacgOWQjuS4gOS4quS9nOeUqOWfn+S8muiiq+W9k+WBmnRoaXPmjIflkJFcclxuICAgICAqIEByZXR1cm5zIHtJV2F0Y2hlcn0g6L+U5Zue6KeC5a+f6ICF5pys6LqrXHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZFxyXG4gICAgICovXHJcbiAgICBCaW5kLnByb3RvdHlwZS5jcmVhdGVXYXRjaGVyID0gZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBzY29wZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDU7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBzY29wZXNbX2kgLSA1XSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBrZXkgPSBnZXRPYmplY3RIYXNocy5hcHBseSh2b2lkIDAsIFtjdXJyZW50VGFyZ2V0LCBleHBdLmNvbmNhdChzY29wZXMpKTtcclxuICAgICAgICB2YXIgd2F0Y2hlciA9IHRoaXMuX3dhdGNoZXJEaWN0W2tleV07XHJcbiAgICAgICAgaWYgKCF3YXRjaGVyKVxyXG4gICAgICAgICAgICB0aGlzLl93YXRjaGVyRGljdFtrZXldID0gd2F0Y2hlciA9IG5ldyAoV2F0Y2hlci5iaW5kLmFwcGx5KFdhdGNoZXIsIFt2b2lkIDAsIHRoaXMsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBjYWxsYmFjaywgdGhpc0FyZ10uY29uY2F0KHNjb3BlcykpKSgpO1xyXG4gICAgICAgIHJldHVybiB3YXRjaGVyO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZSA5q+B57uR5a6a5YWz57O7XHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRcclxuICAgICAqL1xyXG4gICAgQmluZC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5fd2F0Y2hlckRpY3QpIHtcclxuICAgICAgICAgICAgdmFyIHdhdGNoZXIgPSB0aGlzLl93YXRjaGVyRGljdFtrZXldO1xyXG4gICAgICAgICAgICB3YXRjaGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3dhdGNoZXJEaWN0W2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBCaW5kO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBCaW5kO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9CaW5kLmpzXG4vLyBtb2R1bGUgaWQgPSA2MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTFcclxuICpcclxuICog6YCa6K6v55u45YWz55qE5raI5oGvXHJcbiovXHJcbnZhciBOZXRNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTmV0TWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Y+R6YCB572R57uc6K+35rGC5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBOZXRNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIE5ldE1lc3NhZ2UuTkVUX1JFUVVFU1QgPSBcIm5ldFJlcXVlc3RcIjtcclxuICAgIC8qKlxyXG4gICAgICog5o6l5Y+X572R57uc6L+U5Zue5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBOZXRNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIE5ldE1lc3NhZ2UuTkVUX1JFU1BPTlNFID0gXCJuZXRSZXNwb25zZVwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDnvZHnu5zor7fmsYLplJnor6/mtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTmV0TWVzc2FnZS5ORVRfRVJST1IgPSBcIm5ldEVycm9yXCI7XHJcbiAgICByZXR1cm4gTmV0TWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTmV0TWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9OZXRNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA2MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog5peg5Lu75L2V5Yqo55S755qE5by55Ye6562W55Wl77yM5Y+v5bqU55So5LqO5Lu75L2V5pi+56S65bGC5a6e546wXHJcbiovXHJcbnZhciBOb25lUGFuZWxQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOb25lUGFuZWxQb2xpY3koKSB7XHJcbiAgICB9XHJcbiAgICBOb25lUGFuZWxQb2xpY3kucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uIChwYW5lbCwgY2FsbGJhY2ssIGZyb20pIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCAwKTtcclxuICAgIH07XHJcbiAgICBOb25lUGFuZWxQb2xpY3kucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbiAocGFuZWwsIGNhbGxiYWNrLCBmcm9tKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE5vbmVQYW5lbFBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IHsgTm9uZVBhbmVsUG9saWN5IH07XHJcbi8qKiDpu5jorqTlr7zlh7rlrp7kvosgKi9cclxuZXhwb3J0IGRlZmF1bHQgbmV3IE5vbmVQYW5lbFBvbGljeSgpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvTm9uZVBhbmVsUG9saWN5LmpzXG4vLyBtb2R1bGUgaWQgPSA2M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog5by556qX55u45YWz55qE5raI5oGvXHJcbiovXHJcbnZhciBQYW5lbE1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQYW5lbE1lc3NhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOW8ueeql+WJjeeahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9CRUZPUkVfUE9QID0gXCJwYW5lbEJlZm9yZVBvcFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDlvLnnqpflkI7nmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBQYW5lbE1lc3NhZ2UuUEFORUxfQUZURVJfUE9QID0gXCJwYW5lbEFmdGVyUG9wXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreW8ueeql+WJjeeahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9CRUZPUkVfRFJPUCA9IFwicGFuZWxCZWZvcmVEcm9wXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreW8ueeql+WQjueahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9BRlRFUl9EUk9QID0gXCJwYW5lbEFmdGVyRHJvcFwiO1xyXG4gICAgcmV0dXJuIFBhbmVsTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgUGFuZWxNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvUGFuZWxNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA2NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjFcclxuICpcclxuICog6YCa55So5by556qX55qE5ZCE56eN5o6l5Y+jXHJcbiovXHJcbmV4cG9ydCB2YXIgQnV0dG9uVHlwZTtcclxuKGZ1bmN0aW9uIChCdXR0b25UeXBlKSB7XHJcbiAgICBCdXR0b25UeXBlW0J1dHRvblR5cGVbXCJub3JtYWxcIl0gPSAwXSA9IFwibm9ybWFsXCI7XHJcbiAgICBCdXR0b25UeXBlW0J1dHRvblR5cGVbXCJpbXBvcnRhbnRcIl0gPSAxXSA9IFwiaW1wb3J0YW50XCI7XHJcbn0pKEJ1dHRvblR5cGUgfHwgKEJ1dHRvblR5cGUgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvSVByb21wdFBhbmVsLmpzXG4vLyBtb2R1bGUgaWQgPSA2NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDhcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDhcclxuICpcclxuICog5peg5Lu75L2V5Yqo55S755qE5Zy65pmv562W55Wl77yM5Y+v5bqU55So5LqO5Lu75L2V5pi+56S65bGC5a6e546wXHJcbiovXHJcbnZhciBOb25lU2NlbmVQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOb25lU2NlbmVQb2xpY3koKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWHhuWkh+WIh+aNouWcuuaZr+aXtuiwg+W6plxyXG4gICAgICogQHBhcmFtIGZyb20g5YiH5Ye655qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gdG8g5YiH5YWl55qE5Zy65pmvXHJcbiAgICAgKi9cclxuICAgIE5vbmVTY2VuZVBvbGljeS5wcm90b3R5cGUucHJlcGFyZVN3aXRjaCA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xyXG4gICAgICAgIC8vIOi/meS4quetlueVpemHjOWVpeS5n+S4jeeUqOWHhuWkh1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv5pe26LCD5bqmXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliIflh7rnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB0byDliIflhaXnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayDliIfmjaLlrozmr5XnmoTlm57osIPmlrnms5VcclxuICAgICAqL1xyXG4gICAgTm9uZVNjZW5lUG9saWN5LnByb3RvdHlwZS5zd2l0Y2ggPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8g55u05o6l5bu26L+f5Yiw5LiL5LiA5bin5Zue6LCD77yI5LiN6IO95ZCM5q2l5Zue6LCD77yM5ZCm5YiZ5Y+v6IO95Lya5Ye66Zeu6aKY77yJXHJcbiAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE5vbmVTY2VuZVBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IHsgTm9uZVNjZW5lUG9saWN5IH07XHJcbi8qKiDpu5jorqTlr7zlh7rlrp7kvosgKi9cclxuZXhwb3J0IGRlZmF1bHQgbmV3IE5vbmVTY2VuZVBvbGljeSgpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvTm9uZVNjZW5lUG9saWN5LmpzXG4vLyBtb2R1bGUgaWQgPSA2NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDhcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDhcclxuICpcclxuICog5ZCM5q2l5bel5YW36ZuG77yM55So5LqO5a+55aSa5LiqXHJcbiovXHJcbnZhciBfY2FjaGUgPSB7fTtcclxuLyoqXHJcbiAqIOWIpOaWreaYr+WQpuato+WcqOi/m+ihjOaTjeS9nFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOmYn+WIl+WQjVxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0g6Zif5YiX5piv5ZCm5q2j5Zyo5pON5L2cXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNPcGVyYXRpbmcobmFtZSkge1xyXG4gICAgdmFyIGN0eCA9IF9jYWNoZVtuYW1lXTtcclxuICAgIHJldHVybiAoY3R4ICE9IG51bGwgJiYgY3R4Lm9wZXJhdGluZyk7XHJcbn1cclxuLyoqXHJcbiAqIOW8gOWni+WQjOatpeaTjeS9nO+8jOaJgOacieS8oOmAkuS6huebuOWQjG5hbWXnmoTmk43kvZzkvJrooqvku6XpmJ/liJfmlrnlvI/pobrluo/miafooYxcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0gbmFtZSDkuIDkuKrpmJ/liJfnmoTlkI3lrZdcclxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g6KaB5omn6KGM55qE5pa55rOVXHJcbiAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIOaWueazlXRoaXPlr7nosaFcclxuICogQHBhcmFtIHsuLi5hbnlbXX0gW2FyZ3NdIOaWueazleWPguaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdhaXQobmFtZSwgZm4sIHRoaXNBcmcpIHtcclxuICAgIHZhciBhcmdzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICB2YXIgY3R4ID0gX2NhY2hlW25hbWVdO1xyXG4gICAgaWYgKGN0eCA9PSBudWxsKSB7XHJcbiAgICAgICAgX2NhY2hlW25hbWVdID0gY3R4ID0geyBvcGVyYXRpbmc6IGZhbHNlLCBkYXRhczogW10gfTtcclxuICAgIH1cclxuICAgIGlmIChjdHgub3BlcmF0aW5nKSB7XHJcbiAgICAgICAgLy8g6Zif5YiX5q2j5Zyo5omn6KGM77yM5o6o5YWl57yT5a2YXHJcbiAgICAgICAgY3R4LmRhdGFzLnB1c2goeyBmbjogZm4sIHRoaXNBcmc6IHRoaXNBcmcsIGFyZ3M6IGFyZ3MgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyDpmJ/liJfmsqHmnInlnKjmiafooYzvvIznm7TmjqXmiafooYxcclxuICAgICAgICBjdHgub3BlcmF0aW5nID0gdHJ1ZTtcclxuICAgICAgICBmbi5hcHBseSh0aGlzQXJnLCBhcmdzKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5a6M5oiQ5LiA5q2l5pON5L2c5bm25ZSk6YaS5ZCO57ut5pON5L2cXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg6Zif5YiX5ZCN5a2XXHJcbiAqIEByZXR1cm5zIHt2b2lkfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG5vdGlmeShuYW1lKSB7XHJcbiAgICB2YXIgY3R4ID0gX2NhY2hlW25hbWVdO1xyXG4gICAgaWYgKGN0eCA9PSBudWxsIHx8IGN0eC5kYXRhcy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgIC8vIOmYn+WIl+aJp+ihjOWujOS6hu+8jOebtOaOpee7k+adn1xyXG4gICAgICAgIGN0eC5vcGVyYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgZGF0YSA9IGN0eC5kYXRhcy5zaGlmdCgpO1xyXG4gICAgZGF0YS5mbi5hcHBseShkYXRhLnRoaXNBcmcsIGRhdGEuYXJncyk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvU3luY1V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDY3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGJyaWRnZU1hbmFnZXIgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwib2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnlcIjtcclxuaW1wb3J0IERPTUJyaWRnZSBmcm9tIFwiLi4vLi4vRE9NQnJpZGdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0yNVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0yNVxyXG4gKlxyXG4gKiBET03pga7nvanlrp7njrBcclxuKi9cclxudmFyIE1hc2tFbnRpdHlJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWFza0VudGl0eUltcGwocGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5fbWFza0FscGhhID0gMC41O1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdBbHBoYSA9IDAuNTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsQWxwaGEgPSAwLjU7XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ01hc2sgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChwYXJhbXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tYXNrQWxwaGEgPSAocGFyYW1zLm1hc2tBbHBoYSAhPSBudWxsID8gcGFyYW1zLm1hc2tBbHBoYSA6IDAuNSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdBbHBoYSA9IChwYXJhbXMubG9hZGluZ0FscGhhICE9IG51bGwgPyBwYXJhbXMubG9hZGluZ0FscGhhIDogMC41KTtcclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxQYW5lbEFscGhhID0gKHBhcmFtcy5tb2RhbFBhbmVsQWxwaGEgIT0gbnVsbCA/IHBhcmFtcy5tb2RhbFBhbmVsQWxwaGEgOiAwLjUpO1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJZsb2FkaW5n55qu6IKkXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW1zLmxvYWRpbmdTa2luID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gcGFyYW1zLmxvYWRpbmdTa2luO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmxvYWRpbmdTa2luID0gdGVtcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTa2luID0gcGFyYW1zLmxvYWRpbmdTa2luO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1hc2tEYXRhID0gcGFyYW1zIHx8IHt9O1xyXG4gICAgICAgIHRoaXMuX21hc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbExpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuumBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuc2hvd01hc2sgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2hvd2luZ01hc2spXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IHRydWU7XHJcbiAgICAgICAgLy8g5pi+56S6XHJcbiAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKERPTUJyaWRnZS5UWVBFKTtcclxuICAgICAgICAvLyDnu5jliLbpga7nvalcclxuICAgICAgICBpZiAoYWxwaGEgPT0gbnVsbClcclxuICAgICAgICAgICAgYWxwaGEgPSB0aGlzLl9tYXNrQWxwaGE7XHJcbiAgICAgICAgdGhpcy5fbWFzay5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMDBcIjtcclxuICAgICAgICB0aGlzLl9tYXNrLnN0eWxlLm9wYWNpdHkgPSBhbHBoYS50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuX21hc2suc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICB0aGlzLl9tYXNrLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgIGJyaWRnZS5tYXNrTGF5ZXIuYXBwZW5kQ2hpbGQodGhpcy5fbWFzayk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpmpDol4/pga7nvalcclxuICAgICAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmhpZGVNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fc2hvd2luZ01hc2spXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOmakOiXj1xyXG4gICAgICAgIGlmICh0aGlzLl9tYXNrLnBhcmVudEVsZW1lbnQgIT0gbnVsbClcclxuICAgICAgICAgICAgdGhpcy5fbWFzay5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX21hc2spO1xyXG4gICAgfTtcclxuICAgIC8qKuW9k+WJjeaYr+WQpuWcqOaYvuekuumBrue9qSovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hvd2luZ01hc2s7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrliqDovb3lm75cclxuICAgICAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLnNob3dMb2FkaW5nID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nob3dpbmdMb2FkaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vIOaYvuekulxyXG4gICAgICAgIHZhciBicmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZShET01CcmlkZ2UuVFlQRSk7XHJcbiAgICAgICAgLy8g57uY5Yi26YGu572pXHJcbiAgICAgICAgaWYgKGFscGhhID09IG51bGwpXHJcbiAgICAgICAgICAgIGFscGhhID0gdGhpcy5fbG9hZGluZ0FscGhhO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAwMFwiO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnN0eWxlLm9wYWNpdHkgPSBhbHBoYS50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgYnJpZGdlLm1hc2tMYXllci5hcHBlbmRDaGlsZCh0aGlzLl9sb2FkaW5nTWFzayk7XHJcbiAgICAgICAgLy8g5re75YqgbG9hZGluZ+earuiCpFxyXG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmdTa2luKVxyXG4gICAgICAgICAgICBicmlkZ2UubWFza0xheWVyLmFwcGVuZENoaWxkKHRoaXMubG9hZGluZ1NraW4pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZqQ6JeP5Yqg6L295Zu+XHJcbiAgICAgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5oaWRlTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3Nob3dpbmdMb2FkaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAvLyDpmpDol49cclxuICAgICAgICBpZiAodGhpcy5fbG9hZGluZ01hc2sucGFyZW50RWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX2xvYWRpbmdNYXNrKTtcclxuICAgICAgICBpZiAodGhpcy5sb2FkaW5nU2tpbiAhPSBudWxsICYmIHRoaXMubG9hZGluZ1NraW4ucGFyZW50RWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTa2luLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5sb2FkaW5nU2tpbik7XHJcbiAgICB9O1xyXG4gICAgLyoq5b2T5YmN5piv5ZCm5Zyo5pi+56S6bG9hZGluZyovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hvd2luZ0xvYWRpbmc7XHJcbiAgICB9O1xyXG4gICAgLyoqIOaYvuekuuaooeaAgeeql+WPo+mBrue9qSAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLnNob3dNb2RhbE1hc2sgPSBmdW5jdGlvbiAocGFuZWwsIGFscGhhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNTaG93aW5nTW9kYWxNYXNrKHBhbmVsKSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxEaWN0LnNldChwYW5lbCwgcGFuZWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxMaXN0LnB1c2gocGFuZWwpO1xyXG4gICAgICAgIC8vIOe7mOWItumBrue9qVxyXG4gICAgICAgIGlmIChhbHBoYSA9PSBudWxsKVxyXG4gICAgICAgICAgICBhbHBoYSA9IHRoaXMuX21vZGFsUGFuZWxBbHBoYTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMDBcIjtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5zdHlsZS5vcGFjaXR5ID0gYWxwaGEudG9TdHJpbmcoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkucGFyZW50RWxlbWVudDtcclxuICAgICAgICBpZiAocGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBicmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZShET01CcmlkZ2UuVFlQRSk7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGJyaWRnZS5nZXRDaGlsZEluZGV4KHBhcmVudCwgZW50aXR5KTtcclxuICAgICAgICAgICAgYnJpZGdlLmFkZENoaWxkQXQocGFyZW50LCB0aGlzLl9tb2RhbFBhbmVsTWFzaywgaW5kZXgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog6ZqQ6JeP5qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaGlkZU1vZGFsTWFzayA9IGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1Nob3dpbmdNb2RhbE1hc2socGFuZWwpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbERpY3QuZGVsZXRlKHBhbmVsKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTGlzdC5zcGxpY2UodGhpcy5fbW9kYWxQYW5lbExpc3QuaW5kZXhPZihwYW5lbCksIDEpO1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpui/mOmcgOimgU1hc2tcclxuICAgICAgICBpZiAodGhpcy5fbW9kYWxQYW5lbExpc3QubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgLy8g6ZqQ6JePXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX21vZGFsUGFuZWxNYXNrKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOenu+WKqE1hc2tcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX21vZGFsUGFuZWxMaXN0W3RoaXMuX21vZGFsUGFuZWxMaXN0Lmxlbmd0aCAtIDFdLnNraW47XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkucGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKERPTUJyaWRnZS5UWVBFKTtcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGJyaWRnZS5nZXRDaGlsZEluZGV4KHBhcmVudCwgZW50aXR5KTtcclxuICAgICAgICAgICAgICAgIGJyaWRnZS5hZGRDaGlsZEF0KHBhcmVudCwgdGhpcy5fbW9kYWxQYW5lbE1hc2ssIGluZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog5b2T5YmN5piv5ZCm5Zyo5pi+56S65qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9tb2RhbFBhbmVsRGljdC5nZXQocGFuZWwpICE9IG51bGwpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNYXNrRW50aXR5SW1wbDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTWFza0VudGl0eUltcGw7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vbWFzay9NYXNrRW50aXR5LmpzXG4vLyBtb2R1bGUgaWQgPSA2OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBhc3NldHNNYW5hZ2VyIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IE1lZGlhdG9yU3RhdHVzIGZyb20gXCJvbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yU3RhdHVzXCI7XHJcbmltcG9ydCB7IGxpc3RlbkFwcGx5IH0gZnJvbSAnb2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWwnO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMjZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMjZcclxuICpcclxuICog5Li6RE9N5o+Q5L6b55qu6IKk6L2s5o2i55qE5bel5YW36ZuGXHJcbiovXHJcbi8qKlxyXG4gKiDkuLrkuK3ku4vogIXljIXoo4Xnmq7ogqRcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAqIEBwYXJhbSB7KEhUTUxFbGVtZW50fHN0cmluZ3xzdHJpbmdbXSl9IHNraW4g55qu6IKk77yM5Y+v5Lul5pivSFRNTEVsZW1lbnTvvIzkuZ/lj6/ku6XmmK/nmq7ogqTlrZfnrKbkuLLvvIzkuZ/lj6/ku6XmmK/nmq7ogqTmqKHmnb/lnLDlnYDmiJblnLDlnYDmlbDnu4RcclxuICogQHJldHVybnMge0hUTUxFbGVtZW50fSDnmq7ogqTnmoRIVE1MRWxlbWVudOW9ouW8j++8jOWPr+iDveS8mueojeWQjuWGjeWhq+WFheWGheWuue+8jOWmguaenOaDs+WcqOearuiCpOWKoOi9veWujOavleWQjuWGjeaLv+WIsOearuiCpOivt+S9v+eUqGNvbXBsZXRl5Y+C5pWwXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gd3JhcFNraW4obWVkaWF0b3IsIHNraW4pIHtcclxuICAgIHZhciByZXN1bHQgPSAoc2tpbiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ID8gc2tpbiA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO1xyXG4gICAgLy8g5Yik5pat5Lit5LuL6ICF5b2T5YmN54q25oCBXHJcbiAgICBpZiAobWVkaWF0b3Iuc3RhdHVzIDwgTWVkaWF0b3JTdGF0dXMuT1BFTklORykge1xyXG4gICAgICAgIGxpc3RlbkFwcGx5KG1lZGlhdG9yLCBcIm9uT3BlblwiLCBkb1dyYXBTa2luKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIOebtOaOpeaJp+ihjOimgeaJp+ihjOeahFxyXG4gICAgICAgIGRvV3JhcFNraW4oKTtcclxuICAgIH1cclxuICAgIC8vIOWQjOatpei/lOWbnuearuiCpFxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIGZ1bmN0aW9uIGRvV3JhcFNraW4oKSB7XHJcbiAgICAgICAgaWYgKHNraW4gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAvLyDmi7fotJ3lvJXnlKhcclxuICAgICAgICAgICAgZG9Db3B5UmVmKHJlc3VsdCwgc2tpbi5pbm5lckhUTUwsIG1lZGlhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOi9rOaNouearuiCpFxyXG4gICAgICAgICAgICBza2luID0gZ2V0SFRNTENvbnRlbnQoc2tpbik7XHJcbiAgICAgICAgICAgIC8vIOi1i+WAvOearuiCpOWGheWuuVxyXG4gICAgICAgICAgICByZXN1bHQuaW5uZXJIVE1MID0gc2tpbjtcclxuICAgICAgICAgICAgLy8g5ou36LSd5byV55SoXHJcbiAgICAgICAgICAgIGRvQ29weVJlZihyZXN1bHQsIHNraW4sIG1lZGlhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOWIpOaWreaYr+WQpuaYr0RPTeWtl+espuS4slxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIg5a2X56ym5LiyXHJcbiAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRE9NU3RyKHN0cikge1xyXG4gICAgcmV0dXJuIHN0ciAmJiAoc3RyLmluZGV4T2YoXCI8XCIpID49IDAgJiYgc3RyLmluZGV4T2YoXCI+XCIpID49IDApO1xyXG59XHJcbnZhciByZWcgPSAvKFxcLmh0bXxcXC5odG1sfFxcLnRwbCkkLztcclxuLyoqXHJcbiAqIOWIpOaWreaYr+WQpuaYr0RPTeaooeadv+i3r+W+hFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIOi3r+W+hOWtl+espuS4slxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0RPTVBhdGgocGF0aCkge1xyXG4gICAgcmV0dXJuIHBhdGggJiYgcmVnLnRlc3QocGF0aCk7XHJcbn1cclxuLyoqXHJcbiAqIOWwhmZyb23kuK3nmoTmiYDmnInmi6XmnIlpZOWxnuaAp+eahOiKgueCueW8leeUqOWkjeWItuWIsHRv5a+56LGh5LiKXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZnJvbSDlpI3liLbmupBET03oioLngrlcclxuICogQHBhcmFtIHsqfSB0byDlpI3liLbnm67moIflr7nosaFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb3B5UmVmKGZyb20sIHRvKSB7XHJcbiAgICBkb0NvcHlSZWYoZnJvbSwgZnJvbS5pbm5lckhUTUwsIHRvKTtcclxufVxyXG5mdW5jdGlvbiBkb0NvcHlSZWYoZnJvbUVsZSwgZnJvbVN0ciwgdG8pIHtcclxuICAgIC8vIOS9v+eUqOato+WImeihqOi+vuW8j+WwhuaLpeaciWlk55qE6IqC54K56LWL5YC857uZbWVkaWF0b3JcclxuICAgIHZhciByZWcgPSAvaWQ9KFwiKFteXCJdKylcInwnKFteJ10rKScpL2c7XHJcbiAgICB2YXIgcmVzO1xyXG4gICAgd2hpbGUgKHJlcyA9IHJlZy5leGVjKGZyb21TdHIpKSB7XHJcbiAgICAgICAgdmFyIGlkID0gcmVzWzJdIHx8IHJlc1szXTtcclxuICAgICAgICB0b1tpZF0gPSBmcm9tRWxlLnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyBpZCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOi9rOaNouearuiCpOS4ukhUTUxFbGVtZW50XHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsoSFRNTEVsZW1lbnR8c3RyaW5nfHN0cmluZ1tdKX0gc2tpbiDnmq7ogqRcclxuICogQHJldHVybnMge0hUTUxFbGVtZW50fVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRvSFRNTEVsZW1lbnQoc2tpbikge1xyXG4gICAgaWYgKHNraW4gaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcclxuICAgICAgICByZXR1cm4gc2tpbjtcclxuICAgIHZhciByZXN1bHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgcmVzdWx0LmlubmVySFRNTCA9IGdldEhUTUxDb250ZW50KHNraW4pO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKipcclxuICog5bCG55qu6IKk5a2X56ym5LiyL+Wtl+espuS4suaVsOe7hOaIluearuiCpOi3r+W+hOi9rOWPmOS4ukhUTUzlhoXlrrnlrZfnrKbkuLJcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyhzdHJpbmd8c3RyaW5nW10pfSBza2luIOWPr+S7peaYr+earuiCpOWtl+espuS4suOAgeearuiCpOWtl+espuS4suaVsOe7hOaIluearuiCpOi3r+W+hFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEhUTUxDb250ZW50KHNraW4pIHtcclxuICAgIGlmIChza2luIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAvLyDmmK/lrZfnrKbkuLLmlbDnu4TvvIzmi4bliIblkI7nmq7ogqTljJblho3ov57mjqXotbfmnaVcclxuICAgICAgICByZXR1cm4gc2tpbi5tYXAoZ2V0SFRNTENvbnRlbnQpLmpvaW4oXCJcIik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0RPTVN0cihza2luKSkge1xyXG4gICAgICAgIC8vIOaYr+earuiCpOWtl+espuS4su+8jOebtOaOpei/lOWbnlxyXG4gICAgICAgIHJldHVybiBza2luO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g5piv55qu6IKk6Lev5b6E5oiW6Lev5b6E55+t5ZCN56ew77yM6I635Y+W5ZCO6L+U5ZueXHJcbiAgICAgICAgcmV0dXJuIGFzc2V0c01hbmFnZXIuZ2V0QXNzZXRzKHNraW4pO1xyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vdXRpbHMvU2tpblV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDY5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IFR3ZWVuLCBFYXNpbmcgfSBmcm9tIFwiQHR3ZWVuanMvdHdlZW4uanNcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTIyXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTIyXHJcbiAqXHJcbiAqIOWbnuW8ueaViOaenFxyXG4qL1xyXG52YXIgQmFja1BhbmVsUG9saWN5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmFja1BhbmVsUG9saWN5KCkge1xyXG4gICAgICAgIHRoaXMuX3JlZyA9IC8oXFx3KikoXFxkKykoXFx3KikvO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrml7bosIPnlKhcclxuICAgICAqIEBwYXJhbSBwYW5lbCDlvLnlh7rmoYblr7nosaFcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayDlrozmiJDlm57osIPvvIzlv4XpobvosIPnlKhcclxuICAgICAqIEBwYXJhbSBmcm9tIOWKqOeUu+i1t+Wni+eCuVxyXG4gICAgICovXHJcbiAgICBCYWNrUGFuZWxQb2xpY3kucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uIChwYW5lbCwgY2FsbGJhY2ssIGZyb20pIHtcclxuICAgICAgICB2YXIgZW50aXR5ID0gcGFuZWwuc2tpbjtcclxuICAgICAgICB2YXIgY3VyU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVudGl0eSk7XHJcbiAgICAgICAgdmFyIHR3ZWVuID0gbmV3IFR3ZWVuKGVudGl0eSkuZW5kKCkuc3RvcCgpO1xyXG4gICAgICAgIGVudGl0eS5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcclxuICAgICAgICBlbnRpdHkuc3R5bGUubGVmdCA9IFwiY2FsYyg1MCUgLSBcIiArIGN1clN0eWxlLndpZHRoICsgXCIgKiAwLjUpXCI7XHJcbiAgICAgICAgZW50aXR5LnN0eWxlLnRvcCA9IFwiY2FsYyg1MCUgLSBcIiArIGN1clN0eWxlLmhlaWdodCArIFwiICogMC41KVwiO1xyXG4gICAgICAgIGVudGl0eS5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlKDAsIDApXCI7XHJcbiAgICAgICAgLy8g5byA5aeL57yT5YqoXHJcbiAgICAgICAgdmFyIGtleSA9IFwiX190d2Vlbl9fc3RlcF9fXCI7XHJcbiAgICAgICAgZW50aXR5W2tleV0gPSAwO1xyXG4gICAgICAgIHZhciBwcm9wcyA9IHt9O1xyXG4gICAgICAgIHByb3BzW2tleV0gPSAxO1xyXG4gICAgICAgIHR3ZWVuLnRvKHByb3BzLCAzMDApLmVhc2luZyhFYXNpbmcuQmFjay5PdXQpLm9uVXBkYXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZW50aXR5LnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBlbnRpdHlba2V5XSArIFwiLCBcIiArIGVudGl0eVtrZXldICsgXCIpXCI7XHJcbiAgICAgICAgfSkub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBlbnRpdHlba2V5XTtcclxuICAgICAgICAgICAgZW50aXR5LnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSkuc3RhcnQoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreaXtuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHBvcHVwIOW8ueWHuuahhuWvueixoVxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIOWujOaIkOWbnuiwg++8jOW/hemhu+iwg+eUqFxyXG4gICAgICogQHBhcmFtIHRvIOWKqOeUu+WujOe7k+eCuVxyXG4gICAgICovXHJcbiAgICBCYWNrUGFuZWxQb2xpY3kucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbiAocGFuZWwsIGNhbGxiYWNrLCB0bykge1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIHZhciB0d2VlbiA9IG5ldyBUd2VlbihlbnRpdHkpLmVuZCgpLnN0b3AoKTtcclxuICAgICAgICBlbnRpdHkuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZSgxLCAxKVwiO1xyXG4gICAgICAgIC8vIOW8gOWni+e8k+WKqFxyXG4gICAgICAgIHZhciBrZXkgPSBcIl9fdHdlZW5fX3N0ZXBfX1wiO1xyXG4gICAgICAgIGVudGl0eVtrZXldID0gMTtcclxuICAgICAgICB2YXIgcHJvcHMgPSB7fTtcclxuICAgICAgICBwcm9wc1trZXldID0gMDtcclxuICAgICAgICB0d2Vlbi50byhwcm9wcywgMzAwKS5lYXNpbmcoRWFzaW5nLkJhY2suSW4pLm9uVXBkYXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZW50aXR5LnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBlbnRpdHlba2V5XSArIFwiLCBcIiArIGVudGl0eVtrZXldICsgXCIpXCI7XHJcbiAgICAgICAgfSkub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBlbnRpdHlba2V5XTtcclxuICAgICAgICAgICAgZW50aXR5LnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSkuc3RhcnQoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmFja1BhbmVsUG9saWN5O1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBCYWNrUGFuZWxQb2xpY3k7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vcGFuZWwvQmFja1BhbmVsUG9saWN5LmpzXG4vLyBtb2R1bGUgaWQgPSA3MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBUd2VlbiwgRWFzaW5nIH0gZnJvbSBcIkB0d2VlbmpzL3R3ZWVuLmpzXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMlxyXG4gKlxyXG4gKiDmt6HlhaXmt6Hlh7rlnLrmma/liIfmjaLnrZbnlaVcclxuKi9cclxudmFyIEZhZGVTY2VuZVBvbGljeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZhZGVTY2VuZVBvbGljeSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YeG5aSH5YiH5o2i5Zy65pmv5pe26LCD5bqmXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliIflh7rnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB0byDliIflhaXnmoTlnLrmma9cclxuICAgICAqL1xyXG4gICAgRmFkZVNjZW5lUG9saWN5LnByb3RvdHlwZS5wcmVwYXJlU3dpdGNoID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XHJcbiAgICAgICAgaWYgKGZyb20gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTlhYvpmoboioLngrlcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YWdlQ2xvbmUgJiYgdGhpcy5fc3RhZ2VDbG9uZS5wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fc3RhZ2VDbG9uZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5YWL6ZqG5b2T5YmN5bGP5bmVXHJcbiAgICAgICAgICAgIHZhciBzdGFnZSA9IGZyb20uYnJpZGdlLnN0YWdlO1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lID0gc3RhZ2UuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnN0eWxlLmxlZnQgPSBcIjAlXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUuc3R5bGUudG9wID0gXCIwJVwiO1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnN0eWxlLnpJbmRleCA9IFwiMjE0NzQ4MzY0N1wiOyAvLyDlsYLnuqfopoHmnIDpq5hcclxuICAgICAgICAgICAgdGhpcy5fc3RhZ2VDbG9uZS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7IC8vIOimgeWxj+iUveeCueWHu+S6i+S7tlxyXG4gICAgICAgICAgICAvLyDmt7vliqDlhYvpmoboioLngrlcclxuICAgICAgICAgICAgZnJvbS5icmlkZ2UuaHRtbFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5fc3RhZ2VDbG9uZSk7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpGZyb21cclxuICAgICAgICAgICAgdmFyIGZyb21EaXNwbGF5ID0gZnJvbS5za2luO1xyXG4gICAgICAgICAgICBpZiAoZnJvbURpc3BsYXkucGFyZW50RWxlbWVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBmcm9tRGlzcGxheS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGZyb21EaXNwbGF5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouWcuuaZr+aXtuiwg+W6plxyXG4gICAgICogQHBhcmFtIGZyb20g5YiH5Ye655qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gdG8g5YiH5YWl55qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg5YiH5o2i5a6M5q+V55qE5Zue6LCD5pa55rOVXHJcbiAgICAgKi9cclxuICAgIEZhZGVTY2VuZVBvbGljeS5wcm90b3R5cGUuc3dpdGNoID0gZnVuY3Rpb24gKGZyb20sIHRvLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGZyb20gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDlvIDlp4vmt6Hlh7pcclxuICAgICAgICAgICAgdmFyIGtleSA9IFwiX190d2Vlbl9fc3RlcF9fXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmVba2V5XSA9IDE7XHJcbiAgICAgICAgICAgIHZhciBwcm9wcyA9IHt9O1xyXG4gICAgICAgICAgICBwcm9wc1trZXldID0gMDtcclxuICAgICAgICAgICAgbmV3IFR3ZWVuKHRoaXMuX3N0YWdlQ2xvbmUpXHJcbiAgICAgICAgICAgICAgICAuZW5kKClcclxuICAgICAgICAgICAgICAgIC5zdG9wKClcclxuICAgICAgICAgICAgICAgIC50byhwcm9wcywgMzAwKVxyXG4gICAgICAgICAgICAgICAgLmVhc2luZyhFYXNpbmcuTGluZWFyLk5vbmUpXHJcbiAgICAgICAgICAgICAgICAub25VcGRhdGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuX3N0YWdlQ2xvbmUuc3R5bGUub3BhY2l0eSA9IF90aGlzLl9zdGFnZUNsb25lW2tleV07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMuX3N0YWdlQ2xvbmVba2V5XTtcclxuICAgICAgICAgICAgICAgIC8vIOenu+mZpOaIquWxj1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoX3RoaXMuX3N0YWdlQ2xvbmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnN0YXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTlhYvpmoboioLngrlcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YWdlQ2xvbmUgJiYgdGhpcy5fc3RhZ2VDbG9uZS5wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fc3RhZ2VDbG9uZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBGYWRlU2NlbmVQb2xpY3k7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEZhZGVTY2VuZVBvbGljeTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9zY2VuZS9GYWRlU2NlbmVQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDcxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgU2hlbGwgZnJvbSBcIi4uL2Vudi9TaGVsbFwiO1xyXG5pbXBvcnQgQXVkaW9UYWdJbXBsIGZyb20gXCIuL0F1ZGlvVGFnSW1wbFwiO1xyXG5pbXBvcnQgQXVkaW9Db250ZXh0SW1wbCBmcm9tIFwiLi9BdWRpb0NvbnRleHRJbXBsXCI7XHJcbmltcG9ydCBFbmdpbmVNZXNzYWdlIGZyb20gXCIuLi9tZXNzYWdlL0VuZ2luZU1lc3NhZ2VcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTMwXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTMwXHJcbiAqXHJcbiAqIOmfs+mikeeuoeeQhuWZqO+8jOmfs+mikeaOpeWPo+iiq+W8uuihjOWIhuS4uuS4pOmDqOWIhu+8mlNvdW5k5ZKMTXVzaWPjgIJcclxuICogU291bmTvvJrkvb/nlKhBdWRpb+agh+etvuaSreaUvu+8jOWPr+S7pei3qOWfn+aSreaUvuS9huWPr+iDveS8muiiq+afkOS6m+a1j+iniOWZqOmZkOWItu+8jOW/hemhu+WcqOeCueWHu+S6i+S7tuWkhOeQhuWHveaVsOS4reaSreaUvlxyXG4gKiBNdXNpY++8muS9v+eUqEF1ZGlvQ29udGV4dOaSreaUvu+8jOWPr+S7peS4gOWumueoi+W6puS4iui2iui/h+eCueWHu+S6i+S7tuajgOafpe+8jOS9huaXoOazlei3qOWfn+aSreaUvu+8jOmAguWQiOaSreaUvuiDjOaZr+mfs+S5kFxyXG4qL1xyXG52YXIgQXVkaW9NYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXVkaW9NYW5hZ2VyKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsID0gbmV3IEF1ZGlvVGFnSW1wbCgpO1xyXG4gICAgICAgIC8vIOS4uldlYkF1ZGlv5YGa5YW85a655aSE55CGXHJcbiAgICAgICAgd2luZG93W1wiQXVkaW9Db250ZXh0XCJdID0gd2luZG93W1wiQXVkaW9Db250ZXh0XCJdIHx8IHdpbmRvd1tcIndlYmtpdEF1ZGlvQ29udGV4dFwiXSB8fCB3aW5kb3dbXCJtb3pBdWRpb0NvbnRleHRcIl0gfHwgd2luZG93W1wibXNBdWRpb0NvbnRleHRcIl07XHJcbiAgICAgICAgLy8g55Sx5LqOSUXlj6/og73kuI3mlK/mjIFBdWRpb0NvbnRleHTvvIzlm6DmraTlpoLmnpzmmK9JReWImeimgeaUueeUqEF1ZGlv5qCH562+5a6e546wXHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsID0gKHdpbmRvd1tcIkF1ZGlvQ29udGV4dFwiXSA/IG5ldyBBdWRpb0NvbnRleHRJbXBsKCkgOiB0aGlzLl9zb3VuZEltcGwpO1xyXG4gICAgICAgIGNvcmUubGlzdGVuKEVuZ2luZU1lc3NhZ2UuSU5JVElBTElaRUQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g6K+75Y+W5oyB5LmF5YyW6K6w5b2VXHJcbiAgICAgICAgICAgIHZhciBzaGVsbCA9IGNvcmUuZ2V0SW5qZWN0KFNoZWxsKTtcclxuICAgICAgICAgICAgX3RoaXMubXV0ZVNvdW5kID0gKHNoZWxsLmxvY2FsU3RvcmFnZUdldChBdWRpb01hbmFnZXJfMS5TVE9SQUdFX0tFWV9NVVRFX1NPVU5EKSA9PT0gXCJ0cnVlXCIpO1xyXG4gICAgICAgICAgICBfdGhpcy5tdXRlTXVzaWMgPSAoc2hlbGwubG9jYWxTdG9yYWdlR2V0KEF1ZGlvTWFuYWdlcl8xLlNUT1JBR0VfS0VZX01VVEVfTVVTSUMpID09PSBcInRydWVcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBBdWRpb01hbmFnZXJfMSA9IEF1ZGlvTWFuYWdlcjtcclxuICAgIC8qKlxyXG4gICAgICog5rOo5YaMU291bmTpn7PpopHlrp7njrDlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lBdWRpb30gc291bmRJbXBsIFNvdW5k6Z+z6aKR5a6e546w5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXJTb3VuZEltcGwgPSBmdW5jdGlvbiAoc291bmRJbXBsKSB7XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsID0gc291bmRJbXBsO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdWRpb01hbmFnZXIucHJvdG90eXBlLCBcIm11dGVTb3VuZFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5oiW6K6+572uU291bmTnsbvlnovpn7PpopHpnZnpn7PlsZ7mgKdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NvdW5kSW1wbC5tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLl9zb3VuZEltcGwubXV0ZSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5fc291bmRJbXBsLm11dGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g5oyB5LmF5YyWXHJcbiAgICAgICAgICAgIHZhciBzaGVsbCA9IGNvcmUuZ2V0SW5qZWN0KFNoZWxsKTtcclxuICAgICAgICAgICAgc2hlbGwubG9jYWxTdG9yYWdlU2V0KEF1ZGlvTWFuYWdlcl8xLlNUT1JBR0VfS0VZX01VVEVfU09VTkQsIHZhbHVlICsgXCJcIik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vVNvdW5k6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5sb2FkU291bmQgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsLmxvYWQodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvlNvdW5k6Z+z6aKR77yM5aaC5p6c5rKh5pyJ5Yqg6L295YiZ5Lya5YWI6KGM5Yqg6L29XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBdWRpb1BsYXlQYXJhbXN9IHBhcmFtcyDpn7PpopHmkq3mlL7lj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wbGF5U291bmQgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgLy8g5Yik5pat6Z2Z6Z+zXHJcbiAgICAgICAgaWYgKHRoaXMubXV0ZVNvdW5kKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g5YGc5q2i5YW25LuW6Z+z6aKRXHJcbiAgICAgICAgaWYgKHBhcmFtcy5zdG9wT3RoZXJzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcEFsbFNvdW5kKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcEFsbE11c2ljcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwucGxheShwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6Lez6L2sU291bmTpn7PpopHov5vluqZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUg6KaB6Lez6L2s5Yiw55qE6Z+z6aKR5L2N572u77yM5q+r56eS5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuc2Vla1NvdW5kID0gZnVuY3Rpb24gKHVybCwgdGltZSkge1xyXG4gICAgICAgIHRoaXMuX3NvdW5kSW1wbC5zZWVrKHVybCwgdGltZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraJTb3VuZOmfs+mikVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z6aKR5Zyw5Z2AXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuc3RvcFNvdW5kID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX3NvdW5kSW1wbC5zdG9wKHVybCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmoLlgZxTb3VuZOmfs+mikVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z6aKR5Zyw5Z2AXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucGF1c2VTb3VuZCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwucGF1c2UodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWBnOatouaJgOaciVNvdW5k6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnN0b3BBbGxTb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwuc3RvcEFsbCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo5YaMTXVzaWPpn7PpopHlrp7njrDlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lBdWRpb30gbXVzaWNJbXBsIE11c2lj6Z+z6aKR5a6e546w5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXJNdXNpY0ltcGwgPSBmdW5jdGlvbiAobXVzaWNJbXBsKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsID0gbXVzaWNJbXBsO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdWRpb01hbmFnZXIucHJvdG90eXBlLCBcIm11dGVNdXNpY1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5oiW6K6+572uTXVzaWPnsbvlnovpn7PpopHpnZnpn7PlsZ7mgKdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX211c2ljSW1wbC5tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLl9tdXNpY0ltcGwubXV0ZSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5fbXVzaWNJbXBsLm11dGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g5oyB5LmF5YyWXHJcbiAgICAgICAgICAgIHZhciBzaGVsbCA9IGNvcmUuZ2V0SW5qZWN0KFNoZWxsKTtcclxuICAgICAgICAgICAgc2hlbGwubG9jYWxTdG9yYWdlU2V0KEF1ZGlvTWFuYWdlcl8xLlNUT1JBR0VfS0VZX01VVEVfTVVTSUMsIHZhbHVlICsgXCJcIik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vU11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5sb2FkTXVzaWMgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLmxvYWQodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvk11c2lj6Z+z6aKR77yM5aaC5p6c5rKh5pyJ5Yqg6L295YiZ5Lya5YWI6KGM5Yqg6L29XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBdWRpb1BsYXlQYXJhbXN9IFtwYXJhbXNdIOmfs+mikeWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnBsYXlNdXNpYyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICAvLyDliKTmlq3pnZnpn7NcclxuICAgICAgICBpZiAodGhpcy5tdXRlTXVzaWMpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyDlgZzmraLlhbbku5bpn7PpopFcclxuICAgICAgICBpZiAocGFyYW1zLnN0b3BPdGhlcnMpIHtcclxuICAgICAgICAgICAgdGhpcy5zdG9wQWxsU291bmQoKTtcclxuICAgICAgICAgICAgdGhpcy5zdG9wQWxsTXVzaWNzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX211c2ljSW1wbC5wbGF5KHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7PovaxNdXNpY+mfs+mikei/m+W6plxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z6aKRVVJMXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdGltZSDopoHot7PovazliLDnmoTpn7PpopHkvY3nva7vvIzmr6vnp5LlgLxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zZWVrTXVzaWMgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLnNlZWsodXJsLCB0aW1lKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWBnOatok11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zdG9wTXVzaWMgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLnN0b3AodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaaguWBnE11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wYXVzZU11c2ljID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX211c2ljSW1wbC5wYXVzZSh1cmwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i5omA5pyJTXVzaWPpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuc3RvcEFsbE11c2ljcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9tdXNpY0ltcGwuc3RvcEFsbCgpO1xyXG4gICAgfTtcclxuICAgIEF1ZGlvTWFuYWdlci5TVE9SQUdFX0tFWV9NVVRFX1NPVU5EID0gXCJBdWRpb01hbmFnZXI6Om11dGVTb3VuZFwiO1xyXG4gICAgQXVkaW9NYW5hZ2VyLlNUT1JBR0VfS0VZX01VVEVfTVVTSUMgPSBcIkF1ZGlvTWFuYWdlcjo6bXV0ZU11c2ljXCI7XHJcbiAgICBBdWRpb01hbmFnZXIgPSBBdWRpb01hbmFnZXJfMSA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZSxcclxuICAgICAgICB0c2xpYl8xLl9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcclxuICAgIF0sIEF1ZGlvTWFuYWdlcik7XHJcbiAgICByZXR1cm4gQXVkaW9NYW5hZ2VyO1xyXG4gICAgdmFyIEF1ZGlvTWFuYWdlcl8xO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBdWRpb01hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBhdWRpb01hbmFnZXIgPSBjb3JlLmdldEluamVjdChBdWRpb01hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA3MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgYXNzZXRzTWFuYWdlciwgSlNMb2FkTW9kZSB9IGZyb20gXCIuLi9hc3NldHMvQXNzZXRzTWFuYWdlclwiO1xyXG5pbXBvcnQgQXVkaW9UYWdJbXBsIGZyb20gXCIuLi9hdWRpby9BdWRpb1RhZ0ltcGxcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMjNcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMjNcclxuICpcclxuICog5aSW5aOz5o6l5Y+j77yM6K+l57G75pei5L2c5Li65aSW5aOz5o6l5Y+j55qE5rOo5YWl5Z+657G777yM5Lmf5L2c5Li65qCH5YeG5rWP6KeI5Zmo55qE5a6e546w5L2/55SoXHJcbiovXHJcbnZhciBTaGVsbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNoZWxsKCkge1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNoZWxsLnByb3RvdHlwZSwgXCJwcm94eVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u5aSW5aOz5Luj55CG77yM5aaC5p6c5p2h5Lu25ZG95Lit5LqG6K+l5Luj55CG57G75Z6L77yM5YiZ55Sf5oiQ6K+l5Luj55CG5a6e5L6L5bm25pu/5Luj5aSW5aOz6KGM5Li6XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUuaGl0KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJveHkgPSBuZXcgdmFsdWUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTaGVsbC5wcm90b3R5cGUsIFwidHlwZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5b2T5YmN5aSW5aOz57G75Z6LXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fcHJveHkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJveHkudHlwZTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwid2ViXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqIOS4i+mdouaYr+mhtemdoui3s+i9rOaOpeWPoyAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAvKipcclxuICAgICAqIOWIt+aWsOmhtemdolxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7e1xyXG4gICAgICogICAgICAgICBmb3JjZWRSZWxvYWQ/OmJvb2xlYW4sIC8vIGZhbHNl6KGo56S65YWB6K645LuO57yT5a2Y5Y+W77yMdHJ1ZeihqOekuuW8uuWItuS7juacjeWKoeWZqOWPlu+8jOm7mOiupOaYr2ZhbHNlXHJcbiAgICAgKiAgICAgICAgIHVybD86c3RyaW5nLCAvLyDkvKDpgJLliJnkvb/nlKjmlrBVUkzliLfmlrDpobXpnaJcclxuICAgICAqICAgICAgICAgcmVwbGFjZT86Ym9vbGVhbiAvLyDlpoLmnpzmnInmlrB1cmzvvIzliJnooajnpLrmmK/lkKbopoHmm7/mjaLlvZPliY3mtY/op4jljoblj7JcclxuICAgICAqICAgICB9fSBbcGFyYW1zXVxyXG4gICAgICogQG1lbWJlcm9mIFNoZWxsXHJcbiAgICAgKi9cclxuICAgIFNoZWxsLnByb3RvdHlwZS5yZWxvYWQgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Byb3h5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3h5LnJlbG9hZChwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCFwYXJhbXMpXHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFwYXJhbXMudXJsKVxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZChwYXJhbXMuZm9yY2VkUmVsb2FkKTtcclxuICAgICAgICAgICAgZWxzZSBpZiAoIXBhcmFtcy5yZXBsYWNlKVxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBwYXJhbXMudXJsO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShwYXJhbXMudXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDkuIDkuKrmlrDpobXpnaJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3tcclxuICAgICAqICAgICAgICAgdXJsPzpzdHJpbmcsIC8vIOaWsOmhtemdouWcsOWdgO+8jOS4jeS8oOWImeS4jeabtOaWsOWcsOWdgFxyXG4gICAgICogICAgICAgICBuYW1lPzpzdHJpbmcsIC8vIOe7meaWsOmhtemdouWRveWQje+8jOaIluWvvOiIquWIsOW3suaciemhtemdolxyXG4gICAgICogICAgICAgICByZXBsYWNlPzpib29sZWFuLCAvLyDmmK/lkKbmm7/mjaLlvZPliY3mtY/op4jljoblj7LmnaHnm67vvIzpu5jorqRmYWxzZVxyXG4gICAgICogICAgICAgICBmZWF0dXJlczp7W2tleTpzdHJpbmddOmFueX0gLy8g5YW25LuW5Y+v6IO955qE5Y+C5pWwXHJcbiAgICAgKiAgICAgfX0gW3BhcmFtc11cclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICBpZiAodGhpcy5fcHJveHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJveHkub3BlbihwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCFwYXJhbXMpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmVhdHVyZXMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmZlYXR1cmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1zLmZlYXR1cmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goa2V5ICsgXCI9XCIgKyBwYXJhbXMuZmVhdHVyZXNba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgd2luZG93Lm9wZW4ocGFyYW1zLnVybCwgcGFyYW1zLm5hbWUsIGZlYXR1cmVzICYmIGZlYXR1cmVzLmpvaW4oXCIsXCIpLCBwYXJhbXMucmVwbGFjZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhbPpl63nqpflj6NcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAqL1xyXG4gICAgU2hlbGwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSlcclxuICAgICAgICAgICAgdGhpcy5fcHJveHkuY2xvc2UoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHdpbmRvdy5jbG9zZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKiog5LiL6Z2i5piv5pys5Zyw5a2Y5YKo5o6l5Y+jICoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5pys5Zyw5a2Y5YKoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSDopoHojrflj5blgLznmoTplK5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOiOt+WPlueahOWAvFxyXG4gICAgICogQG1lbWJlcm9mIFNoZWxsXHJcbiAgICAgKi9cclxuICAgIFNoZWxsLnByb3RvdHlwZS5sb2NhbFN0b3JhZ2VHZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Byb3h5KVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJveHkubG9jYWxTdG9yYWdlR2V0KGtleSk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7mnKzlnLDlrZjlgqhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IOimgeiuvue9rueahOmUrlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIOimgeiuvue9rueahOWAvFxyXG4gICAgICogQG1lbWJlcm9mIFNoZWxsXHJcbiAgICAgKi9cclxuICAgIFNoZWxsLnByb3RvdHlwZS5sb2NhbFN0b3JhZ2VTZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSlcclxuICAgICAgICAgICAgdGhpcy5fcHJveHkubG9jYWxTdG9yYWdlU2V0KGtleSwgdmFsdWUpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5pys5Zyw5a2Y5YKoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSDopoHnp7vpmaTnmoTplK5cclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUubG9jYWxTdG9yYWdlUmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSlcclxuICAgICAgICAgICAgdGhpcy5fcHJveHkubG9jYWxTdG9yYWdlUmVtb3ZlKGtleSk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa4heepuuacrOWcsOWtmOWCqFxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUubG9jYWxTdG9yYWdlQ2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Byb3h5KVxyXG4gICAgICAgICAgICB0aGlzLl9wcm94eS5sb2NhbFN0b3JhZ2VDbGVhcigpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5jbGVhcigpO1xyXG4gICAgfTtcclxuICAgIFNoZWxsID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBTaGVsbCk7XHJcbiAgICByZXR1cm4gU2hlbGw7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFNoZWxsO1xyXG4vKipcclxuICog6L+Z5pivU2hlbGzlnKjlvq7kv6HmtY/op4jlmajkuIvnmoTkuIDkuKrlj5jlvaLku6PnkIZcclxuICpcclxuICogQGNsYXNzIFNoZWxsV1hcclxuICogQGV4dGVuZHMge1NoZWxsfVxyXG4gKi9cclxudmFyIFNoZWxsV1ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTaGVsbFdYLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2hlbGxXWCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIC8vIOeUqOadpeiusOW9leWKoOi9veW+ruS/oWpz6Ze06ZqZ55qE6Z+z6aKR5Yqg6L296K+35rGCXHJcbiAgICAgICAgdmFyIGxvYWRDYWNoZSA9IFtdO1xyXG4gICAgICAgIHZhciBsb2FkRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOWPmOW8gkF1ZGlvVGFnSW1wbO+8jOWcqOW+ruS/oemHjOeahEF1ZGlv5qCH562+6ZyA6KaB5LuO5b6u5L+h6Kem5Y+R5Yqg6L29XHJcbiAgICAgICAgdmFyIG9yaUxvYWQgPSBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLmxvYWQ7XHJcbiAgICAgICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyDnrKzkuIDmrKHov5vooYzkuobpn7PpopHliqDovb3vvIzlpoLmnpzov5jmsqHliqDovb3ov4dqc++8jOWImeWOu+WKoOi9veS5i1xyXG4gICAgICAgICAgICBpZiAoIWxvYWRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICBsb2FkRmxhZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyDljrvliqDovb3lvq7kv6Fqc1xyXG4gICAgICAgICAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkSnNGaWxlcyhbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cDovL3Jlcy53eC5xcS5jb20vb3Blbi9qcy9qd2VpeGluLTEuMi4wLmpzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IEpTTG9hZE1vZGUuVEFHXHJcbiAgICAgICAgICAgICAgICAgICAgfV0sIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPkeeUn+mUmeivr+S6hu+8jOaBouWkjeWOn+Wni+eahOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLmxvYWQgPSBvcmlMb2FkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTpl63ljIXmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpTG9hZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmHjeaWsOWQr+WKqOe8k+WtmOeahOWKoOi9veivt+axglxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgbG9hZENhY2hlXzEgPSBsb2FkQ2FjaGU7IF9pIDwgbG9hZENhY2hlXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZSA9IGxvYWRDYWNoZV8xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVbMV0ubG9hZChjYWNoZVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmXreWMheaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRDYWNoZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlpITnkIZ1cmxcclxuICAgICAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgICAgIC8vIOWwneivleiOt+WPlue8k+WtmOaVsOaNrlxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmsqHmnInnvJPlrZjmiY3ljrvliqDovb1cclxuICAgICAgICAgICAgaWYgKCFkYXRhIHx8IGRhdGEuX19mcm9tX2NhY2hlX18pIHtcclxuICAgICAgICAgICAgICAgIC8vIOWFiOiwg+eUqOWOn+Wni+aWueazle+8jOWQpuWImeihjOS4uuWwseWPmOS6hlxyXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIG9yaUxvYWQuY2FsbCh0aGlzLCB1cmwpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLl9fZnJvbV9jYWNoZV9fO1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6canPov5jmsqHliqDovb3lpb3liJnnrYnlvoXliqDovb1cclxuICAgICAgICAgICAgICAgIGlmICghd2luZG93W1wid3hcIl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkQ2FjaGUucHVzaChbdXJsLCB0aGlzXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6L+Z6YeM6K6w5b2V5LiA5Liq5LuO57yT5a2Y5p2l55qE5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuX19mcm9tX2NhY2hlX18gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOS7juW+ruS/oemHjOinpuWPkeWKoOi9veaTjeS9nFxyXG4gICAgICAgICAgICAgICAgd2luZG93W1wid3hcIl0uY2hlY2tKc0FwaSh7XHJcbiAgICAgICAgICAgICAgICAgICAganNBcGlMaXN0OiBbXCJjaGVja0pzQXBpXCJdLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gZGF0YS5ub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNoZWxsV1gsIFwiaGl0XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh3aW5kb3cudG9wID09PSB3aW5kb3cgJiZcclxuICAgICAgICAgICAgICAgIC9NaWNyb01lc3Nlbmdlci9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNoZWxsV1gucHJvdG90eXBlLCBcInR5cGVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJ3ZWl4aW5cIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFNoZWxsV1gucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHdpbmRvd1tcIldlaXhpbkpTQnJpZGdlXCJdLmludm9rZShcImNsb3NlV2luZG93XCIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTaGVsbFdYO1xyXG59KFNoZWxsKSk7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBzaGVsbCA9IGNvcmUuZ2V0SW5qZWN0KFNoZWxsKTtcclxuLyoqIOWwneivlea3u+WKoOW+ruS/oeWkluWjs+S7o+eQhiAqL1xyXG5zaGVsbC5wcm94eSA9IFNoZWxsV1g7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvU2hlbGwuanNcbi8vIG1vZHVsZSBpZCA9IDczXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGFzc2V0c01hbmFnZXIgfSBmcm9tIFwiLi4vYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IEF1ZGlvTWVzc2FnZSBmcm9tIFwiLi9BdWRpb01lc3NhZ2VcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vZW52L0Vudmlyb25tZW50XCI7XHJcbmltcG9ydCB7IHN5c3RlbSB9IGZyb20gXCIuLi9zeXN0ZW0vU3lzdGVtXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0zMFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0zMFxyXG4gKlxyXG4gKiDkvb/nlKhBdWRpb0NvbnRleHTlrp7njrBJQXVkaW/mjqXlj6PnmoTlrp7njrDnsbtcclxuKi9cclxudmFyIEF1ZGlvQ29udGV4dEltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdWRpb0NvbnRleHRJbXBsKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fbXV0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3BsYXlpbmdEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5faW5pdGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYXVkaW9DYWNoZSA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBuZXcgKHdpbmRvd1tcIkF1ZGlvQ29udGV4dFwiXSB8fCB3aW5kb3dbXCJ3ZWJraXRBdWRpb0NvbnRleHRcIl0pKCk7XHJcbiAgICAgICAgdmFyIG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIG9uSW5pdCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uSW5pdCk7XHJcbiAgICAgICAgICAgIC8vIOeUn+aIkOS4gOS4quepuueahOmfs+mike+8jOaSreaUvuW5tuWBnOatou+8jOeUqOS7peino+mZpOmZkOWItlxyXG4gICAgICAgICAgICB2YXIgc291cmNlID0gX3RoaXMuX2NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XHJcbiAgICAgICAgICAgIHNvdXJjZS5idWZmZXIgPSBfdGhpcy5fY29udGV4dC5jcmVhdGVCdWZmZXIoMSwgMSwgNDQxMDApO1xyXG4gICAgICAgICAgICBzb3VyY2UuY29ubmVjdChfdGhpcy5fY29udGV4dC5kZXN0aW5hdGlvbik7XHJcbiAgICAgICAgICAgIHNvdXJjZS5zdGFydCgpO1xyXG4gICAgICAgICAgICBzb3VyY2Uuc3RvcCgpO1xyXG4gICAgICAgICAgICAvLyDorr7nva7moIfor4bnrKZcclxuICAgICAgICAgICAgX3RoaXMuX2luaXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeacieato+WcqOaSreaUvueahOmfs+mike+8jOWFqOmDqOWGjeaSreaUvuS4gOasoVxyXG4gICAgICAgICAgICBmb3IgKHZhciB1cmwgaW4gX3RoaXMuX2F1ZGlvQ2FjaGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gX3RoaXMuX2F1ZGlvQ2FjaGVbdXJsXTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBBdWRpb1N0YXR1cy5QTEFZSU5HKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5YGc5q2i5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RvcChkYXRhLnBsYXlQYXJhbXMudXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDph43mlrDmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5KGRhdGEucGxheVBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBvbkluaXQpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uSW5pdCk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUsIFwibXV0ZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Z2Z6Z+z54q25oCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fbXV0ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvLyDpnZnpn7PvvIzmmoLlgZzmiYDmnInlo7Dpn7NcclxuICAgICAgICAgICAgZm9yICh2YXIgdXJsIGluIHRoaXMuX3BsYXlpbmdEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZnpn7PvvIzlgZzmraLpn7PpopHvvIzkuI3lj6/osIPnlKhzdG9w5pa55rOV77yM5Zug5Li66KaB5L+d5oyB5pKt5pS+5Lit55qE6Z+z6aKR54q25oCBXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9TdG9wKHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZ7pnZnpn7PvvIzmkq3mlL7pn7PpopFcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5fcGxheWluZ0RpY3RbdXJsXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3pn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikeWcsOWdgFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIC8vIOWwneivleiOt+WPlue8k+WtmOaVsOaNrlxyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgLy8g5aaC5p6c5rKh5pyJ57yT5a2Y5omN5Y675Yqg6L29XHJcbiAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIOS9v+eUqEF1ZGlvQ29udGV4dOWKoOi9vVxyXG4gICAgICAgICAgICB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXSA9IGRhdGEgPSB7IGJ1ZmZlcjogbnVsbCwgc3RhdHVzOiBBdWRpb1N0YXR1cy5MT0FESU5HLCBwbGF5UGFyYW1zOiBudWxsLCBwcm9ncmVzczogbnVsbCB9O1xyXG4gICAgICAgICAgICAvLyDlvIDlp4vliqDovb1cclxuICAgICAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkQXNzZXRzKHRvVXJsLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY29udGV4dC5kZWNvZGVBdWRpb0RhdGEocmVzdWx0LCBmdW5jdGlvbiAoYnVmZmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuYnVmZmVyID0gYnVmZmVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7nirbmgIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOiHquWKqOaSreaUvuWImeaSreaUvlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wbGF5UGFyYW1zKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGxheShkYXRhLnBsYXlQYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBcImFycmF5YnVmZmVyXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvumfs+mike+8jOWmguaenOmfs+mikeayoeacieWKoOi9veWImeWFiOWKoOi9veWGjeaSreaUvlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QXVkaW9QbGF5UGFyYW1zfSBwYXJhbXMg6Z+z6aKR5pKt5pS+5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb0NvbnRleHRJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwocGFyYW1zLnVybCk7XHJcbiAgICAgICAgLy8g5bCd6K+V6I635Y+W57yT5a2Y5pWw5o2uXHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgICAgLy8g5rKh5pyJ5Yqg6L296L+H77yM5byA5aeL5Yqg6L296Z+z6aKRXHJcbiAgICAgICAgICAgIHRoaXMubG9hZChwYXJhbXMudXJsKTtcclxuICAgICAgICAgICAgLy8g6K6+572u5pKt5pS+5Y+C5pWwXHJcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdLnBsYXlQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGRhdGEuc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEF1ZGlvU3RhdHVzLkxPQURJTkc6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5q2j5Zyo5Yqg6L295Lit77yM5pu/5o2i6Ieq5Yqo5pKt5pS+5Y+C5pWwXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wbGF5UGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBBdWRpb1N0YXR1cy5QTEFZSU5HOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOato+WcqOaSreaUvu+8jOWFs+mXreWQjuWGjeaSreaUvlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcChwYXJhbXMudXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgQXVkaW9TdGF0dXMuUEFVU0VEOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rueKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gQXVkaW9TdGF0dXMuUExBWUlORztcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXmkq3mlL7kuK1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF0gPSBwYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5Yqg6L295a6M5q+V77yM55u05o6l5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2luaXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUgPSB0aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuYnVmZmVyID0gZGF0YS5idWZmZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMubG9vcCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLmxvb3AgPSBwYXJhbXMubG9vcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLmNvbm5lY3QodGhpcy5fY29udGV4dC5kZXN0aW5hdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOebkeWQrOaSreaUvuWujOavlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUub25lbmRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gX3RoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlgZzmraLmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdG9wKHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuWujOavleS6i+S7tlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfRU5ERUQsIHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlvIDlp4vmkq3mlL7vvIzkvJjlhYjlj5blj4LmlbDkuK3nmoTml7bpl7TvvIzmsqHmnInlsLHlj5bpu5jorqTlvIDlp4vml7bpl7RcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy50aW1lICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5VGltZSA9IHBhcmFtcy50aW1lICogMC4wMDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlUaW1lID0gZGF0YS5wbGF5VGltZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEucGxheVRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZS5zdGFydChwbGF5VGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW8gOWni+aSreaUvui/m+W6puebkea1i1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFRpbWUgPSB0aGlzLl9jb250ZXh0LmN1cnJlbnRUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VyVGltZSA9IHBsYXlUaW1lIHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHJvZ3Jlc3MgPSBzeXN0ZW0uZW50ZXJGcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm93VGltZSA9IF90aGlzLl9jb250ZXh0LmN1cnJlbnRUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhVGltZSA9IG5vd1RpbWUgLSBsYXN0VGltZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RUaW1lID0gbm93VGltZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBBdWRpb1N0YXR1cy5QTEFZSU5HKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyVGltZSArPSBkZWx0YVRpbWUgKiAxMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFRpbWUgPSBkYXRhLm5vZGUuYnVmZmVyLmR1cmF0aW9uICogMTAwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1BST0dSRVNTLCBwYXJhbXMudXJsLCBjdXJUaW1lLCB0b3RhbFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5pKt5pS+5byA5aeL5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfU1RBUlRFRCwgcGFyYW1zLnVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLl9kb1N0b3AgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAvLyDorr7nva7nirbmgIFcclxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOi/m+W6puebkea1i1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5wcm9ncmVzcylcclxuICAgICAgICAgICAgICAgIGRhdGEucHJvZ3Jlc3MuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIC8vIOe7k+adn+aSreaUvlxyXG4gICAgICAgICAgICBpZiAoZGF0YS5ub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhLm5vZGUuc3RvcCh0aW1lKTtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuWBnOatouS6i+S7tlxyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9TVE9QUEVELCB1cmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pqC5YGc6Z+z6aKR77yI5LiN5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb0NvbnRleHRJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2RvU3RvcCh1cmwpO1xyXG4gICAgICAgIC8vIOenu+mZpOaSreaUvuS4rVxyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraLpn7PpopHvvIjkvJrph43nva7ov5vluqbvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9kb1N0b3AodXJsLCAwKTtcclxuICAgICAgICAvLyDnp7vpmaTmkq3mlL7kuK1cclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcGxheWluZ0RpY3RbdG9VcmxdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i5omA5pyJ6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUuc3RvcEFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciB1cmwgaW4gdGhpcy5fYXVkaW9DYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AodXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7Povazpn7PpopHov5vluqZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUg6KaB6Lez6L2s5Yiw55qE6Z+z6aKR5L2N572u77yM5q+r56eS5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9Db250ZXh0SW1wbFxyXG4gICAgICovXHJcbiAgICBBdWRpb0NvbnRleHRJbXBsLnByb3RvdHlwZS5zZWVrID0gZnVuY3Rpb24gKHVybCwgdGltZSkge1xyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGRhdGEucGxheVBhcmFtcztcclxuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IEF1ZGlvU3RhdHVzLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWBnOatoumHjeaWsOaSreaUvlxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wKHVybCk7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMudGltZSA9IHRpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEucGxheVRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBdWRpb0NvbnRleHRJbXBsO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBdWRpb0NvbnRleHRJbXBsO1xyXG52YXIgQXVkaW9TdGF0dXM7XHJcbihmdW5jdGlvbiAoQXVkaW9TdGF0dXMpIHtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L295LitXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvU3RhdHVzW0F1ZGlvU3RhdHVzW1wiTE9BRElOR1wiXSA9IDBdID0gXCJMT0FESU5HXCI7XHJcbiAgICAvKipcclxuICAgICAqIOW3suaaguWBnFxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIlBBVVNFRFwiXSA9IDFdID0gXCJQQVVTRURcIjtcclxuICAgIC8qKlxyXG4gICAgICog5pKt5pS+5LitXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvU3RhdHVzW0F1ZGlvU3RhdHVzW1wiUExBWUlOR1wiXSA9IDJdID0gXCJQTEFZSU5HXCI7XHJcbn0pKEF1ZGlvU3RhdHVzIHx8IChBdWRpb1N0YXR1cyA9IHt9KSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hdWRpby9BdWRpb0NvbnRleHRJbXBsLmpzXG4vLyBtb2R1bGUgaWQgPSA3NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi4vcmVzcG9uc2UvVGVzdFJlc3BvbnNlXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVxdWVzdERhdGFcIiwgXCJvbHltcHVzLXIvZW5naW5lL25ldC9wb2xpY2llcy9IVFRQUmVxdWVzdFBvbGljeVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFRlc3RSZXNwb25zZV8xLCBSZXF1ZXN0RGF0YV8xLCBIVFRQUmVxdWVzdFBvbGljeV8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQGF1dGhvciBUZW1wbGF0ZUdlbmVyYXRvclxyXG4gICAgICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICAgICAqIEBtb2RpZnkgZGF0ZSAxMC85LzIwMTdcclxuICAgICAqXHJcbiAgICAgKiDmtYvor5VcclxuICAgICovXHJcbiAgICB2YXIgVGVzdFJlcXVlc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3RSZXF1ZXN0LCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RSZXF1ZXN0KCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICAgICAgX3RoaXMuX19wb2xpY3kgPSBIVFRQUmVxdWVzdFBvbGljeV8xLmRlZmF1bHQ7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRlc3RSZXF1ZXN0LnByb3RvdHlwZSwgXCJfX3BhcmFtc1wiLCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlRlc3RcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBcIi90ZXN0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6IFwiaHR0cFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiBUZXN0UmVzcG9uc2VfMS5kZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVzdDogdGhpcy50ZXN0IC8vIHN0cmluZyAtIOa1i+ivlVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIDtcclxuICAgICAgICByZXR1cm4gVGVzdFJlcXVlc3Q7XHJcbiAgICB9KFJlcXVlc3REYXRhXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdFJlcXVlc3Q7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEZKbGNYVmxjM1F1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlVaWE4wVW1WeGRXVnpkQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN08wbEJTMEU3T3pzN096dE5RVTFGTzBsQlEwWTdVVUZCZVVNc0swSkJRVmM3VVVGQmNFUTdXVUZCUVN4eFJVRjFRa003V1VGRVZTeGpRVUZSTEVkQlFXdENMREpDUVVGTkxFTkJRVU03TzFGQlF6VkRMRU5CUVVNN1VVRmlSeXh6UWtGQlZ5eHBRMEZCVVR0cFFrRkJia0k3WjBKQlJVa3NUVUZCVFN4RFFVRkRPMjlDUVVOSUxFbEJRVWtzUlVGQlJTeE5RVUZOTzI5Q1FVTnlRaXhKUVVGSkxFVkJRVVVzVDBGQlR6dHZRa0ZEU2l4UlFVRlJMRVZCUVVVc1RVRkJUVHR2UWtGRGFFSXNVVUZCVVN4RlFVRkZMSE5DUVVGWk8yOUNRVU4wUWl4SlFVRkpMRVZCUVVVN2QwSkJRMFlzU1VGQlNTeEZRVUZGTEVsQlFVa3NRMEZCUXl4SlFVRkpMRU5CUVVFc1kwRkJZenR4UWtGRGFFTTdhVUpCUTBvc1EwRkJRenRaUVVOT0xFTkJRVU03T3p0WFFVRkJPMUZCUVVFc1EwRkJRenRSUVVWT0xHdENRVUZETzBsQlFVUXNRMEZCUXl4QlFYWkNSQ3hEUVVGNVF5eHhRa0ZCVnl4SFFYVkNia1FpZlE9PVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9uZXQvcmVxdWVzdC9UZXN0UmVxdWVzdC50c1xuLy8gbW9kdWxlIGlkID0gNzVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci9lbmdpbmUvbmV0L0RhdGFUeXBlXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgRGF0YVR5cGVfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBhdXRob3IgVGVtcGxhdGVHZW5lcmF0b3JcclxuICAgICAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAgICAgKiBAbW9kaWZ5IGRhdGUgMTAvOS8yMDE3XHJcbiAgICAgKlxyXG4gICAgICog5rWL6K+VXHJcbiAgICAqL1xyXG4gICAgdmFyIFRlc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3QsIF9zdXBlcik7XHJcbiAgICAgICAgZnVuY3Rpb24gVGVzdCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBUZXN0LnByb3RvdHlwZS5kb1BhcnNlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy50ZXN0ID0gZGF0YS50ZXN0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGVzdC5wcm90b3R5cGUucGFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRlc3Q6IHRoaXMudGVzdFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIFRlc3Q7XHJcbiAgICB9KERhdGFUeXBlXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdDtcclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVZHVnpkQzVxY3lJc0luTnZkWEpqWlZKdmIzUWlPaUlpTENKemIzVnlZMlZ6SWpwYklsUmxjM1F1ZEhNaVhTd2libUZ0WlhNaU9sdGRMQ0p0WVhCd2FXNW5jeUk2SWpzN096czdPenM3T3pzN096dEpRVVZCT3pzN096czdUVUZOUlR0SlFVTkdPMUZCUVd0RExIZENRVUZSTzFGQlFURkRPenRSUVhOQ1FTeERRVUZETzFGQldtRXNjMEpCUVU4c1IwRkJha0lzVlVGQmEwSXNTVUZCVVR0WlFVVjBRaXhGUVVGRkxFTkJRVUVzUTBGQlF5eEpRVUZKTEVsQlFVa3NTVUZCU1N4RFFVRkRPMmRDUVVGRExFMUJRVTBzUTBGQlF6dFpRVU40UWl4SlFVRkpMRU5CUVVNc1NVRkJTU3hIUVVGSExFbEJRVWtzUTBGQlF5eEpRVUZKTEVOQlFVTTdVVUZETVVJc1EwRkJRenRSUVVWTkxHMUNRVUZKTEVkQlFWZzdXVUZGU1N4TlFVRk5MRU5CUVVNN1owSkJRMGdzU1VGQlNTeEZRVUZGTEVsQlFVa3NRMEZCUXl4SlFVRkpPMkZCUTJ4Q0xFTkJRVU03VVVGRFRpeERRVUZETzFGQlEwd3NWMEZCUXp0SlFVRkVMRU5CUVVNc1FVRjBRa1FzUTBGQmEwTXNhMEpCUVZFc1IwRnpRbnBESW4wPVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9uZXQvdHlwZS9UZXN0LnRzXG4vLyBtb2R1bGUgaWQgPSA3NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBsb2FkIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL0hUVFBVdGlsXCI7XHJcbmltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIi4uLy4uL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgeyBuZXRNYW5hZ2VyIH0gZnJvbSBcIi4uL05ldE1hbmFnZXJcIjtcclxuaW1wb3J0IHsgZXh0ZW5kT2JqZWN0IH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTExXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTExXHJcbiAqXHJcbiAqIEhUVFDor7fmsYLnrZbnlaVcclxuKi9cclxudmFyIEhUVFBSZXF1ZXN0UG9saWN5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSFRUUFJlcXVlc3RQb2xpY3koKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWPkemAgeivt+axgumAu+i+kVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7UmVxdWVzdERhdGF9IHJlcXVlc3Qg6K+35rGC5pWw5o2uXHJcbiAgICAgKiBAbWVtYmVyb2YgSFRUUFJlcXVlc3RQb2xpY3lcclxuICAgICAqL1xyXG4gICAgSFRUUFJlcXVlc3RQb2xpY3kucHJvdG90eXBlLnNlbmRSZXF1ZXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QpIHtcclxuICAgICAgICAvLyDlj5bliLDlj4LmlbBcclxuICAgICAgICB2YXIgcGFyYW1zID0gcmVxdWVzdC5fX3BhcmFtcztcclxuICAgICAgICAvLyDkv67mlLnmlbDmja5cclxuICAgICAgICB2YXIgaHR0cFBhcmFtcyA9IGV4dGVuZE9iamVjdCh7XHJcbiAgICAgICAgICAgIHVybDogZW52aXJvbm1lbnQudG9Ib3N0VVJMKHBhcmFtcy5wYXRoLCBwYXJhbXMuaG9zdEluZGV4KSxcclxuICAgICAgICAgICAgb25SZXNwb25zZTogZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gbmV0TWFuYWdlci5fX29uUmVzcG9uc2UocmVxdWVzdC5fX3BhcmFtcy5yZXNwb25zZS50eXBlLCByZXN1bHQsIHJlcXVlc3QpOyB9LFxyXG4gICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBuZXRNYW5hZ2VyLl9fb25FcnJvcihyZXF1ZXN0Ll9fcGFyYW1zLnJlc3BvbnNlLnR5cGUsIGVyciwgcmVxdWVzdCk7IH0sXHJcbiAgICAgICAgICAgIGhlYWRlckRpY3Q6IHt9XHJcbiAgICAgICAgfSwgcGFyYW1zKTtcclxuICAgICAgICAvLyDlj5HpgIFcclxuICAgICAgICBsb2FkKGh0dHBQYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBIVFRQUmVxdWVzdFBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IHsgSFRUUFJlcXVlc3RQb2xpY3kgfTtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWunuS+iyAqL1xyXG5leHBvcnQgZGVmYXVsdCBuZXcgSFRUUFJlcXVlc3RQb2xpY3koKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9wb2xpY2llcy9IVFRQUmVxdWVzdFBvbGljeS5qc1xuLy8gbW9kdWxlIGlkID0gNzdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3JcIiwgXCJvbHltcHVzLXItZWdyZXQvZWdyZXQvaW5qZWN0b3IvSW5qZWN0b3JcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBNZWRpYXRvcl8xLCBJbmplY3Rvcl8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIHZhciBUZXN0Q29tcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoVGVzdENvbXAsIF9zdXBlcik7XHJcbiAgICAgICAgZnVuY3Rpb24gVGVzdENvbXAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgVGVzdENvbXAucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5za2luLnggPSAxMDA7XHJcbiAgICAgICAgICAgIHRoaXMuc2tpbi55ID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5za2luLmFkZENoaWxkKHRoaXMuc2tpbik7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goXCJUZXN0Q29tcE1zZ1wiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRlc3RDb21wLnByb3RvdHlwZS5vbkRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnNraW4ucmVtb3ZlQ2hpbGQodGhpcy5za2luKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRlc3RDb21wID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuRWdyZXRNZWRpYXRvckNsYXNzKFwiVGVzdENvbXBcIiwgXCJUZXN0Q29tcFNraW5cIilcclxuICAgICAgICBdLCBUZXN0Q29tcCk7XHJcbiAgICAgICAgcmV0dXJuIFRlc3RDb21wO1xyXG4gICAgfShNZWRpYXRvcl8xLmRlZmF1bHQpKTtcclxuICAgIGV4cG9ydHMuZGVmYXVsdCA9IFRlc3RDb21wO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVkdWemRFTnZiWEF1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlVaWE4wUTI5dGNDNTBjeUpkTENKdVlXMWxjeUk2VzEwc0ltMWhjSEJwYm1keklqb2lPenM3T3pzN096czdPenM3T3pzN096czdPMGxCU1VFN1VVRkJjME1zTkVKQlFWRTdVVUZCT1VNN08xRkJaVUVzUTBGQlF6dFJRV0pWTEhsQ1FVRk5MRWRCUVdJN1dVRkZTU3hKUVVGSkxFTkJRVU1zU1VGQlNTeERRVUZETEVOQlFVTXNSMEZCUnl4SFFVRkhMRU5CUVVNN1dVRkRiRUlzU1VGQlNTeERRVUZETEVsQlFVa3NRMEZCUXl4RFFVRkRMRWRCUVVjc1IwRkJSeXhEUVVGRE8xbEJRMnhDTEVsQlFVa3NRMEZCUXl4TlFVRk5MRU5CUVVNc1NVRkJTU3hEUVVGRExGRkJRVkVzUTBGQlF5eEpRVUZKTEVOQlFVTXNTVUZCU1N4RFFVRkRMRU5CUVVNN1dVRkZja01zU1VGQlNTeERRVUZETEZGQlFWRXNRMEZCUXl4aFFVRmhMRU5CUVVNc1EwRkJRenRSUVVOcVF5eERRVUZETzFGQlJVMHNORUpCUVZNc1IwRkJhRUk3V1VGRlNTeEpRVUZKTEVOQlFVTXNUVUZCVFN4RFFVRkRMRWxCUVVrc1EwRkJReXhYUVVGWExFTkJRVU1zU1VGQlNTeERRVUZETEVsQlFVa3NRMEZCUXl4RFFVRkRPMUZCUXpWRExFTkJRVU03VVVGa1owSXNVVUZCVVR0WlFVUTFRaXcyUWtGQmEwSXNRMEZCUXl4VlFVRlZMRVZCUVVVc1kwRkJZeXhEUVVGRE8xZEJRekZDTEZGQlFWRXNRMEZsTlVJN1VVRkJSQ3hsUVVGRE8wdEJRVUVzUVVGbVJDeERRVUZ6UXl4clFrRkJVU3hIUVdVM1F6dHpRa0ZtYjBJc1VVRkJVU0o5XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21vZHVsZXMvVGVzdENvbXAudHNcbi8vIG1vZHVsZSBpZCA9IDc4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcclxufTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwib2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1hbmFnZXJcIiwgXCIuL1Rlc3RQYW5lbFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIEluamVjdG9yXzEsIEluamVjdG9yXzIsIE1lZGlhdG9yXzEsIE1vZHVsZU1hbmFnZXJfMSwgVGVzdFBhbmVsXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgdmFyIFRlc3RGb3JNZWRpYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoVGVzdEZvck1lZGlhdG9yLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RGb3JNZWRpYXRvcihza2luKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBza2luKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBUZXN0Rm9yTWVkaWF0b3IucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld01vZGVsID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2tUZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kdWxlTWFuYWdlcl8xLm1vZHVsZU1hbmFnZXIub3BlbihUZXN0UGFuZWxfMS5kZWZhdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJhc2RmYXNkZiAtIFwiICsgZGF0YSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kT24oXCJjbGlja1wiLCBcIm9uQ2xpY2tUZXh0XCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxyXG4gICAgICAgIF0sIFRlc3RGb3JNZWRpYXRvci5wcm90b3R5cGUsIFwic2tpblwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkJpbmRWYWx1ZSh7IGlubmVySFRNTDogXCIn6L+Z5piv5pu/5o2i5ZCO55qE5riy5p+T5Zmo5YaF5bGCIC0gJyArIGRhdGEuZnVjayArICc8YnIvPidcIiB9KSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIFRlc3RGb3JNZWRpYXRvci5wcm90b3R5cGUsIFwiYXNkZlwiLCB2b2lkIDApO1xyXG4gICAgICAgIFRlc3RGb3JNZWRpYXRvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkRPTU1lZGlhdG9yQ2xhc3MoXCJUZXN0Rm9yTWVkaWF0b3JcIiwgXCI8ZGl2Pui/meaYr+abv+aNouWQjueahOa4suafk+WZqOWkluWxgjxkaXYgaWQ9J2FzZGYnPjwvZGl2PjwvZGl2PlwiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxyXG4gICAgICAgIF0sIFRlc3RGb3JNZWRpYXRvcik7XHJcbiAgICAgICAgcmV0dXJuIFRlc3RGb3JNZWRpYXRvcjtcclxuICAgIH0oTWVkaWF0b3JfMS5kZWZhdWx0KSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBUZXN0Rm9yTWVkaWF0b3I7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEVadmNrMWxaR2xoZEc5eUxtcHpJaXdpYzI5MWNtTmxVbTl2ZENJNklpSXNJbk52ZFhKalpYTWlPbHNpVkdWemRFWnZjazFsWkdsaGRHOXlMblJ6SWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1NVRlBRVHRSUVVFMlF5eHRRMEZCVVR0UlFWRnFSQ3g1UWtGQmJVSXNTVUZCU1R0dFFrRkZia0lzYTBKQlFVMHNTVUZCU1N4RFFVRkRPMUZCUTJZc1EwRkJRenRSUVVWTkxHZERRVUZOTEVkQlFXSXNWVUZCWXl4SlFVRkpPMWxCUldRc1NVRkJTU3hEUVVGRExGTkJRVk1zUjBGQlJ6dG5Ra0ZEWWl4SlFVRkpMRVZCUVVVc1NVRkJTVHRuUWtGRFZpeFhRVUZYTEVWQlFVVTdiMEpCUTFRc05rSkJRV0VzUTBGQlF5eEpRVUZKTEVOQlFVTXNiVUpCUVZNc1EwRkJReXhEUVVGRE8yZENRVU5zUXl4RFFVRkRPMkZCUTBvc1EwRkJRVHRaUVVORUxFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNZVUZCWVN4SFFVRkhMRWxCUVVrc1EwRkJReXhEUVVGRE8xRkJRM1JETEVOQlFVTTdVVUZ1UWtRN1dVRkVReXhwUWtGQlRTeERRVUZETEU5QlFVOHNSVUZCUlN4aFFVRmhMRU5CUVVNN08zRkVRVU5tTzFGQlIyaENPMWxCUkVNc2IwSkJRVk1zUTBGQlF5eEZRVUZETEZOQlFWTXNSVUZCUlN4M1EwRkJkME1zUlVGQlF5eERRVUZETzNORFFVTnlSQ3hYUVVGWE8zRkVRVUZETzFGQlRsQXNaVUZCWlR0WlFVUnVReXd5UWtGQlowSXNRMEZCUXl4cFFrRkJhVUlzUlVGQlJTdzJRMEZCTmtNc1EwRkJRenM3VjBGRE9VUXNaVUZCWlN4RFFYVkNia003VVVGQlJDeHpRa0ZCUXp0TFFVRkJMRUZCZGtKRUxFTkJRVFpETEd0Q1FVRlJMRWRCZFVKd1JEdHpRa0YyUW05Q0xHVkJRV1VpZlE9PVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9tb2R1bGVzL1Rlc3RGb3JNZWRpYXRvci50c1xuLy8gbW9kdWxlIGlkID0gNzlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IE1lZGlhdG9yIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclwiO1xyXG5pbXBvcnQgeyBwYW5lbE1hbmFnZXIgfSBmcm9tIFwiLi9QYW5lbE1hbmFnZXJcIjtcclxuaW1wb3J0IE1lZGlhdG9yTWVzc2FnZSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JNZXNzYWdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiDlrp7njrDkuoZJUGFuZWzmjqXlj6PnmoTlvLnnqpfkuK3ku4vogIXln7rnsbtcclxuKi9cclxudmFyIFBhbmVsTWVkaWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQYW5lbE1lZGlhdG9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUGFuZWxNZWRpYXRvcihza2luLCBwb2xpY3kpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBza2luKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnBvbGljeSA9IHBvbGljeTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBQYW5lbE1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25PcGVuID0gZnVuY3Rpb24gKGRhdGEsIGlzTW9kZWwsIGZyb20pIHtcclxuICAgICAgICBwYW5lbE1hbmFnZXIucG9wKHRoaXMsIGRhdGEsIGlzTW9kZWwsIGZyb20pO1xyXG4gICAgfTtcclxuICAgIFBhbmVsTWVkaWF0b3IucHJvdG90eXBlLl9fYWZ0ZXJPbkNsb3NlID0gZnVuY3Rpb24gKGRhdGEsIHRvKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDnr6HmlLlvbkFmdGVyRHJvcO+8jOetieW+heWFs+mXreWKqOeUu+e7k+adn+WQjuWGjeaJp+ihjFxyXG4gICAgICAgIHZhciBvcmlPbkFmdGVyRHJvcCA9IHRoaXMub25BZnRlckRyb3A7XHJcbiAgICAgICAgdGhpcy5vbkFmdGVyRHJvcCA9IGZ1bmN0aW9uIChkYXRhLCB0bykge1xyXG4gICAgICAgICAgICBvcmlPbkFmdGVyRHJvcC5jYWxsKF90aGlzLCBkYXRhLCB0byk7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkeWFs+mXreS6i+S7tlxyXG4gICAgICAgICAgICBfdGhpcy5kaXNwYXRjaChNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfQ0xPU0VELCBfdGhpcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBwYW5lbE1hbmFnZXIuZHJvcCh0aGlzLCBkYXRhLCB0byk7XHJcbiAgICB9O1xyXG4gICAgLyoqIOWcqOW8ueWHuuWJjeiwg+eUqOeahOaWueazlSAqL1xyXG4gICAgUGFuZWxNZWRpYXRvci5wcm90b3R5cGUub25CZWZvcmVQb3AgPSBmdW5jdGlvbiAoZGF0YSwgaXNNb2RlbCwgZnJvbSkge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIC8qKiDlnKjlvLnlh7rlkI7osIPnlKjnmoTmlrnms5UgKi9cclxuICAgIFBhbmVsTWVkaWF0b3IucHJvdG90eXBlLm9uQWZ0ZXJQb3AgPSBmdW5jdGlvbiAoZGF0YSwgaXNNb2RlbCwgZnJvbSkge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIC8qKiDlnKjlhbPpl63liY3osIPnlKjnmoTmlrnms5UgKi9cclxuICAgIFBhbmVsTWVkaWF0b3IucHJvdG90eXBlLm9uQmVmb3JlRHJvcCA9IGZ1bmN0aW9uIChkYXRhLCB0bykge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIC8qKiDlnKjlhbPpl63lkI7osIPnlKjnmoTmlrnms5UgKi9cclxuICAgIFBhbmVsTWVkaWF0b3IucHJvdG90eXBlLm9uQWZ0ZXJEcm9wID0gZnVuY3Rpb24gKGRhdGEsIHRvKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhbmVsTWVkaWF0b3I7XHJcbn0oTWVkaWF0b3IpKTtcclxuZXhwb3J0IGRlZmF1bHQgUGFuZWxNZWRpYXRvcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BhbmVsL1BhbmVsTWVkaWF0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDgwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcclxufTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9TZWNvbmRcIiwgXCIuLi9tb2RlbHMvRnVja01vZGVsXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lZGlhdG9yXCIsIFwib2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNYW5hZ2VyXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci1kb20vZG9tL2luamVjdG9yL0luamVjdG9yXCIsIFwiLi9UZXN0UGFuZWxcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBTZWNvbmRfMSwgRnVja01vZGVsXzEsIFNjZW5lTWVkaWF0b3JfMSwgSW5qZWN0b3JfMSwgTW9kdWxlTWFuYWdlcl8xLCBJbmplY3Rvcl8yLCBJbmplY3Rvcl8zLCBUZXN0UGFuZWxfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBhdXRob3IgUmF5a2lkXHJcbiAgICAgKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gICAgICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMThcclxuICAgICAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE4XHJcbiAgICAgKlxyXG4gICAgICog5rWL6K+V6aaW5Liq5qih5Z2XXHJcbiAgICAqL1xyXG4gICAgdmFyIFRoaXJkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgICAgIF9fZXh0ZW5kcyhUaGlyZCwgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBUaGlyZCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBUaGlyZF8xID0gVGhpcmQ7XHJcbiAgICAgICAgVGhpcmQucHJvdG90eXBlLmxpc3RBc3NldHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXCIuL21vZHVsZXMvdGVzdC5odG1sXCJdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGhpcmQucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBmdWNrTGlzdDogWzEsIDIsIFwic2hpdFwiLCBcInlvdVwiXSxcclxuICAgICAgICAgICAgICAgIGZ1Y2tUZXh0OiBcImZ1Y2sgeW91XCIsXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrQnRuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlld01vZGVsLmZ1Y2tUZXh0ID0gXCJjbGlja2VkXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlTWFuYWdlci5vcGVuKFNlY29uZF8xLmRlZmF1bHQsIG51bGwsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2tUZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlTWFuYWdlci5vcGVuKFRlc3RQYW5lbF8xLmRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2tGdWNrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlTWFuYWdlci5jbG9zZShUaGlyZF8xKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdWNrTW9kZWw6IHRoaXMuZnVja01vZGVsMVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGhpcmQubW9kdWxlTmFtZSA9IFwiVGhpcmRcIjtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5JbmplY3QsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBNb2R1bGVNYW5hZ2VyXzEuZGVmYXVsdClcclxuICAgICAgICBdLCBUaGlyZC5wcm90b3R5cGUsIFwibW9kdWxlTWFuYWdlclwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkluamVjdCxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1Y2tNb2RlbF8xLmRlZmF1bHQpXHJcbiAgICAgICAgXSwgVGhpcmQucHJvdG90eXBlLCBcImZ1Y2tNb2RlbDFcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5JbmplY3QsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdWNrTW9kZWxfMS5JRnVja01vZGVsKVxyXG4gICAgICAgIF0sIFRoaXJkLnByb3RvdHlwZSwgXCJmdWNrTW9kZWwyXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuSW5qZWN0KDEpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVja01vZGVsXzEuSUZ1Y2tNb2RlbClcclxuICAgICAgICBdLCBUaGlyZC5wcm90b3R5cGUsIFwiZnVja01vZGVsM1wiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkJpbmRPbih7IGNsaWNrOiBcIm9uQ2xpY2tCdG5cIiB9KSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kSWYoXCJmdWNrVGV4dCA9PSAnMTIzNCdcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIVE1MRWxlbWVudClcclxuICAgICAgICBdLCBUaGlyZC5wcm90b3R5cGUsIFwiYnRuXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZEZvcihcImZ1Y2sgaW4gZnVja0xpc3RcIiksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZFZhbHVlKHsgdGV4dENvbnRlbnQ6IFwiZnVjayArICcgLSAnICsgZnVja1RleHQgKyAnIC0gMSdcIiB9KSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kT24oXCJjbGlja1wiLCBcIm9uQ2xpY2tUZXh0XCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgXSwgVGhpcmQucHJvdG90eXBlLCBcInR4dFwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkJpbmRPbihcImNsaWNrXCIsIFwib25DbGlja0Z1Y2tcIiksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZFZhbHVlKFwidGV4dENvbnRlbnRcIiwgXCJmdWNrTW9kZWwuZnVja1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIFRoaXJkLnByb3RvdHlwZSwgXCJmdWNrXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgVGhpcmQgPSBUaGlyZF8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuRE9NTWVkaWF0b3JDbGFzcyhcIlRoaXJkXCIsIFwiLi9tb2R1bGVzL3Rlc3QuaHRtbFwiKVxyXG4gICAgICAgIF0sIFRoaXJkKTtcclxuICAgICAgICByZXR1cm4gVGhpcmQ7XHJcbiAgICAgICAgdmFyIFRoaXJkXzE7XHJcbiAgICB9KFNjZW5lTWVkaWF0b3JfMS5kZWZhdWx0KSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBUaGlyZDtcclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVZHaHBjbVF1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlVhR2x5WkM1MGN5SmRMQ0p1WVcxbGN5STZXMTBzSW0xaGNIQnBibWR6SWpvaU96czdPenM3T3pzN096czdPenM3T3pzN096czdPMGxCWVVFN096czdPenM3VFVGUFJUdEpRVWRHTzFGQlFXMURMSGxDUVVGaE8xRkJRV2hFT3p0UlFTdERRU3hEUVVGRE8ydENRUzlEYjBJc1MwRkJTenRSUVhkQ1ppd3dRa0ZCVlN4SFFVRnFRanRaUVVWSkxFMUJRVTBzUTBGQlF5eERRVUZETEhGQ1FVRnhRaXhEUVVGRExFTkJRVU03VVVGRGJrTXNRMEZCUXp0UlFVVk5MSE5DUVVGTkxFZEJRV0k3V1VGQlFTeHBRa0ZwUWtNN1dVRm1SeXhKUVVGSkxFTkJRVU1zVTBGQlV5eEhRVUZITzJkQ1FVTmlMRkZCUVZFc1JVRkJSU3hEUVVGRExFTkJRVU1zUlVGQlJTeERRVUZETEVWQlFVVXNUVUZCVFN4RlFVRkZMRXRCUVVzc1EwRkJRenRuUWtGREwwSXNVVUZCVVN4RlFVRkZMRlZCUVZVN1owSkJRM0JDTEZWQlFWVXNSVUZCUlR0dlFrRkRVaXhMUVVGSkxFTkJRVU1zVTBGQlV5eERRVUZETEZGQlFWRXNSMEZCUnl4VFFVRlRMRU5CUVVNN2IwSkJRM0JETEV0QlFVa3NRMEZCUXl4aFFVRmhMRU5CUVVNc1NVRkJTU3hEUVVGRExHZENRVUZOTEVWQlFVVXNTVUZCU1N4RlFVRkZMRWxCUVVrc1EwRkJReXhEUVVGRE8yZENRVU5vUkN4RFFVRkRPMmRDUVVORUxGZEJRVmNzUlVGQlJUdHZRa0ZEVkN4TFFVRkpMRU5CUVVNc1lVRkJZU3hEUVVGRExFbEJRVWtzUTBGQlF5eHRRa0ZCVXl4RFFVRkRMRU5CUVVNN1owSkJRM1pETEVOQlFVTTdaMEpCUTBRc1YwRkJWeXhGUVVGRk8yOUNRVU5VTEV0QlFVa3NRMEZCUXl4aFFVRmhMRU5CUVVNc1MwRkJTeXhEUVVGRExFOUJRVXNzUTBGQlF5eERRVUZETzJkQ1FVTndReXhEUVVGRE8yZENRVU5FTEZOQlFWTXNSVUZCUlN4SlFVRkpMRU5CUVVNc1ZVRkJWVHRoUVVNM1FpeERRVUZETzFGQlEwNHNRMEZCUXp0UlFUVkRZU3huUWtGQlZTeEhRVUZWTEU5QlFVOHNRMEZCUXp0UlFVY3hRenRaUVVSRExHbENRVUZOTzNORFFVTmxMSFZDUVVGaE8yOUVRVUZETzFGQlJYQkRPMWxCUkVNc2FVSkJRVTA3YzBOQlExa3NiVUpCUVZNN2FVUkJRVU03VVVGRk4wSTdXVUZFUXl4cFFrRkJUVHR6UTBGRFdTeHpRa0ZCVlR0cFJFRkJRenRSUVVVNVFqdFpRVVJETEdsQ1FVRk5MRU5CUVVNc1EwRkJReXhEUVVGRE8zTkRRVU5UTEhOQ1FVRlZPMmxFUVVGRE8xRkJTVGxDTzFsQlJrTXNhVUpCUVUwc1EwRkJReXhGUVVGRExFdEJRVXNzUlVGQlJTeFpRVUZaTEVWQlFVTXNRMEZCUXp0WlFVTTNRaXhwUWtGQlRTeERRVUZETEc5Q1FVRnZRaXhEUVVGRE8zTkRRVU5zUWl4WFFVRlhPekJEUVVGQk8xRkJTWFJDTzFsQlNFTXNhMEpCUVU4c1EwRkJReXhyUWtGQmEwSXNRMEZCUXp0WlFVTXpRaXh2UWtGQlV5eERRVUZETEVWQlFVTXNWMEZCVnl4RlFVRkZMR3REUVVGclF5eEZRVUZETEVOQlFVTTdXVUZETlVRc2FVSkJRVTBzUTBGQlF5eFBRVUZQTEVWQlFVVXNZVUZCWVN4RFFVRkRPM05EUVVOd1FpeFhRVUZYT3pCRFFVRkRPMUZCUjNaQ08xbEJSa01zYVVKQlFVMHNRMEZCUXl4UFFVRlBMRVZCUVVVc1lVRkJZU3hEUVVGRE8xbEJRemxDTEc5Q1FVRlRMRU5CUVVNc1lVRkJZU3hGUVVGRkxHZENRVUZuUWl4RFFVRkRPM05EUVVNdlFpeFhRVUZYT3pKRFFVRkRPMUZCZEVKUUxFdEJRVXM3V1VGRWVrSXNNa0pCUVdkQ0xFTkJRVU1zVDBGQlR5eEZRVUZGTEhGQ1FVRnhRaXhEUVVGRE8xZEJRelZDTEV0QlFVc3NRMEVyUTNwQ08xRkJRVVFzV1VGQlF6czdTMEZCUVN4QlFTOURSQ3hEUVVGdFF5eDFRa0ZCWVN4SFFTdERMME03YzBKQkwwTnZRaXhMUVVGTEluMD1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kdWxlcy9UaGlyZC50c1xuLy8gbW9kdWxlIGlkID0gODFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZW5naW5lIH0gZnJvbSBcIi4vZW5naW5lL0VuZ2luZVwiO1xyXG5leHBvcnQgeyBjb3JlIH0gZnJvbSBcIi4vY29yZS9Db3JlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gKlxyXG4gKiBPbHltcHVz5qGG5p625L6/5o235ZCv5Yqo5LiO5qGG5p625aSW6KeC5qih5Z2XXHJcbiovXHJcbnZhciBPbHltcHVzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT2x5bXB1cygpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5ZCv5YqoT2x5bXB1c+ahhuaetlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBwYXJhbSB7SUluaXRQYXJhbXN9IHBhcmFtcyDlkK/liqjlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBPbHltcHVzXHJcbiAgICAgKi9cclxuICAgIE9seW1wdXMuc3RhcnR1cCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICAvLyDliJ3lp4vljJblvJXmk47mqKHlnZdcclxuICAgICAgICBlbmdpbmUuaW5pdGlhbGl6ZShwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPbHltcHVzO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBPbHltcHVzO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9PbHltcHVzLmpzXG4vLyBtb2R1bGUgaWQgPSA4MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCIuL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCBCcmlkZ2VNZXNzYWdlIGZyb20gXCIuL2JyaWRnZS9CcmlkZ2VNZXNzYWdlXCI7XHJcbmltcG9ydCB7IG1vZHVsZU1hbmFnZXIgfSBmcm9tIFwiLi9tb2R1bGUvTW9kdWxlTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBhc3NldHNNYW5hZ2VyIH0gZnJvbSBcIi4vYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi9lbnYvRW52aXJvbm1lbnRcIjtcclxuaW1wb3J0IHsgaGFzaCB9IGZyb20gXCIuL2Vudi9IYXNoXCI7XHJcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tIFwiLi92ZXJzaW9uL1ZlcnNpb25cIjtcclxuaW1wb3J0IE1vZHVsZU1lc3NhZ2UgZnJvbSBcIi4vbW9kdWxlL01vZHVsZU1lc3NhZ2VcIjtcclxuaW1wb3J0IEVuZ2luZU1lc3NhZ2UgZnJvbSBcIi4vbWVzc2FnZS9FbmdpbmVNZXNzYWdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiBFbmdpbmXmqKHnu4TmmK/lvIDlj5HmoYbmnrbnmoTlvJXmk47pg6jliIbvvIzljIXmi6zkuJrliqHmqKHlnZfns7vnu5/jgIHlupTnlKjnqIvluo/lkK/liqjlkozliJ3lp4vljJbjgIHlvLnnqpflkozlnLrmma/nrqHnkIblmajnrYnkuI7pobnnm67lvIDlj5Hnm7jlhbPnmoTpgLvovpHpg73lnKjov5nkuKrmqKHnu4TkuK1cclxuICog6L+Z5Liq5qih57uE55qE6YC76L6R6YO96auY5bqm6ZuG5oiQ5Zyo5a2Q5qih57uE5Lit5LqG77yM5Zug5q2k5Lmf5Y+q5piv5pS26ZuG55u45YWz5a2Q5qih57uEXHJcbiovXHJcbnZhciBFbmdpbmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFbmdpbmUoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMlkVuZ2luZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SUluaXRQYXJhbXN9IHBhcmFtcyDliJ3lp4vljJblj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBFbmdpbmVcclxuICAgICAqL1xyXG4gICAgRW5naW5lLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAvLyDosIPnlKjov5vluqblm57osIPvvIzliJ3lp4vljJbkuLowJVxyXG4gICAgICAgIHBhcmFtcy5vbkluaXRQcm9ncmVzcyAmJiBwYXJhbXMub25Jbml0UHJvZ3Jlc3MoMCwgSW5pdFN0ZXAuUmVhZHlUb0luaXQpO1xyXG4gICAgICAgIC8vIOaJp+ihjOWIneWni+WMllxyXG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09IFwibG9hZGluZ1wiKVxyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBkb0luaXRpYWxpemUpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgZG9Jbml0aWFsaXplKCk7XHJcbiAgICAgICAgZnVuY3Rpb24gZG9Jbml0aWFsaXplKCkge1xyXG4gICAgICAgICAgICAvLyDosIPnlKjov5vluqblm57osIPvvIzlvIDlp4vliJ3lp4vljJbkuLoxMCVcclxuICAgICAgICAgICAgcGFyYW1zLm9uSW5pdFByb2dyZXNzICYmIHBhcmFtcy5vbkluaXRQcm9ncmVzcygwLjEsIEluaXRTdGVwLlN0YXJ0SW5pdCk7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOS6i+S7tlxyXG4gICAgICAgICAgICBpZiAodGhpcyA9PSBkb2N1bWVudClcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZWFkeXN0YXRlY2hhbmdlXCIsIGRvSW5pdGlhbGl6ZSk7XHJcbiAgICAgICAgICAgIC8vIOimgeWIpOaWrWRvY3VtZW505piv5ZCm5Yid5aeL5YyW5a6M5q+VXHJcbiAgICAgICAgICAgIHNlbGYuX2luaXRQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgICAgIC8vIOWKoOi9vemhtVxyXG4gICAgICAgICAgICBzZWxmLl9sb2FkRWxlbWVudCA9ICh0eXBlb2YgcGFyYW1zLmxvYWRFbGVtZW50ID09IFwic3RyaW5nXCIgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhcmFtcy5sb2FkRWxlbWVudCkgOiBwYXJhbXMubG9hZEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAvLyDnm5HlkKzplJnor6/kuovku7ZcclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5vbkVycm9yKVxyXG4gICAgICAgICAgICAgICAgc2VsZi5saXN0ZW5FcnJvcihwYXJhbXMub25FcnJvcik7XHJcbiAgICAgICAgICAgIC8vIOWIneWni+WMlueOr+Wig+WPguaVsFxyXG4gICAgICAgICAgICBlbnZpcm9ubWVudC5pbml0aWFsaXplKHBhcmFtcy5lbnYsIHBhcmFtcy5ob3N0c0RpY3QsIHBhcmFtcy5jZG5zRGljdCk7XHJcbiAgICAgICAgICAgIC8vIOWIneWni+WMlueJiOacrOWPt+W3peWFt1xyXG4gICAgICAgICAgICB2ZXJzaW9uLmluaXRpYWxpemUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So6L+b5bqm5Zue6LCD77yM54mI5pys5Y+35Yid5aeL5YyW5a6M5q+V5Li6MjAlXHJcbiAgICAgICAgICAgICAgICBwYXJhbXMub25Jbml0UHJvZ3Jlc3MgJiYgcGFyYW1zLm9uSW5pdFByb2dyZXNzKDAuMiwgSW5pdFN0ZXAuVmVyc2lvbkluaXRlZCk7XHJcbiAgICAgICAgICAgICAgICAvLyDnm5HlkKxCcmlkZ2XliJ3lp4vljJblrozmr5Xkuovku7bvvIzmmL7npLrnrKzkuIDkuKrmqKHlnZdcclxuICAgICAgICAgICAgICAgIGNvcmUubGlzdGVuKEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FMTF9JTklULCBzZWxmLm9uQWxsQnJpZGdlc0luaXQsIHNlbGYpO1xyXG4gICAgICAgICAgICAgICAgLy8g5rOo5YaM5bm25Yid5aeL5YyW6KGo546w5bGC5qGl5a6e5L6LXHJcbiAgICAgICAgICAgICAgICBicmlkZ2VNYW5hZ2VyLnJlZ2lzdGVyQnJpZGdlLmFwcGx5KGJyaWRnZU1hbmFnZXIsIHBhcmFtcy5icmlkZ2VzKTtcclxuICAgICAgICAgICAgfSwgcGFyYW1zLnZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOmUmeivr+ebkeWQrOWHveaVsFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KGV2dD86RXJyb3JFdmVudCk9PnZvaWR9IGhhbmRsZXIg6ZSZ6K+v55uR5ZCs5Ye95pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgRW5naW5lXHJcbiAgICAgKi9cclxuICAgIEVuZ2luZS5wcm90b3R5cGUubGlzdGVuRXJyb3IgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIGlmIChoYW5kbGVyKVxyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGhhbmRsZXIpO1xyXG4gICAgfTtcclxuICAgIEVuZ2luZS5wcm90b3R5cGUub25BbGxCcmlkZ2VzSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOihqOeOsOWxguahpeWIneWni+WMluWujOavleS4ujMwJVxyXG4gICAgICAgIHRoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MgJiYgdGhpcy5faW5pdFBhcmFtcy5vbkluaXRQcm9ncmVzcygwLjMsIEluaXRTdGVwLkJyaWRnZXNJbml0ZWQpO1xyXG4gICAgICAgIC8vIOazqOmUgOebkeWQrFxyXG4gICAgICAgIGNvcmUudW5saXN0ZW4oQnJpZGdlTWVzc2FnZS5CUklER0VfQUxMX0lOSVQsIHRoaXMub25BbGxCcmlkZ2VzSW5pdCwgdGhpcyk7XHJcbiAgICAgICAgLy8g5Yid5aeL5YyW5o+S5Lu2XHJcbiAgICAgICAgaWYgKHRoaXMuX2luaXRQYXJhbXMucGx1Z2lucykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5faW5pdFBhcmFtcy5wbHVnaW5zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbiA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIHBsdWdpbi5pbml0UGx1Z2luKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5rOo5YaM55+t5ZCN56ewXHJcbiAgICAgICAgYXNzZXRzTWFuYWdlci5jb25maWdQYXRoKHRoaXMuX2luaXRQYXJhbXMucGF0aERpY3QpO1xyXG4gICAgICAgIC8vIOW8gOWni+mihOWKoOi9vei/h+eoi1xyXG4gICAgICAgIHZhciBwcmVsb2FkcyA9IHRoaXMuX2luaXRQYXJhbXMucHJlbG9hZHM7XHJcbiAgICAgICAgaWYgKHByZWxvYWRzKSB7XHJcbiAgICAgICAgICAgIC8vIOWOu+WKoOi9vVxyXG4gICAgICAgICAgICB2YXIgY3VySW5kZXggPSAwO1xyXG4gICAgICAgICAgICB2YXIgdG90YWxDb3VudCA9IHByZWxvYWRzLmxlbmd0aDtcclxuICAgICAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkQXNzZXRzKHByZWxvYWRzLCB0aGlzLm9uUHJlbG9hZE9LLmJpbmQodGhpcyksIG51bGwsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So6L+b5bqm5Zue6LCD77yM5q+P5Liq6aKE5Yqg6L295paH5Lu25bmz5YiGMzAlLTkwJeeahOi/m+W6plxyXG4gICAgICAgICAgICAgICAgdmFyIHByb2dyZXNzID0gMC4zICsgMC42ICogY3VySW5kZXggLyB0b3RhbENvdW50O1xyXG4gICAgICAgICAgICAgICAgLy8g5L+d55WZMuS9jeWwj+aVsFxyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSBNYXRoLnJvdW5kKHByb2dyZXNzICogMTAwKSAqIDAuMDE7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5faW5pdFBhcmFtcy5vbkluaXRQcm9ncmVzcyAmJiBfdGhpcy5faW5pdFBhcmFtcy5vbkluaXRQcm9ncmVzcyhwcm9ncmVzcywgSW5pdFN0ZXAuUHJlbG9hZCwga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5rKh5pyJ6aKE5Yqg6L2977yM55u05o6l5a6M5oiQXHJcbiAgICAgICAgICAgIHRoaXMub25QcmVsb2FkT0soKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRW5naW5lLnByb3RvdHlwZS5vblByZWxvYWRPSyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyDosIPnlKjov5vluqblm57osIPvvIzmiZPlvIDpppbkuKrmqKHlnZfkuLo5MCVcclxuICAgICAgICB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdFByb2dyZXNzICYmIHRoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MoMC45LCBJbml0U3RlcC5PcGVuRmlyc3RNb2R1bGUpO1xyXG4gICAgICAgIC8vIOa0vuWPkeS6i+S7tlxyXG4gICAgICAgIGNvcmUuZGlzcGF0Y2goRW5naW5lTWVzc2FnZS5JTklUSUFMSVpFRCk7XHJcbiAgICAgICAgLy8g6LCD55So5Yid5aeL5YyW5a6M5oiQ5Zue6LCDXHJcbiAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5vbkluaXRlZCAmJiB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdGVkKCk7XHJcbiAgICAgICAgLy8g55uR5ZCs6aaW5Liq5qih5Z2X5byA5ZCvXHJcbiAgICAgICAgY29yZS5saXN0ZW4oTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFLCB0aGlzLm9uTW9kdWxlQ2hhbmdlLCB0aGlzKTtcclxuICAgICAgICAvLyDmiZPlvIDpppbkuKrmqKHlnZdcclxuICAgICAgICBtb2R1bGVNYW5hZ2VyLm9wZW4odGhpcy5faW5pdFBhcmFtcy5maXJzdE1vZHVsZSwgaGFzaC5maXJzdE1vZHVsZVBhcmFtcyk7XHJcbiAgICAgICAgLy8g5aaC5p6c5pyJ5ZOI5biM5qih5Z2X5YiZ5omT5byA5LmLXHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBoYXNoLm1vZHVsZURhdGFzKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gaGFzaC5tb2R1bGVEYXRhc1tpXTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5qih5Z2X5rKh5pyJ5ZCN5a2X5YiZ5LiN6L+b6KGM5pON5L2cXHJcbiAgICAgICAgICAgIGlmIChkYXRhLm5hbWUpXHJcbiAgICAgICAgICAgICAgICBtb2R1bGVNYW5hZ2VyLm9wZW4oZGF0YS5uYW1lLCBkYXRhLnBhcmFtcywgZGF0YS5kaXJlY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFbmdpbmUucHJvdG90eXBlLm9uTW9kdWxlQ2hhbmdlID0gZnVuY3Rpb24gKGZyb20pIHtcclxuICAgICAgICAvLyDosIPnlKjov5vluqblm57osIPvvIzlhajpg6jov4fnqIvlrozmr5XvvIwxMDAlXHJcbiAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5vbkluaXRQcm9ncmVzcyAmJiB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdFByb2dyZXNzKDEsIEluaXRTdGVwLkluaXRlZCk7XHJcbiAgICAgICAgLy8g5rOo6ZSA55uR5ZCsXHJcbiAgICAgICAgY29yZS51bmxpc3RlbihNb2R1bGVNZXNzYWdlLk1PRFVMRV9DSEFOR0UsIHRoaXMub25Nb2R1bGVDaGFuZ2UsIHRoaXMpO1xyXG4gICAgICAgIC8vIOenu+mZpGxvYWRFbGVtZW505pi+56S6XHJcbiAgICAgICAgaWYgKHRoaXMuX2xvYWRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLl9sb2FkRWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICBwYXJlbnQgJiYgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuX2xvYWRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRW5naW5lID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBFbmdpbmUpO1xyXG4gICAgcmV0dXJuIEVuZ2luZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRW5naW5lO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgZW5naW5lID0gY29yZS5nZXRJbmplY3QoRW5naW5lKTtcclxuZXhwb3J0IHZhciBJbml0U3RlcDtcclxuKGZ1bmN0aW9uIChJbml0U3RlcCkge1xyXG4gICAgLyoqIOahhuaetuW3suWHhuWkh+WlveWIneWni+WMliAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJSZWFkeVRvSW5pdFwiXSA9IDBdID0gXCJSZWFkeVRvSW5pdFwiO1xyXG4gICAgLyoqIOW8gOWni+aJp+ihjOWIneWni+WMliAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJTdGFydEluaXRcIl0gPSAxXSA9IFwiU3RhcnRJbml0XCI7XHJcbiAgICAvKiog54mI5pys5Y+357O757uf5Yid5aeL5YyW5a6M5q+VICovXHJcbiAgICBJbml0U3RlcFtJbml0U3RlcFtcIlZlcnNpb25Jbml0ZWRcIl0gPSAyXSA9IFwiVmVyc2lvbkluaXRlZFwiO1xyXG4gICAgLyoqIOihqOeOsOWxguahpeWIneWni+WMluWujOavlSAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJCcmlkZ2VzSW5pdGVkXCJdID0gM10gPSBcIkJyaWRnZXNJbml0ZWRcIjtcclxuICAgIC8qKiDpooTliqDovb3vvIzlj6/og73kvJrop6blj5HlpJrmrKHvvIzmr4/mrKHkvKDpgJLkuKTkuKrlj4LmlbDvvJrpooTliqDovb3mlofku7blkI3miJbot6/lvoTjgIHpooTliqDovb3mlofku7blhoXlrrkgKi9cclxuICAgIEluaXRTdGVwW0luaXRTdGVwW1wiUHJlbG9hZFwiXSA9IDRdID0gXCJQcmVsb2FkXCI7XHJcbiAgICAvKiog5byA5aeL5omT5byA6aaW5Liq5qih5Z2XICovXHJcbiAgICBJbml0U3RlcFtJbml0U3RlcFtcIk9wZW5GaXJzdE1vZHVsZVwiXSA9IDVdID0gXCJPcGVuRmlyc3RNb2R1bGVcIjtcclxuICAgIC8qKiDpppbkuKrmqKHlnZfmiZPlvIDlrozmr5XvvIzliJ3lp4vljJbmtYHnqIvlrozmr5UgKi9cclxuICAgIEluaXRTdGVwW0luaXRTdGVwW1wiSW5pdGVkXCJdID0gNl0gPSBcIkluaXRlZFwiO1xyXG59KShJbml0U3RlcCB8fCAoSW5pdFN0ZXAgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvRW5naW5lLmpzXG4vLyBtb2R1bGUgaWQgPSA4M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTlcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTlcclxuICpcclxuICog5riy5p+T5qih5byP5p6a5Li+XHJcbiovXHJcbnZhciBSZW5kZXJNb2RlO1xyXG4oZnVuY3Rpb24gKFJlbmRlck1vZGUpIHtcclxuICAgIFJlbmRlck1vZGVbUmVuZGVyTW9kZVtcIkFVVE9cIl0gPSAwXSA9IFwiQVVUT1wiO1xyXG4gICAgUmVuZGVyTW9kZVtSZW5kZXJNb2RlW1wiQ0FOVkFTXCJdID0gMV0gPSBcIkNBTlZBU1wiO1xyXG4gICAgUmVuZGVyTW9kZVtSZW5kZXJNb2RlW1wiV0VCR0xcIl0gPSAyXSA9IFwiV0VCR0xcIjtcclxufSkoUmVuZGVyTW9kZSB8fCAoUmVuZGVyTW9kZSA9IHt9KSk7XHJcbmV4cG9ydCBkZWZhdWx0IFJlbmRlck1vZGU7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L1JlbmRlck1vZGUuanNcbi8vIG1vZHVsZSBpZCA9IDg0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvZW52L0Vudmlyb25tZW50XCI7XHJcbmltcG9ydCB7IHBhbmVsTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3BhbmVsL1BhbmVsTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBwbGF0Zm9ybU1hbmFnZXIgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9wbGF0Zm9ybS9QbGF0Zm9ybU1hbmFnZXJcIjtcclxuaW1wb3J0IHsgdmVyc2lvbiB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3ZlcnNpb24vVmVyc2lvblwiO1xyXG52YXIgUmVzb3VyY2VWZXJzaW9uQ29udHJvbGxlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZXNvdXJjZVZlcnNpb25Db250cm9sbGVyKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFZpcnR1YWxVcmwgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgLy8g5re75YqgaW1nRG9tYWluXHJcbiAgICAgICAgdXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgLy8g5re75Yqg54mI5pys5Y+377yM5pyJ5ZOI5biM5YC85bCx55So5ZOI5biM5YC85Yqg6L2977yM5rKh5pyJ5bCx55So57yW6K+R54mI5pys5Y+35Yqg6L29XHJcbiAgICAgICAgdXJsID0gdmVyc2lvbi53cmFwSGFzaFVybCh1cmwpO1xyXG4gICAgICAgIC8vIOi/lOWbnnVybFxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXI7XHJcbn0oUkVTLlZlcnNpb25Db250cm9sbGVyKSk7XHJcbmV4cG9ydCB7IFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXIgfTtcclxuLy8g6L+Z6YeM55u05o6l5rOo5YaM5LiA5LiLXHJcblJFUy5yZWdpc3RlclZlcnNpb25Db250cm9sbGVyKG5ldyBSZXNvdXJjZVZlcnNpb25Db250cm9sbGVyKCkpO1xyXG52YXIgQXNzZXRzTG9hZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXNzZXRzTG9hZGVyKGhhbmRsZXIpIHtcclxuICAgICAgICB0aGlzLl9yZXRyeURpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVyID0gaGFuZGxlcjtcclxuICAgIH1cclxuICAgIEFzc2V0c0xvYWRlci5wcm90b3R5cGUubG9hZEdyb3VwcyA9IGZ1bmN0aW9uIChncm91cHMpIHtcclxuICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICB0aGlzLl9oYW5kbGVyLnN0YXJ0ICYmIHRoaXMuX2hhbmRsZXIuc3RhcnQoKTtcclxuICAgICAgICAvLyDnu4TlkI3lpoLmnpzmmK/nqbrlrZfnrKbkuLLliJnkvJrlr7zoh7RFZ3JldOS7gOS5iOmDveS4jeW5su+8jOaJgOS7peimgeenu+mZpOepuuWtl+espuS4sueahOe7hOWQjVxyXG4gICAgICAgIGdyb3VwcyA9IGdyb3VwcyAmJiBncm91cHMuZmlsdGVyKGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGdyb3VwID09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGdyb3VwICE9IFwiXCIpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGdyb3VwLm5hbWUgIT0gXCJcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g5byA5aeL5Yqg6L29XHJcbiAgICAgICAgdmFyIGdyb3VwRGljdCA9IHt9O1xyXG4gICAgICAgIHZhciBwZ3NEaWN0O1xyXG4gICAgICAgIHZhciBsZW4gPSBncm91cHMgPyBncm91cHMubGVuZ3RoIDogMDtcclxuICAgICAgICBpZiAobGVuID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlci5jb21wbGV0ZSAmJiB0aGlzLl9oYW5kbGVyLmNvbXBsZXRlKGdyb3VwRGljdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBSRVMuYWRkRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9QUk9HUkVTUywgb25Qcm9ncmVzcywgdGhpcyk7XHJcbiAgICAgICAgICAgIFJFUy5hZGRFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX0NPTVBMRVRFLCBvbk9uZUNvbXBsZXRlLCB0aGlzKTtcclxuICAgICAgICAgICAgUkVTLmFkZEV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfTE9BRF9FUlJPUiwgb25PbmVFcnJvciwgdGhpcyk7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gZ3JvdXBzLmNvbmNhdCgpO1xyXG4gICAgICAgICAgICBwZ3NEaWN0ID0ge307XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZ3JvdXBzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGdyb3VwID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBwZ3NEaWN0W2dyb3VwXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgUkVTLmxvYWRHcm91cChncm91cCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwZ3NEaWN0W2dyb3VwLm5hbWVdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBSRVMubG9hZEdyb3VwKGdyb3VwLm5hbWUsIGdyb3VwLnByaW9yaXR5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvblByb2dyZXNzKGV2dCkge1xyXG4gICAgICAgICAgICAvLyDloavlhYXotYTmupDlrZflhbhcclxuICAgICAgICAgICAgdmFyIGl0ZW1EaWN0ID0gZ3JvdXBEaWN0W2V2dC5ncm91cE5hbWVdO1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW1EaWN0KVxyXG4gICAgICAgICAgICAgICAgZ3JvdXBEaWN0W2V2dC5ncm91cE5hbWVdID0gaXRlbURpY3QgPSB7fTtcclxuICAgICAgICAgICAgaXRlbURpY3RbZXZ0LnJlc0l0ZW0ubmFtZV0gPSBldnQucmVzSXRlbTtcclxuICAgICAgICAgICAgLy8g6K6h566X5oC76L+b5bqmXHJcbiAgICAgICAgICAgIHBnc0RpY3RbZXZ0Lmdyb3VwTmFtZV0gPSBldnQuaXRlbXNMb2FkZWQgLyBldnQuaXRlbXNUb3RhbDtcclxuICAgICAgICAgICAgdmFyIHBncyA9IDA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwZ3NEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICBwZ3MgKz0gcGdzRGljdFtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBncyAvPSBsZW47XHJcbiAgICAgICAgICAgIC8vIOWbnuiwg1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyLnByb2dyZXNzICYmIHRoaXMuX2hhbmRsZXIucHJvZ3Jlc3MoZXZ0LnJlc0l0ZW0sIHBncyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uT25lQ29tcGxldGUoZXZ0KSB7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWNleS4gOWujOavleWbnuiwg1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyLm9uZUNvbXBsZXRlICYmIHRoaXMuX2hhbmRsZXIub25lQ29tcGxldGUoZ3JvdXBEaWN0W2V2dC5ncm91cE5hbWVdKTtcclxuICAgICAgICAgICAgLy8g5rWL6K+V5piv5ZCm5YWo6YOo5a6M5q+VXHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRlbXAuaW5kZXhPZihldnQuZ3JvdXBOYW1lKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOenu+mZpOWKoOi9vee7hOWQjVxyXG4gICAgICAgICAgICAgICAgdGVtcC5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgLy8g5Yik5pat5piv5ZCm5YWo6YOo5a6M5oiQXHJcbiAgICAgICAgICAgICAgICBpZiAodGVtcC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOS6i+S7tuebkeWQrFxyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5yZW1vdmVFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX1BST0dSRVNTLCBvblByb2dyZXNzLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9DT01QTEVURSwgb25PbmVDb21wbGV0ZSwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgUkVTLnJlbW92ZUV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfTE9BRF9FUlJPUiwgb25PbmVFcnJvciwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlci5jb21wbGV0ZSAmJiB0aGlzLl9oYW5kbGVyLmNvbXBsZXRlKGdyb3VwRGljdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25PbmVFcnJvcihldnQpIHtcclxuICAgICAgICAgICAgdmFyIGdyb3VwTmFtZSA9IGV2dC5ncm91cE5hbWU7XHJcbiAgICAgICAgICAgIHZhciByZXRyeVRpbWVzID0gdGhpcy5fcmV0cnlEaWN0W2dyb3VwTmFtZV07XHJcbiAgICAgICAgICAgIGlmIChyZXRyeVRpbWVzID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXRyeVRpbWVzID0gMDtcclxuICAgICAgICAgICAgaWYgKHJldHJ5VGltZXMgPCAzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXRyeURpY3RbZ3JvdXBOYW1lXSA9ICsrcmV0cnlUaW1lcztcclxuICAgICAgICAgICAgICAgIC8vIOaJk+WNsOaXpeW/l1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi5Yqg6L295aSx6LSl77yM6YeN6K+V56ysXCIgKyByZXRyeVRpbWVzICsgXCLmrKE6IFwiICsgZ3JvdXBOYW1lKTtcclxuICAgICAgICAgICAgICAgIC8vIOayoeWIsOacgOWkp+mHjeivleasoeaVsO+8jOWwhuS4unVybOa3u+WKoOS4gOS4qumaj+acuuaXtumXtOaIs+mHjeaWsOWKoOWbnuWKoOi9vemYn+WIl1xyXG4gICAgICAgICAgICAgICAgUkVTLmxvYWRHcm91cChldnQuZ3JvdXBOYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaJk+WNsOaXpeW/l1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi5Yqg6L295aSx6LSlM+asoe+8jOato+WcqOWwneivleWIh+aNokNETi4uLlwiKTtcclxuICAgICAgICAgICAgICAgIC8vIOWwneivleWIh+aNokNETlxyXG4gICAgICAgICAgICAgICAgdmFyIGFsbERvbmUgPSBlbnZpcm9ubWVudC5uZXh0Q0ROKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWFsbERvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDph43mlrDliqDovb1cclxuICAgICAgICAgICAgICAgICAgICBSRVMubG9hZEdyb3VwKGV2dC5ncm91cE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk5LqL5Lu255uR5ZCsXHJcbiAgICAgICAgICAgICAgICAgICAgUkVTLnJlbW92ZUV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfUFJPR1JFU1MsIG9uUHJvZ3Jlc3MsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5yZW1vdmVFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX0NPTVBMRVRFLCBvbk9uZUNvbXBsZXRlLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9MT0FEX0VSUk9SLCBvbk9uZUVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjmqKHmnb/mlrnms5VcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVyLm9uZUVycm9yICYmIHRoaXMuX2hhbmRsZXIub25lRXJyb3IoZXZ0KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDliIfmjaJDRE7lpLHotKXkuobvvIzlvLnlh7rmj5DnpLrvvIzkvb/nlKjmiLflj6/ku6XmiYvliqjliLfmlrDpobXpnaJcclxuICAgICAgICAgICAgICAgICAgICBwYW5lbE1hbmFnZXIuY29uZmlybShcIui1hOa6kOe7hOWKoOi9veWksei0pVtcIiArIGdyb3VwTmFtZSArIFwiXe+8jOeCueWHu+ehruWumuWIt+aWsOmhtemdolwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtTWFuYWdlci5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gQXNzZXRzTG9hZGVyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBc3NldHNMb2FkZXI7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L0Fzc2V0c0xvYWRlci5qc1xuLy8gbW9kdWxlIGlkID0gODVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCBXZWJQbGF0Zm9ybSBmcm9tIFwiLi9XZWJQbGF0Zm9ybVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjFcclxuICpcclxuICog5bmz5Y+w5o6l5Y+j566h55CG5Zmo77yM6YCa6L+H5qGl5o6l5qih5byP57uf5LiA5LiN5ZCM5bmz5Y+w55qE5LiN5ZCM5o6l5Y+j77yM5LuO6ICM5a6e546w5a+55qGG5p625YW25LuW5qih5Z2X6YCP5piO5YyWXHJcbiovXHJcbnZhciBQbGF0Zm9ybU1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQbGF0Zm9ybU1hbmFnZXIoKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5bmz5Y+w5o6l5Y+j5a6e546w5a+56LGh77yM6buY6K6k5piv5pmu6YCa572R6aG15bmz5Y+w77yM5Lmf5Y+v5Lul5qC55o2u6ZyA6KaB5a6a5Yi2XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SVBsYXRmb3JtfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBQbGF0Zm9ybU1hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gbmV3IFdlYlBsYXRmb3JtKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIt+aWsOW9k+WJjemhtemdolxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBQbGF0Zm9ybU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGxhdGZvcm1NYW5hZ2VyLnByb3RvdHlwZS5yZWxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybS5yZWxvYWQoKTtcclxuICAgIH07XHJcbiAgICBQbGF0Zm9ybU1hbmFnZXIgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIFBsYXRmb3JtTWFuYWdlcik7XHJcbiAgICByZXR1cm4gUGxhdGZvcm1NYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBQbGF0Zm9ybU1hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBwbGF0Zm9ybU1hbmFnZXIgPSBjb3JlLmdldEluamVjdChQbGF0Zm9ybU1hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGxhdGZvcm0vUGxhdGZvcm1NYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA4NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjFcclxuICpcclxuICog572R6aG15bmz5Y+w5o6l5Y+j5a6e546w57G777yM5Lmf5piv5bmz5Y+w5o6l5Y+j55qE6buY6K6k57G7XHJcbiovXHJcbnZhciBXZWJQbGF0Zm9ybSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdlYlBsYXRmb3JtKCkge1xyXG4gICAgfVxyXG4gICAgV2ViUGxhdGZvcm0ucHJvdG90eXBlLnJlbG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBXZWJQbGF0Zm9ybTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgV2ViUGxhdGZvcm07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wbGF0Zm9ybS9XZWJQbGF0Zm9ybS5qc1xuLy8gbW9kdWxlIGlkID0gODdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgdHdlZW5Gcm9tLCB0d2VlblRvIH0gZnJvbSBcIi4uL3V0aWxzL1R3ZWVuVXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjJcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjJcclxuICpcclxuICog5Zue5by55pWI5p6cXHJcbiovXHJcbnZhciBCYWNrUGFuZWxQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCYWNrUGFuZWxQb2xpY3koKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuaXtuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHBhbmVsIOW8ueWHuuahhuWvueixoVxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIOWujOaIkOWbnuiwg++8jOW/hemhu+iwg+eUqFxyXG4gICAgICogQHBhcmFtIGZyb20g5Yqo55S76LW35aeL54K5XHJcbiAgICAgKi9cclxuICAgIEJhY2tQYW5lbFBvbGljeS5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKHBhbmVsLCBjYWxsYmFjaywgZnJvbSkge1xyXG4gICAgICAgIC8vIOW8gOWni+WKqOeUu+W8ueWHulxyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIGVncmV0LlR3ZWVuLnJlbW92ZVR3ZWVucyhlbnRpdHkpO1xyXG4gICAgICAgIC8vIOaBouWkjeS9k+enr1xyXG4gICAgICAgIGVudGl0eS5zY2FsZVggPSAxO1xyXG4gICAgICAgIGVudGl0eS5zY2FsZVkgPSAxO1xyXG4gICAgICAgIHZhciBmcm9tWCA9IDA7XHJcbiAgICAgICAgdmFyIGZyb21ZID0gMDtcclxuICAgICAgICBpZiAoZnJvbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZyb21YID0gZnJvbS54O1xyXG4gICAgICAgICAgICBmcm9tWSA9IGZyb20ueTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZyb21YID0gZW50aXR5LnN0YWdlLnN0YWdlV2lkdGggKiAwLjU7XHJcbiAgICAgICAgICAgIGZyb21ZID0gZW50aXR5LnN0YWdlLnN0YWdlSGVpZ2h0ICogMC41O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmm7TmlrDlvLnlh7rlkI7kvY3nva5cclxuICAgICAgICBlbnRpdHkueCA9IGZyb21YIC0gZW50aXR5LndpZHRoICogMC41O1xyXG4gICAgICAgIGVudGl0eS55ID0gZnJvbVkgLSBlbnRpdHkuaGVpZ2h0ICogMC41O1xyXG4gICAgICAgIC8vIOW8gOWni+e8k+WKqFxyXG4gICAgICAgIHR3ZWVuRnJvbShlbnRpdHksIHtcclxuICAgICAgICAgICAgeDogZnJvbVgsXHJcbiAgICAgICAgICAgIHk6IGZyb21ZLFxyXG4gICAgICAgICAgICBzY2FsZVg6IDAsXHJcbiAgICAgICAgICAgIHNjYWxlWTogMFxyXG4gICAgICAgIH0sIDMwMCwgZWdyZXQuRWFzZS5iYWNrT3V0KS5jYWxsKGNhbGxiYWNrKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreaXtuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHBvcHVwIOW8ueWHuuahhuWvueixoVxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIOWujOaIkOWbnuiwg++8jOW/hemhu+iwg+eUqFxyXG4gICAgICogQHBhcmFtIHRvIOWKqOeUu+WujOe7k+eCuVxyXG4gICAgICovXHJcbiAgICBCYWNrUGFuZWxQb2xpY3kucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbiAocGFuZWwsIGNhbGxiYWNrLCB0bykge1xyXG4gICAgICAgIC8vIOW8gOWni+WKqOeUu+WFs+mXrVxyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIGVncmV0LlR3ZWVuLnJlbW92ZVR3ZWVucyhlbnRpdHkpO1xyXG4gICAgICAgIHZhciB0b1ggPSAwO1xyXG4gICAgICAgIHZhciB0b1kgPSAwO1xyXG4gICAgICAgIGlmICh0byAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRvWCA9IHRvLng7XHJcbiAgICAgICAgICAgIHRvWSA9IHRvLnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0b1ggPSBlbnRpdHkueCArIGVudGl0eS53aWR0aCAqIDAuNTtcclxuICAgICAgICAgICAgdG9ZID0gZW50aXR5LnkgKyBlbnRpdHkuaGVpZ2h0ICogMC41O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0d2VlblRvKGVudGl0eSwge1xyXG4gICAgICAgICAgICB4OiB0b1gsXHJcbiAgICAgICAgICAgIHk6IHRvWSxcclxuICAgICAgICAgICAgc2NhbGVYOiAwLFxyXG4gICAgICAgICAgICBzY2FsZVk6IDBcclxuICAgICAgICB9LCAzMDAsIGVncmV0LkVhc2UuYmFja0luKS5jYWxsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g5oGi5aSN5L2T56evXHJcbiAgICAgICAgICAgIGVudGl0eS5zY2FsZVggPSAxO1xyXG4gICAgICAgICAgICBlbnRpdHkuc2NhbGVZID0gMTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCYWNrUGFuZWxQb2xpY3k7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEJhY2tQYW5lbFBvbGljeTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvcGFuZWwvQmFja1BhbmVsUG9saWN5LmpzXG4vLyBtb2R1bGUgaWQgPSA4OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjJcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjJcclxuICpcclxuICogRWdyZXTnvJPliqjlt6Xlhbfpm4bvvIznlKjmnaXlvKXooaVFZ3JldOeahFR3ZWVu55qE5LiN6LazXHJcbiovXHJcbmV4cG9ydCBmdW5jdGlvbiB0d2VlblRvKHRhcmdldCwgcHJvcHMsIGR1cmF0aW9uLCBlYXNlKSB7XHJcbiAgICByZXR1cm4gZWdyZXQuVHdlZW4uZ2V0KHRhcmdldCkudG8ocHJvcHMsIGR1cmF0aW9uLCBlYXNlKTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gdHdlZW5Gcm9tKHRhcmdldCwgcHJvcHMsIGR1cmF0aW9uLCBlYXNlKSB7XHJcbiAgICAvLyDlr7nmjaLlj4LmlbDnirbmgIFcclxuICAgIHZhciB0b1Byb3BzID0ge307XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICB0b1Byb3BzW2tleV0gPSB0YXJnZXRba2V5XTtcclxuICAgICAgICB0YXJnZXRba2V5XSA9IHByb3BzW2tleV07XHJcbiAgICB9XHJcbiAgICAvLyDlvIDlp4vnvJPliqhcclxuICAgIHJldHVybiBlZ3JldC5Ud2Vlbi5nZXQodGFyZ2V0KS50byh0b1Byb3BzLCBkdXJhdGlvbiwgZWFzZSk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvdXRpbHMvVHdlZW5VdGlsLmpzXG4vLyBtb2R1bGUgaWQgPSA4OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjJcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjJcclxuICpcclxuICog5reh5YWl5reh5Ye65Zy65pmv5YiH5o2i562W55WlXHJcbiovXHJcbnZhciBGYWRlU2NlbmVQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGYWRlU2NlbmVQb2xpY3koKSB7XHJcbiAgICAgICAgdGhpcy5fdGVtcFNuYXBzaG90ID0gbmV3IGVncmV0LkJpdG1hcCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlh4blpIfliIfmjaLlnLrmma/ml7bosIPluqZcclxuICAgICAqIEBwYXJhbSBmcm9tIOWIh+WHuueahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIHRvIOWIh+WFpeeahOWcuuaZr1xyXG4gICAgICovXHJcbiAgICBGYWRlU2NlbmVQb2xpY3kucHJvdG90eXBlLnByZXBhcmVTd2l0Y2ggPSBmdW5jdGlvbiAoZnJvbSwgdG8pIHtcclxuICAgICAgICBpZiAoZnJvbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByb290ID0gZnJvbS5icmlkZ2Uucm9vdDtcclxuICAgICAgICAgICAgLy8g5oiq5Y+W5b2T5YmN5bGP5bmVXHJcbiAgICAgICAgICAgIHZhciB0ZXh0dXJlID0gbmV3IGVncmV0LlJlbmRlclRleHR1cmUoKTtcclxuICAgICAgICAgICAgdGV4dHVyZS5kcmF3VG9UZXh0dXJlKHJvb3QpO1xyXG4gICAgICAgICAgICB0aGlzLl90ZW1wU25hcHNob3QudGV4dHVyZSA9IHRleHR1cmU7XHJcbiAgICAgICAgICAgIHRoaXMuX3RlbXBTbmFwc2hvdC5hbHBoYSA9IDE7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQodGhpcy5fdGVtcFNuYXBzaG90KTtcclxuICAgICAgICAgICAgLy8g56e76ZmkZnJvbVxyXG4gICAgICAgICAgICB2YXIgZnJvbURpc3BsYXkgPSBmcm9tLnNraW47XHJcbiAgICAgICAgICAgIGlmIChmcm9tRGlzcGxheS5wYXJlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgZnJvbURpc3BsYXkucGFyZW50LnJlbW92ZUNoaWxkKGZyb21EaXNwbGF5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouWcuuaZr+aXtuiwg+W6plxyXG4gICAgICogQHBhcmFtIGZyb20g5YiH5Ye655qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gdG8g5YiH5YWl55qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg5YiH5o2i5a6M5q+V55qE5Zue6LCD5pa55rOVXHJcbiAgICAgKi9cclxuICAgIEZhZGVTY2VuZVBvbGljeS5wcm90b3R5cGUuc3dpdGNoID0gZnVuY3Rpb24gKGZyb20sIHRvLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmIChmcm9tICE9IG51bGwpIHtcclxuICAgICAgICAgICAgLy8g5byA5aeL5reh5Ye6XHJcbiAgICAgICAgICAgIGVncmV0LlR3ZWVuLnJlbW92ZVR3ZWVucyh0aGlzLl90ZW1wU25hcHNob3QpO1xyXG4gICAgICAgICAgICBlZ3JldC5Ud2Vlbi5nZXQodGhpcy5fdGVtcFNuYXBzaG90KS50byh7XHJcbiAgICAgICAgICAgICAgICBhbHBoYTogMFxyXG4gICAgICAgICAgICB9LCAzMDApLmNhbGwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g56e76Zmk5oiq5bGPXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdGVtcFNuYXBzaG90LnBhcmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVtcFNuYXBzaG90LnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl90ZW1wU25hcHNob3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5Zue5pS26LWE5rqQXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdGVtcFNuYXBzaG90LnRleHR1cmUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RlbXBTbmFwc2hvdC50ZXh0dXJlLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wU25hcHNob3QudGV4dHVyZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g56e76Zmk5oiq5bGPXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZW1wU25hcHNob3QucGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RlbXBTbmFwc2hvdC5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fdGVtcFNuYXBzaG90KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZhZGVTY2VuZVBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRmFkZVNjZW5lUG9saWN5O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9zY2VuZS9GYWRlU2NlbmVQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDkwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGJyaWRnZU1hbmFnZXIgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwib2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnlcIjtcclxuaW1wb3J0IEVncmV0QnJpZGdlIGZyb20gXCIuLi8uLi9FZ3JldEJyaWRnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMjVcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMjVcclxuICpcclxuICogRWdyZXTpga7nvanlrp7njrBcclxuKi9cclxudmFyIE1hc2tFbnRpdHlJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWFza0VudGl0eUltcGwocGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5fbWFza0FscGhhID0gMC41O1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdBbHBoYSA9IDAuNTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsQWxwaGEgPSAwLjU7XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ01hc2sgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChwYXJhbXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tYXNrQWxwaGEgPSAocGFyYW1zLm1hc2tBbHBoYSAhPSBudWxsID8gcGFyYW1zLm1hc2tBbHBoYSA6IDAuNSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdBbHBoYSA9IChwYXJhbXMubG9hZGluZ0FscGhhICE9IG51bGwgPyBwYXJhbXMubG9hZGluZ0FscGhhIDogMC41KTtcclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxQYW5lbEFscGhhID0gKHBhcmFtcy5tb2RhbFBhbmVsQWxwaGEgIT0gbnVsbCA/IHBhcmFtcy5tb2RhbFBhbmVsQWxwaGEgOiAwLjUpO1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkaW5nU2tpbkZhY3RvcnkgPSBwYXJhbXMubG9hZGluZ1NraW5GYWN0b3J5O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1hc2tEYXRhID0gcGFyYW1zIHx8IHt9O1xyXG4gICAgICAgIHRoaXMuX21hc2sgPSBuZXcgZWdyZXQuU2hhcGUoKTtcclxuICAgICAgICB0aGlzLl9tYXNrLnRvdWNoRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2sgPSBuZXcgZWdyZXQuU2hhcGUoKTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay50b3VjaEVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTGlzdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrID0gbmV3IGVncmV0LlNoYXBlKCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2sudG91Y2hFbmFibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUsIFwibG9hZGluZ1NraW5cIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJbnmq7ogqRcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9sb2FkaW5nU2tpbiAmJiB0aGlzLl9sb2FkaW5nU2tpbkZhY3RvcnkpXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkaW5nU2tpbiA9IHRoaXMuX2xvYWRpbmdTa2luRmFjdG9yeSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGluZ1NraW47XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuumBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuc2hvd01hc2sgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2hvd2luZ01hc2spXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IHRydWU7XHJcbiAgICAgICAgLy8g5pi+56S6XHJcbiAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKEVncmV0QnJpZGdlLlRZUEUpO1xyXG4gICAgICAgIC8vIOe7mOWItumBrue9qVxyXG4gICAgICAgIGlmIChhbHBoYSA9PSBudWxsKVxyXG4gICAgICAgICAgICBhbHBoYSA9IHRoaXMuX21hc2tBbHBoYTtcclxuICAgICAgICB0aGlzLl9tYXNrLmdyYXBoaWNzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5fbWFzay5ncmFwaGljcy5iZWdpbkZpbGwoMCwgYWxwaGEpO1xyXG4gICAgICAgIHRoaXMuX21hc2suZ3JhcGhpY3MuZHJhd1JlY3QoMCwgMCwgYnJpZGdlLnJvb3Quc3RhZ2Uuc3RhZ2VXaWR0aCwgYnJpZGdlLnJvb3Quc3RhZ2Uuc3RhZ2VIZWlnaHQpO1xyXG4gICAgICAgIHRoaXMuX21hc2suZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG4gICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgIGJyaWRnZS5tYXNrTGF5ZXIuYWRkQ2hpbGQodGhpcy5fbWFzayk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpmpDol4/pga7nvalcclxuICAgICAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmhpZGVNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fc2hvd2luZ01hc2spXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOmakOiXj1xyXG4gICAgICAgIGlmICh0aGlzLl9tYXNrLnBhcmVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLl9tYXNrLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9tYXNrKTtcclxuICAgIH07XHJcbiAgICAvKirlvZPliY3mmK/lkKblnKjmmL7npLrpga7nvakqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmlzU2hvd2luZ01hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dpbmdNYXNrO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pi+56S65Yqg6L295Zu+XHJcbiAgICAgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5zaG93TG9hZGluZyA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zaG93aW5nTG9hZGluZylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdMb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAvLyDmmL7npLpcclxuICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRWdyZXRCcmlkZ2UuVFlQRSk7XHJcbiAgICAgICAgLy8g57uY5Yi26YGu572pXHJcbiAgICAgICAgaWYgKGFscGhhID09IG51bGwpXHJcbiAgICAgICAgICAgIGFscGhhID0gdGhpcy5fbG9hZGluZ0FscGhhO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLmdyYXBoaWNzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suZ3JhcGhpY3MuYmVnaW5GaWxsKDAsIGFscGhhKTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5ncmFwaGljcy5kcmF3UmVjdCgwLCAwLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZVdpZHRoLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZUhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG4gICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgIGJyaWRnZS5tYXNrTGF5ZXIuYWRkQ2hpbGQodGhpcy5fbG9hZGluZ01hc2spO1xyXG4gICAgICAgIC8vIOa3u+WKoGxvYWRpbmfnmq7ogqRcclxuICAgICAgICBpZiAodGhpcy5sb2FkaW5nU2tpbilcclxuICAgICAgICAgICAgYnJpZGdlLm1hc2tMYXllci5hZGRDaGlsZCh0aGlzLmxvYWRpbmdTa2luKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmakOiXj+WKoOi9veWbvlxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaGlkZUxvYWRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zaG93aW5nTG9hZGluZylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgLy8g6ZqQ6JePXHJcbiAgICAgICAgaWYgKHRoaXMuX2xvYWRpbmdNYXNrLnBhcmVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fbG9hZGluZ01hc2spO1xyXG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmdTa2luICE9IG51bGwgJiYgdGhpcy5sb2FkaW5nU2tpbi5wYXJlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2tpbi5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fbG9hZGluZ1NraW4pO1xyXG4gICAgfTtcclxuICAgIC8qKuW9k+WJjeaYr+WQpuWcqOaYvuekumxvYWRpbmcqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmlzU2hvd2luZ0xvYWRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dpbmdMb2FkaW5nO1xyXG4gICAgfTtcclxuICAgIC8qKiDmmL7npLrmqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5zaG93TW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsLCBhbHBoYSkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzU2hvd2luZ01vZGFsTWFzayhwYW5lbCkpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsRGljdC5zZXQocGFuZWwsIHBhbmVsKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTGlzdC5wdXNoKHBhbmVsKTtcclxuICAgICAgICAvLyDmmL7npLpcclxuICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRWdyZXRCcmlkZ2UuVFlQRSk7XHJcbiAgICAgICAgLy8g57uY5Yi26YGu572pXHJcbiAgICAgICAgaWYgKGFscGhhID09IG51bGwpXHJcbiAgICAgICAgICAgIGFscGhhID0gdGhpcy5fbW9kYWxQYW5lbEFscGhhO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLmdyYXBoaWNzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2suZ3JhcGhpY3MuYmVnaW5GaWxsKDAsIGFscGhhKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5ncmFwaGljcy5kcmF3UmVjdCgwLCAwLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZVdpZHRoLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZUhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2suZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG4gICAgICAgIC8vIOa3u+WKoOaYvuekulxyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkucGFyZW50O1xyXG4gICAgICAgIGlmIChwYXJlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHBhcmVudC5nZXRDaGlsZEluZGV4KGVudGl0eSk7XHJcbiAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZEF0KHRoaXMuX21vZGFsUGFuZWxNYXNrLCBpbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDpmpDol4/mqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5oaWRlTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzU2hvd2luZ01vZGFsTWFzayhwYW5lbCkpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsRGljdC5kZWxldGUocGFuZWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxMaXN0LnNwbGljZSh0aGlzLl9tb2RhbFBhbmVsTGlzdC5pbmRleE9mKHBhbmVsKSwgMSk7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5ZCm6L+Y6ZyA6KaBTWFza1xyXG4gICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTGlzdC5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAvLyDpmpDol49cclxuICAgICAgICAgICAgaWYgKHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuX21vZGFsUGFuZWxNYXNrKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOenu+WKqE1hc2tcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX21vZGFsUGFuZWxMaXN0W3RoaXMuX21vZGFsUGFuZWxMaXN0Lmxlbmd0aCAtIDFdLnNraW47XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkucGFyZW50O1xyXG4gICAgICAgICAgICBpZiAocGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyZW50LmdldENoaWxkSW5kZXgoZW50aXR5KTtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZEF0KHRoaXMuX21vZGFsUGFuZWxNYXNrLCBpbmRleCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIOW9k+WJjeaYr+WQpuWcqOaYvuekuuaooeaAgeeql+WPo+mBrue9qSAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmlzU2hvd2luZ01vZGFsTWFzayA9IGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fbW9kYWxQYW5lbERpY3QuZ2V0KHBhbmVsKSAhPSBudWxsKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWFza0VudGl0eUltcGw7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1hc2tFbnRpdHlJbXBsO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9tYXNrL01hc2tFbnRpdHkuanNcbi8vIG1vZHVsZSBpZCA9IDkxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0xN1xyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0xN1xyXG4gKlxyXG4gKiBVSeW3peWFt+mbhlxyXG4qL1xyXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG4vKipcclxuICog5YyF6KOFRVVJ55qERGF0YUdyb3Vw57uE5Lu277yM5L2/55So5Lyg5YWl55qE5aSE55CG5Ye95pWw5aSE55CG5q+P5Liq5riy5p+T5Zmo5pu05paw55qE6YC76L6RXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtldWkuRGF0YUdyb3VwfSBncm91cCDooqvljIXoo4XnmoREYXRhR3JvdXDnu4Tku7ZcclxuICogQHBhcmFtIHsoZGF0YT86YW55LCByZW5kZXJlcj86YW55KT0+dm9pZH0gcmVuZGVyZXJIYW5kbGVyIOa4suafk+WZqOWkhOeQhuWHveaVsO+8jOavj+asoeaVsOaNruabtOaWsOaXtuS8muiiq+iwg+eUqO+8jOWkhOeQhuWNleS4qua4suafk+WZqOeahOa4suafk+mAu+i+kVxyXG4gKiBAcGFyYW0geyhkYXRhcz86ZXVpLklDb2xsZWN0aW9uLCBncm91cD86ZXVpLkRhdGFHcm91cCk9PnZvaWR9IFt1cGRhdGVIYW5kbGVyXSDmlbDmja7mm7TmlrDlpITnkIblh73mlbDvvIzmr4/mrKHmmL7npLrmm7TmlrDml7bkvJrooqvosIPnlKjvvIzlpITnkIbliJfooajmmL7npLrmm7TmlrDlkI7nmoTmuLLmn5PpgLvovpFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3cmFwRVVJTGlzdChncm91cCwgcmVuZGVyZXJIYW5kbGVyLCB1cGRhdGVIYW5kbGVyKSB7XHJcbiAgICBncm91cC5pdGVtUmVuZGVyZXIgPSBJdGVtUmVuZGVyZXIuYmluZChudWxsLCBncm91cC5pdGVtUmVuZGVyZXJTa2luTmFtZSwgcmVuZGVyZXJIYW5kbGVyKTtcclxuICAgIGlmICh1cGRhdGVIYW5kbGVyKSB7XHJcbiAgICAgICAgLy8g55uR5ZCsZ3JvdXDlsLrlr7jmmK/lkKbmlLnlj5hcclxuICAgICAgICB2YXIgZW50ZXJGcmFtZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChncm91cC5jb250ZW50V2lkdGggPiAwIHx8IGdyb3VwLmNvbnRlbnRIZWlnaHQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTkuovku7bnm5HlkKxcclxuICAgICAgICAgICAgICAgIGdyb3VwLnJlbW92ZUV2ZW50TGlzdGVuZXIoZWdyZXQuRXZlbnQuRU5URVJfRlJBTUUsIGVudGVyRnJhbWVIYW5kbGVyLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlSGFuZGxlcihncm91cC5kYXRhUHJvdmlkZXIsIGdyb3VwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZ3JvdXAuYWRkRXZlbnRMaXN0ZW5lcihlZ3JldC5FdmVudC5FTlRFUl9GUkFNRSwgZW50ZXJGcmFtZUhhbmRsZXIsIHRoaXMpO1xyXG4gICAgfVxyXG59XHJcbnZhciBJdGVtUmVuZGVyZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJdGVtUmVuZGVyZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJdGVtUmVuZGVyZXIoc2tpbk5hbWUsIHJlbmRlcmVySGFuZGxlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuc2tpbk5hbWUgPSBza2luTmFtZTtcclxuICAgICAgICBfdGhpcy5fcmVuZGVyZXJIYW5kbGVyID0gcmVuZGVyZXJIYW5kbGVyO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEl0ZW1SZW5kZXJlci5wcm90b3R5cGUuZGF0YUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kYXRhQ2hhbmdlZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVySGFuZGxlcih0aGlzLmRhdGEsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJdGVtUmVuZGVyZXI7XHJcbn0oZXVpLkl0ZW1SZW5kZXJlcikpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9VSVV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDkyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCBDb21tYW5kIGZyb20gXCJvbHltcHVzLXIvY29yZS9jb21tYW5kL0NvbW1hbmRcIjtcclxuaW1wb3J0IEVncmV0QnJpZGdlIGZyb20gXCIuLi8uLi9FZ3JldEJyaWRnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTgtMDItMDVcclxuICogQG1vZGlmeSBkYXRlIDIwMTgtMDItMDVcclxuICpcclxuICog6L+Z5Liq5ZG95Luk5piv5Li65LqG5L+u5aSNZWdyZXTlnKhkaXNwbGF5PT1ub25l5pe26I635Y+W6Ieq6Lqr5bC65a+45piv56m65bC65a+455qEYnVnXHJcbiovXHJcbnZhciBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFVwZGF0ZVNjcmVlblNpemVDb21tYW5kLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQucHJvdG90eXBlLmV4ZWMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMubXNnLnBhcmFtcztcclxuICAgICAgICB2YXIgdG8gPSBwYXJhbXNbMF07XHJcbiAgICAgICAgdmFyIGZyb20gPSBwYXJhbXNbMV07XHJcbiAgICAgICAgaWYgKHRvICYmIHRvLmJyaWRnZS50eXBlID09PSBFZ3JldEJyaWRnZS5UWVBFICYmIGZyb20gJiYgZnJvbS5icmlkZ2UudHlwZSAhPT0gRWdyZXRCcmlkZ2UuVFlQRSkge1xyXG4gICAgICAgICAgICAvLyDmmK/ku47lhbbku5bnsbvlnovlnLrmma/ot7Povazlm57mnaXnmoTvvIzkuLrkuobpmLLmraLlnKjlhbbku5blnLrmma/op6blj5Hov4dyZXNpemXlr7zoh7RlZ3JldOWwuuWvuOWkseaViO+8jOabtOaWsOS4gOasoeWxj+W5leWwuuWvuFxyXG4gICAgICAgICAgICBlZ3JldC51cGRhdGVBbGxTY3JlZW5zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZDtcclxufShDb21tYW5kKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFVwZGF0ZVNjcmVlblNpemVDb21tYW5kO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9jb21tYW5kL1VwZGF0ZVNjcmVlblNpemVDb21tYW5kLmpzXG4vLyBtb2R1bGUgaWQgPSA5M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uL0NvcmVcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTAxXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTAxXHJcbiAqXHJcbiAqIOWGheaguOWRveS7pOexu++8jOWGheaguOWRveS7pOWcqOazqOWGjOS6hua2iOaBr+WQjuWPr+S7peWcqOa2iOaBr+a0vuWPkeaXtuiiq+aJp+ihjFxyXG4qL1xyXG52YXIgQ29tbWFuZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENvbW1hbmQobXNnKSB7XHJcbiAgICAgICAgdGhpcy5tc2cgPSBtc2c7XHJcbiAgICB9XHJcbiAgICBDb21tYW5kLnByb3RvdHlwZS5kaXNwYXRjaCA9IGZ1bmN0aW9uICh0eXBlT3JNc2cpIHtcclxuICAgICAgICB2YXIgcGFyYW1zID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgcGFyYW1zW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb3JlLmRpc3BhdGNoLmFwcGx5KGNvcmUsIFt0eXBlT3JNc2ddLmNvbmNhdChwYXJhbXMpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29tbWFuZDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQ29tbWFuZDtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9jb21tYW5kL0NvbW1hbmQuanNcbi8vIG1vZHVsZSBpZCA9IDk0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBNZWRpYXRvclN0YXR1cyBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvclN0YXR1c1wiO1xyXG5pbXBvcnQgU2NlbmVNZWRpYXRvciBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lZGlhdG9yXCI7XHJcbmltcG9ydCB7IGxpc3RlbkFwcGx5IH0gZnJvbSAnb2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWwnO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMDlcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMDlcclxuICpcclxuICogRWdyZXTnmq7ogqTlt6Xlhbfpm4ZcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBTa2luKG1lZGlhdG9yLCBza2luKSB7XHJcbiAgICB2YXIgcmVzdWx0O1xyXG4gICAgdmFyIGNvbXAgPSBnZXRDb21wb25lbnQoc2tpbik7XHJcbiAgICBpZiAoIWNvbXAgJiYgIShza2luIGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdCkpIHtcclxuICAgICAgICB2YXIgY29tcENscyA9ICgobWVkaWF0b3Iuc2tpbiBpbnN0YW5jZW9mIGV1aS5Db21wb25lbnQgJiYgbWVkaWF0b3Iuc2tpbi5jb25zdHJ1Y3RvcikgfHwgZXVpLkNvbXBvbmVudCk7XHJcbiAgICAgICAgY29tcCA9IG5ldyBjb21wQ2xzKCk7XHJcbiAgICAgICAgY29tcC5za2luTmFtZSA9IHNraW47XHJcbiAgICAgICAgcmVzdWx0ID0gY29tcDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJlc3VsdCA9IHNraW47XHJcbiAgICB9XHJcbiAgICAvLyDliKTmlq3kuK3ku4vogIXlvZPliY3nirbmgIFcclxuICAgIGlmIChtZWRpYXRvci5zdGF0dXMgPCBNZWRpYXRvclN0YXR1cy5PUEVOSU5HKSB7XHJcbiAgICAgICAgbGlzdGVuQXBwbHkobWVkaWF0b3IsIFwib25PcGVuXCIsIGRvV3JhcFNraW4pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g55u05o6l5omn6KGM6KaB5omn6KGM55qEXHJcbiAgICAgICAgZG9XcmFwU2tpbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIGZ1bmN0aW9uIGRvV3JhcFNraW4oKSB7XHJcbiAgICAgICAgLy8g5Zy65pmv6ZyA6KaB5ouJ5Ly45Yiw5LiOc3RhZ2XlkIzlrr3pq5hcclxuICAgICAgICBpZiAobWVkaWF0b3IgaW5zdGFuY2VvZiBTY2VuZU1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIGNvbXAucGVyY2VudFdpZHRoID0gMTAwO1xyXG4gICAgICAgICAgICBjb21wLnBlcmNlbnRIZWlnaHQgPSAxMDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWQr+WKqOW8leeUqOi9rOWPkVxyXG4gICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyICYmIGNvbXAgJiYgY29tcC5za2luKSB7XHJcbiAgICAgICAgICAgIC8vIOi9rOWPkXVp5byV55So77yM5aaC5p6c5Lyg5YWl55qE5piv5pi+56S65a+56LGh77yM5YiZ6ZyA6KaB5Yik5pat55uu5qCH5piv5ZCm5bGe5LqO6K+l5a+56LGh55qE5ZCO6KOUXHJcbiAgICAgICAgICAgIHZhciBuZWVkSnVkZ2VEZXNjZW5kYW50ID0gKHNraW4gaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGNvbXAuc2tpbi5za2luUGFydHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBjb21wW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuZWVkSnVkZ2VEZXNjZW5kYW50IHx8IGlzRGVzY2VuZGFudCh0YXJnZXQsIHNraW4pKVxyXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yW25hbWVdID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldENvbXBvbmVudChza2luKSB7XHJcbiAgICBpZiAoIShza2luIGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdCkpXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAoc2tpbiBpbnN0YW5jZW9mIGV1aS5Db21wb25lbnQgJiYgc2tpbi5za2luKVxyXG4gICAgICAgIHJldHVybiBza2luO1xyXG4gICAgcmV0dXJuIGdldENvbXBvbmVudChza2luLnBhcmVudCk7XHJcbn1cclxuZnVuY3Rpb24gaXNEZXNjZW5kYW50KGRlc2NlbmRhbnQsIGFzY2VuZGFudCkge1xyXG4gICAgcmV0dXJuIChkZXNjZW5kYW50ICE9PSBhc2NlbmRhbnQgJiYgY29udGFpbnMoZGVzY2VuZGFudCwgYXNjZW5kYW50KSk7XHJcbn1cclxuZnVuY3Rpb24gY29udGFpbnModGFyZ2V0LCBwYXJlbnQpIHtcclxuICAgIGlmICghdGFyZ2V0IHx8ICFwYXJlbnQpXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKHRhcmdldCA9PT0gcGFyZW50KVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgcmV0dXJuIGNvbnRhaW5zKHRhcmdldC5wYXJlbnQsIHBhcmVudCk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvdXRpbHMvU2tpblV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDk1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=